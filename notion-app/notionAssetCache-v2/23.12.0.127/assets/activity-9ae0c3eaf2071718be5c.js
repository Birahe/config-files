"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1471],{48298:(e,t,o)=>{o.d(t,{kn:()=>m,kj:()=>p,Tr:()=>g});var i=o(58129),r=o(90468),a=o(19889),n=o(50906),s=o(54642),d=o(10279),c=o(9953),l=o(30149),h=o(85057),u=o(98905);const m=async e=>{const{environment:t,store:o,accessRequestStore:i,forActor:r,status:s,from:h}=e,u=t.currentUser.id;if("approved"===s){const e={type:"existingUser",value:r,spaceRole:"read_and_write"};if(!(await d.n_({environment:t,store:o,inviteTargets:[e],inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return}l.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{c.sW({store:i,transaction:e,data:{granted_time:Date.now(),granted_by_table:a.KJ,granted_by_id:u,resolved_time:Date.now(),resolved_by_table:a.KJ,resolved_by_id:u,status:s}})}}),n.O8I(t,{status:s,request_id:i.id,from:h,for_actor_id:r.id,space_role:o.getRole()})};async function p(e){if(u.Z.reset(),!e.canAdmin)return;const{environment:t,spaceId:o}=e,i=await s.getUnreadAccessRequestCount(t,{parentTable:r.bx,parentId:o,size:1});"success"===i.type&&u.Z.setState({spaceId:o,count:i.data.count})}function g(e,t){const o=new Map;for(const r of t){const t=(0,h.Kv)(e,{table:i.J8,id:r}),n=t.getValue();if(!n)continue;if(n.for_actor_table!==a.KJ||n.created_by_table!==a.KJ)continue;const s=(0,h.Kv)(e,{table:n.for_actor_table,id:n.for_actor_id}).getValue();if(!s)continue;const d=(0,h.Kv)(e,{table:n.created_by_table,id:n.created_by_id}).getValue();if(d)if(o.has(n.for_actor_id)){const e=o.get(n.for_actor_id);if(!e)continue;n.created_time>e.latestRequestTime?o.set(n.for_actor_id,{...e,createdByActorsWithReason:[{actor:d,reason:n.message},...e.createdByActorsWithReason],accessRequest:n,accessRequestStore:t,latestRequestTime:n.created_time}):o.set(n.for_actor_id,{...e,createdByActorsWithReason:[...e.createdByActorsWithReason,{actor:d,reason:n.message}]})}else o.set(n.for_actor_id,{forActor:s,createdByActorsWithReason:[{actor:d,reason:n.message}],accessRequest:n,accessRequestStore:t,latestRequestTime:n.created_time})}return Array.from(o.values())}},68831:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Ko});var i=o(97464),r=o.n(i),a=o(77094),n=o.n(a),s=o(67294),d=o(83355),c=o(40902),l=o(15145),h=o(41432),u=o(39068),m=o(55061),p=o(89101),g=o(21202),v=o(6287),b=o(13493),f=o(70279),y=o(33709),S=o(90468),A=o(99108),M=o(97880),w=o(5366),O=o(85057),k=o(480),R=o(81954),_=o(24405),T=o(58129),J=o(29369),I=o(19889),C=o(82990),D=o(4708),B=o(33929),N=o(49085),P=o(66897),V=o(8848),x=o(3779),L=o(17659),F=o(37834),Z=o(30149),K=o(43250),U=o(12534),E=o(16402),q=o(4761),z=o(73063),G=o(86176),H=o(58032),W=o(70301),Y=o(45653),$=o(67706),j=o(62967),X=o(19719),Q=o(60709),ee=o(98742),te=o(10161),oe=o(48019),ie=o(31945),re=o(78140),ae=o(72495),ne=o(64369),se=o(44890);function de(e){window.__c={n:"InboxActionsMenu"};const{notification:t,rootStore:o,onArchiveClicked:i,onMarkAsReadClicked:a,onMarkAsUnreadClicked:d}=e,c=(0,k.O7)(),l=(0,k.Fy)(),h=(0,w.useIntl)(),u=(0,R.VK)((()=>(0,D.NP)()),[]),p=(0,R.VK)((()=>(0,D.m7)()),[]),v=(0,R.VK)((()=>!!t&&(0,m.$2)(t.type)),[t]),b=(0,R.VK)((()=>{const e=null==t?void 0:t.navigable_block_id;if(e)return O.G.createChildStore(o,{table:g.iU,id:e})}),[o,t]),f=(0,R.VK)((()=>null==b?void 0:b.getFollowSettingsKey()),[b]),y=(0,R.VK)((()=>{if(!f)return[];if(!b)return[];const e="inbox";return te.default.checkGate("property_updates_notifications")?(0,se.CA)({followSettingsKey:f,environment:c,blockStore:b,from:e,useCopyChanges:p}):(0,se.Zk)({followSettingsKey:f,environment:c,blockStore:b,from:e})}),[f,c,b,p]),S=(0,R.VK)((()=>u&&v&&y.length>0),[u,v,y]),A=(0,s.useCallback)((e=>{t&&(0,U.ZP)({event:e,context:U.Af.NotificationClick,callback:()=>{i(),Z.createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:c,perform:e=>{L.aZ({notification:t,rootStore:o,transaction:e})}})}})}),[c,t,i,o]),M=(0,s.useCallback)((e=>{t&&(0,U.ZP)({event:e,context:U.Af.NotificationClick,callback:()=>{t.read?d():a(),Z.createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:c,perform:e=>{L.$h({notification:t,rootStore:o,transaction:e,read:!t.read})}})}})}),[c,t,a,d,o]),T=(0,s.useCallback)((()=>{f&&b&&t&&X.Z8({environment:c,notificationId:t.id,pageId:b.pointer.id,isCurrentlyFollowing:(0,se.v5)(f).following,from:"inbox"})}),[c,b,f,t]),J=(0,_.yK)((e=>({container:{display:"flex",height:"min-content",background:e.buttonGroupBackground,boxShadow:e.lightBoxShadow,borderRadius:4,padding:2},button:{height:l.isMobile?30:26,width:l.isMobile?30:26},iconStyle:{fill:e.mediumIconColor,padding:2},readIcon:{width:l.isMobile?21:19,height:l.isMobile?22:20},archiveIcon:{width:l.isMobile?24:23,height:l.isMobile?24:23},ellipsisIcon:{width:l.isMobile?24:23,height:l.isMobile?24:23},headerLabel:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:C.Z.fontWeight.semibold},footerLabel:{padding:12,backgroundColor:e.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${e.regularDividerColor}`,marginTop:1}})),[l]);return t?n()("div",{style:J.container},void 0,n()(H.Z,{renderTooltip:()=>t.read?n()(w.FormattedMessage,{defaultMessage:"Mark this notification as unread",id:"inboxActionsMenu.markNotificationAsUnread.tooltipMessage",description:"Tooltip message for the icon button to mark a notification as unread. The icon is an image of an empty speech bubble."}):n()(w.FormattedMessage,{defaultMessage:"Mark this notification as read",id:"inboxActionsMenu.markNotificationAsRead.tooltipMessage",description:"Tooltip message for the icon button to mark a notification as read. The icon is an image of a speech bubble with a checkmark in it."}),render:e=>s.createElement(z.Z,r()({style:J.button,icon:t.read?x.Z.notificationUnread:x.Z.notificationRead,iconStyle:{...J.iconStyle,...J.readIcon},onClick:M},e))}),n()(H.Z,{renderTooltip:()=>n()(w.FormattedMessage,{defaultMessage:"Archive this notification",id:"inboxActionsMenu.handleArchive.tooltipMessage",description:"Tooltip message for the icon button to archive a notification. The icon is an image of a storage file box."}),render:e=>s.createElement(z.Z,r()({style:J.button,icon:x.Z.archive,iconStyle:{...J.iconStyle,...J.archiveIcon},onClick:A},e))}),S&&n()(H.Z,{renderTooltip:()=>s.createElement(w.FormattedMessage,ce.changePageNotificationSettings),render:e=>n()(ie.ZP,{popupType:l.isMobile?ie.Z4.SlideUp:ie.Z4.Popup,alignmentToOrigin:ie.vR.Start,placementToOrigin:ie.pO.Bottom,render:e=>n()(re.Z,{menuType:Q.og.Popup,minWidth:290,maxHeight:"50vh",maxWidth:l.isMobile?"100vw":void 0,header:n()(ne.Z,{style:J.headerLabel,isSmall:!0,isSecondaryColor:!0},void 0,n()(w.FormattedMessage,p?{id:"UpdateSidebarTabUpdatesHeader.pageNotificationSettings.label",defaultMessage:"Page notification settings",description:"Label for the get notified dropdown in the Updates sidebar"}:{id:"UpdateSidebarTabUpdatesHeader.getNotifiedButton.label",defaultMessage:"Get notified for",description:"Label for the get notified dropdown in the Updates sidebar"}))},void 0,n()(oe.Z,{context:{blocks:[],environment:c,publicEditMode:void 0},sections:[(0,j.$J)({key:"in-app-notifications-section",render:e=>s.createElement(ae.Z,e),actions:y.map((e=>e.action))})],initialFocus:void 0,onAccept:()=>e.close()}),p&&n()(ne.Z,{style:J.footerLabel,isMultiline:!0,isSmall:!0},void 0,n()(w.FormattedMessage,{id:"GetNotifiedDropdown.dropdownSelect.caption",defaultMessage:"You will always be notified of @mentions and discussions involving you",description:"Footer in menu explaining that user is always subscribed to replies and @mentions."}))),renderOrigin:t=>s.createElement(z.Z,r()({ariaLabel:h.formatMessage(ce.changePageNotificationSettings),style:J.button,icon:x.Z.ellipsis,iconStyle:{...J.iconStyle,...J.archiveIcon}},e,(0,ee.Z)(t,{onClick:()=>T()})))})})):null}const ce=(0,w.defineMessages)({changePageNotificationSettings:{defaultMessage:"Change page notification settings",id:"inboxActionsMenu.notificationSettings.tooltipMessage",description:"Tooltip message for the three dot icon button that opens a popup to the page notification settings."}}),le=s.memo(de);var he=o(32469),ue=o(93963);class me extends d.Z{constructor(){super(...arguments),this.storeTypes={hovered:N.default.createClass(!1),hoveredOverInboxActionsMenu:N.default.createClass(!1)},this.handleMouseOver=()=>{this.stores.hovered.setState(!0)},this.handleMouseLeave=()=>{this.stores.hovered.setState(!1)},this.handleMouseEnterInboxActions=()=>{this.stores.hoveredOverInboxActionsMenu.setState(!0)},this.handleMouseLeaveInboxActions=()=>{this.stores.hoveredOverInboxActionsMenu.setState(!1)},this.handleArchive=()=>{const{notification:e,rootStore:t,onArchiveClicked:o}=this.props;o(),e&&Z.createAndCommit({userAction:"ActivitySection.handleArchive",environment:this.environment,perform:o=>{L.aZ({notification:e,rootStore:t,transaction:o})}})},this.handleMarkAsRead=e=>{const{notification:t,rootStore:o,onNotificationFrameClicked:i}=this.props;t&&!t.read&&(this.stores.hoveredOverInboxActionsMenu.state||(0,U.ZP)({event:e,context:U.Af.NotificationClick,callback:()=>{i(),Z.createAndCommit({userAction:"ActivitySection.handleMarkAsRead",environment:this.environment,perform:e=>{L.$h({notification:t,rootStore:o,transaction:e,read:!0})}})}}))},this.handleOpenSnapshot=()=>{if(this.props.navigableBlockId){const e=O.G.createChildStore(this.props.rootStore,{table:g.iU,id:this.props.navigableBlockId});F.jN({environment:this.environment,blockStore:e,openSnapshotNearTimestamp:this.props.timestamp.toString(),from:"activity"})}}}renderComponent(){const{children:e}=this.props,t="mentions"===q.ZP.state.currentTab;return n()("div",{onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,onClick:this.handleMarkAsRead},void 0,this.renderInboxActions(),n()("div",{style:{...me.wrapStyle,paddingBottom:e?12:8,paddingLeft:this.environment.device.isMobile?this.environment.WindowSizeStore.state.paddingLeftCSS:0,paddingRight:this.environment.device.isMobile?this.environment.WindowSizeStore.state.paddingRightCSS:0,...this.shouldShowReadNotificationStyle()&&{opacity:.7}}},void 0,n()("div",{style:this.getHeaderAndAvatarStyle()},void 0,n()("div",{className:K.FoE,style:this.avatarAndStatusDotStyle()},void 0,n()("div",{style:{marginRight:4}},void 0,t&&n()("div",{style:{marginRight:this.environment.device.isMobile?3:2}},void 0,this.renderStatusDot({opacity:1}))),this.props.icon),this.renderHeader(),this.renderSnapshotButton(),this.renderPrivate()),e&&this.renderChildren()),this.renderDivider())}renderDivider(){const{isLast:e}=this.props;if(!e)return n()("div",{style:this.getBorderBottomStyle()})}renderHeader(){const{timestamp:e,header:t}=this.props,o=(0,E.IS)(e),i=(0,E.uy)(e);return n()("div",{style:me.headerStyle},void 0,n()("div",{className:K.NFf},void 0,t),n()("div",{style:{display:"flex",marginTop:4,marginBottom:this.props.children?8:4}},void 0,n()("div",{style:this.getTimeStyle(),className:K.CZG},void 0,n()($.Z,{text:o,tooltipText:i,icon:x.Z.calendar})),this.props.navigableBlockId&&this.props.rootStore&&n()(G.Z,{isLink:!0,innerStyle:this.getPathStyle(),store:O.G.createChildStore(this.props.rootStore,{table:g.iU,id:this.props.navigableBlockId}),left:n()("div",{style:this.getSeparatorDotStyle()},void 0,"·"),onClick:this.props.onBacklinkClicked})))}renderSnapshotButton(){if(!this.props.showSnapshotButton)return;if(this.props.timestamp<new Date("2018-10-26").getTime())return;const e=B.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"});return this.props.navigableBlockId?n()(H.Z,{renderTooltip:()=>e,render:t=>s.createElement(z.Z,r()({ariaLabel:e,onClick:this.handleOpenSnapshot,icon:x.Z.versionHistoryThick},t))}):void 0}renderInboxActions(){const{notification:e,rootStore:t,onArchiveClicked:o,onMarkAsReadClicked:i,onMarkAsUnreadClicked:r}=this.props,{currentTab:a}=q.ZP.state;if("mentions"===a&&e&&!e.visited)return n()("div",{style:this.getStatusLabelContainerStyle(),onMouseEnter:this.handleMouseEnterInboxActions,onMouseLeave:this.handleMouseLeaveInboxActions},void 0,n()("div",{style:this.getInboxActionsStyle()},void 0,n()(le,{notification:e,rootStore:t,onArchiveClicked:o,onMarkAsReadClicked:i,onMarkAsUnreadClicked:r})))}renderStatusDot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!this.isSeen()&&n()(ue.z,{style:{...this.getStatusDotStyle(),...e}})}renderPrivate(){if(this.props.isPrivate&&!this.props.notification)return n()(he.Z,{style:{marginTop:1,marginBottom:4,marginLeft:8}})}renderChildren(){return n()("div",{className:K.nU_},void 0,this.props.children)}isSeen(){const{notification:e}=this.props;return!e||e.read}shouldShowReadNotificationStyle(){const{currentTab:e}=q.ZP.state;return this.isSeen()&&"mentions"===e&&!this.props.showSnapshotButton&&this.props.notification}avatarAndStatusDotStyle(){return{display:"flex",alignItems:"flex-start",position:"relative"}}getHeaderAndAvatarStyle(){return{display:"flex",paddingLeft:16,paddingRight:16+("mentions"!==q.ZP.state.currentTab||this.props.showSnapshotButton?0:69)}}getBorderBottomStyle(){return{borderBottom:`1px solid ${this.theme.regularDividerColor}`}}getPathStyle(){return{fontSize:12,color:this.theme.lightTextColor}}getTimeStyle(){return{fontSize:12,color:this.theme.lightTextColor,whiteSpace:"nowrap"}}getSeparatorDotStyle(){return{fontSize:12,color:this.theme.lightTextColor,marginLeft:4,marginRight:4}}getStatusLabelContainerStyle(){return{display:"flex",alignItems:"flex-start",marginTop:1,marginBottom:4,position:"relative",marginLeft:this.environment.device.isMobile?23:8}}getStatusDotStyle(){return{position:"absolute",opacity:this.stores.hovered.state?0:1,left:-7,top:10}}getInboxActionsStyle(){const{isMobile:e}=this.environment.device;return{transition:"opacity 100ms ease-out",opacity:e||this.stores.hovered.state?1:0,position:"absolute",right:16,top:12,zIndex:1}}}me.displayName="ActivitySection",me.wrapStyle={paddingTop:12},me.headerStyle={fontSize:14,lineHeight:1.4,flexGrow:1,minWidth:0};const pe={marginTop:2,marginRight:8,flexShrink:0};function ge(e){let{actor:t,environment:o}=e;const i=o.currentUser.id===t.value.id;return Number((0,P.z8)(t))+Number(i)}function ve(e){const{authors:t}=e,o=(0,k.O7)(),i=t.sort(((e,t)=>ge({actor:e,environment:o})-ge({actor:t,environment:o})))[0];return i&&(0,P.z8)(i)?n()(W.Z,{botValue:i.value,style:pe,size:24}):n()(Y.Z,{userValue:i&&i.value,style:pe,size:24,avatarShouldShowShadow:!0})}function be(){return window.__c={n:"ReminderIcon"},n()("div",{style:{display:"flex",backgroundColor:V.ZP.red,height:28,width:28,borderRadius:"100%",...pe}},void 0,x.Z.alarmClock({height:16,width:16,fill:V.ZP.white,marginLeft:6,marginTop:5}))}function fe(){return window.__c={n:"VerificationIcon"},n()("div",{style:{height:25,width:25,...pe}},void 0,x.Z.typesVerification({height:25,width:25}))}const ye=me;function Se(e){window.__c={n:"ActivitySectionRedesignedIA"};const[t,o]=(0,s.useState)(!1),[i,r]=(0,s.useState)(!1),{notification:a,prominentTitleLink:d,children:c,rootStore:l,icon:h,isPrivate:u,isLast:m,onBacklinkClicked:p,onArchiveClicked:g,onNotificationFrameClicked:v,onMarkAsReadClicked:b,onMarkAsUnreadClicked:f,showRecordPath:y,navigableBlockId:S,showSnapshotButton:A,timestamp:M,header:w}=e,O=(0,k.O7)(),T=(0,R.VK)((()=>"mentions"===q.ZP.state.currentTab),[]),J=!a||a.read,I=O.device.isMobile,C=Boolean(J&&T&&!A&&a),D=(0,R.VK)((()=>{const e=O.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[O.WindowSizeStore]),B=(0,_.yK)((e=>({container:{paddingTop:12,paddingBottom:c?12:8,paddingLeft:I?D.left:0,paddingRight:I?D.right:0,...C&&{opacity:.7}},headerAndAvatar:{display:"flex",paddingLeft:16,paddingRight:16},avatarAndStatusDot:{display:"flex",alignItems:"flex-start",position:"relative"},statusDot:{position:"absolute",opacity:1,left:-7,top:10},statusDotWrapper:{marginRight:I?3:2},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},divider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[c,D,I,C]),N=(0,s.useCallback)((e=>{a&&!a.read&&(i||(0,U.ZP)({event:e,context:U.Af.NotificationClick,callback:()=>{v(),Z.createAndCommit({userAction:"ActivitySectionRedesignedIA.handleMarkAsRead",environment:O,perform:e=>{L.$h({notification:a,rootStore:l,transaction:e,read:!0})}})}}))}),[O,i,a,v,l]),P=(0,s.useCallback)((()=>o(!0)),[]),V=(0,s.useCallback)((()=>o(!1)),[]);return n()("div",{onMouseOver:P,onMouseLeave:V,onClick:N},void 0,n()(Ae,{notification:a,rootStore:l,isMobile:I,isHovered:t,isMentionsTab:T,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onArchiveClicked:g,onMarkAsReadClicked:b,onMarkAsUnreadClicked:f}),n()("div",{style:B.container},void 0,n()("div",{style:B.headerAndAvatar},void 0,n()("div",{className:K.FoE,style:B.avatarAndStatusDot},void 0,n()("div",{style:{marginRight:4}},void 0,T&&n()("div",{style:B.statusDotWrapper},void 0,!J&&n()(ue.z,{style:B.statusDot}))),h),n()(Me,{timestamp:M,header:w,prominentTitleLink:d,hasChildren:Boolean(c),navigableBlockId:S,rootStore:l,onBacklinkClick:p,showRecordPath:y}),A&&S&&n()(we,{timestamp:M,navigableBlockId:S,rootStore:l}),u&&!a&&n()(he.Z,{style:B.privatePageBadge})),c&&n()("div",{className:K.nU_},void 0,c)),!m&&n()("div",{style:B.divider}))}function Ae(e){window.__c={n:"InboxActions"};const{notification:t,rootStore:o,isMobile:i,isHovered:r,isMentionsTab:a,onArchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:c,onMouseEnter:l,onMouseLeave:h}=e,u=(0,_.yK)((()=>({container:{display:"flex",alignItems:"flex-start",marginTop:1,marginBottom:4,position:"relative",marginLeft:i?23:8},body:{transition:"opacity 100ms ease-out",opacity:i||r?1:0,position:"absolute",right:16,top:12,zIndex:1}})),[i,r]);return a&&t?t.visited?null:n()("div",{style:u.container,onMouseEnter:l,onMouseLeave:h},void 0,n()("div",{style:u.body},void 0,n()(le,{notification:t,rootStore:o,onArchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:c}))):null}function Me(e){window.__c={n:"Header"};const{timestamp:t,prominentTitleLink:o,header:i,hasChildren:r,navigableBlockId:a,rootStore:s,showRecordPath:d,onBacklinkClick:c}=e,l=(0,E.IS)(t,{useCompactFormat:!0}),h=(0,k.O7)().device.isMobile,u=(0,E.uy)(t),m=(0,_.yK)((e=>({container:{width:"100%"},header:{width:h?"calc(100% - 98px)":"calc(100% - 90px)",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:h?28:void 0,display:"flex",alignItems:"baseline"},title:{fontSize:14,marginTop:4,marginBottom:r?8:4},time:{fontSize:12,color:e.lightTextColor,whiteSpace:"nowrap",display:"inline",paddingLeft:6},path:{marginTop:4,marginBottom:4},separatorDot:{fontSize:12,color:e.lightTextColor,marginLeft:4,marginRight:4}})),[r,h]);return n()("div",{style:m.container},void 0,n()("div",{style:m.header},void 0,n()("div",{className:K.NFf},void 0,i,n()("div",{style:m.time,className:K.CZG},void 0,n()($.Z,{text:l,tooltipText:u,icon:x.Z.calendar})))),d&&a&&s&&n()("div",{style:m.path},void 0,n()(G.Z,{isLink:!0,store:O.G.createChildStore(s,{table:g.iU,id:a}),onClick:c})),o&&n()("div",{style:m.title},void 0,o))}function we(e){window.__c={n:"SnapshotButton"};const{timestamp:t,navigableBlockId:o,rootStore:i}=e,a=(0,k.O7)();if(t<new Date("2018-10-26").getTime())return null;const d=B.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),c=()=>{const e=O.G.createChildStore(i,{table:g.iU,id:o});F.jN({environment:a,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return n()(H.Z,{renderTooltip:()=>d,render:e=>s.createElement(z.Z,r()({ariaLabel:d,onClick:c,icon:x.Z.versionHistoryThick},e))})}const Oe=s.memo(Se);var ke=o(96486),Re=o.n(ke),_e=o(24211),Te=o(61784),Je=o(77420),Ie=o(48298),Ce=o(50906),De=o(91376),Be=o(64404),Ne=(o(41892),o(76725)),Pe=o(55384),Ve=o(63306),xe=o(64002);class Le extends s.PureComponent{render(){const{href:e}=this.props;return n()("a",{href:(0,xe.Nm)({str:e,allowNoProtocol:!0}),style:this.getStyle(),className:"notion-email-button-hover"},void 0,this.props.children)}getStyle(){return{display:this.props.inline?"inline":"block",color:V.ZP.inherit,textDecoration:"none",cursor:"pointer",...this.props.style}}}const Fe=Le;class Ze extends s.PureComponent{render(){const e=this.getPathWithoutDomain();return e.length>0?n()("div",{},void 0,this.props.left,(0,Ne.Z)(e,(e=>n()("span",{style:{paddingLeft:4,paddingRight:4}},`slash:${e}`,"/"))),this.props.right):null}getPathWithoutDomain(){const{getRecordValue:e,blockId:t,intl:o}=this.props,i=Ve.uJ({table:"block",id:t},e),r=Pe.om.fromGetRecordValueFn(e);return Re().initial(i.reverse()).map((e=>{const t=Pe.kk.fromBlock(e),i=t.getRenderTitle({getRecordModel:r,userTimeZone:this.props.userTimeZone,intl:o})||o.formatMessage({id:"recordPath.untitledBlock.placeholder",defaultMessage:"Untitled"}),a=t.getRenderUrl({getRecordModel:r,pageVisitSource:l.tY.Email});return n()(Fe,{href:`${this.props.baseUrl}${a}`,style:{display:"inline-block",maxWidth:120,verticalAlign:"top",...C.Z.textOverflowStyle}},e.id,i)}))}}const Ke=(0,w.injectIntl)(Ze);o(43593),o(17755),o(58102);s.PureComponent;class Ue extends s.PureComponent{constructor(){super(...arguments),this.theme=(0,V.gh)({theme:"light"})}render(){const{children:e}=this.props;return n()("table",{style:{paddingTop:12,paddingBottom:e?0:8,borderSpacing:0,width:"100%",borderCollapse:"separate"}},void 0,n()("tr",{},void 0,n()("td",{style:{verticalAlign:"top",width:Ue.avatarSize+6,minWidth:Ue.avatarSize+6,paddingTop:2}},void 0,this.props.icon),n()("td",{},void 0,this.renderHeader())),n()("tr",{},void 0,n()("td",{}),n()("td",{style:{maxWidth:400}},void 0,e&&this.renderChildren())),this.renderDivider())}renderDivider(){const{isLast:e}=this.props;if(!e)return n()("tr",{},void 0,n()("td",{colSpan:2},void 0,n()("div",{style:this.getBorderBottomStyle()})))}renderHeader(){const{timestamp:e,header:t,intl:o}=this.props,i=(0,Te.Yx)(Math.min(e,Date.now()),"medium_with_time",(0,_e.E2)(o),this.props.userTimeZone);return n()("div",{style:Ue.headerStyle},void 0,n()("div",{},void 0,t),n()("table",{style:{...this.getPathAndTimeStyle(),marginTop:4,marginBottom:this.props.children?8:4,borderSpacing:0}},void 0,n()("tr",{},void 0,n()("td",{},void 0,i),n()("td",{},void 0,this.props.navigableBlockId&&n()(Ke,{getRecordValue:this.props.getRecordValue,blockId:this.props.navigableBlockId,baseUrl:this.props.baseUrl,left:n()("span",{style:this.getDotStyle()},void 0,"·"),userTimeZone:this.props.userTimeZone})))))}renderChildren(){return n()("div",{},void 0,this.props.children)}getBorderBottomStyle(){return{borderBottom:`1px solid ${this.props.theme.regularDividerColor}`,marginBottom:4}}getPathAndTimeStyle(){return{fontSize:12,color:this.theme.lightTextColor,whiteSpace:"nowrap"}}getDotStyle(){return{color:this.theme.lightTextColor,marginLeft:4,marginRight:4}}}Ue.avatarSize=28,Ue.headerStyle={fontSize:14,lineHeight:1.4};const Ee={fontWeight:C.Z.fontWeight.semibold};(0,w.injectIntl)(Ue);var qe=o(70203),ze=o(67669),Ge=o(27832);function He(e){const{edits:t,rootStore:o}=e,i=Re().uniqWith(t.flatMap((e=>e.authors||[])),Re().isEqual);return Re().compact(i.map((e=>Ye(e,o))))}function We(e){const{currentUserStore:t}=Ge.default.state,o=null==t?void 0:t.id;return function(e,t,o){const i=t.find((e=>e.value.id===o)),r=t.map((t=>(0,P.$4)(e,t)));if(1===t.length)return n()("span",{},void 0,n()(w.FormattedMessage,i?{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label",description:"Bolded string for denoting that the current user generated an activity update notification.",values:{b:e=>n()("span",{style:Ee},void 0,e)}}:{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhrase.forOneAuthor.label",description:"Bolded string for showing the single author that generated an activity update notification.",values:{author:r[0],b:e=>n()("span",{style:Ee},void 0,e)}}));if(2===t.length){if(i){const o=t.filter((e=>e!==i)).map((t=>(0,P.$4)(e,t)));return n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"<b>{firstAuthor}</b> and you",id:"activitySection.authorPhrase.forTwoAuthorsCurrentUser.label",description:"Bolded string for listing two authors in an activity update notification, with the current user being one of them.",values:{firstAuthor:o[0],b:e=>n()("span",{style:Ee},void 0,e)}}))}return n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"<b>{firstAuthor}</b> and <b>{secondAuthor}</b>",id:"activitySection.authorPhrase.forTwoAuthors.label",description:"Bolded string for listing two authors in an activity update notification.",values:{firstAuthor:r[0],secondAuthor:r[1],b:e=>n()("span",{style:Ee},void 0,e)}}))}if(r.length>2){if(i){const o=t.filter((e=>e!==i)).map((t=>(0,P.$4)(e,t))),r=n()(w.FormattedMessage,{defaultMessage:"{numberOfOtherAuthors, plural, =0 {<b>{firstAuthor}</b>, <b>{secondAuthor}</b> and you} one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthorsCurrentUser.label",description:"Bolded string for showing multiple authors that generated an activity update notification, with the current user being one of them.",values:{numberOfOtherAuthors:o.length-2,firstAuthor:o[0],secondAuthor:o[1],b:e=>n()("span",{style:Ee},void 0,e)}});return n()("span",{},void 0,r)}{const e=n()(w.FormattedMessage,{defaultMessage:"{numberOfOtherAuthors, plural, one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthors.label",description:"Bolded string for showing multiple authors that generated an activity update notification.",values:{numberOfOtherAuthors:r.length-2,firstAuthor:r[0],secondAuthor:r[1],b:e=>n()("span",{style:Ee},void 0,e)}});return n()("span",{},void 0,e)}}return n()("span",{style:Ee},void 0,n()(w.FormattedMessage,{defaultMessage:"Nobody",description:"Default text when there's an activity update with no users attached",id:"activitySection.authorPhrase.forNoAuthors.label"}))}(B.default.getIntl(),e,o)}function Ye(e,t){if(e.table===I.KJ){const o=$e(e.id,t);if(o)return(0,P.dp)(o)}else{const o=function(e,t){return(0,O.Kv)(t,{table:Je.cZ,id:e}).getValue()}(e.id,t);if(o)return(0,P.D$)(o)}}function $e(e,t){return O.U6.createChildStore(t,{table:I.KJ,id:e}).getValue()}function je(e){const{tab:t,recordId:o,recordType:i,rootStore:r,environment:a}=e;if("all"===t){if(!o)return!1;let e;return e="block"===i?O.G.createChildStore(r,{table:g.iU,id:o}):"collection"===i?O.NW.createChildStore(r,{table:v.v,id:o}):O.H2.createChildStore(r,{table:S.bx,id:o}),(0,ze.yi)(a,e)}return!1}function Xe(e){const{activity:t,rootStore:o}=e;if("commented"!==t.type)return;const i=o.getRecordModel({table:y.qF,id:t.discussion_id,spaceId:t.space_id});if(!i)return;const r=i.getContext();if(!r)return;const a=(0,qe.VP)(r,(e=>!(0,qe.xw)(e)||(0,qe.h1)(e)===i.id));return{id:i.id,context:a}}var Qe=o(61519),et=o(62385);class tt extends d.Z{constructor(){super(...arguments),this.storeTypes={role:N.default.createClass(void 0)}}renderComponent(){const{accessRequestStore:e}=this.props;if(e.isDefined()){if(e.isResolvedSpaceMembershipRequest())return this.renderResolvedSpaceMembershipRequest();if(this.canResolveMembershipRequests())return n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(et.Z,{onClick:()=>this.resolveMembershipRequest("approved"),style:this.getButtonStyle(!1)},void 0,n()(w.FormattedMessage,{defaultMessage:"Approve",id:"approveSpaceMembershipActivityAction.approveButton.label",description:"Button in notification to approve a membership request."})),n()(et.Z,{onClick:()=>this.resolveMembershipRequest("rejected"),style:{height:26,paddingLeft:8,paddingRight:8}},void 0,n()(w.FormattedMessage,{defaultMessage:"Decline",id:"approveSpaceMembershipActivityAction.declineButton.label",description:"Decline space membership request button in notification."})),!this.environment.device.isMobile&&s.createElement(s.Fragment,null,n()(Qe.Z,{size:1,vertical:!0,style:{height:26,paddingLeft:8,paddingRight:8}}),n()(et.Z,{onClick:()=>{Ce.E50(this.environment,{disable_membership_requests:this.props.spaceStore.getDisableMembershipRequests()}),this.handleOpenSettingsMembersRequests()},style:{height:26,paddingLeft:8,paddingRight:8}},void 0,n()(w.FormattedMessage,{defaultMessage:"View all requests",id:"approveSpaceMembershipActivityAction.viewAllRequests.label",description:"Button that takes user to the settings modal members requests tab to see all existing requests."}))))}}renderResolvedSpaceMembershipRequest(){const{accessRequestStore:e}=this.props;if(!e.isDefined())return;const t=e.isResolvedSpaceMembershipRequest()&&this.renderActor(e.getResolvedByPointer());return s.createElement(s.Fragment,null,n()(ne.Z,{isSecondaryColor:!0},void 0,"approved"===e.getStatus()?n()(w.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestApproved.title",values:{grantedBy:t},description:"Message showing that space membership request has been approved."}):n()(w.FormattedMessage,{defaultMessage:"Declined by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestDeclined.title",values:{grantedBy:t},description:"Message showing that space membership request has been declined."})),n()(ne.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,Te.Yx)(Math.min(e.getResolvedTime(),Date.now()),"medium_with_time",(0,_e.E2)(this.props.intl))))}handleOpenSettingsMembersRequests(){De.r({currentTab:"members",subtab:Be.Q.Requests})}canResolveMembershipRequests(){return this.props.spaceStore.canEditMembership()}renderActor(e){const{table:t,id:o}=e;return We(Re().compact([this.getActor(t,o)]))}getActor(e,t){if(e===I.KJ){const o=this.rootStore.getRecordValue({table:e,id:t});if(o)return(0,P.dp)(o)}if(e===Je.cZ){const o=this.rootStore.getRecordValue({table:e,id:t});if(o)return(0,P.D$)(o)}}get rootStore(){return this.props.accessRequestStore}async resolveMembershipRequest(e){if(!this.canResolveMembershipRequests())return;const t=this.environment,{spaceStore:o,accessRequestStore:i}=this.props;if(!i.isDefined())return;const r=this.getActor(I.KJ,i.getForActorId());r&&r.table===I.KJ&&await Ie.kn({environment:t,store:o,accessRequestStore:i,forActor:r.value,status:e,from:"notification"})}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}}tt.displayName="ApproveSpaceMembershipActivityAction";const ot=(0,w.injectIntl)(tt);var it=o(13991),rt=o(27006),at=o(10279),nt=o(9953),st=o(21115),dt=o(78291),ct=o(7567);class lt extends d.Z{constructor(){super(...arguments),this.storeTypes={role:N.default.createClass(void 0)},this.handleApproveMembershipRequest=async()=>{},this.handleGrantPageAccess=async()=>{const{targetBlockStore:e,accessRequestStore:t}=this.props,o=this.getInviteTargetWithNewPermissionItem();if(!("permissionItem"in o))return;const i=this.environment.currentUser.id;if(!i)return;if("type"in o){let t;if("existingUser"===o.type){t=(await at.n_({environment:this.environment,store:e,inviteTargets:[o],inviteRole:o.permissionItem.role,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else if("bot"===o.type){t=(await at.n_({environment:this.environment,store:e,inviteTargets:[o],inviteRole:void 0,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else(0,M.t1)(o);if(!t)return}Z.createAndCommit({userAction:"GrantPageAccessActivityAction.handleGrantPageAccess",environment:this.environment,perform:r=>{"type"in o||at.ep({environment:this.environment,transaction:r,store:e,permissionItems:[o.permissionItem]}),nt.sW({store:t,transaction:r,data:{granted_time:Date.now(),granted_by_table:I.KJ,granted_by_id:i,resolved_time:Date.now(),resolved_by_table:I.KJ,resolved_by_id:i,status:"approved"}})}});const r=t.getValue(),a=r&&r.created_time&&r.granted_time?r.granted_time-r.created_time:void 0;Ce.nCD(this.environment,{requestId:r&&r.id,timeElapsedSinceRequest:a,newAccessLevel:o.permissionItem.role,...this.getGrantOrIgnoreAccessArgs()})},this.handleRoleChange=e=>{const t=this.props.accessRequestStore.id,o=this.stores.role.state;this.stores.role.setState(e),Ce.If_(this.environment,{requestId:t,previousAccessLevel:o,newAccessLevel:e,...this.getGrantOrIgnoreAccessArgs()})},this.handleArchive=()=>{const{notification:e}=this.props;e&&(Z.createAndCommit({userAction:"GrantPageAccessActivityAction.handleArchive",environment:this.environment,perform:t=>{L.aZ({notification:e,rootStore:this.props.accessRequestStore,transaction:t})}}),Ce.cOL(this.environment,this.getGrantOrIgnoreAccessArgs()))}}renderComponent(){const e=this.props.accessRequestStore.getValue();if(!e)return;if((0,T.Kc)(e))return this.renderGrantedAccessRequest(e);if(!this.canGrantAccess())return;const t=e.parent_table===S.bx,o=this.getCurrentPermissionItem();if(o&&!t){const t=this.renderActor(e.for_actor_table,e.for_actor_id),i=o.role===this.getRole();return s.createElement(s.Fragment,null,n()(ne.Z,{isSecondaryColor:!0,style:{marginBottom:6}},void 0,n()(w.FormattedMessage,{defaultMessage:"{requestingUser} already has access.",id:"grantPageAccessActivityAction.alreadyHasAccess.label",description:"Shown if the user who requested access already has access",values:{requestingUser:t}})),n()(ct.Z,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:g.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===I.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!0)}),n()(et.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(i)},void 0,n()(w.FormattedMessage,{defaultMessage:"Change",id:"grantPageAccessActivityAction.changePermissionButton.label",description:"Change permission button for page access requests in notification."})),this.renderArchiveButton())}return s.createElement(s.Fragment,null,n()(ct.Z,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:g.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===I.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!1)}),n()(et.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(!1)},void 0,n()(w.FormattedMessage,{defaultMessage:"Grant access",id:"grantPageAccessActivityAction.grantAccessButton.label",description:"Button in notification to grant access to a page access request."})),this.renderArchiveButton())}renderGrantedAccessRequest(e){const t=this.renderActor(e.granted_by_table,e.granted_by_id),o=(0,Te.$b)(Math.min(e.granted_time,Date.now()),it.SP,B.default.getIntl());return s.createElement(s.Fragment,null,n()(ne.Z,{isSecondaryColor:!0},void 0,n()(w.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"grantPageAccessActivityAction.accessGranted.title",description:"Approval message for page access requests in notification.",values:{grantedBy:t,time:o}})),n()(ne.Z,{isSmall:!0,isSecondaryColor:!0},void 0,o))}renderArchiveButton(){const{notification:e}=this.props;if(e&&!e.visited)return n()(et.Z,{onClick:this.handleArchive,style:{height:26,paddingLeft:8,paddingRight:8}},void 0,n()(w.FormattedMessage,{defaultMessage:"Ignore",id:"grantPageAccessActivityAction.ignoreButton.label",description:"Ignore page access request button in notification."}))}getRole(){const e=this.getCurrentPermissionItem(),t=e&&e.role;return this.stores.role.state||t||this.props.initialRole}getNewPermissionItem(){const e=this.props.accessRequestStore.getValue();if(e)return e.for_actor_table===I.KJ?{type:"user_permission",user_id:e.for_actor_id,role:this.getRole()}:{type:"bot_permission",bot_id:e.for_actor_id,role:this.getRole()}}getInviteTargetWithNewPermissionItem(){const e=this.getNewPermissionItem();if(!e)return{};if(this.getCurrentPermissionItem())return{permissionItem:e};const{data:t}=dt.default.state;if("user_permission"===e.type){const o=this.rootStore.getRecordValue({table:I.KJ,id:e.user_id}),i=t?st.CM(t):[],r=i&&i.some((t=>t.userId===e.user_id));return o&&!r?{type:"existingUser",value:o,permissionItem:e}:{permissionItem:e}}if("bot_permission"===e.type){const o=this.rootStore.getRecordValue({table:Je.cZ,id:e.bot_id}),i=(t?st.NM(t):[]).some((t=>t.botId===e.bot_id));return o&&!i?{type:"bot",value:o,permissionItem:e}:{permissionItem:e}}(0,M.t1)(e)}getCurrentPermissionItem(){const e=this.props.accessRequestStore.getValue();if(!e)return;const t=this.props.targetBlockStore.getPermissionItems();for(const o of t){if(e.for_actor_table===I.KJ&&(0,rt.jg)(o)&&o.user_id===e.for_actor_id)return o;if(e.for_actor_table===Je.cZ&&(0,rt.FB)(o)&&o.bot_id===e.for_actor_id)return o}}canGrantAccess(){return this.props.targetBlockStore.canAdmin()}renderActor(e,t){return We(Re().compact([this.getActor(e,t)]))}getActor(e,t){if(e===I.KJ){const o=this.rootStore.getRecordValue({table:e,id:t});if(o)return(0,P.dp)(o)}if(e===Je.cZ){const o=this.rootStore.getRecordValue({table:e,id:t});if(o)return(0,P.D$)(o)}}get rootStore(){return this.props.accessRequestStore}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}getGrantOrIgnoreAccessArgs(){const{notification:e}=this.props;return{tab:X.Jn(),activityId:null==e?void 0:e.activity_id,notificationId:null==e?void 0:e.id}}}lt.displayName="GrantPageAccessActivityAction";const ht=lt;var ut=o(18698);const mt=function(e){window.__c={n:"ApproveTeamMembershipActivityButton"};const{accessRequestStore:t,teamStore:o}=e,i=(0,k.O7)(),r=(0,w.useIntl)(),{isRequestResolved:a,resolvedStatus:s,resolvedTime:d}=(0,R.VK)((()=>({isRequestResolved:t.isResolvedTeamMembershipRequest(),resolvedStatus:t.getStatus(),resolvedTime:t.getResolvedTime()})),[t]),c=(0,R.VK)((()=>{const e=t.getResolvedById();if(!e)return;const o=O.U6.createChildStore(t,{table:I.KJ,id:e});return o?o.getDisplayName(r):void 0}),[t,r]),l=async e=>{await ut.ow({environment:i,teamStore:o,accessRequestStore:t,status:e})},h=(0,_.yK)((e=>({container:{display:"flex",alignItems:"center"},approveButton:{height:26,paddingLeft:8,paddingRight:8,fontSize:12,marginRight:10,fontWeight:500,boxShadow:e.plainButtonBoxShadow},declineButton:{height:26,paddingLeft:8,paddingRight:8}})),[]);return n()("div",{style:h.container},void 0,a?n()("div",{},void 0,n()(ne.Z,{isSecondaryColor:!0},void 0,n()(w.FormattedMessage,"approved"===s?{defaultMessage:"Approved by {grantedBy}",id:"approveTeamMembershipActivityButton.requestApproved.title",values:{grantedBy:c},description:"Message showing that a team membership request has been approved."}:{defaultMessage:"Declined by {grantedBy}",id:"approveTeamMembershipActivityButton.requestDeclined.title",values:{grantedBy:c},description:"Message showing that a team membership request has been declined."})),n()(ne.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,Te.Yx)(Math.min(d??0,Date.now()),"medium_with_time",(0,_e.E2)(r)))):n()("div",{},void 0,n()(et.Z,{style:h.approveButton,onClick:()=>l("approved")},void 0,n()(w.FormattedMessage,{defaultMessage:"Approve",id:"approveTeamMembershipActivityButton.approveButton.label",description:"Button in notification to approve a team membership request."})),n()(et.Z,{style:h.declineButton,onClick:()=>l("rejected")},void 0,n()(w.FormattedMessage,{defaultMessage:"Decline",id:"approveTeamMembershipActivityButton.declineButton.label",description:"Decline team membership request button in notification."}))))};var pt=o(82813),gt=o(51456);function vt(e){return(0,xe.SK)(e,{[l.$X]:l.tY.Notification})}function bt(e){const t=e.mightCloseTab??!0;yt({target:"body",...e,mightCloseTab:t})}function ft(e){const t=e.mightCloseTab??!0;yt({target:"title",...e,mightCloseTab:t})}function yt(e){const{target:t,environment:o,activity:i,notification:r,source:a,tab:n,mightCloseTab:s}=e,d="notifications_tab"===a?q.ZP.state.sessionId:void 0,c="notifications_tab"===a?q.ZP.isFilteredToUnreadOnly():void 0;Ce.CgP(o,{target:t,activity_id:i.id,notification_id:null==r?void 0:r.id,sessionId:d,is_filtered:c,tab:n}),s&&X.pw({environment:o,target:t}),r&&pt.e((0,gt.getClientEventTracker)(o),{alreadyRead:r.read,notificationId:r.id,activityId:r.activity_id,from:t,sessionId:d})}function St(e){const{notification:t,activity:o,environment:i,tab:r}=e,a={environment:i,activity:o,notificationId:null==t?void 0:t.id,alreadyRead:Boolean(null==t?void 0:t.read),tab:r};return{onBacklinkClicked:e=>X.EQ({...a,backlinkPageId:e}),onArchiveClicked:()=>X._b(a),onMarkAsReadClicked:()=>X.cC(a),onMarkAsUnreadClicked:()=>X.u_(a),onNotificationFrameClicked:()=>X.ix(a)}}const At={userSelect:"text",WebkitUserSelect:"text"},Mt={padding:1,...At},wt={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},Ot={fontWeight:C.Z.fontWeight.semibold};function kt(e){return{padding:0,paddingLeft:Rt(e),paddingRight:16,paddingBottom:3,...At}}function Rt(e){const{source:t,isMobile:o}=e;return"notifications_tab"===t?52+(o?3:2):52}function _t(e){return{height:26,paddingLeft:8,paddingRight:8,color:e.mediumTextColor}}function Tt(e){return{display:"inline",whiteSpace:"normal",marginRight:e?3:0,wordBreak:"break-word",...Ot}}function Jt(e){return{boxShadow:e.plainButtonBoxShadow,height:26,paddingLeft:8,paddingRight:8,fontWeight:500,color:e.regularTextColor}}function It(e){var t;window.__c={n:"NotificationActions"};const{isMobile:o,environment:i,rootStore:r,activity:a,tabArgs:s}=e,{source:d}=s,c=Boolean(null===(t=s.notification)||void 0===t?void 0:t.visited),l=(0,_.yK)((e=>({container:{paddingLeft:Rt({source:d,isMobile:o})-8,paddingTop:4}})),[o,d]);return c?n()("div",{style:l.container},void 0,n()(Ct,{tabArgs:s,environment:i,rootStore:r,activity:a})):null}function Ct(e){window.__c={n:"UnarchiveButton"};const{tabArgs:t,environment:o,rootStore:i,activity:r}=e,{notification:a,tab:s}=t,d=(0,_.yK)((e=>({secondaryButton:_t(e)})),[]);return Boolean(null==a?void 0:a.visited)?n()(et.Z,{onClick:()=>{a&&(Z.createAndCommit({userAction:"Activity.handleUnarchive",environment:o,perform:e=>{L.E1({notificationId:a.id,visited:!1,rootStore:i,transaction:e})}}),X.F5({environment:o,activity:r,tab:s,notificationId:a.id,alreadyRead:a.read}))},style:d.secondaryButton},void 0,n()(w.FormattedMessage,{defaultMessage:"Unarchive",id:"activity.actions.unarchiveButton.label"})):null}var Dt=o(57688),Bt=o(62820),Nt=o(84076),Pt=o(31278),Vt=o(76798);function xt(e){window.__c={n:"Title"};const{titledRecordStore:t,getRecordModel:o,activity:i,tabArgs:r}=e,a=(0,R.VK)((()=>t.getModel()),[t]),d=(0,k.O7)(),c=(0,R.VK)((()=>null==a?void 0:a.getRenderIcon({getRecordModel:o})),[a,o]),h=(0,_.yK)((()=>({container:Mt,icon:wt,recordTitle:Tt(void 0!==c)})),[c]),u=(0,s.useCallback)((()=>{const e=t.table;switch(e){case g.iU:case v.v:case S.bx:ft({environment:d,activity:i,...r});break;case J.e0:bt({environment:d,activity:i,...r}),Dt.hI({environment:d,teamStore:t,shouldScroll:!0}),Bt.Z.setState({...Bt.Z.state,open:!1});break;default:(0,M.t1)(e)}}),[i,d,r,t]),m=(0,R.VK)((()=>{if(a&&a.table!==J.e0)return a.getRenderUrl({getRecordModel:o,pageVisitSource:l.tY.Notification})}),[a,o]);return a?n()(Nt.Z,{href:m,onClick:u,external:!1,innerStyle:h.container,inline:!0},void 0,c&&s.createElement(s.Fragment,null,n()(Pt.Z,{disabled:!0,icon:c,isEmptyPage:!1,size:18,style:h.icon}),n()("span",{},void 0," ")),n()(Vt.ZP,{store:t,style:h.recordTitle})):null}const Lt=s.memo(xt);function Ft(e){let{activity:t,rootStore:o,tabArgs:i,isLast:a,useRedesignedIA:d}=e;const{notification:c,tab:l,source:h}=i,u=(0,s.useMemo)((()=>t.edits??[]),[t]),m=u[0],p=(0,k.O7)(),g=p.device.isMobile,v=(0,_.yK)((()=>({message:{paddingLeft:Rt({source:h,isMobile:g}),paddingRight:16,marginTop:8,marginBottom:8},messageLabel:{whiteSpace:"pre-wrap"}})),[h,g]),b=O.oK.createChildStore(o,{table:T.J8,id:t.access_request_id}),f=(0,R.VK)((()=>b.getModel()),[b]),y=(0,R.VK)((()=>(null==f?void 0:f.getParentTable())===S.bx&&!(0,D.p1)()),[f]),A=f&&n()(Zt,{activity:t,accessRequest:f,rootStore:o,tabArgs:i}),M=m.message,J=(0,R.VK)((()=>He({edits:u,rootStore:o})),[u,o]),I=(0,R.VK)((()=>We(J)),[J]);return y||!A?null:d?s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,A),isLast:a,isPrivate:!1,rootStore:o,showRecordPath:!1,notification:c,icon:n()(ve,{authors:J}),showSnapshotButton:!1},St({notification:c,activity:t,environment:p,tab:l})),M&&n()("div",{style:v.message},void 0,n()(ne.Z,{isSmall:!0},void 0,n()(w.FormattedMessage,{id:"activity.accessRequested.messageLabel",defaultMessage:"Message from {author}",values:{author:I}})),n()(ne.Z,{isMultiline:!0,style:v.messageLabel},void 0,M)),n()(qt,{activity:t,accessRequestStore:b,rootStore:o,source:h,notification:c}),n()(It,{tabArgs:i,activity:t,isMobile:p.device.isMobile,environment:p,rootStore:o})):s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,A),isLast:a,isPrivate:!1,rootStore:o,notification:c,icon:n()(ve,{authors:J}),showSnapshotButton:!1},St({notification:c,activity:t,environment:p,tab:l})),M&&n()("div",{style:v.message},void 0,n()(ne.Z,{isSmall:!0},void 0,n()(w.FormattedMessage,{id:"activity.accessRequested.messageLabel",defaultMessage:"Message from {author}",values:{author:I}})),n()(ne.Z,{isMultiline:!0,style:v.messageLabel},void 0,M)),n()(qt,{activity:t,accessRequestStore:b,rootStore:o,source:h,notification:c}),n()(It,{tabArgs:i,activity:t,isMobile:p.device.isMobile,environment:p,rootStore:o}))}function Zt(e){const{activity:t,accessRequest:o,rootStore:i,tabArgs:r}=e,a=(0,R.VK)((()=>o.getParentTable()),[o]);switch(a){case S.bx:return n()(Ut,{activity:t,accessRequest:o,rootStore:i});case J.e0:return n()(Et,{activity:t,rootStore:i,tabArgs:r});case g.iU:return n()(Kt,{activity:t,tabArgs:r,rootStore:i});default:(0,M.t1)(a)}}function Kt(e){window.__c={n:"BlockAccessRequestHeader"};const{activity:t,rootStore:o,tabArgs:i}=e,r=(0,s.useMemo)((()=>t.edits??[]),[t]),a=(0,R.VK)((()=>He({edits:r,rootStore:o})),[r,o]),d=(0,R.VK)((()=>We(a)),[a]);if(!t.navigable_block_id)return null;const c=O.G.createChildStore(o,{table:g.iU,id:t.navigable_block_id});return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to {pageName}} other {{authorOrAuthors} requested access to {pageName}}}",values:{numberOfAuthors:a.length,authorOrAuthors:d,pageName:n()(Lt,{titledRecordStore:c,activity:t,tabArgs:i,getRecordModel:o.getRecordModel})},id:"activity.accessRequested.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}function Ut(e){const{activity:t,accessRequest:o,rootStore:i}=e,r=(0,s.useMemo)((()=>t.edits??[]),[t]),a=(0,_.yK)((()=>({inviteePhrase:{fontWeight:C.Z.fontWeight.semibold}})),[]),d=(0,R.VK)((()=>o.getForActorPointer()),[o]),c=O.U6.createChildStore(i,{table:I.KJ,id:d.id}),l=(0,R.VK)((()=>c.getModel()),[c]),h=(0,R.VK)((()=>null==l?void 0:l.getEmail()),[l]),u=(0,R.VK)((()=>o.getForActorId()===o.getCreatedById()),[o]),m=(0,R.VK)((()=>He({edits:r,rootStore:i})),[r,i]),p=(0,R.VK)((()=>We(m)),[m]),g=(0,R.VK)((()=>{if(!u)return h;const e=null==l?void 0:l.getFullName(B.default.getIntl());return e?`${e} (${h})`:h}),[u,l,h]);return l&&d.table===I.KJ?n()(w.FormattedMessage,u?{defaultMessage:"{invitee} requested to become a workspace member",values:{invitee:n()("span",{style:a.inviteePhrase},void 0,g)},id:"activity.accessRequestedMembershipFromGuest.header",description:"Notification header describing that a user created a membership request for themself."}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested {invitee} to become a workspace member} other {{authorOrAuthors} requested {invitee} to become a workspace member}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,invitee:n()("span",{style:a.inviteePhrase},void 0,g)},id:"activity.accessRequestedMembership.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):null}function Et(e){window.__c={n:"TeamMembershipRequestHeader"};const{activity:t,rootStore:o,tabArgs:i}=e,r=(0,s.useMemo)((()=>t.edits??[]),[t]),a=(0,R.VK)((()=>He({edits:r,rootStore:o})),[r,o]),d=(0,R.VK)((()=>We(a)),[a]);if(!r||!t.team_id)return null;const c=O.zX.createChildStore(o,{table:J.e0,id:t.team_id});return n()(w.FormattedMessage,{defaultMessage:"{user} requested to become a member of {teamName}",values:{user:n()("span",{style:{fontWeight:C.Z.fontWeight.semibold}},void 0,d),teamName:n()(Lt,{titledRecordStore:c,getRecordModel:o.getRecordModel,activity:t,tabArgs:i})},id:"activity.teamAccessRequest.header",description:"Notification header describing that a user created a team access request."})}function qt(e){const{activity:t,accessRequestStore:o,rootStore:i,source:r,notification:a}=e,d=(0,s.useMemo)((()=>t.edits||[]),[t])[0],c=(0,R.VK)((()=>o.getParentTable()),[o]),l=(0,R.VK)((()=>o.getParentId()),[o]),h=(0,k.O7)().device.isMobile,u=(0,_.yK)((e=>({actionPrimaryContainer:{paddingLeft:Rt({source:r,isMobile:h}),paddingTop:12,paddingBottom:8},actionButton:Jt(e)})),[r,h]),m=l?O.G.createChildStore(i,{table:g.iU,id:l}):void 0,p=(0,R.VK)((()=>c===g.iU&&Boolean(null==m?void 0:m.canAdmin())),[c,m]);if(!c||!l||!d)return null;switch(c){case g.iU:return p&&m?n()("div",{style:u.actionPrimaryContainer},void 0,n()(ht,{accessRequestStore:o,targetBlockStore:m,initialRole:"reader",buttonStyle:u.actionButton,notification:a})):null;case S.bx:const e=O.H2.createChildStore(i,{table:c,id:l});return n()("div",{style:u.actionPrimaryContainer},void 0,n()(ot,{accessRequestStore:o,spaceStore:e,initialRole:"reader",buttonStyle:u.actionButton,notification:a}));case J.e0:const t=O.zX.createChildStore(i,{table:c,id:l});return n()("div",{style:u.actionPrimaryContainer},void 0,n()(mt,{accessRequestStore:o,teamStore:t}));default:(0,M.t1)(c)}}const zt=s.memo(Ft);var Gt=o(65991),Ht=o(64921);class Wt extends d.Z{constructor(){super(...arguments),this.storeTypes={open:N.default.createClass(!1)},this.handleOpen=()=>{this.stores.open.setState(!0)}}renderComponent(){return this.stores.open.state||this.props.items.length<=this.props.visible?n()("div",{},void 0,this.props.items):n()("div",{},void 0,this.props.items.slice(0,this.props.visible),n()(Ht.Z,{onClick:this.handleOpen,style:this.getStyle()},void 0,n()(w.FormattedMessage,{defaultMessage:"View {moreCount} more",id:"activity.viewMoreButton.label",values:{moreCount:this.props.items.length-this.props.visible}})))}getStyle(){return{display:"flex",alignItems:"center",height:28,fontSize:12,color:this.theme.lightTextColor,padding:0,paddingLeft:52,paddingRight:16}}}Wt.displayName="ViewMore";const Yt=Wt;function $t(e){const{activity:t,rootStore:o,tabArgs:i,isLast:a,useRedesignedIA:d}=e,{tab:c,notification:l,source:h}=i,u=(0,A.hI)(t.edits??[]),m=u.length>0,p=O.G.createChildStore(o,{table:g.iU,id:u[0].navigable_block_id}),v=(0,R.VK)((()=>He({edits:u,rootStore:o})),[u,o]),b=(0,R.VK)((()=>We(v)),[v]),f=(0,k.O7)(),y=(0,R.VK)((()=>je({recordId:p.id,recordType:"block",tab:c,rootStore:o,environment:f})),[p,c,o,f]);if(!(0,R.VK)((()=>p.isDefined()),[p])||!m)return null;const S=n()(Lt,{titledRecordStore:p,getRecordModel:o.getRecordModel,activity:t,tabArgs:i}),M="pageUpdatesSidebar"===c;return d?s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated {pageTitle}} other {{authorOrAuthors} updated {pageTitle}}}",id:"activity.blockEdited.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:v.length,authorOrAuthors:b,pageTitle:S}})),isLast:a,isPrivate:y,rootStore:o,navigableBlockId:p.id,notification:l,icon:n()(ve,{authors:v}),showSnapshotButton:M,showRecordPath:!0},St({notification:l,activity:t,environment:f,tab:c})),n()(Yt,{visible:5,items:u.map(((e,r)=>n()(jt,{edit:e,rootStore:o,onClick:()=>bt({environment:f,activity:t,...i}),source:h,isMobile:f.device.isMobile},r)))}),n()(It,{tabArgs:i,activity:t,isMobile:f.device.isMobile,environment:f,rootStore:o})):s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:v.length,authorOrAuthors:b,pageTitle:S}})),isLast:a,isPrivate:y,rootStore:o,navigableBlockId:p.id,notification:l,icon:n()(ve,{authors:v}),showSnapshotButton:M},St({notification:l,activity:t,environment:f,tab:c})),n()(Yt,{visible:5,items:u.map(((e,r)=>n()(jt,{edit:e,rootStore:o,onClick:()=>bt({environment:f,activity:t,...i}),source:h,isMobile:f.device.isMobile},r)))}),n()(It,{tabArgs:i,activity:t,isMobile:f.device.isMobile,environment:f,rootStore:o}))}function jt(e){window.__c={n:"BlockPropertyEditComponent"};const{rootStore:t,edit:o,onClick:i,source:r,isMobile:a}=e,s=(0,R.VK)((()=>function(e,t){const o=t.getRecordModel({table:g.iU,id:e.block_id}),i=(null==o?void 0:o.getType())===h.Ti.tableRow?t.getRecordModel({table:g.iU,id:o.getParentId()}):o;return null==i?void 0:i.getRenderUrl({getRecordModel:t.getRecordModel,pageVisitSource:l.tY.Notification})}(o,t)||p._j.root),[o,t]);return n()(Nt.Z,{href:s,onClick:i,innerStyle:kt({source:r,isMobile:a})},void 0,n()(Gt.Z,{edit:o,rootStore:t}))}var Xt=o(23482),Qt=o(98459),eo=o(4083),to=o(14976),oo=o(17731),io=o(98165);function ro(){window.__c={n:"BlockHighlighterBar"};const e=(0,_.yK)((()=>({blockContext:{flexShrink:0,display:"flex",width:3,borderRadius:3,marginLeft:2,marginRight:8,minHeight:24,background:V.DB}})),[]);return n()("div",{style:e.blockContext})}function ao(e){let{activity:t,tabArgs:o,rootStore:i,isLast:a,useRedesignedIA:d}=e;const c=t.edits??[],{source:h,tab:u,notification:m}=o;let p=c.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":return!0;default:(0,M.t1)(e)}}));0===p.length&&0!==c.length&&"updates_sidebar"!==h&&(p=c);const v=p.length>0,b=(0,k.O7)(),f=i.getRecordStore(i,{table:y.qF,id:t.discussion_id,spaceId:t.space_id}),S=(0,R.VK)((()=>f.isDefined()),[f]),A=(0,R.VK)((()=>{const e=f.getParentPointer();if(e)return O.G.createChildStore(i,e)}),[f,i]),T=(0,R.VK)((()=>Boolean(A&&A.isDefined())),[A]),J=O.G.createChildStore(i,{table:g.iU,id:t.navigable_block_id}),I=(0,R.VK)((()=>J.isDefined()),[J]),C=(0,R.VK)((()=>Boolean(A&&(0,io.fl)((0,io.qA)(A)))),[A]),D=(0,R.VK)((()=>{if(!C||!A)return;const e=A.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:l.tY.Notification}):void 0}),[C,A,i,t.discussion_id]),B=(0,R.VK)((()=>He({edits:p,rootStore:i})),[p,i]),N=(0,R.VK)((()=>We(B)),[B]),P=C,V=(0,_.yK)((()=>({flex:{display:"flex"}})),[]),x=(0,s.useCallback)((e=>{if(bt({...o,environment:b,activity:t,mightCloseTab:P}),!C&&A){var i;const r=e.target;eo.oK({environment:b,discussionStore:f,rect:r.getBoundingClientRect(),blockStore:A,discussionLocation:lo({forReplyMenu:!0,source:o.source}),activityId:t.id,notificationId:null===(i=o.notification)||void 0===i?void 0:i.id})}}),[t,C,A,f,b,o,P]),L=(0,s.useCallback)((()=>{var e;e={...o,environment:b,activity:t,mightCloseTab:P},yt({target:"add_reaction",...e,mightCloseTab:!1})}),[o,b,t,P]),F=n()(Lt,{titledRecordStore:J,getRecordModel:i.getRecordModel,activity:t,tabArgs:o}),Z=(0,R.VK)((()=>je({recordId:t.navigable_block_id,recordType:g.iU,tab:u,rootStore:i,environment:b})),[t,u,i,b]),K=b.device.isMobile,U=(0,R.VK)((()=>lo({source:h,forReplyMenu:!1})),[h]),E=(0,R.VK)((()=>Xe({activity:t,rootStore:i})),[t,i]),q=null==E?void 0:E.id,z=null==E?void 0:E.context,G=(0,R.VK)((()=>{const e=J.getAssociatedCollectionStore();return null==e?void 0:e.getDatabaseType()}),[J]);if(!(v&&I&&T&&S))return null;if(d){const e=!z,d=n()("div",{style:V.flex},void 0,e&&n()(ro,{}),F),c=function(e){let{databaseType:t,authorCount:o,authorPhrase:i}=e;switch(t){case Xt.iS:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a task} other {{authorOrAuthors} commented on a task}}",values:{numberOfAuthors:o,authorOrAuthors:i},id:"activity.commentTaskActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.wW:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a project} other {{authorOrAuthors} commented on a project}}",values:{numberOfAuthors:o,authorOrAuthors:i},id:"activity.commentProjectActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.zU:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a document} other {{authorOrAuthors} commented on a document}}",values:{numberOfAuthors:o,authorOrAuthors:i},id:"activity.commentDocActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.GZ:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a wiki} other {{authorOrAuthors} commented on a wiki}}",values:{numberOfAuthors:o,authorOrAuthors:i},id:"activity.commentWikiActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.Fi:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a meeting note} other {{authorOrAuthors} commented on a meeting note}}",values:{numberOfAuthors:o,authorOrAuthors:i},id:"activity.commentMeetingActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.nG:case Xt.p$:case void 0:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a page} other {{authorOrAuthors} commented on a page}}",values:{numberOfAuthors:o,authorOrAuthors:i},id:"activity.commentActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});default:(0,M.t1)(t)}}({authorCount:B.length,authorPhrase:N,databaseType:G});return s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,c),isLast:a,isPrivate:Z,rootStore:i,prominentTitleLink:d,navigableBlockId:t.navigable_block_id,notification:m,icon:n()(ve,{authors:B}),showSnapshotButton:!1,showRecordPath:!0},St({notification:m,environment:b,tab:u,activity:t})),n()(no,{discussionId:q,discussionContext:z,alwaysHighlightWithBlockBar:!0,url:D,onClick:x,rootStore:i,source:h}),n()(Yt,{visible:5,items:p.map(((e,t,o)=>n()(Nt.Z,{onClick:x,href:D,innerStyle:kt({source:h,isMobile:K})},t,n()(Gt.Z,{edit:e,rootStore:i,type:"comment-edit",discussionLocation:U,highlightCurrentUser:!0,onReactionClick:L,hideAuthorName:1===p.length}))))}),n()(so,{activity:t,rootStore:i,tabArgs:o}))}return s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in {blockName}} other {{authorOrAuthors} commented in {blockName}}}",values:{numberOfAuthors:B.length,authorOrAuthors:N,blockName:F},id:"activity.commentActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:a,isPrivate:Z,rootStore:i,navigableBlockId:t.navigable_block_id,notification:m,icon:n()(ve,{authors:B}),showSnapshotButton:!1},St({notification:m,environment:b,tab:u,activity:t})),n()(no,{url:D,onClick:x,discussionId:q,discussionContext:z,alwaysHighlightWithBlockBar:!1,rootStore:i,source:h}),n()(Yt,{visible:5,items:p.map(((e,t,o)=>n()(Nt.Z,{onClick:x,href:D,innerStyle:kt({source:h,isMobile:K})},t,n()(Gt.Z,{edit:e,rootStore:i,type:"comment-edit",discussionLocation:U,onReactionClick:L,hideAuthorName:!1}))))}),n()(so,{activity:t,rootStore:i,tabArgs:o}))}function no(e){window.__c={n:"CommentContext"};const{url:t,onClick:o,rootStore:i,source:r,discussionId:a,alwaysHighlightWithBlockBar:s,discussionContext:d}=e,c=0===(0,qe.ll)(d).length||s,l=(0,k.O7)(),h=l.device.isMobile,u=(0,_.Fg)(),m=(0,_.yK)((e=>({linkbox:{...kt({source:r,isMobile:h}),display:"flex",alignItems:"center",fontSize:14,...c&&{color:e.mediumTextColor},paddingTop:2,paddingBottom:6,marginBottom:0}})),[h,r,c]),p=(0,R.VK)((()=>(0,to.IY)({environment:l,textValue:d?{value:d,spaceId:i.id}:void 0,parentStore:i,disableHover:!0,disableStyleAnnotations:c,disableDateStyleAnnotations:!1,disabled:!0,highlightDiscussionId:a,theme:u,emojiType:(0,oo.e_)(l),katex:l.KatexStore.getKatex(),formulaValueTypes:[]})),[i,l,d,a,u,c]);return d?n()(Nt.Z,{href:t,onClick:o,innerStyle:m.linkbox},void 0,c&&n()(ro,{}),n()("div",{style:C.Z.textOverflowStyle},void 0,p)):null}function so(e){window.__c={n:"CommentActions"};const{activity:t,rootStore:o,tabArgs:i}=e,{source:r,notification:a,tab:d}=i,c=o.getRecordStore(o,{table:y.qF,id:t.discussion_id,spaceId:t.space_id}),l=(0,R.VK)((()=>c.isDefined()),[c]),h=(0,k.O7)(),u=h.device.isMobile,m=O.t1.createChildStore(o,{table:y.qF,id:t.discussion_id,spaceId:(0,Qt.CG)(o.pointer.spaceId)}),p=(0,R.VK)((()=>c.getParentId()),[c]),v=(0,s.useCallback)((e=>{if(!p)return;const i=O.G.createChildStore(o,{table:g.iU,id:p}),n=e.target,s=null==a?void 0:a.id;eo.oK({environment:h,discussionStore:m,rect:n.getBoundingClientRect(),blockStore:i,discussionLocation:lo({forReplyMenu:!0,source:r}),activityId:t.id,notificationId:s}),"notifications_tab"===r&&X.gY({environment:h,notificationId:s,alreadyRead:Boolean(null==a?void 0:a.read),activity:t,tab:d})}),[t,m,h,a,p,o,r,d]),b=(0,_.yK)((e=>({container:{paddingLeft:Rt({source:r,isMobile:u}),paddingTop:12,paddingBottom:4},actionButton:Jt(e)})),[u,r]),f=Boolean(null==a?void 0:a.visited);return l?n()("div",{style:b.container},void 0,n()(et.Z,{onClick:v,style:b.actionButton},void 0,n()(w.FormattedMessage,{defaultMessage:"Reply",id:"activity.replyButton.label"})),f&&s.createElement(s.Fragment,null,n()(co,{}),n()(Ct,{tabArgs:i,environment:h,rootStore:o,activity:t}))):null}function co(){return window.__c={n:"Separator"},n()("div",{style:{width:5,display:"inline-block"}})}function lo(e){const{forReplyMenu:t,source:o}=e;if("updates_sidebar"===o)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${X.Jn()}`}const ho=s.memo(ao);const uo=function(e){window.__c={n:"EmailEditedActivity"};const{activity:t,rootStore:o,tabArgs:i,isLast:a,useRedesignedIA:d}=e,{tab:c,notification:l}=i,h=(0,k.O7)(),u=(0,A.hI)(t.edits??[]),m=(0,R.VK)((()=>He({edits:u,rootStore:o})),[u,o]),p=(0,R.VK)((()=>We(m)),[m]),{oldEmail:g,newEmail:v}=(0,R.VK)((()=>{const e=u[0];return{oldEmail:e?e.old_email:"",newEmail:e?e.new_email:""}}),[u]),b="pageUpdatesSidebar"===c;return d?s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} changed email from {oldEmail} to {newEmail}} other {{authorOrAuthors} changed email from {oldEmail} to {newEmail}}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,oldEmail:g,newEmail:v},id:"activity.emailEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:a,isPrivate:!1,rootStore:o,showRecordPath:!1,notification:l,icon:n()(ve,{authors:m}),showSnapshotButton:b},St({notification:l,activity:t,environment:h,tab:c}))):s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} changed email from {oldEmail} to {newEmail}} other {{authorOrAuthors} changed email from {oldEmail} to {newEmail}}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,oldEmail:g,newEmail:v},id:"activity.emailEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:a,isPrivate:!1,rootStore:o,notification:l,icon:n()(ve,{authors:m}),showSnapshotButton:b},St({notification:l,activity:t,environment:h,tab:c})))};var mo=o(54584);function po(e){const{activity:t,rootStore:o,isLast:i,tabArgs:a,useRedesignedIA:d}=e,{tab:c,notification:h,source:u}=a,m=(0,k.O7)(),p=t.edits??[],v=p.length>0,b=p[0],f=O.G.createChildStore(o,{table:g.iU,id:b.navigable_block_id}),y=(0,R.VK)((()=>f.isDefined()),[f]),S=O.G.createChildStore(o,{table:g.iU,id:t.mentioned_block_id}),A=(0,R.VK)((()=>S.isDefined()),[S]),M=(0,R.VK)((()=>{const e=S.getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:l.tY.Notification})}),[S,o]),_=(0,R.VK)((()=>o.getModel()),[o]),T=(0,R.VK)((()=>(0,mo.QH)(B.default.getIntl(),_,t.mentioned_group_id)),[_,t]),J=(0,R.VK)((()=>He({edits:t.edits||[],rootStore:o})),[t,o]),I=(0,R.VK)((()=>We(J)),[J]),C=m.device.isMobile,D=(0,R.VK)((()=>je({recordId:f.id,recordType:g.iU,tab:c,rootStore:o,environment:m})),[f,c,o,m]);if(!(v&&y&&A&&M))return null;const N=n()(Lt,{titledRecordStore:f,activity:t,tabArgs:a,getRecordModel:o.getRecordModel});return d?s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{authorOrAuthors} mentioned {groupName} in a page",values:{authorOrAuthors:I,groupName:T},id:"activity.groupMentionActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:i,isPrivate:D,rootStore:o,prominentTitleLink:N,navigableBlockId:f.id,showRecordPath:!0,notification:h,icon:n()(ve,{authors:J}),showSnapshotButton:!1},St({notification:h,activity:t,environment:m,tab:c})),n()(Nt.Z,{href:M,onClick:()=>bt({environment:m,activity:t,...a}),innerStyle:kt({source:u,isMobile:C})},void 0,n()(Gt.Z,{edit:b,rootStore:o,highlightCurrentUser:!0})),n()(It,{tabArgs:a,activity:t,isMobile:C,environment:m,rootStore:o})):s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{authorOrAuthors} mentioned {groupName} in {pageName}",values:{authorOrAuthors:I,pageName:N,groupName:T},id:"activity.groupMentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:i,isPrivate:D,rootStore:o,navigableBlockId:f.id,notification:h,icon:n()(ve,{authors:J}),showSnapshotButton:!1},St({notification:h,activity:t,environment:m,tab:c})),n()(Nt.Z,{href:M,onClick:()=>bt({environment:m,activity:t,...a}),innerStyle:kt({source:u,isMobile:C})},void 0,n()(Gt.Z,{edit:b,rootStore:o})),n()(It,{tabArgs:a,activity:t,isMobile:C,environment:m,rootStore:o}))}function go(e){let t,o,{permissionGroup:i,spaceId:r}=e;window.__c={n:"PermissionGroupTitle"},i?(t=i.icon,o=i.name||n()(w.FormattedMessage,{defaultMessage:"Untitled group",id:"activity.permissionGroupTitles.untitledGroup"})):o=n()(w.FormattedMessage,{defaultMessage:"Deleted group",id:"activity.permissionGroupTitles.deletedGroup"});const a=void 0!==t,d=(0,_.yK)((()=>({title:Tt(a)})),[a]),c=(0,s.useMemo)((()=>(0,M.$K)(t)?{icon:t,pointer:{table:"space",id:r}}:void 0),[t,r]);return n()("span",{},void 0,c&&n()(Pt.Z,{disabled:!0,icon:c,isEmptyPage:!1,size:18,style:wt}),n()("span",{style:d.title},void 0,o))}const vo=s.memo(go);const bo=function(e){window.__c={n:"PrivateContentTransferredActivity"};const{activity:t,rootStore:o,tabArgs:i,isLast:a,useRedesignedIA:d}=e,{tab:c,notification:l}=i,h=(0,k.O7)(),u=(0,s.useMemo)((()=>t.edits??[]),[t]),m=(0,R.VK)((()=>He({edits:u,rootStore:o})),[u,o]),p=(0,R.VK)((()=>We(m)),[m]),v=O.G.createChildStore(o,{table:g.iU,id:t.navigable_block_id}),b=(0,R.VK)((()=>v.isDefined()),[v]),f=(0,R.VK)((()=>je({recordId:v.id,recordType:g.iU,tab:c,rootStore:o,environment:h})),[v,c,o,h]),y=u[0],S=(0,R.VK)((()=>$e(y.from_user_id,o)),[y,o]),A=(0,R.VK)((()=>$e(y.to_user_id,o)),[y,o]);if(!(u.length>0&&S&&A&&b))return null;const M=(0,P.$4)(B.default.getIntl(),{table:I.KJ,value:S}),_=n()(Lt,{titledRecordStore:v,activity:t,tabArgs:i,getRecordModel:o.getRecordModel});return d?s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:n()(w.FormattedMessage,{defaultMessage:"{authorPhrase} transferred private content from {fromUserName} to you",values:{authorPhrase:p,fromUserName:M},id:"activity.privateContentTransferred.standardizedHeader",description:"Notification header for when private content is transferred from one user to another."}),isLast:a,prominentTitleLink:_,isPrivate:f,rootStore:o,notification:i.notification,icon:n()(ve,{authors:m}),showSnapshotButton:!1,showRecordPath:!1},St({notification:l,activity:t,environment:h,tab:c}))):s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:n()(w.FormattedMessage,{defaultMessage:"{authorPhrase} transferred private content from {fromUserName} to you: {pageName}",values:{authorPhrase:p,fromUserName:M,pageName:_},id:"activity.privateContentTransferred.header",description:"Notification header for when private content is transferred from one user to another."}),isLast:a,isPrivate:f,rootStore:o,notification:i.notification,icon:n()(ve,{authors:m}),showSnapshotButton:!1},St({notification:l,activity:t,environment:h,tab:c})))};function fo(e){const{activity:t,rootStore:o,tabArgs:i,isLast:a,useRedesignedIA:d}=e,{notification:c,tab:h,source:u}=i,m=(0,k.O7)(),p=t.edits??[],v=p.length>0,b=O.G.createChildStore(o,{table:g.iU,id:p[0].navigable_block_id}),f=(0,R.VK)((()=>b.isDefined()),[b]),y=O.G.createChildStore(o,{table:g.iU,id:t.reminder_block_id}),S=(0,R.VK)((()=>y.isDefined()),[y]),A=(0,R.VK)((()=>{const e=y.getModel();if(e)return e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:l.tY.Notification})}),[y,o]),M=(0,R.VK)((()=>je({recordId:b.id,recordType:g.iU,tab:h,rootStore:o,environment:m})),[b,h,o,m]);if(!(v&&f&&S&&A))return null;const _=m.device.isMobile,T=n()(Lt,{titledRecordStore:b,getRecordModel:o.getRecordModel,activity:t,tabArgs:i});return d?s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"Reminder in {pageTitle}",id:"activity.reminderInActivity.header",values:{pageTitle:T}})),isLast:a,isPrivate:M,rootStore:o,navigableBlockId:b.id,showRecordPath:!0,notification:c,icon:n()(be,{}),showSnapshotButton:!1},St({notification:c,activity:t,environment:m,tab:h})),n()(Nt.Z,{href:A,onClick:()=>bt({environment:m,activity:t,...i}),innerStyle:kt({source:u,isMobile:_})},void 0,n()(Gt.Z,{edit:p[0],rootStore:o}))):s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"Reminder in {pageTitle}",id:"activity.reminderInActivity.header",values:{pageTitle:T}})),isLast:a,isPrivate:M,rootStore:o,navigableBlockId:b.id,notification:c,icon:n()(be,{}),showSnapshotButton:!1},St({notification:c,activity:t,environment:m,tab:h})),n()(Nt.Z,{href:A,onClick:()=>bt({environment:m,activity:t,...i}),innerStyle:kt({source:u,isMobile:_})},void 0,n()(Gt.Z,{edit:p[0],rootStore:o})))}var yo=o(45094),So=o(23537);function Ao(e){window.__c={n:"TitleCard"};const{titledRecordStore:t,rootStore:o,activity:i,tabArgs:r}=e,a=o.getRecordModel,d=(0,R.VK)((()=>t.getModel()),[t]),c=(0,k.O7)(),h=(0,R.VK)((()=>null==d?void 0:d.getRenderIcon({getRecordModel:a})),[d,a]),u=(0,_.yK)((e=>({container:{...Mt,display:"block",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:3,marginTop:8,padding:10},icon:{...wt,marginRight:8},activityTitle:{display:"inline",whiteSpace:"normal",marginRight:void 0!==h?3:0,wordBreak:"break-word",...Ot},flexRow:{display:"flex",alignItems:"center"},title:{maxWidth:"80%"},spacer:{flexGrow:1},subtitle:{fontSize:12,color:e.lightTextColor},avatarContainer:{display:"flex",flexDirection:"row",justifyContent:"start",overflow:"hidden",paddingRight:2,alignItems:"center"},overlappingAvatar:{marginRight:-5,position:"relative"},rightmostAvatar:{position:"relative"},remainderCount:{paddingLeft:2,color:e.lightTextColor}})),[h]),m=(0,R.VK)((()=>{if(d&&d.table!==J.e0)return d.getRenderUrl({getRecordModel:a,pageVisitSource:l.tY.Notification})}),[d,a]),p=(0,s.useCallback)((()=>{const e=t.table;switch(e){case g.iU:case S.bx:ft({environment:c,activity:i,...r});break;case J.e0:bt({environment:c,activity:i,...r}),Dt.hI({environment:c,teamStore:t,shouldScroll:!0}),Bt.Z.setState({...Bt.Z.state,open:!1});break;default:(0,M.t1)(e)}}),[i,c,r,t]),v=(0,R.VK)((()=>{const e=t.table;switch(e){case"space":const o=t.getPublicSpaceData();return o?n()("div",{},void 0,n()(w.FormattedMessage,{id:"activity.titleCard.spaceSubtitle",description:"Label for the space card in the user-invited notification indicating number of workspace members and workspace plan type.",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} · {planType}",values:{numberOfWorkspaceMembers:B.default.formatNumber(o.memberCount),planType:B.default.formatMessage((0,yo.em)(o.subscriptionTier))}})):null;case"block":return n()(G.Z,{store:t});case"team":const i=t.getUserIdsInTeam().length,r=t.getTeamAccessLevel();return n()("div",{},void 0,n()(w.FormattedMessage,{id:"activity.titleCard.teamSubtitle",description:"Label for the team card in the team membership changed notification indicating number of teamspace members and privacy settings.",defaultMessage:"{accessLevel} · {numberOfTeamMembers, plural, one {{numberOfTeamMembers} member} other {{numberOfTeamMembers} members}}",values:{accessLevel:r,numberOfTeamMembers:i}}));default:(0,M.t1)(e)}}),[t]),b=(0,R.VK)((()=>{const e=t.table;let i=[];switch(e){case"space":const r=t.getModel();if(!r)break;i=r.getUserPermissionItems().map((e=>e.user_id));break;case"block":const a=t.getCreatedByPointer();(null==a?void 0:a.table)===I.KJ&&(i=[a.id]);break;case"team":i=(0,So.xf)({teamStore:t,spaceStore:o});break;default:(0,M.t1)(e)}const r=Math.max(0,i.length-3),a=Math.min(i.length,3);return n()("div",{style:u.avatarContainer},void 0,i.slice(0,3).map(((e,o)=>{const i=O.U6.createChildStore(t,{table:I.KJ,id:e}),r=o===a-1;if(i)return n()(Y.Z,{userStore:i,size:24,avatarShouldShowShadow:!1,style:r?u.rightmostAvatar:u.overlappingAvatar,isOffline:!1,hasTooltip:!c.device.isMobile})})),r>0&&n()("div",{style:u.remainderCount},void 0,n()(w.FormattedMessage,{defaultMessage:"{remainingAvatarCount, plural, one {+{remainingAvatarCount}} other {+{remainingAvatarCount}}}",id:"activity.titleCard.members.otherCount.message",description:"Label for the number of remaining members that overflow from a list of user avatars.",values:{remainingAvatarCount:r}})))}),[c.device.isMobile,u,t,o]);return d?n()(Nt.Z,{href:m,onClick:p,external:!1,innerStyle:u.container,inline:!0},void 0,n()("div",{style:u.flexRow},void 0,h&&n()(Pt.Z,{disabled:!0,icon:h,isEmptyPage:!1,size:25,style:u.icon}),n()("div",{style:u.title},void 0,n()(Vt.ZP,{store:t,style:u.activityTitle}),n()("div",{style:u.subtitle},void 0,v)),n()("div",{style:u.spacer}),n()("div",{},void 0,b))):null}const Mo=s.memo(Ao);function wo(e){const{activity:t,rootStore:o,tabArgs:i,isLast:a,useRedesignedIA:d}=e,{notification:c,tab:l}=i,h=(0,k.O7)(),u=t.edits??[],m=u.length>0,p=(0,R.VK)((()=>He({edits:t.edits||[],rootStore:o})),[t,o]),g=(0,R.VK)((()=>We(p)),[p]),v=u[0],b=O.zX.createChildStore(o,{table:J.e0,id:v.team_id}),f=(0,R.VK)((()=>b.isDefined()),[b]);return m&&f?d?s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a teamspace} other {{authorOrAuthors} invited you to a teamspace}}",values:{numberOfAuthors:p.length,authorOrAuthors:g},id:"activity.userInvitedToTeamActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),prominentTitleLink:n()(Mo,{titledRecordStore:b,rootStore:o,activity:t,tabArgs:i}),isLast:a,isPrivate:!1,rootStore:o,notification:c,showRecordPath:!1,icon:n()(ve,{authors:p}),showSnapshotButton:!1},St({notification:c,activity:t,environment:h,tab:l}))):s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to teamspace {teamName}} other {{authorOrAuthors} invited you to {teamName}}}",values:{numberOfAuthors:p.length,authorOrAuthors:g,teamName:n()(Lt,{titledRecordStore:b,getRecordModel:o.getRecordModel,activity:t,tabArgs:i})},id:"activity.userInvitedToTeamActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),isLast:a,isPrivate:!1,rootStore:o,notification:c,icon:n()(ve,{authors:p}),showSnapshotButton:!1},St({notification:c,activity:t,environment:h,tab:l}))):null}var Oo=o(84683),ko=o(94044),Ro=o(63143);function _o(e){const{activity:t,rootStore:o,tabArgs:i,isLast:a,useRedesignedIA:d}=e,{notification:c,tab:l}=i,h=(0,k.O7)(),u=(t.edits??[])[0],m=Do({rootStore:o,edit:u}),p=function(e){let{data:t,spaceId:o,tab:i,rootStore:r}=e;const a=(0,k.O7)();return(0,R.VK)((()=>{let e,n;if(!t)return!1;if("block"===(null==t?void 0:t.type))e=t.block.id,n="block";else if("space"===(null==t?void 0:t.type)||"group"===(null==t?void 0:t.type)){if(!o)return!1;e=o,n="space"}else(0,M.t1)(t);return je({recordId:e,recordType:n,tab:i,rootStore:r,environment:a})}),[t,a,r,o,i])}({data:m,spaceId:u.space_id,tab:l,rootStore:o}),g=(0,R.VK)((()=>He({edits:t.edits??[],rootStore:o})),[t.edits,o]),v=(0,s.useMemo)((()=>St({notification:c,environment:h,tab:l,activity:t})),[t,h,c,l]);if(!t.edits||0===t.edits.length||!m)return null;const b=parseInt(t.end_time),f=0===g.filter(P.uC).length,y=f?void 0:n()(ve,{authors:g});return d?s.createElement(Oe,r()({timestamp:b,header:n()("span",{},void 0,n()(Jo,{data:m,authors:g,isFromBot:f,spaceId:u.space_id})),prominentTitleLink:n()(To,{data:m,rootStore:o,activity:t,tabArgs:i}),isLast:a,isPrivate:p,rootStore:o,navigableBlockId:t.navigable_block_id,showRecordPath:!1,notification:c,icon:y,showSnapshotButton:!1},v),s.createElement(Co,r()({},e,{edit:u}))):s.createElement(ye,r()({timestamp:b,header:n()("span",{},void 0,n()(Io,{data:m,authors:g,isFromBot:f,activity:t,tabArgs:i,getRecordModel:o.getRecordModel,spaceId:u.space_id})),isLast:a,isPrivate:p,rootStore:o,navigableBlockId:t.navigable_block_id,notification:c,icon:y,showSnapshotButton:!1},v),s.createElement(Co,r()({},e,{edit:u})))}function To(e){let{data:t,rootStore:o,activity:i,tabArgs:r}=e;switch(t.type){case"block":return n()(Mo,{tabArgs:r,titledRecordStore:t.block,rootStore:o,activity:i});case"group":return null;case"space":return n()(Mo,{tabArgs:r,titledRecordStore:t.space,rootStore:o,activity:i});default:(0,M.t1)(t)}}function Jo(e){let{data:t,authors:o,isFromBot:i,spaceId:r}=e;const a=(0,R.VK)((()=>We(o)),[o]),s=(0,R.VK)((()=>{var e;return"block"===t.type?null===(e=t.block.getAssociatedCollectionStore())||void 0===e?void 0:e.getDatabaseType():void 0}),[t]);switch(t.type){case"block":if(i)switch(s){case Xt.wW:return n()(w.FormattedMessage,{defaultMessage:"You have been invited to a project",id:"activity.userInvitedActivityProjectByBot.standardizedHeader",description:"Notification header for updates. Used when the invite to the project is from a bot."});case Xt.iS:return n()(w.FormattedMessage,{defaultMessage:"You have been invited to a task",id:"activity.userInvitedActivityTaskByBot.standardizedHeader",description:"Notification header for updates. Used when the invite to the task is from a bot."});case Xt.zU:return n()(w.FormattedMessage,{defaultMessage:"You have been invited to a document",id:"activity.userInvitedActivityDocByBot.standardizedHeader",description:"Notification header for updates. Used when the invite to the document is from a bot."});case Xt.Fi:return n()(w.FormattedMessage,{defaultMessage:"You have been invited to a meeting",id:"activity.userInvitedActivityMeetingByBot.standardizedHeader",description:"Notification header for updates. Used when the invite to the meeting is from a bot."});case Xt.p$:return n()(w.FormattedMessage,{defaultMessage:"You have been invited to a sprint",id:"activity.userInvitedActivitySprintByBot.standardizedHeader",description:"Notification header for updates. Used when the invite to the sprint is from a bot."});case Xt.GZ:return n()(w.FormattedMessage,{defaultMessage:"You have been invited to a wiki",id:"activity.userInvitedActivityWikiByBot.standardizedHeader",description:"Notification header for updates. Used when the invite to the wiki is from a bot."});default:return n()(w.FormattedMessage,{defaultMessage:"You have been invited to a page",id:"activity.userInvitedActivityNavigableBlockByBot.standardizedHeader",description:"Notification header for updates. Used when the invite is from a bot."})}else switch(s){case Xt.wW:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a project} other {{authorOrAuthors} invited you to a project}}",values:{numberOfAuthors:o.length,authorOrAuthors:a},id:"activity.userInvitedActivityProject.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.iS:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a task} other {{authorOrAuthors} invited you to a task}}",values:{numberOfAuthors:o.length,authorOrAuthors:a},id:"activity.userInvitedActivityTask.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.zU:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a document} other {{authorOrAuthors} invited you to a document}}",values:{numberOfAuthors:o.length,authorOrAuthors:a},id:"activity.userInvitedActivityDoc.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.Fi:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a meeting} other {{authorOrAuthors} invited you to a meeting}}",values:{numberOfAuthors:o.length,authorOrAuthors:a},id:"activity.userInvitedActivityMeeting.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.p$:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a sprint} other {{authorOrAuthors} invited you to a sprint}}",values:{numberOfAuthors:o.length,authorOrAuthors:a},id:"activity.userInvitedActivitySprint.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.GZ:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a wiki} other {{authorOrAuthors} invited you to a wiki}}",values:{numberOfAuthors:o.length,authorOrAuthors:a},id:"activity.userInvitedActivityWiki.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});default:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a page} other {{authorOrAuthors} invited you to a page}}",values:{numberOfAuthors:o.length,authorOrAuthors:a},id:"activity.userInvitedActivityNavigableBlock.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}case"group":const e=n()(vo,{permissionGroup:t.group,spaceId:r});return n()(w.FormattedMessage,i?{defaultMessage:"You have been invited to group {groupName}",values:{groupName:e},id:"activity.userInvitedActivityGroupIdByBot.standardizedHeader",description:"Notification header for updates. Used when the invite is from a bot."}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to group {groupName}} other {{authorOrAuthors} invited you to group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:a,groupName:e},id:"activity.userInvitedActivityGroupId.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case"space":return n()(w.FormattedMessage,i?{defaultMessage:"You have been invited to a workspace",id:"activity.userInvitedActivityOtherInviteByBot.standardizedHeader",description:"Notification header for updates. Used when the invite is from a bot."}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a workspace} other {{authorOrAuthors} invited you to a workspace}}",values:{numberOfAuthors:o.length,authorOrAuthors:a},id:"activity.userInvitedActivityOtherInvite.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});default:(0,M.t1)(t)}}function Io(e){let{data:t,authors:o,isFromBot:i,activity:r,tabArgs:a,getRecordModel:s,spaceId:d}=e;const c=(0,R.VK)((()=>We(o)),[o]);switch(t.type){case"block":const e=t.block,l=n()(Lt,{tabArgs:a,titledRecordStore:e,activity:r,getRecordModel:s});return n()(w.FormattedMessage,i?{defaultMessage:"You have been invited to {blockName}",values:{blockName:l},id:"activity.userInvitedActivityNavigableBlockByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to {blockName}} other {{authorOrAuthors} invited you to {blockName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:c,blockName:l},id:"activity.userInvitedActivityNavigableBlock.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case"group":const h=n()(vo,{permissionGroup:t.group,spaceId:d});return n()(w.FormattedMessage,i?{defaultMessage:"You have been added to group {groupName}",values:{groupName:h},id:"activity.userInvitedActivityGroupIdByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to group {groupName}} other {{authorOrAuthors} added you to group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:c,groupName:h},id:"activity.userInvitedActivityGroupId.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case"space":const u=n()(Lt,{tabArgs:a,titledRecordStore:t.space,activity:r,getRecordModel:s});return n()(w.FormattedMessage,i?{defaultMessage:"You have been invited to {spaceName}",values:{spaceName:u},id:"activity.userInvitedActivityOtherInviteByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to {spaceName}} other {{authorOrAuthors} invited you to {spaceName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:c,spaceName:u},id:"activity.userInvitedActivityOtherInvite.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});default:(0,M.t1)(t)}}function Co(e){let{edit:t,activity:o,rootStore:i,tabArgs:r}=e;window.__c={n:"InviteDetail"};const a=(0,k.O7)(),{isMobile:s}=a.device,{source:d}=r,c=(0,_.yK)((()=>({inviteMessage:{paddingLeft:Rt({source:d,isMobile:s}),paddingTop:8,paddingBottom:8,paddingRight:12,fontSize:14}})),[s,d]),h=Do({rootStore:i,edit:t}),u=parseInt(o.end_time),m=(0,R.VK)((()=>{if("block"!==(null==h?void 0:h.type))return;const e=h.block;return null!=e&&e.isDefined()?e.getModel():void 0}),[h]),p=(0,R.VK)((()=>{if(m)return vt(m.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:l.tY.Notification}))}),[m,i.getRecordModel]),g=(0,R.VK)((()=>{if(!m)return{isValid:!1};const e=m&&(0,ko.$e)(m,o);if(!e)return{isValid:!1};const t=i.getRecordValue({table:Oo.Tu,id:e,spaceId:o.space_id});return null!=t&&t.message&&t.created_time<=u+5*Ro.hM?{isValid:!0,message:t.message}:{isValid:!1}}),[o,u,m,i]);return null!=g&&g.isValid?n()(Nt.Z,{href:p,onClick:()=>bt({...r,environment:a,activity:o,mightCloseTab:!0}),innerStyle:c.inviteMessage},void 0,g.message):null}function Do(e){let{rootStore:t,edit:o}=e;return(0,R.VK)((()=>{if(o)return o.navigable_block_id?{type:"block",block:O.G.createChildStore(t,{table:g.iU,id:o.navigable_block_id})}:o.permission_group_id?{type:"group",group:(0,m.Bg)({spaceId:o.space_id,permissionGroupId:o.permission_group_id,getRecordValue:t.getRecordValue})}:{type:"space",space:O.H2.createChildStore(t,{table:S.bx,id:o.space_id})}}),[o,t])}const Bo=s.memo(_o);var No=o(70921);function Po(e){const{activity:t,rootStore:o,tabArgs:i,isLast:a,useRedesignedIA:d}=e,{source:c,tab:h,notification:u}=i,m=(0,k.O7)(),p=t.edits??[],v=p.length>0,b=p[0],f=O.G.createChildStore(o,{table:g.iU,id:b.navigable_block_id}),y=(0,R.VK)((()=>f.isDefined()),[f]),S=O.G.createChildStore(o,{table:g.iU,id:t.mentioned_block_id}),A=O.WJ.createChildStore(o,{table:No.TY,id:t.id,spaceId:t.space_id}),M=(0,R.VK)((()=>A.getStandardizedMentionedPropertyURI()),[A]),_=(0,R.VK)((()=>S.isDefined()),[S]),T=(0,R.VK)((()=>{const e=S.getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:l.tY.Notification})}),[S,o]),J=(0,R.VK)((()=>He({edits:t.edits||[],rootStore:o})),[t,o]),I=(0,R.VK)((()=>We(J)),[J]),C=(0,R.VK)((()=>je({recordId:f.id,recordType:"block",tab:h,rootStore:o,environment:m})),[f,h,o,m]);if(!(v&&y&&_&&T))return null;const D=m.device.isMobile,B=n()(Lt,{titledRecordStore:f,getRecordModel:o.getRecordModel,activity:t,tabArgs:i}),N=function(e,t,o){switch(e){case Xt.Es.Assign:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} assigned you a task} other {{authorOrAuthors} assigned you a task}}",values:{numberOfAuthors:o.length,authorOrAuthors:t},id:"activity.mentionTaskActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case Xt.zI.People:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in a project} other {{authorOrAuthors} mentioned you in a project}}",values:{numberOfAuthors:o.length,authorOrAuthors:t},id:"activity.mentionProjectActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});default:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in a page} other {{authorOrAuthors} mentioned you in a page}}",values:{numberOfAuthors:o.length,authorOrAuthors:t},id:"activity.mentionActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}}(M,I,J);if(d)return s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,N),isLast:a,isPrivate:C,rootStore:o,navigableBlockId:f.id,prominentTitleLink:B,notification:u,icon:n()(ve,{authors:J}),showRecordPath:!0,showSnapshotButton:!1},St({notification:u,activity:t,environment:m,tab:h})),n()(Nt.Z,{href:T,onClick:()=>bt({environment:m,activity:t,...i}),innerStyle:kt({source:c,isMobile:D})},void 0,n()(Gt.Z,{edit:b,rootStore:o,highlightCurrentUser:!0})),n()(It,{tabArgs:i,activity:t,isMobile:D,environment:m,rootStore:o}));{const e=function(e,t,o,i){switch(e){case Xt.Es.Assign:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} assigned you to {pageName}} other {{authorOrAuthors} assigned you to {pageName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:t,pageName:i},id:"activity.mentionTaskActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});default:return n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in {pageName}} other {{authorOrAuthors} mentioned you in {pageName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:t,pageName:i},id:"activity.mentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}}(M,I,J,B);return s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,e),isLast:a,isPrivate:C,rootStore:o,navigableBlockId:f.id,notification:u,icon:n()(ve,{authors:J}),showSnapshotButton:!1},St({notification:u,activity:t,environment:m,tab:h})),n()(Nt.Z,{href:T,onClick:()=>bt({environment:m,activity:t,...i}),innerStyle:kt({source:c,isMobile:D})},void 0,n()(Gt.Z,{edit:b,rootStore:o})),n()(It,{tabArgs:i,activity:t,isMobile:D,environment:m,rootStore:o}))}}var Vo=o(80951);function xo(e){const{activity:t,rootStore:o,tabArgs:i,isLast:a,useRedesignedIA:d}=e,{tab:c,source:l,notification:h}=i,u=(0,k.O7)(),m=O.G.createChildStore(o,{table:g.iU,id:t.navigable_block_id}),p=(0,R.VK)((()=>m.isDefined()),[m]),b=O.NW.createChildStore(o,{table:v.v,id:t.collection_id,spaceId:t.space_id}),f=(0,R.VK)((()=>b.isDefined()),[b]),y=(0,R.VK)((()=>{const e=b.getSchema(),t=Object.keys(e).find((t=>{var o;return"verification"===(null===(o=e[t])||void 0===o?void 0:o.type)}));let i=n()(w.FormattedMessage,{id:"Activity.author.unknown",defaultMessage:"Unknown",description:"Label for a user when the user info is unknown for some reason"});if(t){const e=m.getPropertyValue(t),r=Vo._w(e);if(r){const e=Ye(r[0],o);e&&e.value&&(i=We([e]))}}return i}),[m,b,o]),S=(0,R.VK)((()=>je({recordId:m.id,recordType:"block",tab:c,rootStore:o,environment:u})),[m,c,o,u]);if(!p||!f)return null;const A=n()(Lt,{titledRecordStore:m,getRecordModel:o.getRecordModel,activity:t,tabArgs:i}),M=n()(w.FormattedMessage,{defaultMessage:"Verification expired for <boldtext>{pageTitle}</boldtext>",values:{pageTitle:A,boldtext:e=>n()("span",{style:{fontWeight:500}},void 0,e)},id:"activity.verificationExpired.header",description:"Notification header for when verification for a page has expired."}),_=parseInt(t.start_time),T=parseInt(t.end_time),J=u.device.isMobile,I=n()("div",{style:{fontSize:14,...kt({source:l,isMobile:J})}},void 0,n()(w.FormattedMessage,_&&T?{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:y,startDate:(0,E.gs)(parseInt(t.start_time)),endDate:(0,E.gs)(parseInt(t.end_time))},id:"activity.verificationExpired.contentWithTimestamp",description:"Notification content for when verification for a page has expired, to show who last verified it and when."}:{defaultMessage:"Last verified by {person}",values:{person:y},id:"activity.verificationExpired.contentWithoutTimestamp",description:"Notification content for when verification for a page has expired, to show who last verified it."}));return d?s.createElement(Oe,r()({timestamp:parseInt(t.end_time),header:M,isLast:a,isPrivate:S,rootStore:b,navigableBlockId:t.navigable_block_id,notification:h,icon:n()(fe,{}),showRecordPath:!0,showSnapshotButton:!1},St({notification:h,activity:t,environment:u,tab:c})),I,n()(It,{tabArgs:i,activity:t,isMobile:u.device.isMobile,environment:u,rootStore:o})):s.createElement(ye,r()({timestamp:parseInt(t.end_time),header:M,isLast:a,isPrivate:S,rootStore:b,navigableBlockId:t.navigable_block_id,notification:h,icon:n()(fe,{}),showSnapshotButton:!1},St({notification:h,activity:t,environment:u,tab:c})),I,n()(It,{tabArgs:i,activity:t,isMobile:u.device.isMobile,environment:u,rootStore:o}))}var Lo=o(1136),Fo=o(45669);class Zo extends d.Z{constructor(){super(...arguments),this.renderBlockEdit=(e,t,o)=>{const{tabArgs:i}=this.props,{source:r}=i;let a=this.getRecordModel({table:g.iU,id:e.block_id});a&&a.type===h.Ti.tableRow&&(a=this.getRecordModel({table:g.iU,id:a.parent_id}));const s=a?a.getRenderUrl({getRecordModel:this.getRecordModel,pageVisitSource:l.tY.Activity}):p._j.root,d=this.environment.device.isMobile;return"block-deleted"===e.type?e.block_data.block_value.type===h.Ti.page?n()(Nt.Z,{href:s,onClick:()=>bt({...i,environment:this.environment,activity:o}),innerStyle:kt({source:r,isMobile:d})},t,n()(Gt.Z,{edit:e,rootStore:this.props.rootStore})):n()("div",{style:kt({source:r,isMobile:d})},t,n()(Gt.Z,{edit:e,rootStore:this.props.rootStore})):n()(Nt.Z,{href:s,onClick:()=>bt({...i,environment:this.environment,activity:o}),innerStyle:kt({source:r,isMobile:d})},t,n()(Gt.Z,{edit:e,rootStore:this.props.rootStore}))},this.renderCollectionPropertyEdit=(e,t)=>{if("collection-property-changed"!==e.type)return;const{source:o}=this.props.tabArgs,i=this.environment.device.isMobile;return n()(Nt.Z,{href:t,innerStyle:kt({source:o,isMobile:i})},void 0,n()(Gt.Z,{edit:e,rootStore:this.props.rootStore}))},this.getRecordStore=e=>this.props.rootStore.getRecordStore(this.props.rootStore,e),this.getSpaceStore=e=>O.H2.createChildStore(this.props.rootStore,{table:S.bx,id:e}),this.getDiscussionContext=()=>{const e=Xe({activity:this.props.activity,rootStore:this.props.rootStore});if(e)return e.context}}willMountOrUpdate(){this.warmCommentData(),this.environment.KatexStore.loadIfNeeded(this.getDiscussionContext)}warmCommentData(){if("commented"===this.props.activity.type){const e=this.getRecordStore({table:y.qF,id:this.props.activity.discussion_id,spaceId:this.props.activity.space_id});if(e.isDefined()){const t=e.getCommentStores();for(const e of t)if(e.isDefined()&&e.getCreatedByTable()&&e.getCreatedById()){this.getRecordStore(e.getCreatedByPointer()).load()}}}}renderComponent(){const{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r}=this.props;switch(e.type){case"block-edited":return this.renderBlockEditActivity(e);case"block-property-edited":return n()($t,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});case"collection-row-created":case"collection-row-deleted":return this.renderCollectionRowActivity(e);case"top-level-block-created":case"top-level-block-deleted":return this.renderTopLevelBlockActivity(e);case"permissions-edited":return this.renderPermissionsActivity(e);case"permission-group-edited":return this.renderPermissionGroupActivity(e);case"user-mentioned":return n()(Po,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});case"commented":return n()(ho,{activity:e,tabArgs:o,rootStore:t,isLast:i,useRedesignedIA:r});case"user-invited":return n()(Bo,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});case"collection-edited":return this.renderCollectionEdited(e);case"collection-view-edited":return this.renderCollectionViewEdited(e);case"collection-property-edited":return this.renderCollectionPropertyEdited(e);case"reminder":return n()(fo,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});case"page-locked":case"page-unlocked":return this.renderPageLockActivity(e);case"email-edited":return n()(uo,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});case"access-requested":return n()(zt,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});case"page-deleted":case"page-restored":case"page-permanently-deleted":return this.renderPageDeleteOrRestoreActivity(e);case"team-membership-edited":return n()(wo,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});case"private-content-transferred":return n()(bo,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});case"permission-group-mentioned":return n()(po,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});case"verification-expired":return n()(xo,{activity:e,rootStore:t,tabArgs:o,isLast:i,useRedesignedIA:r});default:(0,M.t1)(e)}}renderBlockEditActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a}=t;if(!e.edits)return;const d=(0,A.hI)(e.edits).filter((e=>{const{block_value:t}="block-changed"===e.type?e.block_data.after:e.block_data;return t.parent_table!==f.x_}));if(0===d.length)return;const c=this.getBlockStore(d[0].navigable_block_id);if(!c.isDefined())return;const l=He({edits:d,rootStore:o}),h=We(l),u=n()(Lt,{titledRecordStore:c,activity:e,tabArgs:t,getRecordModel:o.getRecordModel});return s.createElement(ye,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:l.length,authorOrAuthors:h,pageTitle:u}})),isLast:this.props.isLast,isPrivate:je({recordId:c.id,recordType:"block",tab:a,rootStore:o,environment:this.environment}),rootStore:this.props.rootStore,navigableBlockId:c.id,notification:i,icon:n()(ve,{authors:l}),showSnapshotButton:this.isTopbarUpdatesMenu()},St({notification:i,activity:e,environment:this.environment,tab:a})),n()(Yt,{visible:5,items:d.map(((t,o)=>this.renderBlockEdit(t,o,e)))}),n()(It,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o}))}renderCollectionRowActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a}=t;if(!e.edits)return;const d=e.edits[0],c=this.getBlockStore(e.collection_row_id);if(!c.isDefined())return;if(!c.getProperties())return;const l=He({edits:e.edits,rootStore:o}),h=We(l),u=n()(Lt,{titledRecordStore:c,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),m="collection-row-created"===d.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {pageTitle}} other {{authorOrAuthors} created {pageTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:h,pageTitle:u},id:"activity.collectionRowCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {pageTitle}} other {{authorOrAuthors} deleted {pageTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:h,pageTitle:u},id:"activity.collectionRowDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return s.createElement(ye,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,m),isLast:this.props.isLast,isPrivate:je({recordId:c.id,recordType:"block",tab:a,rootStore:o,environment:this.environment}),rootStore:this.props.rootStore,navigableBlockId:c.id,notification:i,icon:n()(ve,{authors:l}),showSnapshotButton:this.isTopbarUpdatesMenu()},St({notification:i,activity:e,environment:this.environment,tab:a})),n()(It,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o}))}renderTopLevelBlockActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a}=t;if(!e.edits)return;const d=e.edits[0],c=this.getBlockStore(e.top_level_block_id);if(!c.isDefined())return;const l=c.hasSpacePermission(),h=He({edits:e.edits,rootStore:o}),u=We(h),m=n()(Lt,{titledRecordStore:c,activity:e,tabArgs:t,getRecordModel:o.getRecordModel});let p;return p=l?"top-level-block-created"===d.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created workspace page {pageTitle}} other {{authorOrAuthors} created workspace page {pageTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:u,pageTitle:m},id:"activity.topLevelBlockWorkspaceCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted workspace page {pageTitle}} other {{authorOrAuthors} deleted workspace page {pageTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:u,pageTitle:m},id:"activity.topLevelBlockWorkspaceDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"top-level-block-created"===d.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created private page {pageTitle}} other {{authorOrAuthors} created private page {pageTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:u,pageTitle:m},id:"activity.topLevelBlockPrivateCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted private page {pageTitle}} other {{authorOrAuthors} deleted private page {pageTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:u,pageTitle:m},id:"activity.topLevelBlockPrivateDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),s.createElement(ye,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,p),isLast:this.props.isLast,isPrivate:je({recordId:c.id,recordType:"block",tab:a,rootStore:o,environment:this.environment}),rootStore:this.props.rootStore,notification:i,icon:n()(ve,{authors:h}),showSnapshotButton:!1},St({notification:i,activity:e,environment:this.environment,tab:a})))}renderPermissionsActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a,source:d}=t;if(!e.edits)return;const l=(0,A.hI)(e.edits);if(0===l.length)return;let h,u;const m=l[0];if(m.navigable_block_id){const i=this.getBlockStore(m.navigable_block_id);if(!i.isDefined())return;u=n()(Lt,{titledRecordStore:i,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),h=je({recordId:i.id,recordType:"block",tab:a,rootStore:o,environment:this.environment})}else{const i=this.getSpaceStore(m.space_id);if(!i.isDefined())return;u=n()(Lt,{titledRecordStore:i,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),h=je({recordId:m.space_id,recordType:"space",tab:a,rootStore:o,environment:this.environment})}const{autojoinEdits:p,inheritanceEdits:g,otherEdits:v}=c.md(e.edits),b=[];p.forEach(((t,d)=>{const c=He({edits:[t],rootStore:o}),l=We(c);b.push(s.createElement(ye,r()({key:`autojoin-${d}`,timestamp:t.timestamp,header:n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} joined {pageOrSpaceName}} other {{authorOrAuthors} joined {pageOrSpaceName}}}",values:{numberOfAuthors:c.length,authorOrAuthors:l,pageOrSpaceName:u},id:"activity.permissionsActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:this.props.isLast,isPrivate:h,rootStore:this.props.rootStore,navigableBlockId:t.navigable_block_id,notification:i,icon:n()(ve,{authors:c}),showSnapshotButton:!1},St({notification:i,activity:e,environment:this.environment,tab:a}))))}));const f=this.environment.device.isMobile;g.forEach(((c,l)=>{const m=He({edits:[c],rootStore:o}),p=We(m);let g;"permission-restriction-created"===c.type?g=n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restricted access for {pageOrSpaceName}} other {{authorOrAuthors} restricted access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,pageOrSpaceName:u,inSudoMode:c.inSudoMode},id:"activity.restrictPermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"permission-restriction-deleted"===c.type&&(g=n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored inherited access for {pageOrSpaceName}} other {{authorOrAuthors} restored inherited access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,pageOrSpaceName:u,inSudoMode:c.inSudoMode},id:"activity.restorePermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),b.push(s.createElement(ye,r()({key:`inheritance-${l}`,timestamp:parseInt(e.end_time),header:n()("span",{},void 0,g),isLast:this.props.isLast,isPrivate:h,rootStore:this.props.rootStore,navigableBlockId:c.navigable_block_id,notification:i,icon:n()(ve,{authors:m}),showSnapshotButton:!1},St({notification:i,activity:e,environment:this.environment,tab:a})),n()("div",{style:kt({source:d,isMobile:f})},void 0,n()(Gt.Z,{edit:c,rootStore:this.props.rootStore})),n()(It,{tabArgs:t,activity:e,isMobile:f,environment:this.environment,rootStore:o})))}));const y=(c,l,u)=>{if(c.length>0){const p=He({edits:c,rootStore:o});b.push(s.createElement(ye,r()({key:l,timestamp:parseInt(e.end_time),header:u,isLast:this.props.isLast,isPrivate:h,rootStore:this.props.rootStore,navigableBlockId:m.navigable_block_id,notification:i,icon:n()(ve,{authors:p}),showSnapshotButton:!1},St({notification:i,activity:e,environment:this.environment,tab:a})),c.map(((e,t,o)=>n()("div",{style:kt({source:d,isMobile:f})},t,n()(Gt.Z,{edit:e,rootStore:this.props.rootStore},t)))),n()(It,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o})))}},S=v.filter((e=>!e.inSudoMode));if(S.length>0){const e=He({edits:S,rootStore:o}),t=We(e);y(S,"other",n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}}",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:u},id:"activity.updatedPermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})))}const M=v.filter((e=>e.inSudoMode));if(M.length>0){const e=He({edits:M,rootStore:o}),t=We(e);y(M,"other-sudo",n()("span",{},void 0,n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}} using administrator privileges",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:u},id:"activity.updatedPermissionsForActivityInSudoMode.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})))}return b}renderPermissionGroupActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a,source:d}=t;if(!e.edits)return;const c=(0,A.hI)(e.edits)[0];if(!c)return;const l=this.getSpaceStore(c.space_id);if(!l.isDefined())return;const h=vt(l.getModel().getRenderUrl({getRecordModel:this.getRecordModel})),u=n()(vo,{permissionGroup:(0,m.c_)({activity:e,getRecordValue:this.getRecordValue}),spaceId:e.space_id}),p=He({edits:e.edits,rootStore:o}),g=this.environment.device.isMobile;return s.createElement(ye,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,this.renderPermissionGroupEditedHeader({activity:e,authors:p,groupName:u})),isLast:this.props.isLast,isPrivate:je({recordId:e.space_id,recordType:"space",tab:a,rootStore:o,environment:this.environment}),rootStore:o,notification:i,icon:n()(ve,{authors:p}),showSnapshotButton:!1},St({notification:i,activity:e,environment:this.environment,tab:a})),n()(Nt.Z,{href:h,onClick:()=>bt({...t,environment:this.environment,activity:e}),innerStyle:kt({source:d,isMobile:g})},void 0,n()(Gt.Z,{edit:c,rootStore:o})),n()(It,{tabArgs:t,activity:e,isMobile:g,environment:this.environment,rootStore:o}))}renderCollectionEdited(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a}=t;if(!e.edits)return;const d=this.getRecordStore({table:v.v,id:e.collection_id,spaceId:e.space_id});if(!d.isDefined())return;const h=e.edits[0];if(!h)return;const u=d.getModel().getRenderUrl({getRecordModel:this.getRecordModel,pageVisitSource:l.tY.Activity}),m=He({edits:e.edits,rootStore:o}),p=We(m),g=n()(Lt,{titledRecordStore:d,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),b="collection-created"===h.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {collectionTitle}} other {{authorOrAuthors} created {collectionTitle}}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,collectionTitle:g},id:"activity.collectionCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {collectionTitle}} other {{authorOrAuthors} edited {collectionTitle}}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,collectionTitle:g},id:"activity.collectionEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return s.createElement(ye,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,b),isLast:this.props.isLast,isPrivate:je({recordId:e.collection_id,recordType:"collection",tab:a,rootStore:o,environment:this.environment}),rootStore:o,navigableBlockId:e.navigable_block_id,notification:i,icon:n()(ve,{authors:m}),showSnapshotButton:this.isTopbarUpdatesMenu()},St({notification:i,activity:e,environment:this.environment,tab:a})),c.OC(h)&&this.renderCollectionDescriptionEdit(h,u),n()(It,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o}))}renderCollectionDescriptionEdit(e,t){const{source:o}=this.props.tabArgs,i=this.environment.device.isMobile;return n()(Nt.Z,{href:t,innerStyle:kt({source:o,isMobile:i})},void 0,n()(Gt.Z,{edit:e,rootStore:this.props.rootStore}))}renderCollectionViewEdited(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a}=t;if(!e.edits)return;const d=this.getRecordStore({table:v.v,id:e.collection_id,spaceId:e.space_id});if(!d.isDefined())return;const c=this.getRecordStore({table:b.n,id:e.collection_view_id,spaceId:e.space_id});if(!c.isDefined())return;const l=(0,A.hI)(e.edits)[0];if(!l)return;const h=this.renderCollectionViewTitle(c,e),u=n()(Lt,{titledRecordStore:d,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),m=He({edits:e.edits,rootStore:o}),p=We(m);let g;return g="collection-view-created"===l.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,collectionTitle:u,collectionViewTitle:h},id:"activity.collectionViewCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"collection-view-deleted"===l.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,collectionTitle:u,collectionViewTitle:h},id:"activity.collectionViewDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:m.length,authorOrAuthors:p,collectionTitle:u,collectionViewTitle:h},id:"activity.collectionViewEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),s.createElement(ye,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,g),isLast:this.props.isLast,isPrivate:je({recordId:e.collection_id,recordType:"collection",tab:a,rootStore:o,environment:this.environment}),rootStore:o,navigableBlockId:e.navigable_block_id,notification:i,icon:n()(ve,{authors:m}),showSnapshotButton:this.isTopbarUpdatesMenu()},St({notification:i,activity:e,environment:this.environment,tab:a})),n()(It,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o}))}renderCollectionPropertyEdited(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a}=t;if(!e.edits)return;const d=(0,A.hI)(e.edits),c=d[0];if(!c)return;const h=this.getRecordStore({table:v.v,id:e.collection_id,spaceId:e.space_id});if(!h.isDefined())return;const u=h.getModel().getRenderUrl({getRecordModel:this.getRecordModel,pageVisitSource:l.tY.Activity}),m="collection-property-changed"===c.type?c.collection_property_data.after:c.collection_property_data,p=He({edits:e.edits,rootStore:o}),g=We(p),b=n()(Lt,{titledRecordStore:h,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),f=this.renderCollectionPropertyTitle(m);let y;return y="collection-property-created"===c.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:p.length,authorOrAuthors:g,collectionTitle:b,collectionPropertyTitle:f},id:"activity.collectionPropertyCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"collection-property-deleted"===c.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:p.length,authorOrAuthors:g,collectionTitle:b,collectionPropertyTitle:f},id:"activity.collectionPropertyDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:p.length,authorOrAuthors:g,collectionTitle:b,collectionPropertyTitle:f},id:"activity.collectionPropertyEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),s.createElement(ye,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,y),isLast:this.props.isLast,isPrivate:je({recordId:e.collection_id,recordType:"collection",tab:a,rootStore:o,environment:this.environment}),rootStore:o,navigableBlockId:e.navigable_block_id,notification:i,icon:n()(ve,{authors:p}),showSnapshotButton:this.isTopbarUpdatesMenu()},St({notification:i,activity:e,environment:this.environment,tab:a})),n()(Yt,{visible:5,items:d.map((e=>this.renderCollectionPropertyEdit(e,u)))}),n()(It,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o}))}renderPageLockActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a}=t;if(!e.edits)return;const d=e.edits[0],c=this.getBlockStore(d.navigable_block_id);if(!c.isDefined())return;const l=He({edits:e.edits,rootStore:o}),h=We(l),u=n()(Lt,{titledRecordStore:c,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),m="page-locked"===e.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} locked {blockTitle}} other {{authorOrAuthors} locked {blockTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:h,blockTitle:u},id:"activity.pageLocked.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} unlocked {blockTitle}} other {{authorOrAuthors} unlocked {blockTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:h,blockTitle:u},id:"activity.pageUnlocked.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return s.createElement(ye,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,m),isPrivate:je({recordId:c.id,recordType:"block",tab:a,rootStore:o,environment:this.environment}),isLast:this.props.isLast,rootStore:o,navigableBlockId:c.id,notification:i,icon:n()(ve,{authors:l}),showSnapshotButton:!1},St({notification:i,activity:e,environment:this.environment,tab:a})),n()(It,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o}))}renderPageDeleteOrRestoreActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:i,tab:a}=t;if(!e.edits)return;const d=e.edits[0];if(!d)return;const c=this.getRecordStore({table:g.iU,id:d.navigable_block_id,spaceId:d.space_id});if(!c.isDefined())return;const l=He({edits:e.edits,rootStore:o}),h=We(l),u=n()(Lt,{titledRecordStore:c,activity:e,tabArgs:t,getRecordModel:o.getRecordModel});let m;return"page-deleted"===e.type?m=n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {blockTitle}} other {{authorOrAuthors} deleted {blockTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:h,blockTitle:u},id:"emailActivity.pageDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"page-restored"===e.type?m=n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored {blockTitle}} other {{authorOrAuthors} restored {blockTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:h,blockTitle:u},id:"emailActivity.pageRestored.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"page-permanently-deleted"===e.type?m=n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} permanently deleted {blockTitle}} other {{authorOrAuthors} permanently deleted {blockTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:h,blockTitle:u},id:"emailActivity.pagePermanentlyDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):(0,M.t1)(e),s.createElement(ye,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,m),isPrivate:je({recordId:c.id,recordType:"block",tab:a,rootStore:o,environment:this.environment}),isLast:this.props.isLast,rootStore:o,navigableBlockId:c.id,notification:i,icon:n()(ve,{authors:l}),showSnapshotButton:!1},St({notification:i,activity:e,environment:this.environment,tab:a})),n()(It,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o}))}renderCollectionPropertyTitle(e){const{theme:t}=this;return n()("span",{style:{...Ot,whiteSpace:"nowrap"}},void 0,n()(u.ZP,{icon:e.icon,type:e.type,size:12,style:Zo.svgIconStyle,theme:t}),e.name)}renderCollectionViewTitle(e,t){const{tabArgs:o}=this.props;if(!e.isDefined())return;const i=e.getModel().getRenderUrl({getRecordModel:this.getRecordModel,pageVisitSource:l.tY.Activity}),r=e.getFormat().collection_view_icon,a=e.getType();return n()(Nt.Z,{href:i,onClick:()=>ft({environment:this.environment,activity:t,...o}),external:!1,innerStyle:{...Mt,...Ot},inline:!0},void 0,n()(Lo.F,{viewIcon:r,viewType:a,color:"light",style:{display:"inline-block",verticalAlign:"middle",marginRight:4,marginBottom:2},size:12}),n()(Fo.Z,{collectionViewName:e.getName(),collectionViewType:e.getType()}))}isTopbarUpdatesMenu(){return"pageUpdatesSidebar"===this.props.tabArgs.tab}renderPermissionGroupEditedHeader(e){const{activity:t,authors:o,groupName:i}=e,r=We(o),a=(0,A.hI)(t.edits||[])[0];return a?"permission-group-created"===a.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created group {groupName}} other {{authorOrAuthors} created group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:r,groupName:n()("span",{style:Ot},void 0,i)},id:"activity.updatedPermissionGroupCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"permission-group-deleted"===a.type?n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted group {groupName}} other {{authorOrAuthors} deleted group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:r,groupName:n()("span",{style:Ot},void 0,i)},id:"activity.updatedPermissionGroupDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:r,groupName:n()("span",{style:Ot},void 0,i)},id:"activity.updatedPermissionGroupEditedDefault.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(w.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:r,groupName:n()("span",{style:Ot},void 0,i)},id:"activity.updatedPermissionGroupEdit.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}get getRecordValue(){return this.props.rootStore.getRecordValue}get getRecordModel(){return this.props.rootStore.getRecordModel}getBlockStore(e){return O.G.createChildStore(this.props.rootStore,{table:g.iU,id:e})}}Zo.displayName="Activity",Zo.svgIconStyle={width:12,height:12,display:"inline-block",verticalAlign:"middle",marginBottom:2,marginRight:4};const Ko=Zo},98905:(e,t,o)=>{o.d(t,{Z:()=>a});var i=o(49085);class r extends i.default{getInitialState(){return{count:0}}}const a=new r}}]);