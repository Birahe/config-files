"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[801],{56305:(e,t,i)=>{i.r(t),i.d(t,{default:()=>p});var o=i(77094),n=i.n(o),a=(i(67294),i(81954)),r=i(5366),s=i(43250),l=i(12982),d=i(22230),u=i(79500),c=i(43113),g=i(97812);function p(e){window.__c={n:"DeveloperIntegrationCreateV2"};const{onClose:t,onSuccess:i}=e,o=(0,a.qz)(void 0,d.Z);return n()(g.Z,{className:s.Zp2,title:n()(r.FormattedMessage,{id:"developerIntegrationsCreateInternal.title.label",defaultMessage:"Create a new integration"}),subtitle:n()(r.FormattedMessage,{id:"developerIntegrationsCreateInternal.subtitle.label",defaultMessage:"We’ll walk you through how to set up a new integration"}),onNavigateBack:t,sideContent:n()(u.T,{supportedPages:(0,l.H)("create-bot")})},void 0,n()(c.Z,{onCreateNew:i,integrationFormStore:o,currentPage:"basic"}))}},79500:(e,t,i)=>{i.d(t,{T:()=>c,e:()=>m});var o=i(77094),n=i.n(o),a=i(67294),r=i(81954),s=i(24405),l=i(82990),d=i(12982),u=i(89728);function c(e){window.__c={n:"DeveloperIntegrationFormSectionSidebar"};const{supportedPages:t,selectedPage:i,setSelectedPage:o,integrationFormStore:a}=e,s=(0,r.VK)((()=>null==a?void 0:a.getState().type),[a]),l=i||t[0],u=e=>{if(!(0,d.mP)(e))return;const t=(0,d._R)(s);l!==e&&t&&(null==a||a.updateRecordTypeOnSwitch(t)),o&&o(e)};return n()("div",{style:h},void 0,t.map((e=>{const t=function(e,t,i){if(e!==t||!i)return!1;const o="linkPreview"===e&&"update-guest-integration"!==i;return"distribution"===e&&"update-bot"!==i||o}(l,e,s);return n()("div",{},e,n()(p,{highlightedSelection:l,currentSelection:{key:d.vb[e].key,title:d.vb[e].title},handleOnClick:u}),t&&n()(g,{currentPage:e,formStateType:s}))})))}function g(e){window.__c={n:"DeveloperIntegrationFormSidebarSection"};const{currentPage:t,formStateType:i}=e,o=d.vb[t].subsections,[r,l]=a.useState(),u=r||o[0].key,c=(0,s.yK)((()=>({sectionContainer:{marginLeft:20}})),[]),g=e=>{if((0,d.mP)(e))return;const t=document.getElementById((0,d.bK)(e));t&&(t.scrollIntoView(),l(e))};return n()("div",{style:c.sectionContainer},void 0,o.map((e=>n()(p,{currentSelection:e,highlightedSelection:u,handleOnClick:g,formStateType:i},e.key))))}function p(e){window.__c={n:"DeveloperIntegrationFormSidebarButton"};const{currentSelection:{key:t,title:i},highlightedSelection:o,handleOnClick:a,formStateType:r}=e,d="create-third-party-external-integration"===r&&"unfurling"===t,c=(0,s.yK)((e=>({sidebarButton:{...v,color:e.sidebarTextColor,...o===t&&{color:e.regularTextColor,fontWeight:l.Z.fontWeight.medium}}})),[t,o]);return n()(u.Z,{style:c.sidebarButton,onClick:()=>a(t),disabled:d,disabledFeedback:!0},void 0,i)}function m(e){window.__c={n:"DeveloperIntegrationFormSectionHeader"};const{section:t}=e,{title:i,subtitle:o,key:a}=t,r=(0,s.yK)((e=>({titleStyle:{...f},subtitleStyle:{fontWeight:l.Z.fontWeight.regular,fontSize:15,color:e.lightTextColor}})),[]);return n()("div",{style:r.titleStyle,id:(0,d.bK)(a)},void 0,i,o&&n()("div",{style:r.subtitleStyle},void 0,o))}const f={fontSize:30,marginTop:24,marginBottom:24,fontWeight:l.Z.fontWeight.bold},v={fontSize:15,height:28,marginTop:4,width:"100%"},h={display:"grid",gridTemplate:"none | auto | auto",marginTop:24,position:"sticky",top:16}},43113:(e,t,i)=>{i.d(t,{Z:()=>rt});var o=i(77094),n=i.n(o),a=i(96486),r=i(67294),s=i(480),l=i(81954),d=i(21202),u=i(97880),c=i(5366),g=i(8981),p=i(47307),m=i(12982),f=i(33665),v=i(27832),h=i(85057),b=i(33929),y=i(97464),w=i.n(y),_=i(13991),S=i(24405),M=i(8848),k=i(84619),I=i(3779),F=i(74446),x=i(45953),C=i(89101),T=i(44312),Z=i(90468),R=i(82990),P=i(54642),D=i(43132),V=i(65270),L=i(38755),B=i(52507),E=i(64921),A=i(52275),U=i(12508),O=i(74194),N=i(9342),z=i(89728),Y=i(72495),K=i(58032),W=i(60709),H=i(78140),$=i(44532);function q(e){window.__c={n:"DeveloperIntegrationFormDropdown"};const{value:t}=e,[i,o]=r.useState(!1),a=()=>o(!1);return n()($.GI,{popupType:$.GI.PopupType.Popup,alignmentToOrigin:$.GI.Alignment.Start,placementToOrigin:$.GI.Placement.Bottom,originGap:2,sameWidthAsOrigin:!0,open:i,onDismiss:a,render:()=>r.createElement(J,w()({},e,{value:t,onClose:a})),origin:r.createElement(j,w()({},e,{value:t,onClick:()=>o(!0)}))})}function j(e){const{onClick:t,value:i,renderMenuItem:o}=e,n=(0,S.yK)((e=>({dropdown:{background:e.whiteButtonBackground,border:`1px solid ${e.outlineButtonBorder}`,borderRadius:3,height:32},expandIcon:{height:12,width:12,fill:e.lightIconColor}})),[]);return r.createElement(r.Fragment,null,o({item:i,focused:!1,onClick:t,style:n.dropdown,right:I.Z.expand(n.expandIcon)}))}function J(e){window.__c={n:"SelectionDropdown"};const{keyName:t,items:i,value:o,setValue:a,renderMenuItem:s,onClose:l}=e;let d=0;const u=i.map(((e,t)=>(e.id===(null==o?void 0:o.id)&&(d=t),{key:e.id,action:()=>{a(e),l()},render:t=>s({...t,item:e})})));return n()(H.Z,{menuType:W.og.Popup},void 0,n()(N.Z,{type:N.i.Vertical,initialFocus:d,sections:[{key:`form-input-section-${t}`,items:u,render:e=>r.createElement(Y.Z,e)}]}))}var G=i(53471),Q=i(71669),X=i(68785),ee=i(63296),te=i(81865);function ie(e){const{value:t,setValue:i,setError:o}=e,a=(0,s.O7)(),[l,d]=r.useState(!1);return r.createElement(r.Fragment,null,t&&n()(te.Z,{url:t,isAuthenticated:!1,stripGoogleIconQuery:!0,width:90,render:(e,t)=>n()("div",{style:{width:90,height:90}},void 0,n()(Q.Z,{src:t,style:{width:90,height:90,objectFit:"cover",borderRadius:3}}))}),n()(ee.Z,{isLarge:!0,style:{width:"fit-content",backgroundColor:"white"},onClick:()=>{G.cR({environment:a,onStart:()=>d(!0),bucket:"public",onError:e=>{o(e.message),d(!1)},onComplete:e=>{i(e[0]),d(!1)},accept:"image/*"})}},void 0,n()(c.FormattedMessage,{id:"formInputIcon.uploadButton.label",defaultMessage:"Upload image"}),l&&n()(X.Z,{style:{marginLeft:4}})))}function oe(e){window.__c={n:"DeveloperIntegrationFormLabel"};const{label:t,subtitle:i,caption:o,error:a,children:r,field:s,formStateType:l}=e,d=m.aP[s].requiredBy[l],u=(0,S.yK)((()=>({wrapper:{display:"flex"},label:{fontSize:15,fontWeight:R.Z.fontWeight.medium,color:M.ZP.frontTextMedium},required:{color:M.ZP.red,marginLeft:2},subtitle:{fontSize:15,color:M.ZP.frontTextLight},caption:{fontSize:15,color:M.ZP.frontTextLight},error:{marginTop:4,fontSize:15,color:M.ZP.frontRed},field:{display:"grid",gridTemplateColumns:"1fr",gap:6,marginBottom:32}})),[]);return n()("div",{style:u.field},void 0,n()("header",{style:u.wrapper},void 0,n()("div",{style:u.label},void 0,t),d&&n()("div",{style:u.required},void 0,"*")),o&&n()("div",{style:u.caption},void 0,o),r,i&&n()("div",{style:u.subtitle},void 0,i),a&&n()("div",{style:u.error},void 0,a))}var ne=i(91996),ae=i(38381),re=i(74181),se=i(95477),le=i(85567),de=i(719);function ue(e){window.__c={n:"DeveloperIntegrationsUrlsInput"};const{currentValue:t,setNewValue:i,typeaheadTitle:o,style:a}=e,s=t||[],[l,d]=r.useState(""),u=()=>d("");return n()($.ZP,{popupType:$.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:l.length>0,onDismiss:u,origin:n()(de.Z,{style:{background:M.ZP.white,minHeight:32,fontSize:15},placeholder:"",value:l,onChange:e=>d(e.target.value),tokens:s.map(((e,t)=>n()(le.Z,{format:k.l.Medium,showRemoveButton:!0,isSingle:!1,shouldWrap:!0,value:e,style:a,onClickRemove:()=>{i(s.filter((t=>t!==e)))}},`${e}-${t}`))),onRemoveLastToken:()=>{s.length>0&&i(s.slice(0,s.length-1))}}),render:()=>{const e=l.trim(),t=(0,re.ue)(se.Z.domainBaseUrl,e).map((e=>({key:e,render:t=>r.createElement(A.Z,w()({},t,{title:e})),action:()=>{u(),i([...s,e])}})));return n()(H.Z,{menuType:W.og.Popup},void 0,n()(N.Z,{type:N.i.Vertical,initialFocus:0,sections:[{key:"valid-url-suggestion",items:t,render:e=>r.createElement(Y.Z,w()({},e,{title:o}))}]}))}})}function ce(e){window.__c={n:"DeveloperIntegrationFormRegexRule"};const{currentRule:t,onUpdate:i,shouldShowDelete:o,onDelete:a,onError:s}=e,{name:l,regex:d,attributes:u,sampleUrls:g}=t,[p,m]=r.useState(JSON.stringify(u,null,2));return n()("div",{style:{marginBottom:24}},void 0,n()("label",{},void 0,n()("div",{style:{fontSize:15,fontWeight:R.Z.fontWeight.regular,color:M.ZP.frontTextMedium}},void 0,n()(c.FormattedMessage,{id:"developerIntegrationForm.regexRule.name.label",defaultMessage:"Rule Name",description:"Label for the name input of the developer's pattern rule (e.g. github_pull)"})),n()(O.Z,{inputClassName:l,style:{background:M.ZP.white,height:32,fontSize:15},value:l,onChange:e=>{i({...t,name:e.target.value})},right:o&&n()(ge,{onDelete:a})})),n()("label",{},void 0,n()("div",{style:{fontSize:15,fontWeight:R.Z.fontWeight.regular,color:M.ZP.frontTextMedium}},void 0,n()(c.FormattedMessage,{id:"developerIntegrationForm.sampleUrls.label",defaultMessage:"Sample URLs",description:"Label name for a field for sample URLs the developer wants to test their regexes on."})),n()(ue,{currentValue:g,setNewValue:e=>{i({...t,sampleUrls:e})},style:{color:M.ZP.frontTextMedium},setErrorValue:e=>s(e),typeaheadTitle:n()(c.FormattedMessage,{id:"developerIntegrationsForm.urlsInput.typePrompt",defaultMessage:"Type or paste a url…",description:"Prompt that appears as user adds urls to an input field."})})),n()("label",{},void 0,n()("div",{style:{fontSize:15,fontWeight:R.Z.fontWeight.regular,color:M.ZP.frontTextMedium}},void 0,n()(c.FormattedMessage,{id:"developerIntegrationForm.regexRule.pattern.label",defaultMessage:"Pattern",description:"Label for the regex input of the developer's regex pattern rule."})),n()(O.Z,{style:{background:M.ZP.white,fontSize:15},autosize:!0,textarea:!0,value:d,onChange:e=>{i({...t,regex:e.target.value})}})),n()("label",{},void 0,n()("div",{style:{fontSize:15,fontWeight:R.Z.fontWeight.regular,color:M.ZP.frontTextMedium}},void 0,n()(c.FormattedMessage,{id:"developerIntegrationForm.regexRule.attributes.label",defaultMessage:"Attributes",description:"Label for the attributes input of the developer's attribute JSON definition."})),n()(O.Z,{format:O.B.ExtraLarge,style:{backgroundColor:M.ZP.white},inputStyle:{fontSize:14,lineHeight:"18px",height:200,fontFamily:R.Z.baseFontFamily.mono,padding:4},textarea:!0,value:p,onChange:e=>{const o=e.target.value;m(o);const a=(0,ne.Jv)(o);void 0===a?s(n()(c.FormattedMessage,{id:"developerIntegrationForm.jsonEditor.error",defaultMessage:"{value} attributes has invalid JSON.",description:"Error message returned to a developer when their payload is invalid.",values:{value:l}})):i({...t,attributes:a})}})))}function ge(e){let{onDelete:t}=e;return window.__c={n:"Trash"},n()(E.Z,{style:{padding:4,borderRadius:3},onClick:()=>{ae.Z.setState({open:!0,isDestructive:!1,isWarning:!0,title:n()(c.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.title",defaultMessage:"Are you sure you want to delete this regex pattern rule?",description:"Confirmation modal message developer receives when trying to delete a Link Preview regex pattern rule."}),message:n()(c.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.message",defaultMessage:"Changes will not be saved until you submit the form.",description:"Help message show in confirmation modal when developer tries to delete a Link Preview regex pattern rule."}),confirmationMessage:n()(c.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.confirm",defaultMessage:"Delete",description:"Confirmation message shown in modal when developer tries to delete a Link Preview regex pattern rule."}),onConfirm:()=>{t()}})}},void 0,I.Z.trash({width:15,height:15}))}var pe=i(79500),me=i(31278),fe=i(76798);const ve=r.forwardRef(((e,t)=>{const{item:i,...o}=e,a=(0,s.O7)(),d=(0,l.VK)((()=>i&&(0,L.Wd)(a,i)),[a,i]),u=(0,l.VK)((()=>i&&(0,L.rn)(a,i)),[a,i]);return r.createElement(A.Z,w()({},o,{ref:t,title:i&&n()(fe.ZP,{store:i}),icon:i&&n()(me.Z,{disabled:!0,icon:d,title:u,isEmptyPage:!1,size:19})}))}));var he=i(77420),be=i(50906);function ye(e){window.__c={n:"DeveloperIntegrationShowSecret"};const{secret:t,secretName:i,onCopy:o,actionButtons:a}=e;return n()(O.Z,{type:t?"text":"password",disabled:!0,style:{fontFamily:R.Z.getCompositeFontFamily(_.SP).mono,color:M.ZP.frontTextMedium},inputStyle:t?{cursor:"text"}:void 0,value:t||" ".repeat(40),right:n()("div",{style:{display:"flex"}},void 0,n()("div",{style:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1}}),t?n()(we,{onCopy:o,secret:t,secretName:i}):a)})}function we(e){window.__c={n:"CopySecretButton"};const{secretName:t,secret:i,onCopy:o}=e,a=(0,s.O7)(),[l,d]=r.useState(!1),u=r.useCallback((()=>{D.RD({environment:a,stringValue:i,copiedMessage:D.tq.copiedToClipboard}),o()}),[a,o,i]),g=n()(c.FormattedMessage,l?{defaultMessage:"{secretName} copied",id:"formSecretShow.secretCopied.tooltip",description:"Tooltip shown when user copied integration secret to clipboard",values:{secretName:t}}:{defaultMessage:"Copy {secretName}",id:"formSecretShow.copySecret.tooltip",description:"Shortcut for copying a token from an integration management page; 'secretName' will be either 'secret' or 'token'",values:{secretName:t}});return n()(K.Z,{placement:K.Z.Placement.Top,renderTooltip:()=>g,render:e=>r.createElement(E.Z,w()({onClick:e=>{e.preventDefault(),d(!0),setTimeout((()=>{d(!1)}),1500),u()}},e,{style:{..._e.button,color:l?M.ZP.mediumTextColor:M.ZP.blue}}),n()(c.FormattedMessage,l?{id:"formSecretShow.copied.label",defaultMessage:"Copied"}:{id:"formSecretShow.copySecret.label",defaultMessage:"Copy"}))})}const _e={button:{display:"inline-flex",alignItems:"center",fontFamily:R.Z.getCompositeFontFamily(_.SP).sans,borderRadius:3,padding:"0 6px",height:24,color:M.ZP.blue}};function Se(e){window.__c={n:"DeveloperIntegrationShowBotToken"};const{onError:t,bot:i}=e,o=(0,s.O7)(),a=i.id,[l,d]=r.useState(),u=r.useCallback((async()=>{const e=await P.getBotToken(o,{botId:a});var i;"success"===e.type?(be.Cm3(o,{table:he.cZ}),d(e.data.token)):t((null===(i=e.body)||void 0===i?void 0:i.message)??"Error fetching bot token.")}),[o,a,t]),g=r.useCallback((async()=>{const e=await P.revokeBotToken(o,{botId:a});return"success"===e.type?{success:!0}:(t((null===(i=e.body)||void 0===i?void 0:i.message)??"Error revoking bot token."),{success:!1});var i}),[o,a,t]);return n()(ye,{secret:l,secretName:n()(c.FormattedMessage,{id:"developerIntegrationForm.botToken.secretName",defaultMessage:"token"}),onCopy:()=>{be.IVn(o,{table:he.cZ,from:"developer-integrations-view"})},actionButtons:r.createElement(r.Fragment,null,n()(E.Z,{onClick:()=>{!function(e){const{onConfirm:t}=e;ae.Z.setState({isDestructive:!1,isWarning:!1,open:!0,onConfirm:t,title:n()(c.FormattedMessage,{id:"developerIntegrationForm.refreshBotToken.confirmationModal.title",defaultMessage:"Refresh token?",description:"Confirmation message asking the user if they want to refresh the bot token."}),message:n()(c.FormattedMessage,{id:"developerIntegrationForm.refreshBotToken.confirmationModal.message",defaultMessage:"Refreshing will revoke the existing token and generate a new one. Make sure you’re storing the token securely.",description:"Message telling the user about what will happen if they agree to refresh."}),confirmationMessage:n()(c.FormattedMessage,{id:"developerIntegrationForm.refreshBotToken.confirmationModal.confirm",defaultMessage:"Continue",description:"Confirmation 'continue' button when asking user if t hey want to refresh their bot token."})})}({onConfirm:async()=>{(await g()).success&&await u()}})},style:Me.button},void 0,n()(c.FormattedMessage,{id:"developerIntegrationShotBotToken.refreshSecret.label",defaultMessage:"Refresh",description:"Button in bot token input if user wants to refresh their token. Will revoke the old one and generate a new one."})),n()(E.Z,{onClick:()=>{u()},style:Me.button},void 0,n()(c.FormattedMessage,{id:"developerIntegrationShotBotToken.showSecret.label",defaultMessage:"Show",description:"Button in bot token input if user wants to view their token."})))})}const Me={button:{display:"inline-flex",alignItems:"center",fontFamily:R.Z.getCompositeFontFamily(_.SP).sans,borderRadius:3,padding:"0 6px",height:24,color:M.ZP.blue}};var ke=i(9844);function Ie(e){window.__c={n:"DeveloperIntegrationShowClientSecret"};const{onError:t,integration:i}=e,o=(0,s.O7)(),[a,d]=r.useState(),u=i.id,p=i.info.has_viewed_secret,m=(0,l.VK)((()=>v.default.state.currentUserStore),[]),f=m?(0,h.Kv)(m,{id:u,table:ke.K2}):void 0,b=r.useCallback((async()=>{if(!f)return;const e=await P.getIntegrationSecret(o,{integrationId:u});var i;"success"===e.type?(g.bO({environment:o,integrationStore:f}),be.Cm3(o,{table:ke.K2}),d(e.data.secret)):t((null===(i=e.body)||void 0===i?void 0:i.message)??"Error fetching client secret.")}),[o,f,u,t]);return n()(ye,{secret:a,secretName:n()(c.FormattedMessage,{id:"developerIntegrationForm.integrationSecret.secretName",defaultMessage:"secret"}),onCopy:()=>{be.IVn(o,{table:ke.K2,from:"developer-integrations-view"})},actionButtons:n()(Fe,{onClick:()=>{!function(e){const{hasSecretBeenViewed:t,onConfirm:i}=e,o=n()(c.FormattedMessage,t?{id:"developerIntegrationForm.clientSecret.confirmationModal.refreshTitle",defaultMessage:"Refresh OAuth client secret?",description:"Confirmation message asking the user if they want to refresh the client secret."}:{id:"developerIntegrationForm.clientSecret.confirmationModal.showTitle",defaultMessage:"Show OAuth client secret?",description:"Confirmation message asking the user if they want to see the client secret."}),a=n()(c.FormattedMessage,t?{id:"developerIntegrationForm.clientSecret.confirmationModal.alreadyViewedMessage",defaultMessage:"You’ve already viewed the client secret. Viewing again will revoke and generate a new one. Make sure you’re storing the secret securely.",description:"Message telling the user about the client secret."}:{id:"developerIntegrationForm.clientSecret.confirmationModal.displayOnceMessage",defaultMessage:"This client secret will only be displayed once and cannot be viewed again. Make sure you’re storing the secret securely.",description:"Message telling the user that the client secret will only show once."});ae.Z.setState({isDestructive:!1,isWarning:!1,open:!0,onConfirm:i,title:o,message:a,confirmationMessage:n()(c.FormattedMessage,{id:"developerIntegrationForm.clientSecret.confirmationModal.confirm",defaultMessage:"Continue"})})}({hasSecretBeenViewed:p,onConfirm:()=>{b()}})},hasSecretBeenViewed:p})})}function Fe(e){window.__c={n:"ShowSecretButton"};const{onClick:t,hasSecretBeenViewed:i}=e;return n()(E.Z,{onClick:t,style:xe.button},void 0,n()(c.FormattedMessage,i?{id:"formSecretShow.refreshSecret.label",defaultMessage:"Refresh"}:{id:"formSecretShow.showSecret.label",defaultMessage:"Show"}))}const xe={button:{display:"inline-flex",alignItems:"center",fontFamily:R.Z.getCompositeFontFamily(_.SP).sans,borderRadius:3,padding:"0 6px",height:24,color:M.ZP.blue}};var Ce=i(47478),Te=i(42402),Ze=i(46978),Re=i(5478);function Pe(e){const{integrationFormStore:t,formData:i,setFormData:o,pageSections:a,fieldDetails:s}=e,d=(0,l.VK)((()=>t.getState()),[t]),{type:u}=d,c=a.map((e=>({...e,fields:e.fields.filter((e=>{const{supportedBy:t}=m.aP[e];return t[u]}))})));return r.createElement(r.Fragment,null,c.map((e=>r.createElement(r.Fragment,null,e.fields.length>0&&n()("div",{style:{marginBottom:24}},e.key,n()(pe.e,{section:e})),e.fields.map((e=>n()(De,{formData:i,setFormData:o,formStoreState:d,formFieldDetail:s,field:e},e)))))))}function De(e){window.__c={n:"DeveloperIntegrationsFormFieldView"};const{formData:t,setFormData:i,formStoreState:o,formFieldDetail:a,field:r}=e,s=(0,l.VK)((()=>v.default.state.currentUserRootStore),[]),d=(0,l.VK)((()=>s?s.getAdminSpaceStores():[]),[s]),{type:u}=o,{label:c,subtitle:g,caption:p}=a[r]??{},m=Ve[r];return m?n()(oe,{label:c,subtitle:g,caption:p,error:t[r].error,field:r,formStateType:u},r,n()(m,{autoFocus:Boolean("create-bot"===u&&"name"===r),spaces:d,currentValue:t[r].value,setErrorValue:e=>{i({field:r,error:e})},setNewValue:e=>{i({value:e,field:r})},formStoreState:o})):null}const Ve={type:function(){return window.__c={n:"ShowIntegrationType"},n()(O.Z,{style:{color:M.ZP.frontTextLight},value:"Internal",disabled:!0})},name:Le,icon:function(e){window.__c={n:"IconUpload"};const{currentValue:t,setNewValue:i,setErrorValue:o}=e;return n()(ie,{value:t,setValue:i,setError:o})},space:function(e){window.__c={n:"SpacePicker"};const{spaces:t,currentValue:i,setNewValue:o,setErrorValue:a}=e,[s,l]=r.useState(!1);return(0,r.useEffect)((()=>{s||0!==t.length||(l(!0),a(n()(c.FormattedMessage,{id:"developerIntegrationsForm.spacePicker.missingSpacesError",defaultMessage:"You are not an owner of any workspaces. Please <linktonotion>create a new one</linktonotion> or ask your workspace owner to update your access.",values:{linktonotion:e=>n()(Te.Z,{href:(0,f.UY)("guides.joinOrCreateWorkspace")},void 0,e)}})))}),[t,a,s]),n()(q,{keyName:"space",items:t,value:i,setValue:o,renderMenuItem:e=>r.createElement(ve,e)})},token:function(e){const t=(0,s.O7)(),{currentValue:i,setErrorValue:o}=e,a=(0,l.VK)((()=>v.default.state.currentUserStore),[]),d=(0,l.VK)((()=>{if(!a||!i)return;if(i.value.parent_table!==Z.bx)return;const e=h.H2.createChildStore(a,{id:i.value.parent_id,table:i.value.parent_table});return(0,L.rn)(t,e)}),[a,i,t]);if(!i)return null;return r.createElement(r.Fragment,null,n()(Se,{bot:i.value,onError:o}),d&&n()("div",{style:{fontSize:15,color:M.ZP.frontTextLight}},void 0,n()(c.FormattedMessage,{id:"developerIntegrationForm.botToken.subtitle",defaultMessage:"Only works with the <bold>{spaceName}</bold> workspace. To change workspace, <developertermslink>create another integration</developertermslink>.",values:{spaceName:d,bold:e=>n()("b",{},void 0,e),developertermslink:e=>n()(Te.Z,{href:C._j.myIntegrations},void 0,e)}})))},client_id:function(e){window.__c={n:"ShowOAuthClientId"};const{currentValue:t}=e,i=(0,s.O7)(),[o,a]=r.useState(!1),l=Ue(o);if(!t)return null;const d=n()(c.FormattedMessage,o?{defaultMessage:"ID copied",id:"developerIntegrationsForm.clientIdCopied.tooltip"}:{defaultMessage:"Copy client ID",id:"developerIntegrationsForm.copyClientId.tooltip"});return n()(O.Z,{type:"text",disabled:!0,style:l.authInput,value:t.value.id,right:n()("div",{style:{display:"flex"}},void 0,n()("div",{style:l.authInputRight}),n()(K.Z,{placement:K.Z.Placement.Top,renderTooltip:()=>d,render:e=>r.createElement(E.Z,w()({onClick:e=>{e.preventDefault(),a(!0),setTimeout((()=>{a(!1)}),1500),D.RD({environment:i,stringValue:t.value.id,copiedMessage:D.tq.copiedLinkToClipboard})}},e,{style:l.authButton}),n()(c.FormattedMessage,o?{id:"developerIntegrationsForm.copiedId.label",defaultMessage:"Copied"}:{id:"developerIntegrationsForm.copyId.label",defaultMessage:"Copy"}))}))})},client_secret:function(e){window.__c={n:"ShowOAuthClientSecret"};const{currentValue:t,setErrorValue:i}=e;if(!t)return null;return n()(Ie,{integration:t.value,onError:i})},authorization_url:function(e){window.__c={n:"ShowAuthorizationURL"};const{currentValue:t}=e,i=(0,s.O7)(),[o,a]=r.useState(!1),l=Ue(o);if(!t)return null;const d=n()(c.FormattedMessage,o?{defaultMessage:"URL copied",id:"developerIntegrationsForm.authUrlCopied.tooltip",description:"A message that appears when a user has clicked a button to copy a URL"}:{defaultMessage:"Copy authorization URL",id:"developerIntegrationsForm.authUrlCopy.tooltip",description:"A message that tells the developer that clicking the button will copy a URL to the authorization page"});return n()(O.Z,{type:"text",disabled:!0,style:l.authInput,value:t,right:n()("div",{style:{display:"flex"}},void 0,n()("div",{style:l.authInputRight}),n()(K.Z,{placement:K.Z.Placement.Top,renderTooltip:()=>d,render:e=>r.createElement(E.Z,w()({onClick:e=>{e.preventDefault(),a(!0),setTimeout((()=>{a(!1)}),1500),D.RD({environment:i,stringValue:t,copiedMessage:D.tq.copiedLinkToClipboard})}},e,{style:l.authButton}),n()(c.FormattedMessage,o?{id:"developerIntegrationsForm.copiedAuthUrl.label",defaultMessage:"Copied",description:"After clicking this button, the URL will have been copied to the clipboard."}:{id:"developerIntegrationsForm.copyAuthUrl.label",defaultMessage:"Copy",description:"Clicking this button will copy the URL."}))}))})},capabilities:function(e){window.__c={n:"CapabilitiesTypePicker"};const{setNewValue:t,currentValue:i}=e,o={...m.fP,...i},s={no_user_capabilities:!1===o.read_user_without_email&&!1===o.read_user_with_email,read_user_without_email:!0===o.read_user_without_email&&!1===o.read_user_with_email,read_user_with_email:!0===o.read_user_with_email};return n()(N.Z,{type:N.i.Vertical,initialFocus:void 0,sections:a.compact([{key:"content_capabilities",items:["read_content","update_content","insert_content"].map((e=>Ee(e,o,t))),render:e=>r.createElement(Y.Z,w()({},e,{title:b.default.formatMessage(Be.content_capabilities_title)}))},{key:"comment_capabilities",items:["read_comment","insert_comment"].map((e=>Ee(e,o,t))),render:e=>r.createElement(Y.Z,w()({},e,{title:b.default.formatMessage(Be.comment_capabilities_title)}))},{key:"user_capabilities",items:["no_user_capabilities","read_user_without_email","read_user_with_email"].map((e=>((e,t,i,o)=>({key:e,action:()=>null,render:a=>{const s=t=>{t.preventDefault(),o({...i,read_user_without_email:"no_user_capabilities"!==e,read_user_with_email:"read_user_with_email"===e})};return r.createElement(A.Z,w()({},a,{title:b.default.formatMessage(Be[`${e}_title`]),caption:b.default.formatMessage(Be[`${e}_caption`]),icon:n()(Ze.Z,{isSelected:t}),key:e,onClick:s}))}}))(e,s[e],o,t))),render:e=>r.createElement(Y.Z,w()({},e,{title:b.default.formatMessage(Be.user_capabilities_title)}))}])})},template_url:Le,redirect_uris:function(e){return window.__c={n:"RedirectUrisInput"},r.createElement(ue,w()({},e,{style:{color:M.ZP.frontTextMedium},typeaheadTitle:n()(c.FormattedMessage,{id:"developerIntegrationsForm.redirectUri.typePrompt",defaultMessage:"Type a redirect uri…"})}))},tagline:Le,privacy_policy_url:Le,terms_of_use_url:Le,email:Le,developer_name:Le,website_url:Le,unfurl_url:Le,domain:function(e){const{currentValue:t,autoFocus:i,setNewValue:o,formStoreState:a,setErrorValue:l}=e,d=(0,s.O7)(),p=(0,c.useIntl)(),m=Ae();if("update-third-party-external-integration"!==a.type&&"update-first-party-external-integration"!==a.type)return null;const{developmentDomain:f,verifiedDomains:v,domainVerifications:h}=t||{developmentDomain:"",verifiedDomains:[],domainVerifications:[]},b=v.map((e=>({domain:e,status:Re.YF.Success,data:{type:"verified",domain:e}}))),y=Date.now(),w=h.filter(B.AS).sort(((e,t)=>e.createdAt-t.createdAt)).map((e=>({domain:e.domain,status:y>e.expiresAt?Re.YF.Failure:Re.YF.Pending,data:{...e,type:y>e.expiresAt?"invalid":"unverified"}}))),_=a.startingRecord.value.id;async function S(){const e=await P.getIntegrationDomainVerifications(d,{integrationId:_});if("success"===e.type){const t=x.PF.create(e.data.recordMap),i=F.mF.fromRecordMapWithRole(t),n=e.data.verificationIds.map((e=>i({table:T.Jd,id:e}))).filter(u.$K).map(B.Hs).filter((e=>"verified"!==e.type));o({developmentDomain:f,verifiedDomains:v,domainVerifications:n})}}if("update-third-party-external-integration"===a.type)return n()(Ce.ZP,{domains:[...b,...w],domainVerificationStore:a.domainVerificationStore,verificationType:"integration",verificationTargetId:_,refreshDomains:S,onRemoveDomain:async function(e){if("verified"!==e.type){const t=await P.deleteDomainVerificationCode(d,{id:e.id});"failed"===t.type&&l(t.error.message),await S()}else g.QO({environment:d,integrationId:_,allVerifiedDomains:v,domainToRemove:e.domain})}});return r.createElement(r.Fragment,null,n()("div",{style:m.domainInputTitle},void 0,n()(c.FormattedMessage,{id:"developerIntegrationForm.domain.developmentDomain.label",defaultMessage:"Development domain",description:"Label for the development domain input of the user's integration. The domain only used by the integration in the development workspace."})),n()(O.Z,{autoFocus:i,style:m.basicTextInput,value:f,onChange:e=>o({verifiedDomains:v,domainVerifications:h,developmentDomain:e.target.value})}),n()("div",{style:m.domainInputTitle},void 0,n()(c.FormattedMessage,{id:"developerIntegrationForm.domain.verifiedDomains.label",defaultMessage:"Verified domain(s)",description:"Label for domain verification input of the user's integration. Includes modals that will go through adding and verifying a domain and the list of verified domains."})),n()(de.Z,{placeholder:p.formatMessage({id:"domainVerificationInput.domainInput.placeholder",defaultMessage:"No domains configured",description:"Placeholder input for adding new domains."}),value:"",onChange:()=>{},onRemoveLastToken:()=>{},readOnly:!0,tokens:b.map((e=>{let{domain:t,status:i}=e;return n()(Re.ZP,{status:i,showRemoveButton:!1,isSingle:!1,format:k.l.Medium,value:t},t)}))}))},url_matching_and_placeholder:function(e){const{currentValue:t,setNewValue:i,setErrorValue:o}=e,a=Ae();return r.createElement(r.Fragment,null,null==t?void 0:t.map(((e,a)=>n()(ce,{currentRule:e,shouldShowDelete:0!==a,onUpdate:e=>{i([...t.slice(0,a),e,...t.slice(a+1)])},onDelete:()=>{0!==a&&i([...t.slice(0,a),...t.slice(a+1)])},onError:o},`regex-rule-${a}`))),n()(z.Z,{style:a.plainButton,isBlue:!0,onClick:e=>{e.preventDefault(),i([...t??[],V.VH])}},void 0,I.Z.plus(a.icon),n()(c.FormattedMessage,{id:"developerIntegrationsForm.regexPatternRulesInput.addMore.label",defaultMessage:"Add another rule",description:"A button in the 'URL matching and placeholder section. Developers can add multiple rules to match pasted URLs to their Link Preview integration."})))},external_oauth_authorize_url:Le,external_oauth_token_url:Le,external_client_id:Le,external_client_secret:function(e){window.__c={n:"HiddenTextInput"};const{autoFocus:t,currentValue:i,setNewValue:o}=e,a=Ae();return n()(O.Z,{type:"password",autoFocus:t,style:a.basicTextInput,value:i,onChange:e=>o(e.target.value)})},external_oauth_scopes:Le,external_deletion_url:Le};function Le(e){window.__c={n:"BasicTextInput"};const{autoFocus:t,currentValue:i,setNewValue:o}=e,a=Ae();return n()(O.Z,{autoFocus:t,style:a.basicTextInput,value:i,onChange:e=>o(e.target.value)})}const Be=(0,c.defineMessages)({read_comment_title:{id:"developerIntegrationForm.capabilities.read_comment.title",defaultMessage:"Read comments",description:"Label for a check box to enable an integration to read comments."},read_comment_caption:{id:"developerIntegrationForm.capabilities.read_comment.caption",defaultMessage:"Read comments on blocks and pages.",description:"Description for a check box to enable an integration to read comments."},insert_comment_title:{id:"developerIntegrationForm.capabilities.insert_comment.title",defaultMessage:"Insert comments",description:"Label for a check box to enable an integration to insert comments."},insert_comment_caption:{id:"developerIntegrationForm.capabilities.insert_comment.caption",defaultMessage:"Create comments on blocks and pages.",description:"Description for a check box to enable an integrations to insert comments."},comment_capabilities_title:{id:"developerIntegrationForm.capabilities.comment_capabilities.title",defaultMessage:"Comment Capabilities",description:"Header for a section where a developer can configure comment access for an integration."},content_capabilities_title:{id:"developerIntegrationForm.capabilities.content_capabilities.headerTitle",defaultMessage:"Content Capabilities",description:"Header for a section where a developer can configure content access for an integration."},user_capabilities_title:{id:"developerIntegrationForm.capabilities.user_capabilities.headerTitle",defaultMessage:"User Capabilities",description:"Header for a section where a developer can configure user access for an integration."},read_content_title:{id:"developerIntegrationForm.capabilities.read_content.title",defaultMessage:"Read content"},read_content_caption:{id:"developerIntegrationForm.capabilities.read_content.caption",defaultMessage:"Request to read content."},update_content_title:{id:"developerIntegrationForm.capabilities.update_content.title",defaultMessage:"Update content"},update_content_caption:{id:"developerIntegrationForm.capabilities.update_content.caption",defaultMessage:"Request to update existing content."},insert_content_title:{id:"developerIntegrationForm.capabilities.insert_content.title",defaultMessage:"Insert content"},insert_content_caption:{id:"developerIntegrationForm.capabilities.insert_content.caption",defaultMessage:"Request to create new content."},no_user_capabilities_title:{id:"developerIntegrationForm.capabilities.no_user_capabilities.title",defaultMessage:"No user information"},no_user_capabilities_caption:{id:"developerIntegrationForm.capabilities.no_user_capabilities.caption",defaultMessage:"Do not request any user information access."},read_user_without_email_title:{id:"developerIntegrationForm.capabilities.read_user_without_email.title",defaultMessage:"Read user information without email addresses"},read_user_without_email_caption:{id:"developerIntegrationForm.capabilities.read_user_without_email.caption",defaultMessage:"Request access to user information, not including email addresses."},read_user_with_email_title:{id:"developerIntegrationForm.capabilities.read_user_with_email.title",defaultMessage:"Read user information including email addresses"},read_user_with_email_caption:{id:"developerIntegrationForm.capabilities.read_user_with_email.caption",defaultMessage:"Request access to user information, including email addresses."}}),Ee=(e,t,i)=>({key:e,action:()=>null,render:o=>{const a=o=>{o.preventDefault(),i({...t,[e]:!t[e]})};return r.createElement(A.Z,w()({},o,{title:b.default.formatMessage(Be[`${e}_title`]),caption:b.default.formatMessage(Be[`${e}_caption`]),icon:n()(U.Z,{checked:Boolean(t[e]),size:16,onClick:a}),key:e,onClick:a}))}});function Ae(){return(0,S.yK)((()=>({basicTextInput:{background:M.ZP.white,height:32,fontSize:15},domainInputTitle:{marginTop:15,fontSize:15,fontWeight:R.Z.fontWeight.regular,color:M.ZP.frontTextMedium},plainButton:{display:"flex",alignItems:"center"},icon:{width:15,height:15}})),[])}function Ue(e){return(0,S.yK)((()=>({authInput:{color:M.ZP.frontTextMedium,fontFamily:R.Z.getCompositeFontFamily(_.SP).mono},authInputRight:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1},authButton:{display:"inline-flex",alignItems:"center",borderRadius:3,padding:"0 6px",height:24,color:e?M.ZP.frontTextMedium:M.ZP.blue,fontFamily:R.Z.getCompositeFontFamily(_.SP).sans}})),[e])}const Oe={key:"basic",title:b.default.formatMessage(m.sY.basicSectionTitle),fields:["type","space","name","icon"]},Ne=[Oe],ze={type:{label:b.default.formatMessage(m.sY.integrationTypeLabel),subtitle:b.default.formatMessage(m.sY.integrationTypeSubtitle)},name:{label:b.default.formatMessage(m.sY.nameLabel),subtitle:b.default.formatMessage(m.sY.nameSubtitle)},icon:{label:b.default.formatMessage(m.sY.iconLabel),subtitle:b.default.formatMessage(m.sY.iconSubtitle)},space:{label:b.default.formatMessage(m.sY.spaceLabel),subtitle:b.default.formatMessage(m.sY.spaceSubtitle)}};const Ye=[{key:"capabilities",title:b.default.formatMessage(m.sY.capabilitiesSectionTitle),fields:["capabilities"]}],Ke={capabilities:{label:b.default.formatMessage(m.sY.capabilitiesLabel),caption:n()(c.FormattedMessage,{id:"developerIntegrationForm.capabilities.caption",defaultMessage:"These requested capabilities will be displayed to users when they authorize your integration. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:e=>n()(Te.Z,{href:"https://developers.notion.com/docs/authorization"},void 0,e)}})}};var We=i(70764),He=i(24006);function $e(e){const{label:t,subtitle:i,onClick:o,isDisabled:a,isActive:s}=e,l=(0,S.yK)((e=>({label:{fontSize:15,color:e.lightTextColor,display:"flex",justifyContent:"space-between"},subtitle:{fontSize:15,color:e.lightTextColor,paddingTop:15}})),[]);return r.createElement(r.Fragment,null,n()("div",{style:l.label},void 0,t,n()(He.Z,{onClick:o,on:s,disabled:a})),n()("div",{style:l.subtitle},void 0,i))}const qe=[{key:"organization",title:b.default.formatMessage(m.sY.organizationSectionTitle),fields:["developer_name","website_url","tagline","privacy_policy_url","terms_of_use_url","email"]},{key:"oauth",title:b.default.formatMessage(m.sY.oauthSectionTitle),fields:["redirect_uris","template_url"]}];function je(e){const t=e?b.default.formatMessage(m.sY.redirectUrisBetaSubtitle):b.default.formatMessage(m.sY.redirectUrisSubtitle);return{redirect_uris:{label:b.default.formatMessage(m.sY.redirectUrisLabel),subtitle:t},website_url:{label:b.default.formatMessage(m.sY.websiteUrlLabel),subtitle:b.default.formatMessage(m.sY.websiteUrlSubtitle)},tagline:{label:b.default.formatMessage(m.sY.taglineLabel),subtitle:b.default.formatMessage(m.sY.taglineSubtitle)},privacy_policy_url:{label:b.default.formatMessage(m.sY.privacyPolicyUrlLabel),subtitle:b.default.formatMessage(m.sY.privacyPolicyUrlSubtitle)},terms_of_use_url:{label:b.default.formatMessage(m.sY.termOfUseLabel),subtitle:b.default.formatMessage(m.sY.termOfUseSubtitle)},template_url:{label:b.default.formatMessage(m.sY.templateLabel),subtitle:b.default.formatMessage(m.sY.templateSubtitle)},email:{label:b.default.formatMessage(m.sY.emailLabel),subtitle:b.default.formatMessage(m.sY.emailSubtitle)},developer_name:{label:b.default.formatMessage(m.sY.developerNameLabel),subtitle:b.default.formatMessage(m.sY.developerNameSubtitle)}}}var Je=i(97122);const Ge=(0,c.defineMessages)({confirmTitle:{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.title",defaultMessage:"Switch to Public integration?"},confirmContinue:{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.confirm",defaultMessage:"Continue"},confirmCapability:{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.title",defaultMessage:"Change requested capabilities?"},confirmCapabilityMessage:{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.message",defaultMessage:"Any existing users of your integration will be required to re-authenticate."},confirmCapabilitySubmit:{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.confirm",defaultMessage:"Change"},submitButtonCreate:{id:"formHandler.submitButton.create.label",defaultMessage:"Submit"},submitButtonUpdate:{id:"formHandler.submitButton.create.update",defaultMessage:"Save changes"},submitButtonContinue:{id:"formHandler.submitButton.continue.label",defaultMessage:"Continue",description:"Continue button when users are creating new external integration"},submitButtonSaved:{id:"formHandler.submitButton.saved.label",defaultMessage:"Saved",description:"Button text when user successfully saves form"}});function Qe(e){window.__c={n:"DeveloperIntegrationFormHandler"};const{onSubmit:t,children:i,submitType:o,currentPage:a,capabilitiesHaveChanged:r,formSaved:s}=e,l=(0,m.hs)(a,o),d=("update-guest-integration"===o||"update-third-party-external-integration"===o)&&r,u=tt({});return n()("form",{id:"developer-integration-form",style:u.formContainerStyle,onSubmit:e=>{e.preventDefault(),"create-guest-integration"===o?ae.Z.setState({open:!0,isDestructive:!1,isWarning:!1,title:b.default.formatMessage(Ge.confirmTitle),message:n()(c.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.message",defaultMessage:"You‘ll get an OAuth secret and will need to implement OAuth for authorization. See <oauthdocumentationlink>developer docs</oauthdocumentationlink> for more information.",values:{oauthdocumentationlink:e=>n()(Te.Z,{href:C._j.developerOAuthDocs},void 0,e)}}),confirmationMessage:b.default.formatMessage(Ge.confirmContinue),onConfirm:()=>{t()}}):d?ae.Z.setState({open:!0,isDestructive:!1,isWarning:!0,title:b.default.formatMessage(Ge.confirmCapability),message:b.default.formatMessage(Ge.confirmCapabilityMessage),confirmationMessage:b.default.formatMessage(Ge.confirmCapabilitySubmit),onConfirm:()=>{t()}}):t()}},void 0,i,l&&n()(Xe,{submitType:o,formSaved:s}))}function Xe(e){window.__c={n:"FormFooter"};const{submitType:t,formSaved:i}=e,o=(0,m.oX)(t),a=(0,m.w8)(t),r=!o&&i,s=tt({isCreate:o});return n()("div",{style:s.buttonContainerStyle},void 0,o&&n()("span",{style:s.buttonLabelStyle},void 0,n()(c.FormattedMessage,{id:"developerIntegrationFormHandler.create.developerTermsOnSubmit",defaultMessage:"By {action}, you agree to Notion's <developertermslink>Developer Terms</developertermslink>.",values:{developertermslink:e=>n()(Te.Z,{href:C._j.developerTerms},void 0,e),action:a?"continuing":"submitting"},description:"Subtitle that provides link to developer terms on submit"})),n()(et,{submitType:t,showSavedButton:r}))}function et(e){window.__c={n:"FormButton"};const{submitType:t,showSavedButton:i}=e,o=(0,m.oX)(t),a=(0,m.w8)(t),r=tt({showSavedButton:i}),s=a?"submitButtonContinue":"submitButtonCreate",l=i?"submitButtonSaved":"submitButtonUpdate",d=o?b.default.formatMessage(Ge[s]):b.default.formatMessage(Ge[l]);return n()(Je.h,{styles:r.buttonBackground,onClick:()=>{const e=document.querySelector("form#developer-integration-form");if(e){const t=e.ownerDocument.createElement("input");t.style.display="none",t.type="submit",e.appendChild(t).click(),e.removeChild(t)}}},void 0,d,o&&I.Z.arrowRight(r.rightArrow))}function tt(e){const{showSavedButton:t,isCreate:i}=e;return(0,S.yK)((()=>({buttonContainerStyle:{display:"flex",marginTop:24,flexDirection:i?"row":"row-reverse",alignItems:"center"},buttonLabelStyle:{fontSize:15,color:M.ZP.frontTextLight,marginRight:42},formContainerStyle:{minWidth:200,maxWidth:440,marginLeft:24,display:"flex",flexDirection:"column"},buttonBackground:{...t&&{background:M.ZP.frontBlackButtonBackgroundPressed}},rightArrow:{width:14,height:14,marginLeft:4}})),[t,i])}const it=[{key:"secrets",title:b.default.formatMessage(m.sY.secretSectionTitle),fields:["token","client_id","client_secret","authorization_url"]}],ot={token:{label:b.default.formatMessage(m.sY.tokenLabel)},client_id:{label:b.default.formatMessage(m.sY.clientIdLabel)},client_secret:{label:b.default.formatMessage(m.sY.clientSecretLabel)},authorization_url:{label:b.default.formatMessage(m.sY.authorizationUrlLabel)}};const nt={key:"external_oauth",title:b.default.formatMessage(m.sY.externalOauthSectionTitle),subtitle:n()(c.FormattedMessage,{id:"developerIntegrationFormUnfurlingView.sectionSubtitle.external_oauth",description:"Subtitle for external oauth section with link to Notion docs",defaultMessage:"See <textlink>Notion documentation</textlink> for information on <authlink>OAuth 2.0.</authlink>",values:{textlink:e=>n()(Te.Z,{href:"https://developers.notion.com/docs/build-a-link-preview-integration",external:!0},void 0,e),authlink:e=>n()(Te.Z,{href:"https://datatracker.ietf.org/doc/html/rfc6749",external:!0},void 0,e)}}),fields:["icon","external_oauth_authorize_url","external_oauth_token_url","external_client_id","external_client_secret","external_oauth_scopes","external_deletion_url"]};const at={icon:{label:b.default.formatMessage(m.sY.iconLabel),subtitle:b.default.formatMessage(m.sY.iconSubtitle)},unfurl_url:{label:b.default.formatMessage(m.sY.unfurlUrlLabel),caption:b.default.formatMessage(m.sY.unfurlUrlCaption)},domain:{label:b.default.formatMessage(m.sY.domainLabel),caption:n()(c.FormattedMessage,{id:"developerIntegrationForm.domainVerification.caption",defaultMessage:"Development and verified domains for URLs to unfurl with this integration. Domains must be verified before publishing to users. See the <textlink>Notion documentation</textlink> for more verification process.",description:"Description of the domain field for integrations and the domain verification process.",values:{textlink:e=>n()(Te.Z,{href:"https://developers.notion.com/docs/building-a-link-preview#domain-verification",external:!0},void 0,e)}})},url_matching_and_placeholder:{label:b.default.formatMessage(m.sY.urlMatchingAndPlaceholderLabel),caption:b.default.formatMessage(m.sY.urlMatchingAndPlaceholderCaption)},external_oauth_authorize_url:{label:b.default.formatMessage(m.sY.externalOauthAuthorizeUrlLabel),caption:b.default.formatMessage(m.sY.externalOauthAuthorizeUrlCaption)},external_oauth_token_url:{label:b.default.formatMessage(m.sY.externalOauthTokenUrlLabel),caption:b.default.formatMessage(m.sY.externalOauthTokenUrlCaption)},external_oauth_scopes:{label:b.default.formatMessage(m.sY.externalOauthScopesLabel),caption:b.default.formatMessage(m.sY.externalOauthScopesCaption)},external_client_id:{label:b.default.formatMessage(m.sY.externalClientIdLabel)},external_client_secret:{label:b.default.formatMessage(m.sY.externalClientSecretLabel)},external_deletion_url:{label:b.default.formatMessage(m.sY.externalDeletionUrlLabel),caption:b.default.formatMessage(m.sY.externalDeletionUrlCaption)}};function rt(e){var t;window.__c={n:"DeveloperIntegrationForm"};const{integrationFormStore:i,onCreateNew:o,currentPage:b,setSelectedPage:y,spaceName:w}=e,_=(0,s.O7)(),[S,M]=r.useState(!1),k=(0,l.VK)((()=>v.default.state.currentUserRootStore),[]),I=(0,l.VK)((()=>i.getState()),[i]),{type:F}=I,[x,C]=r.useReducer(m.x6,m.yb);(0,r.useEffect)((()=>{if(!k)return;(async()=>{const e=await(0,m.hl)({formStoreState:I,userRootStore:k,environment:_});for(const t of(0,u.Yd)(e))C({field:t,value:e[t]})})()}),[I,k,_,b]),(0,r.useEffect)((()=>{const e=()=>{M(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",e),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",e)}}));const T=a.debounce((async()=>{M(!0);const e=(0,m.m0)({formData:x,setFormData:C,formStateType:F,currentFieldNames:lt(b)});let t;if(x.template_url.value){const e=(0,f.K2)(x.template_url.value);k&&e&&(t=h.G.createChildStore(k,{table:d.iU,id:e}),await t.load())}const i=(0,m.Z6)({formData:x,setFormData:C,formStateType:F,templateStore:t,currentFieldNames:lt(b)});if(e.length>0||i.length>0||(0,m.tm)({formData:x,formStateType:F,currentFieldNames:lt(b)})||!k)return void M(!1);const a=g.JJ({environment:_,formState:I,formData:(0,m.Xr)(x)});if(!a)return p.showErrorMessage(n()(c.FormattedMessage,{id:"developerIntegrationsForm.error.submission",defaultMessage:"There was an error submitting your integration. Please try again or contact support if the issue persists."})),void M(!1);o&&o(a),(0,m.w8)(F)||(0,m.oX)(F)&&y&&y("secrets")}),300),Z=function(e,t){if(!t||!e)return!1;return(0,u.qP)(t).some((t=>{let[i,o]=t;return Boolean(e[i])!==o}))}(null===(t=I.startingRecord)||void 0===t?void 0:t.value.capabilities,x.capabilities.value),R=st[b];return n()(Qe,{submitType:F,onSubmit:T,capabilitiesHaveChanged:Z,currentPage:b,formSaved:S},void 0,n()(R,{integrationFormStore:i,formData:x,setFormData:C,spaceName:w}))}const st={distribution:function(e){const{integrationFormStore:t}=e,i=(0,l.VK)((()=>t.getState().type),[t]),o=(0,l.VK)((()=>(0,We.QS)()),[]),a=["update-guest-integration","update-third-party-external-integration","update-first-party-external-integration","create-third-party-external-integration"].includes(i),s="update-bot"!==i,[d,u]=(0,r.useState)(s);return r.createElement(r.Fragment,null,n()($e,{onClick:()=>{const e=d?"internal":"public";u(!d),t.updateRecordTypeOnSwitch(e)},label:b.default.formatMessage(m.sY.distributionSwitcherLabel),subtitle:n()(c.FormattedMessage,{id:"developerIntegrationFormDistributionView.switcher.subtitle",defaultMessage:"A public integration is available to any Notion user. <br>After submission, only the creator will be able to manage this integration. To transfer ownership of this integration to another user, please contact Notion support.</br> <br>If you're interested in sharing your integration to Notion’s <galleryLink>connection gallery</galleryLink>, reach out to our team <textLink>here.</textLink> </br>",description:"Developer form section switcher subtitle on distribution page",values:{galleryLink:e=>n()(Te.Z,{href:"https://www.notion.so/integrations/all",external:!0},void 0,e),textLink:e=>n()(Te.Z,{href:"https://notionup.typeform.com/to/kViev734?typeform-source=www.notion.so",external:!0},void 0,e),br:e=>n()("div",{style:{marginTop:15}},void 0,e)}}),isActive:d,isDisabled:a}),d&&r.createElement(Pe,w()({},e,{pageSections:qe,fieldDetails:je(o)})))},linkPreview:function(e){const{integrationFormStore:t}=e,i=(0,l.VK)((()=>t.getState().type),[t]),o=(0,l.VK)((()=>{var e;return null===(e=t.getState().startingRecord)||void 0===e?void 0:e.value.id}),[t]),a="update-third-party-external-integration"===i||"update-first-party-external-integration"===i,s="create-third-party-external-integration"===i||"update-third-party-external-integration"===i||"update-first-party-external-integration"===i,[d,u]=(0,r.useState)(s),p="create-third-party-external-integration"===i?[nt]:[nt,(f=o,{key:"unfurling",title:b.default.formatMessage(m.sY.unfurlingSectionTitle),subtitle:n()(c.FormattedMessage,{id:"developerIntegrationForm.sectionCaption.unfurling",defaultMessage:"Visit the <previewlab>Link Preview Lab</previewlab> to plan out unfurling previews and responses.",values:{previewlab:e=>{if(!f)return"";const t=g.Pk({table:ke.K2,id:f});return n()(Te.Z,{href:t,external:!0},void 0,e)}}}),fields:["unfurl_url","domain","url_matching_and_placeholder"]})];var f;return r.createElement(r.Fragment,null,n()($e,{onClick:()=>{const e=d?"public":"unfurling";u(!d),t.updateRecordTypeOnSwitch(e)},label:b.default.formatMessage(m.sY.unfurlingSwitcherLabel),subtitle:n()(c.FormattedMessage,{id:"developerIntegrationFormUnfurlingView.switcher.subtitle",defaultMessage:"Unfurl external data inside Notion. Requires additional fields to configure the matching URL pattern and interface. <br> To be publicly distributed, <formLink>fill out this form</formLink> to submit your integration for security review. </br>",description:"Developer form section switcher subtitle on unfurling page",values:{br:e=>n()("div",{style:{marginTop:15}},void 0,e),formLink:e=>n()(Te.Z,{href:"https://docs.google.com/forms/d/e/1FAIpQLSd94UcRziV-1yFv6udO0qZwohLyXxhYYadUqEJyyEd03RAj1w/viewform",external:!0},void 0,e)}}),isActive:d,isDisabled:a}),d&&r.createElement(Pe,w()({},e,{pageSections:p,fieldDetails:at})))},secrets:function(e){return window.__c={n:"DeveloperIntegrationFormSecretsView"},r.createElement(Pe,w()({},e,{pageSections:it,fieldDetails:ot}))},capabilities:function(e){return window.__c={n:"DeveloperIntegrationFormCapabilitiesView"},r.createElement(Pe,w()({},e,{pageSections:Ye,fieldDetails:Ke}))},basic:function(e){window.__c={n:"DeveloperIntegrationsFormBasicView"};const{integrationFormStore:t,formData:i,setFormData:o,spaceName:a}=e,r=a?n()(c.FormattedMessage,{id:"developerIntegrationView.subtitle.internalIntegrationLabel",defaultMessage:"Workspace owners for <bold>{spaceName}</bold> can manage this integration",description:"Subtitle for the basic page of the internal integration form. {spaceName} is the name of the Notion workspace.",values:{spaceName:a,bold:e=>n()("b",{},void 0,e)}}):void 0;return n()(Pe,{integrationFormStore:t,formData:i,setFormData:o,pageSections:[{...Oe,subtitle:r}],fieldDetails:ze})}};function lt(e){switch(e){case"basic":return(0,m.Qo)(Ne);case"secrets":return(0,m.Qo)(it);case"capabilities":return(0,m.Qo)(Ye);case"distribution":return(0,m.Qo)(qe);case"linkPreview":return["icon","external_oauth_authorize_url","external_oauth_token_url","external_client_id","external_client_secret","external_oauth_scopes","external_deletion_url","unfurl_url","domain","url_matching_and_placeholder"];default:return[]}}},87886:(e,t,i)=>{i.r(t),i.d(t,{LinkPreviewLab:()=>ie,default:()=>te});var o=i(97464),n=i.n(o),a=i(77094),r=i.n(a),s=i(67294),l=i(480),d=i(81954),u=i(24405),c=i(63123),g=i(3779),p=i(74181),m=i(89602),f=i(70203),v=i(97880),h=i(82990),b=i(44876),y=i(36054),w=i(5366),_=i(8981),S=i(43250),M=i(91996),k=i(65270),I=i(60709),F=i(27832),x=i(61766),C=i(30874),T=i(3403),Z=i(64921),R=i(52275),P=i(31945),D=i(74194),V=i(78140),L=i(9342),B=i(63296),E=i(72495),A=i(29823),U=i(97812),O=i(76745),N=i(67206),z=i(17970),Y=i(34958),K=i(14577),W=i(20475),H=i(8848),$=i(77744),q=(i(73063),i(58032)),j=i(64369);i(29551);function J(e){window.__c={n:"Artboard"};const[t,i]=(0,s.useState)(!1);return r()("div",{onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)}},void 0,r()(G,{isInverted:e.isInverted},void 0,r()(Q,{showSize:e.showSize??t,showInsets:e.showInsets??t,insetSize:24},void 0,r()(ee,{isInverted:e.isInverted},void 0,e.children))))}function G(e){window.__c={n:"ArtboardBorder"};const t=(0,u.Fg)(),i=X(),o=e.isInverted?i:t,n=(0,s.useMemo)((()=>({borderRadius:3,overflow:"hidden",border:`1px solid ${o.regularDividerColor}`,backgroundColor:o.contentBackground,marginTop:12,marginBottom:12,color:o.regularTextColor})),[o]);return r()("div",{style:n},void 0,e.children)}function Q(e){window.__c={n:"ArtboardInsets"};const{showInsets:t,showSize:i,insetSize:o,children:n}=e,a=(0,s.useRef)(null),l=(0,u.yK)((e=>{const i=t?"rgba(255, 105, 180, 1)":"rgba(255, 105, 180, 0)",n=`1px dashed ${i}`,a=`${o}px`,r="all 0.1s ease-in-out",s={t:{borderBottom:n,transition:r},l:{borderRight:n,transition:r},r:{borderLeft:n,transition:r},b:{borderTop:n,transition:r,position:"relative"}};return{grid:{display:"grid",gridTemplateColumns:`${a} auto ${a}`,gridTemplateRows:`${a} auto ${a}`,...s.t,...s.l,...s.r,...s.b},...s,tl:{...s.t,...s.l},tr:{...s.t,...s.r},bl:{...s.b,...s.l},br:{...s.b,...s.r},c:{position:"relative"},insetText:{color:i,fontSize:10,paddingLeft:(o-10)/2,fontFamily:h.Z.baseFontFamily.githubMono,lineHeight:a,maxHeight:o,transition:r,position:"absolute"}}}),[t,o]);return r()("div",{style:l.grid},void 0,r()("div",{style:l.tl}),r()("div",{style:l.t}),r()("div",{style:l.tr}),r()("div",{style:l.l}),s.createElement("div",{style:l.c,ref:a},n),r()(q.Z,{forceVisibleState:i??t,renderTooltip:()=>{var e;return`${null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect().height}px`},placement:q.Z.Placement.Right,render:()=>r()("div",{style:l.r})}),r()("div",{style:l.bl}),r()(q.Z,{placement:q.Z.Placement.Bottom,forceVisibleState:i??t,renderTooltip:()=>{var e;return`${null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect().width}px`},render:()=>r()("div",{style:l.b},void 0,r()(j.Z,{style:l.insetText},void 0,`${o}px inset`))}),r()("div",{style:l.br}))}function X(){const{mode:e}=(0,u.Fg)();return(0,H.gh)({theme:"light"===e?"dark":"light"})}function ee(e){let{children:t,isInverted:i}=e;window.__c={n:"InverseThemeProvider"};const{mode:o}=X(),n=function(e){const t=(0,l.O7)();return(0,s.useMemo)((()=>{const i=new W.Z;return i.setState({mode:e}),{...t,ThemeStore:i,ThemeModeStore:new K.Z((()=>i.state.mode),{debugName:"UIDocComponents.ThemeModeStore"})}}),[t,e])}(o);return i?r()(Y.EnvironmentContextProvider,{value:n},void 0,t):(0,$.jD)(t)}function te(e){window.__c={n:"DeveloperIntegrationLab"};const t=(0,l.O7)(),{integrationPointer:i}=e,o=(0,d.VK)((()=>F.default.state.currentUserStore),[]),n=(0,d.VK)((()=>{if(o)return o.getRecordValue(i)}),[o,i]),a=(0,c.V)({value:n,waitTimeInMs:5e3});return"pending"===a.status?r()(T.Z,{}):"rejected"!==a.status&&(0,p.VM)(a.value)?r()(U.Z,{className:S.hEP,title:r()(w.FormattedMessage,{id:"developerIntegrationLab.title.label",defaultMessage:"Link Preview Lab"}),subtitle:r()(w.FormattedMessage,{id:"developerIntegrationLab.subtitle.label",defaultMessage:"Plan out preview URL regex patterns and API responses."}),onNavigateBack:()=>_.V2(t,i),navigateBackMessage:r()(w.FormattedMessage,{id:"developerIntegrationLab.navigateBack.label",defaultMessage:"Back to integration"}),innerContainerStyles:{width:1200,margin:"auto",marginBottom:200}},void 0,r()(ie,{starterIntegration:a.value})):r()(A.Z,{})}function ie(e){let{starterIntegration:t}=e;window.__c={n:"LinkPreviewLab"};const[i,o]=s.useState(""),[n,a]=s.useState(k.Az),[l,d]=s.useState(k.SV),[u,c]=s.useState(k.VR()),[g,p]=s.useState(k.nZ),[m,f]=s.useState(k.e_),[v,h]=s.useState(k.P4),[y,w]=s.useState(t);return s.useEffect((()=>{const{original_url_domains:e,development_url_domains:i,original_url_patterns:o}=t.info,n=(null==e?void 0:e[0])||(null==i?void 0:i[0]);if(n&&p(n),null!=o&&o[0]){const{regex:e,attributes:t,sample_urls:i}=null==o?void 0:o[0];f(e);const n=t.map(b.Ah);h(n);const r=null==i?void 0:i[0];r&&a(r)}}),[t]),s.useEffect((()=>{w((e=>k.Hx({domain:g,regex:m,attributes:v,currentIntegration:e})))}),[g,m,v]),s.useEffect((()=>{C.Z.setState({loaded:!0,loading:!1,userId:void 0,spaceId:k.C,integrations:[y],externalAuthentications:[],bots:[],completeSlackAuthentications:[],webhookSubscriptions:[]})}),[y]),r()("div",{style:{display:"flex",justifyContent:"space-between"}},void 0,r()(oe,{style:{flex:1,marginRight:12},setErrorMessage:o,rootUrl:n,setRootUrl:a,relatedUrisToAttributes:u,setRelatedUrisToAttributes:c,domain:g,setDomain:p,regexPattern:m,setRegexPattern:f,regexAttributes:v,setRegexAttributes:h,rootAttributes:l,setRootAttributes:d}),r()(re,{style:{flex:1},rootUrl:n,rootAttributes:l,relatedUrisToAttributes:u,integration:y,errorMessage:i}))}function oe(e){window.__c={n:"ConfigurationInput"};const{style:t,rootUrl:i,setRootUrl:o,domain:n,setDomain:a,regexPattern:s,setRegexPattern:l,regexAttributes:u,setRegexAttributes:c,rootAttributes:g,setRootAttributes:p,relatedUrisToAttributes:f,setRelatedUrisToAttributes:v,setErrorMessage:b}=e,y=(0,d.VK)((()=>k.TG(g)),[g]);return r()("div",{style:t},void 0,r()("label",{},void 0,r()("div",{style:{fontSize:15,fontWeight:h.Z.fontWeight.medium}},void 0,r()(w.FormattedMessage,{id:"developerIntegrationLab.rootUrl.label",defaultMessage:"Pasted URL to Preview",description:"A url that the developers can test their integrations against as if a user attempted to unfurl it themselves."})),r()(D.Z,{value:i,onChange:e=>o(e.target.value)})),r()(se,{title:r()(w.FormattedMessage,{id:"developerIntegrationLab.regexConfiguration.label",defaultMessage:"Manage Regex Configuration",description:"Allows developers to test out regular expressions to match pasted unfurled urls."}),style:{marginTop:12}},void 0,r()("label",{style:{marginTop:12}},void 0,r()("div",{style:{fontSize:15,fontWeight:h.Z.fontWeight.medium}},void 0,r()(w.FormattedMessage,{id:"developerIntegrationLab.domain.label",defaultMessage:"Domain",description:"The domain of their integration (e.g. 'notion.so')."})),r()(D.Z,{value:n,onChange:e=>a(e.target.value)})),r()(de,{regexPattern:s,setRegexPattern:l,setErrorMessage:b}),r()("label",{style:{marginTop:12}},void 0,r()("div",{style:{fontSize:15,fontWeight:h.Z.fontWeight.medium}},void 0,r()(w.FormattedMessage,{id:"developerIntegrationLab.regexAttributes.label",defaultMessage:"Regex Attributes",description:"The matched attributes within their configuredregex patterns."})),r()(le,{value:u,onChange:c,validationType:m.$1,setErrorMessage:b}))),r()(se,{title:r()(w.FormattedMessage,{id:"developerIntegrationLab.rootAttributes.label",defaultMessage:"Unfurl response payload",description:"Allows developers to test their unfurl responses against our validator and visualizer."}),style:{marginTop:12}},void 0,r()(le,{value:g,onChange:p,validationType:m.$1,setErrorMessage:b})),r()(se,{title:r()(w.FormattedMessage,{id:"developerIntegrationLab.relatedAttributes.label",defaultMessage:"Related unfurl response payloads",description:"Allows developers to test additional unfurl responses against our validator and visualizer."}),style:{marginTop:12}},void 0,y.map((e=>{const t=f[e];return r()(se,{title:e,style:{marginTop:12,marginLeft:12}},e,t?r()(le,{value:t,onChange:t=>{v({...f,[e]:t})},validationType:m.$1,setErrorMessage:b}):r()(w.FormattedMessage,{id:"developerIntegrationLab.relatedAttributes.empty",defaultMessage:"No related attributes found."}))}))))}const ne=["preview","mention","hover"],ae=["authenticate","error","update","loaded"];function re(e){window.__c={n:"ConfigurationOutput"};const{style:t,rootUrl:i,rootAttributes:o,relatedUrisToAttributes:n,integration:a,errorMessage:l}=e,[d,u]=s.useState("preview"),[c,g]=s.useState("loaded");return r()("div",{style:t},void 0,r()("div",{style:{display:"flex",alignItems:"center"}},void 0,r()("div",{style:{marginRight:12}},void 0,"Preview type:"),r()(ue,{title:d,options:ne,onSelectOption:e=>u(e)}),r()("div",{style:{marginLeft:12,marginRight:12}},void 0,"Preview state:"),r()(ue,{title:c,options:ae,onSelectOption:e=>g(e)})),r()("div",{style:{marginTop:12,maxWidth:600}},void 0,r()(ce,{previewType:d,previewState:c,rootUrl:i,rootAttributes:o,relatedUrisToAttributes:n,integration:a,errorMessage:l})))}function se(e){window.__c={n:"Toggle"};const[t,i]=s.useState(!1);return r()("div",{style:e.style},void 0,r()(Z.Z,{onClick:()=>i(!t),style:{display:"flex",alignItems:"center"}},void 0,g.Z.triangle({width:"0.6875em",height:"0.6875em",transition:"transform 200ms ease-out",transform:`rotateZ(${t?180:90}deg)`,marginRight:4}),e.title),t&&e.children)}function le(e){window.__c={n:"JSONEditor"};const{value:t,onChange:i,validationType:o,setErrorMessage:n}=e,[a,l]=s.useState(JSON.stringify(t,null,2));return r()(D.Z,{format:D.B.ExtraLarge,inputStyle:{fontSize:14,lineHeight:"18px",height:500},textarea:!0,value:a,onChange:e=>{const t=e.target.value;l(t);const a=M.Jv(t);if(void 0===a)n("Could not parse JSON object input.");else{const e=(0,y.Gu)(o,a);e?n(e.message):(n(""),i(a))}}})}function de(e){window.__c={n:"RegexInput"};const{regexPattern:t,setRegexPattern:i,setErrorMessage:o}=e,[n,a]=s.useState(t);return r()("label",{style:{marginTop:12}},void 0,r()("div",{style:{fontSize:15,fontWeight:h.Z.fontWeight.medium}},void 0,"Regex Pattern"),r()(D.Z,{value:n,onChange:e=>{const t=e.target.value;a(t);try{new RegExp(t);i(t),o("")}catch(n){o("Invalid Regex.")}}}))}function ue(e){window.__c={n:"PreviewDropdownButton"};const{title:t,options:i,onSelectOption:o}=e,[a,l,u]=(0,d.AF)(void 0,x.Z);return r()(P.ZP,{popupType:P.Z4.Popup,buttonPopupStore:u,renderOrigin:()=>r()(B.Z,{onClick:()=>l({...a,open:!0})},void 0,t,g.Z.chevronDown({width:10,marginTop:4,marginLeft:4})),render:()=>r()(V.Z,{menuType:I.og.Popup},void 0,r()(L.Z,{type:L.i.Vertical,sections:[{key:t,items:i.map((e=>({key:e,action:()=>{o(e),l({...a,open:!1})},render:t=>s.createElement(R.Z,n()({},t,{title:e}))}))),render:e=>s.createElement(E.Z,e)}],initialFocus:void 0}))})}function ce(e){const{previewType:t,previewState:i,rootUrl:o,rootAttributes:n,relatedUrisToAttributes:a,integration:d,errorMessage:c}=e,[g,p]=s.useState(""),m=(0,l.O7)(),[f,v]=s.useState();s.useEffect((()=>{const e=k.rn({environment:m,rootUrl:o,rootAttributes:n,relatedUrisToAttributes:a,integration:d});"error"in e?p(e.error):(p(""),v(e))}),[m,o,n,a,d]),s.useEffect((()=>{p(c)}),[c]);const h=(0,u.yK)((e=>({error:{marginTop:12,marginBottom:12,padding:"12px 24px",marginRight:"auto",backgroundColor:e.accentColors.red[100]}})),[]);return s.createElement(s.Fragment,null,g&&r()("div",{style:h.error},void 0,g," "),f&&s.createElement(s.Fragment,null,r()(J,{isInverted:!1,showInsets:!1,showSize:!1},void 0,r()(pe,{previewType:t,previewState:i,previewStores:f})),r()(J,{isInverted:!0,showInsets:!1,showSize:!1},void 0,r()(pe,{previewType:t,previewState:i,previewStores:f}))))}function ge(e){window.__c={n:"RenderedHoverPreview"};const{previewStores:t}=e,i=(0,u.yK)((e=>({container:{borderRadius:4,boxShadow:e.lightBoxShadow}})),[]),o=(0,d.VK)((()=>{const e=t.previewBlockStore.id;if(!e)return;return{annotation:(0,f.x3)(e),store:t.inlineBlockStore,token:void 0}}),[t.previewBlockStore,t.inlineBlockStore]);return o?r()("div",{style:i.container},void 0,r()(N.D,{isHoveredTokenEditable:!0,state:o})):null}function pe(e){const{previewType:t,previewState:i,previewStores:o}=e;return"preview"===t?r()(O.Z,{store:"authenticate"===i?o.emptyInstanceBlockStore:o.previewBlockStore,disabled:!1,forceActionForUIDoc:"loaded"===i?void 0:i}):"mention"===t?r()(z.Z,{store:"authenticate"===i?o.emptyInlineBlockStore:o.inlineBlockStore,disabled:!1}):"hover"===t?s.createElement(ge,e):void(0,v.t1)(t)}},29823:(e,t,i)=>{i.d(t,{Z:()=>c});var o=i(77094),n=i.n(o),a=(i(67294),i(480)),r=i(3779),s=i(5366),l=i(8981),d=i(43250),u=i(97812);function c(){window.__c={n:"DeveloperIntegrationNotFound"};const e=(0,a.O7)();return n()(u.Z,{className:d.wG0,title:n()(s.FormattedMessage,{id:"developerIntegrationNotFound.title.label",defaultMessage:"Not Found"}),subtitle:n()(s.FormattedMessage,{id:"developerIntegrationNotFound.subtitle.label",defaultMessage:"This integration doesn’t exist."}),onNavigateBack:()=>l.A1(e),icon:r.Z.eyes({width:98,height:98}),sideContent:null},void 0,null)}},12265:(e,t,i)=>{i.r(t),i.d(t,{default:()=>A});var o=i(77094),n=i.n(o),a=i(67294),r=i(480),s=i(81954),l=i(63123),d=i(15070),u=i(59054),c=i(39248),g=i(77420),p=i(44312),m=i(49953),f=i(9844),v=i(90468),h=i(70043),b=i(97880),y=i(5366),w=i(50906),_=i(54642),S=i(8981),M=i(43250),k=i(70764),I=i(12982),F=i(38755),x=i(27832),C=i(22230),T=i(85057),Z=i(3403),R=i(91754),P=i(31278),D=i(79500),V=i(43113),L=i(29823),B=i(97812),E=i(42402);function A(e){window.__c={n:"DeveloperIntegrationView"};const{botOrIntegrationPointer:t}=e,i=(0,r.O7)(),o=(0,s.VK)((()=>x.default.state.currentUserRootStore),[]),A=(0,s.qz)(void 0,C.Z),U=(0,s.VK)((()=>A.getState().type),[A]),O=(0,s.VK)((()=>A.getState().startingRecord),[A]),N=(0,s.VK)((()=>A.getState().status),[A]),z=(0,s.VK)((()=>{const e=(0,k.QS)();return(0,I.H)(U,e)}),[U]),[Y,K]=(0,a.useState)("secrets"),W="published"===N&&"secrets"!==Y,H=(0,s.VK)((()=>{if(t&&o){const e=t.table,i=o.getRecordValue(t);if(i){const n=e===f.K2&&(0,d.Be)(i.capabilities)&&o.getRecordValue({table:m.r9,id:t.id});return{botOrIntegrationRecord:{value:i,table:t.table},maybeExternalAuthRecord:n?{table:m.r9,value:n}:void 0}}}}),[o,t]),[{value:$}]=(0,u.r5)((async()=>{if(!o||!H||H.botOrIntegrationRecord.table!==f.K2)return[];const e=H.botOrIntegrationRecord.value.id,t=await _.getIntegrationDomainVerifications(i,{integrationId:e});if("success"===t.type){return t.data.verificationIds.map((e=>o.getRecordValue({table:p.Jd,id:e}))).filter(b.$K)}if("failed"===t.type)throw t.error;return(0,b.t1)(t)}),[i,H,o]);(0,a.useEffect)((()=>{if(!H)return;const{botOrIntegrationRecord:e,maybeExternalAuthRecord:t}=H;A.initializeNewForm(e,t,$||[]),w.DUp(i,{table:e.table})}),[A,i,H,$]);const q=(0,s.VK)((()=>{if(!o||!H)return;const{botOrIntegrationRecord:e}=H;if(e.value.parent_table!==v.bx)return;const t=T.H2.createChildStore(o,{id:e.value.parent_id,table:e.value.parent_table});return(0,F.rn)(i,t)}),[H,o,i]),j=(0,l.V)({value:O});if("rejected"===j.status||!t)return n()(L.Z,{});if("pending"===j.status)return n()(Z.Z,{});const J=j.value,G=J.value.name,Q=J.table===g.cZ?J.value.icon:J.value.info.icon,X={id:J.value.id,table:J.table},ee=Q?{pointer:X,icon:Q}:void 0;return n()(B.Z,{className:M.TFu,title:G,subtitle:n()(y.FormattedMessage,{id:"developerIntegrationView.subtitle.genericLabel",defaultMessage:"Review and edit integration information.",description:"Subtitle for the developer integration view."}),onNavigateBack:()=>S.A1(i),icon:n()(P.Z,{disabled:!0,icon:ee,title:G,isEmptyPage:!1,size:98,isLarge:!0,style:{boxShadow:h.Z.frontDeepShadow},useInvertedColors:!0}),sideContent:n()(D.T,{supportedPages:z,selectedPage:Y,setSelectedPage:K,integrationFormStore:A})},void 0,W&&n()(R.Z,{type:R.$.Red,isMobile:!1,style:{marginBottom:20}},void 0,n()(y.FormattedMessage,{id:"developerIntegrationView.publishedIntegrationWarning.label",defaultMessage:"Saving changes to your integration will immediately update its listing on Notion's <integrationgallerylink>Integration Gallery.</integrationgallerylink> ",description:"A warning that appears to developers when they're editing an integration that has already been published in our Integration Gallery.",values:{integrationgallerylink:e=>n()(E.Z,{disableHover:!0,href:(0,c.E)(J.value.id,J.value.name||"")},void 0,e)}})),n()(V.Z,{integrationFormStore:A,currentPage:Y,setSelectedPage:K,spaceName:q}))}},22230:(e,t,i)=>{i.d(t,{Z:()=>g});var o=i(49085),n=i(74181),a=i(77420),r=i(9844),s=i(5500),l=i(97880),d=i(95477),u=i(52507);class c extends o.default{getInitialState(){return{type:"create-bot",startingRecord:void 0,recordTypeOnSubmission:"internal",status:"unpublished"}}updateRecordTypeOnSwitch(e){if("update-bot"===this.state.type){if("public"!==e)return;this.setState({type:"create-guest-integration",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"})}else if("create-guest-integration"===this.state.type){if("internal"!==e)return;this.setState({type:"update-bot",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"})}else if("update-guest-integration"===this.state.type){if("unfurling"!==e)return;this.setState({type:"create-third-party-external-integration",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,startingAuthRecord:void 0,status:"unpublished"})}else if("create-third-party-external-integration"===this.state.type){if("public"!==e)return;this.setState({type:"update-guest-integration",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"})}else"create-bot"===this.state.type||"update-third-party-external-integration"===this.state.type||"update-first-party-external-integration"===this.state.type||(0,l.t1)(this.state)}initializeNewForm(e,t,i){if(e.table===a.cZ)this.setState({type:"update-bot",startingRecord:e,recordTypeOnSubmission:"internal",status:"unpublished"});else if(e.table===r.K2)if((0,n.VM)(e.value))if((0,s.BP)({integrationId:e.value.id,env:d.Z.env}))this.setState({type:"update-first-party-external-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"unfurling",status:e.value.status});else{if(!t)return;const o=i.map((e=>({type:e.verified_at?"verified":"unverified",id:e.id,domain:e.domain,verificationCode:e.verification_code,createdAt:e.created_at,expiresAt:e.expires_at,alive:e.alive})));this.setState({type:"update-third-party-external-integration",startingRecord:{table:e.table,value:e.value},startingAuthRecord:t,recordTypeOnSubmission:"unfurling",status:e.value.status,domainVerifications:o,domainVerificationStore:"update-third-party-external-integration"===this.state.type?this.state.domainVerificationStore:new u.ZP})}else"guest"===e.value.type&&this.setState({type:"update-guest-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"public",status:e.value.status});else(0,l.t1)(e)}}const g=c}}]);