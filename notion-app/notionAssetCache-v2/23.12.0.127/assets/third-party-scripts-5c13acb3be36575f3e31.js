"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9765],{78910:(e,s,i)=>{i.r(s),i.d(s,{InjectThirdPartyScripts:()=>A,useThirdPartyScripts:()=>M});var a=i(96486),t=i.n(a),n=i(67294),r=i(13991),o=i(480),d=i(81954),c=i(29450),u=i(66673),l=i(65454),p=i(4615);const g="a2a8e2144b2bbbb4074a",m="901895b8-45c7-40c8-ba91-626cfc6739b3";function f(){var e,s,i;if(!window._cio)for(window._cio=[],e=function(e){return function(){window._cio.push([e].concat(Array.prototype.slice.call(arguments,0)))}},s=["load","identify","sidentify","track","page","on","off","reset"],i=0;i<s.length;i++)window._cio[s[i]]=e(s[i])}var S=i(7250),y=i(62291),w=i(49902),b=i(50906),I=i(5978),_=i(95477),E=i(15010),v=i(58455),h=i(27832),k=i(61893),Z=i(74055),V=i(10161),D=i(3418),K=i(69454),C=i(7339);function M(){const e=(0,o.O7)(),s=(0,o.Fy)(),{currentUser:i}=e,{isEnabled:a,spaceId:M,userEmail:A,userDaysSinceSignup:P,userDomainType:L,isSpaceAdmin:R}=(0,d.VK)((()=>{const e=v.default.state.isSprigEnabled&&k.Z.state.permission.performance&&V.default.checkGate("sprig")&&s.isDesktop,{currentUserSettingsStore:i,currentSpaceStore:a,currentUserStore:t}=h.default.state,n=null==a?void 0:a.id,r=null==t?void 0:t.getEmail(),o=i?(0,E.e2)(i):null,d=Boolean(null==a?void 0:a.canAdmin());return{isEnabled:e,spaceId:n,userEmail:r,userDaysSinceSignup:o,userDomainType:(0,E.JF)(),isSpaceAdmin:d}}),[s]),T=(0,d.VK)((()=>C.C.state.ready),[]);!function(e){let{isEnabled:s,isLoggedIn:i,userId:a,onMessageOpened:t,onMessageDismissed:r,onMessageError:o,onMessageAction:d}=e;(0,n.useEffect)((()=>{s&&(0,c.hasPermissionForThirdPartyServiceBrowser)("customer_io")&&("cio-tracker"in window||(f(),(0,l.ZP)("https://assets.customer.io/assets/track.js",{id:"cio-tracker",attributes:{"data-site-id":g,"data-use-array-params":"true","data-in-app-org-id":m,"data-use-in-app":"true","data-auto-track-page":"false"}})))}),[s]);const S=(0,u.D9)(a);(0,n.useEffect)((()=>{S!==a&&(f(),i&&void 0!==a?(window._cio.identify({id:(0,p.cj)(a)}),t&&window._cio.on("in-app:message-opened",t),r&&window._cio.on("in-app:message-dismissed",r),d&&window._cio.on("in-app:message-action",d),window._cio.on("in-app:message-error",o)):window._cio.reset())}),[i,a,S,t,r,o,d])}({isEnabled:(0,d.VK)((()=>i.isLoggedIn()&&T&&V.default.checkGate("customerio")),[i,T]),isLoggedIn:i.isLoggedIn(),userId:i.id,onMessageOpened:s=>{Z.Z.state.suppressReason?b.EKj(e,{message_id:s.detail.messageId,reason:Z.Z.state.suppressReason}):(Z.Z.setState({...Z.Z.state,isVisible:!0}),b.IMV(e,{message_id:s.detail.messageId}))},onMessageDismissed:s=>{Z.Z.setState({...Z.Z.state,isVisible:!1}),b.x91(e,{message_id:s.detail.messageId})},onMessageError:s=>{b.ybK(e,{message_id:s.detail.messageId})},onMessageAction:s=>{if(s.detail.actionValue.startsWith("relative_url=")){const i=s.detail.actionValue.split("relative_url=")[1];I.navigate({environment:e,url:i})}s.detail.message.dismiss()}}),(0,w.kI)({isEnabled:a,isLoggedIn:i.isLoggedIn(),userId:i.id,spaceId:M,userEmail:A,sprigConfig:_.Z.sprig,userDaysSinceSignup:P??0,isSpaceAdmin:R,userDomainType:L}),(0,S.oG)({getLocale:(0,n.useCallback)((()=>r.SP),[]),analyticsSettings:(0,d.VK)((()=>t().pick(v.default.state,["isIntercomEnabled","intercomAppId","intercomUserHash","noIntercomUserId","user_id","user_email"])),[]),onVisibilityChange:(0,n.useCallback)((s=>{K.Z.updateShouldResizeWebview(e,s,"v1"),s?D.Z.addNamedPopup("intercom"):D.Z.removeNamedPopup("intercom")}),[e])}),(0,y.Z7)({userId:i.id,spaceId:M,replaysSessionSampleRate:(0,d.VK)((()=>V.default.getConfigKey("sentry","replaysSessionSampleRate-v0")),[]),replaysOnErrorSampleRate:(0,d.VK)((()=>V.default.getConfigKey("sentry","replaysOnErrorSampleRate-v0")),[])})}function A(){return M(),null}}}]);