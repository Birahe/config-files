"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9380],{60951:(e,t,a)=>{a.r(t),a.d(t,{PushNotification:()=>N});var o=a(96486),r=a.n(o),s=a(40902),c=a(66897),i=a(99036),n=a(38297),l=a(55384),d=a(55061),m=a(21202),u=a(13493),p=a(70279),b=a(19889),f=a(70203),g=a(44805),y=a(64002);function N(e){const{activity:t,getRecordValue:a,baseURL:o,userTimeZone:N,pageVisitSource:k,intl:M,useSimplifiedEmailSubjectForGrouping:v}=e,J=l.om.fromGetRecordValueFn(a),q=(0,d.P6)({...e}),j=(0,d.XW)(q,M),R=(0,d.oP)({...e,intl:M}),V=(0,d.iR)({...e,intl:M}),h=(0,d.rn)({...e,intl:M});switch(t.type){case"top-level-block-created":return{subject:M.formatMessage(d.qJ.topLevelBlockCreated,{userName:j,targetName:R,spaceName:h})};case"top-level-block-deleted":return{subject:M.formatMessage(d.qJ.topLevelBlockDeleted,{userName:j,targetName:R,spaceName:h})};case"collection-row-created":return{subject:M.formatMessage(d.qJ.collectionRowCreated,{userName:j,targetName:R,collectionName:V})};case"collection-row-deleted":return{subject:M.formatMessage(d.qJ.collectionRowDeleted,{userName:j,targetName:R,collectionName:V})};case"block-edited":{let c;if(t.edits){const l=t.edits[0];if("block-changed"===l.type){const t=l.block_data.after.block_value,m=(0,n.ky)({block:t,getRecordValue:a});if("page"===t.type&&m){const t=l.block_schema||i.Kc(M),o=s.OS({before:l.block_data.before.block_value,after:l.block_data.after.block_value,schema:t}).filter((e=>{const a=t[e];return a&&"formula"!==a.type})).map((o=>{const r=t[o],s=r?r.name:void 0,c=(0,d.v4)({intl:M,property:o,schema:t,block:l.block_data.after.block_value,getRecordValue:a,userTimeZone:e.userTimeZone,baseURL:e.baseURL})||M.formatMessage(d.qJ.emptyBlockEditedProperty);return M.formatMessage(d.qJ.propertyNameAndValueEdited,{propertyName:s,propertyValue:c})})),n=s.B9({before:l.block_data.before.block_value,after:l.block_data.after.block_value}),m=r().compact(n.map((e=>{const t=(0,d._u)({formatProperty:e,intl:M}),o=(0,d.W9)({formatProperty:e,intl:M,block:l.block_data.after.block_value,getRecordValue:a});if(t&&o)return M.formatMessage(d.qJ.propertyNameAndValueEdited,{propertyName:t,propertyValue:o})})));c=M.formatList(o.concat(m),{type:"conjunction",style:"narrow"})}else c=(0,d._2)({intl:M,blockValue:t,getRecordValue:a,baseURL:o,userTimeZone:N})}else if("block-created"===l.type){const e=l.block_data.block_value;c=(0,d._2)({intl:M,blockValue:e,getRecordValue:a,baseURL:o,userTimeZone:N})}else if("block-deleted"===l.type){const e=l.block_data.block_value,t=(0,d._2)({intl:M,blockValue:e,getRecordValue:a,baseURL:o,userTimeZone:N});c=M.formatMessage(d.qJ.blockDeletedEditBody,{renderedBlock:t})}}return{subject:v?_(R,M):M.formatMessage(d.qJ.blockEditedNotification,{userName:j,blockName:R}),body:c}}case"block-property-edited":const T={subject:v?_(R,M):M.formatMessage(d.qJ.blockPropertyEditedNotification,{userName:j,blockName:R}),body:void 0};if(t.edits){const o=t.edits[0],r=Object.entries(o.property_updates).filter((e=>{let[t,a]=e;const r=o.filtered_block_schema[t];return r&&!["formula","created_by","created_time"].includes(r.type)})).map((t=>{let[r,s]=t;const c=o.filtered_block_schema[r],i=c?c.name:void 0,n=(0,d.Wy)({intl:M,propertySchema:c,textValue:s.after.value,getRecordValue:a,userTimeZone:e.userTimeZone,baseURL:e.baseURL})||M.formatMessage(d.qJ.emptyBlockEditedProperty);return M.formatMessage(d.qJ.propertyNameAndValueEdited,{propertyName:i,propertyValue:n})}));T.body=M.formatList(r,{type:"conjunction",style:"narrow"})}return T;case"permissions-edited":return{subject:M.formatMessage(d.qJ.userEditedPermissionsFor,{userName:j,targetName:R}),body:(0,d.gt)({intl:M,activity:t,getRecordValue:a,pageVisitSource:k,userTimeZone:e.userTimeZone})};case"user-mentioned":return{subject:v?_(R,M):M.formatMessage(d.qJ.userMentionedIn,{userName:j,targetName:R}),body:(0,d.kU)({intl:M,getRecordValue:a,baseURL:o,userTimeZone:e.userTimeZone,blockId:t.mentioned_block_id,property:t.mentioned_property})};case"commented":{let o;if(t.edits){const r=t.edits[0];if("comment-created"===r.type){const t=a({table:p.x_,id:r.comment_id,spaceId:r.space_id}),s=r.comment_data||t;s&&(o=`ðŸ’¬ ${g.Xh({intl:M,textValue:s.text,getRecordModel:J,userTimeZone:e.userTimeZone})}`)}else if("comment-changed"===r.type)o=`ðŸ’¬ ${g.Xh({intl:M,textValue:r.comment_data.after.text,getRecordModel:J,userTimeZone:e.userTimeZone})}`;else{const t=a({table:p.x_,id:r.comment_id,spaceId:r.space_id}),s=r.comment_data||t;if(s){const t=g.Xh({intl:M,textValue:s.text,getRecordModel:J,userTimeZone:e.userTimeZone});o=M.formatMessage(d.qJ.userDeletedComment,{commentText:t})}}}return{subject:v?_(R,M):M.formatMessage(d.qJ.userCommentedSubject,{userName:j,targetName:R}),body:o}}case"user-invited":const w=(0,y.pE)(R),Z=w.length>0?w:M.formatMessage(d.qJ.defaultPageName);if(t.permission_group_id)return{subject:M.formatMessage(d.qJ.userAddedToSpace,{userName:j,workspaceName:Z})};return{subject:0===q.filter(c.uC).length?M.formatMessage(d.qJ.userInvitedToSpaceByBot,{workspaceName:Z}):M.formatMessage(d.qJ.userInvitedToSpace,{userName:j,workspaceName:Z})};case"collection-edited":{let e,a=M.formatMessage(d.qJ.userEditedCollectionSubject,{userName:j,collectionName:R});if(t.edits){const o=t.edits[0];if("collection-changed"===o.type&&o.collection_data){const t=o.collection_data.after?o.collection_data.after.description:void 0,r=o.collection_data.before?o.collection_data.before.description:void 0;r&&!t?a=M.formatMessage(d.qJ.collectionDescriptionDeleted,{userName:j,collectionName:R}):!r&&t?(a=M.formatMessage(d.qJ.collectionDescriptionCreated,{userName:j,collectionName:R}),e=f.Jc(t)):r&&t&&s.Dn(r,t)&&(e=f.Jc(t))}else if("collection-created"===o.type&&o.collection_data){const t=o.collection_data.description;t&&(a=M.formatMessage(d.qJ.userCreatedCollectionSubject,{userName:j,collectionName:R}),e=f.Jc(t))}}return{subject:a,body:e}}case"collection-view-edited":const U=e.getRecordValue({table:u.n,id:t.collection_view_id,spaceId:t.space_id}),S=U&&U.name||M.formatMessage(d.qJ.untitledCollectionView);return{subject:M.formatMessage(d.qJ.collectionViewEditedSubject,{userName:j,collectionViewName:S,collectionName:R})};case"collection-property-edited":const E=t.edits&&t.edits[0],L=E&&("collection-property-changed"===E.type?E.collection_property_data.after.name:E.collection_property_data.name)||M.formatMessage(d.qJ.collectionPropertyEditedUnknown);return t.collection_property_id,{subject:M.formatMessage(d.qJ.collectionPropertyEditedSubject,{userName:j,propertyType:L,collectionName:R})};case"reminder":return{subject:M.formatMessage(d.qJ.reminderSubject,{pageName:R}),body:(0,d.kU)({getRecordValue:a,baseURL:o,userTimeZone:e.userTimeZone,blockId:t.reminder_block_id,property:t.reminder_property,intl:M})};case"permission-group-edited":return{subject:(0,d.pF)({activity:t,intl:M,userName:j,targetName:R})};case"page-locked":case"page-unlocked":return{subject:"page-locked"===t.type?M.formatMessage(d.qJ.pageLockedActivity,{userName:j,pageName:R}):M.formatMessage(d.qJ.pageUnlockedActivity,{userName:j,pageName:R})};case"email-edited":return{subject:M.formatMessage(d.qJ.emailEditedActivity,{userName:j})};case"access-requested":return{subject:t.parent_table===m.iU?M.formatMessage(d.qJ.accessRequestedSubject,{userName:j,pageName:R}):M.formatMessage(d.qJ.membershipRequestedSubject,{userName:j,workspaceName:R})};case"page-deleted":return{subject:M.formatMessage(d.qJ.pageDeletedActivity,{userName:j})};case"page-restored":return{subject:M.formatMessage(d.qJ.pageRestoredActivity,{userName:j})};case"page-permanently-deleted":return{subject:M.formatMessage(d.qJ.pagePermanentlyDeletedActivity,{userName:j})};case"team-membership-edited":return{subject:M.formatMessage(d.qJ.userInvitedToTeam,{userName:j,teamName:R})};case"private-content-transferred":const x=t.edits&&t.edits[0].from_user_id;if(!x)return{subject:M.formatMessage({description:"Notification that shows when private content is transferred but there is no from user name.",defaultMessage:"{author} transferred private content to you: {pageName}",id:"pushNotification.privateContentTransferred.noFromUserName"},{author:j,pageName:R})};const C=a({table:b.KJ,id:x});return{subject:M.formatMessage(d.qJ.privateContentTransferred,{author:j,pageName:R,fromUserName:C&&l.kk.fromValue(b.KJ,C).getFullName(M)})};case"permission-group-mentioned":const I=(0,d.Bg)({spaceId:t.space_id,permissionGroupId:t.mentioned_group_id,getRecordValue:e.getRecordValue}),P=(0,d.jQ)(M,I);return{subject:v?_(R,M):M.formatMessage(d.qJ.permissionGroupMentionedIn,{userName:j,targetName:R,groupName:P}),body:(0,d.kU)({intl:M,getRecordValue:a,baseURL:o,userTimeZone:e.userTimeZone,blockId:t.navigable_block_id,property:t.mentioned_property})};case"verification-expired":return{subject:M.formatMessage(d.qJ.verificationExpired,{pageName:R})}}}function _(e,t){return t.formatMessage({description:"Header for the email subject line when there is new activity on a page",defaultMessage:"New activity in {pageTitle}",id:"emailActivity.pageActivity.simplifiedSubjectLine"},{pageTitle:e})}}}]);