"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8586],{41311:(e,t,i)=>{i.d(t,{w1:()=>_,XP:()=>I,y2:()=>x,bA:()=>Z,T_:()=>P,B3:()=>F,h7:()=>A});var n=i(65917),a=i(4615),o=i(98459),s=i(80984),r=i(64002),l=i(5366),d=i(95477),c=i(77373),u=i(93959),p=i(70538),m=i(71935),g=i(27832),h=i(22756),f=i(67940),v=i(50906),y=i(54642),b=i(51127),S=i(47307),w=i(84908),M=i(30738),C=i(15356),k=i(30149);const T=(0,l.defineMessages)({authenticatingWithAsana:{id:"asanaActions.authenticatingWithAsana.loadingMessage",defaultMessage:"Authenticating with Asana…"},titleMessage:{id:"asanaActions.loginWithAsanaPopupModal.title",defaultMessage:"Asana login"}});async function _(e){const{environment:t,flowId:i}=e;await y.disconnectAsana(t,{});const n=(0,m.eC)(t);let a=(0,s.s1)(d.Z.domainBaseUrl,{authType:n,userId:t.currentUser.id});if(a=n.redirectToAuth?a:await(0,m.HU)(t,a),t.device.isElectron)return h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0}),void w.openExternalUrl(a);const o=await C.M(t,{width:580,height:800,url:a,titleMessage:T.titleMessage});if(!o)return;const l=r.Qc(o);if(!l.query.code||!l.query.state)return;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0});const c=await y.authWithAsana(t,{code:l.query.code,encryptedState:l.query.state}),u=await y.getAsanaWorkspacesNames(t,{});if("failed"===c.type)v.a1y(t,{import_source:"asana",data:{import_type:"api",status:"failure",error:c.error},flowId:i}),console.error(c.error),S.showError(c);else if(v.a1y(t,{import_source:"asana",data:{import_type:"api",status:"success"},flowId:i}),"success"===u.type){const{data:{account:e,workspaces:t}}=u;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!1,account:e,workspaces:t})}}async function I(e){const{environment:t}=e;h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!0});const i=await y.disconnectAsana(t,{});"failed"===i.type?(console.error(i.error),S.showError(i)):(v.qJZ(t,{integration_name:"asana"}),"success"===i.type&&h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!1,account:void 0,workspaces:[]}))}async function x(e){const{selectedWorkspace:t,environment:i}=e;h.Z.setState({...h.Z.state,isLoadingProjects:!0});const n=await y.getTeamsAndProjectsInAsanaWorkspace(i,{workspaceId:t,size:5});"success"===n.type&&h.Z.setState({...h.Z.state,teamsAndProjects:n.data,isLoadingProjects:!1})}async function Z(e){let{environment:t}=e;h.Z.setState({...h.Z.state,isLoadingAsanaWorkspaces:!0});const i=await y.getAsanaWorkspacesNames(t,{});"success"===i.type&&h.Z.setState({...h.Z.state,account:i.data.account,workspaces:i.data.workspaces,isLoadingAsanaWorkspaces:!1})}async function P(e){let{environment:t,spaceStore:i,teamsStores:s,flowId:r}=e;const l=h.Z.state.selectedWorkspace;if(!l)return;h.Z.setState({...h.Z.state,templateCreationInProgress:!0});const d={},m={};try{for(const e in h.Z.state.selectedProjectsAndTeamspaces){if(0===h.Z.state.selectedProjectsAndTeamspaces[e].projects.length)continue;let n;const a=h.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:o}=a;if(!o)continue;const r=s.find((e=>e.id===a.notionTeamspaceId));if(n=r||i,m[o])d[e]=m[o];else{const{serverCommitResult:i,performResult:a}=k.createAndCommit({environment:t,perform:e=>{const i={type:"preset",uri:p._F};if("preset"===i.type&&!i.uri.startsWith("notion://wiki")){var a;const o=i.uri,s=null===(a=(0,u.SP)(o))||void 0===a?void 0:a.uri;if(!s)return;const r=(0,c.p)().find((e=>e.uri===s));if(null==r?void 0:r.presets.find((e=>e.uri===o))){return b.ZF({environment:t,appParentStore:n,appUri:s,presetUri:o,transaction:e,from:"asana_import"})}return[]}},userAction:"importActions.importAsana"});d[e]=a,m[o]=a,await i}}}catch(F){return void h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const S=[],w=g.default.state.currentSpaceViewStore;if(!w)return;const C=M.Ym({environment:t,spaceStore:i,spaceViewStore:w,append:!0});await C.deferred.promise;const T=C.pageId;h.Z.setState({...h.Z.state,loggerPageId:T});const _=new Set,I=[],x=[];for(const n in d){const e=h.Z.state.selectedProjectsAndTeamspaces[n],t=d[n];if(!(t&&e.notionTeamspaceId&&e.projects.length))continue;const a="string"==typeof e.projects?[]:e.projects;I.push(...a),_.add(e.notionTeamspaceId),x.push(n),S.push({collectionViewBlocks:t.map((e=>({id:e.id,spaceId:(0,o.CG)(i.id)}))),projectIds:a,asanaTeamId:n,notionTeamSpaceId:e.notionTeamspaceId,importAllProjects:"all"===e.projects,importOnlyIncompleteProjects:"in_complete"===e.projects})}const Z=y.parallelAsanaImport(t,{importParams:S,spaceId:(0,o.CG)(i.id),asanaWorkspaceId:l,importCompletedTasks:h.Z.state.importCompletedTasks,loggerPageId:T,flowId:r||(0,a.ZP)()});h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"importingData"}),f.Z.reset();const P=h.Z.state.workspaces.find((e=>e.gid===l));P&&function(e,t,i){try{v.qyQ(e,{import_source:"asana",data:t,flowId:i})}catch(a){n.log({level:"error",from:"asanaV2Actions",type:"parallelAsanaImport",error:{miscDataString:JSON.stringify({error:a,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceName:P.name,teams:x,projects:I,numberOfTeamspacesUsed:_.size,completedTasks:h.Z.state.importCompletedTasks,userId:t.currentUser.id,spaceId:(0,o.CG)(i.id)},r);for await(const n of Z){if(!h.Z.state.isModalOpen)break;if(n.error)return void h.Z.setState({...h.Z.state,currentTab:"failure"});"success"===n.taskStatus&&h.Z.setState({...h.Z.state,currentTab:"confirm",result:n.value.status,isComplete:!0})}}function F(e){var t;let{teamId:i,spaceId:n}=e;h.Z.setState({...h.Z.state,selectedProjectsAndTeamspaces:{...h.Z.state.selectedProjectsAndTeamspaces,[i]:{projects:(null===(t=h.Z.state.selectedProjectsAndTeamspaces[i])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:n}}})}function A(){h.Z.setState({...h.Z.state,isModalOpen:!0})}},30738:(e,t,i)=>{i.d(t,{Ym:()=>V,T5:()=>W,A1:()=>K,am:()=>z,ro:()=>N,su:()=>U});var n=i(96486),a=i.n(n),o=i(13991),s=i(41432),r=i(7406),l=i(65917),d=i(59730);const c=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],u=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],p={markdown:u,csv:["text/plain",".csv"],html:["text/html"],docx:c,gdocs:c,dropbox:c,quip:["text/html",u],workflowy:["text/plain"],confluence:["application/zip"]};var m=i(2911),g=i(61784),h=i(32056),f=i(29477),v=i(4615),y=i(98459),b=i(21202),S=i(5366),w=i(72340),M=i(33954),C=i(33929),k=i(46190),T=i(78900),_=i(90365),I=i(82066),x=i(85057),Z=i(50906),P=i(54642),F=i(47307),A=i(94419),B=i(92625),E=i(9953),D=i(29974),R=i(30149),L=i(53471);const O=(0,S.defineMessages)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importingFromConfluenceViaAPIMessage:{id:"importActions.importingFromConfluenceViaAPI.loadingMessage",defaultMessage:"Importing confluence space: {confluenceSpaceKey}.",description:"Display message when confluence space is importing."},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed."},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB.",description:"importFile failure message when file exceeds 5MB"},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},confluenceImportViaAPIFailed:{id:"importActions.confluenceImportViaAPIFailedError.message",defaultMessage:"Confluence space import failed.",description:"ImportFile failure message when import via API fails."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}",description:"'Import' is a noun"}});async function N(e){const{environment:t,pageStore:i,spaceStore:n,isTeamPage:a,spaceViewStore:s,uploadType:c,flowId:u}=e;let y;try{const r=await L.y({multiple:!0,accept:p[c].join(",")});if(0===r.length)return;const l=1===r.length;if("confluence"===c){const i=1073741824*(Number((0,w.$6)(t))||15);if(r[0].size>i)throw Z.a1y(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:r[0].size},flowId:u}),new d.nY("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:h.td(i,1)}}})}const m=await new Promise(((e,i)=>{L.IL({environment:t,uploadType:c,files:r,bucket:"temporary",preventLimitFreeFileSize:!0,flowId:u,onBatchStart:()=>{B.j({message:l?O.uploadingOneFile:O.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:r.length,percentComplete:0}})},onBatchProgress:e=>{let{uploadedFiles:t,progressPercent:i}=e;B.j({message:l?O.uploadingOneFile:O.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:t,totalNumberOfFiles:r.length,percentComplete:i}})},onBatchComplete:t=>{B.j({message:l?O.uploadingOneFile:O.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:r.length,percentComplete:100}}),e(t)},onBatchError:i})}));let S,M;if(i&&i.isEmptyPage())r.length>1||i.isInsideCollection()?(S=i.id,M="AppendToBlock"):(S=i.id,M="ReplaceBlock");else{const{performResult:e}=R.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const i=C.default.formatMessage(O.importTitle,{date:(0,g.Yx)(Date.now(),"medium",o.SP)}),l=D.KE({environment:t,spaceStore:n,spaceViewStore:s,isPrivate:!a,prepend:!a,title:i,transaction:e});let d;d=r.length>1?"AppendToBlock":"ReplaceBlock";const c=f.UZ();return e.postSubmitCallbacks.push((e=>{e?c.reject(e):c.resolve()})),{deferred:c,createdPage:l,pageId:l.id,importType:d}}});y=e.createdPage,S=e.pageId,M=e.importType,await e.deferred.promise}const k=m.map(((e,t)=>({fileURL:e,fileName:r[t].name})));let T=0;B.j({message:l?O.importingOneFile:O.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:T,totalNumberOfFiles:r.length}});for(const{fileURL:e,fileName:i}of k){if("confluence"===c){Z.a1y(t,{import_source:"confluence",data:{import_type:"file",status:"success",fileSize:r[0].size},flowId:u});const a=V({environment:t,spaceStore:n,spaceViewStore:s});await a.deferred.promise;const o=a.pageId,l=P.parallelImportConfluenceExport(t,{fileURL:e,fileName:i,page:{id:S,spaceId:n.id},loggerPageId:o,flowId:u||(0,v.ZP)()});for await(const e of l){if(e.error)throw e.error;e.value.isComplete||B.j(e.value.status)}}else if("AppendToBlock"===M){const{value:a}=await P.importFile(t,{fileURL:e,fileName:i,importType:M,block:{id:S,spaceId:n.id}}).next();if(a.error)throw a.error}else if("ReplaceBlock"===M){const{value:a}=await P.importFile(t,{fileURL:e,fileName:i,importType:M,block:{id:S,spaceId:n.id}}).next();if(a.error)throw a.error}T++,B.j({message:l?O.importingOneFile:O.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:T,totalNumberOfFiles:r.length}})}return B.x(),x.G.createChildStore(n,{table:b.iU,id:S})}catch(T){var S,k;let e;l.log({level:"error",from:"importFiles",type:"importFilesFailure",error:(0,m.Ui)(T),data:{spaceId:n.id}}),B.x(),R.createAndCommit({userAction:"importActions.importFiles",environment:t,perform:e=>{y&&A.Od({parent:n.getPagesStore(),childToRemove:y,transaction:e})}});let i=null,a=null;throw T instanceof d.hm&&T.clientData?(i=T.clientData,M.Em[T.clientData.type]&&"ImportFileSizeTooLargeError"===(0,r.tg)(T).message?a=M.Em[T.clientData.type]:M.$5[T.clientData.type]&&"CsvImportError"===(0,r.tg)(T).message?a=M.$5[T.clientData.type]:M.zP[T.clientData.type]&&(a=M.zP[T.clientData.type])):T instanceof d.nY&&"upload_file_size_exceeded"===(null===(S=T.body)||void 0===S||null===(k=S.clientData)||void 0===k?void 0:k.type)&&M.zP[T.body.clientData.type]&&(i=T.body.clientData,a=M.zP[i.type]),e=i&&a?C.default.formatMessage(a,i.messageValues):"ImportFileSizeTooLargeError"===(0,r.tg)(T).message?C.default.formatMessage(O.fileImportFailedSizeTooLarge):C.default.formatMessage(O.importFailed),F.showErrorMessage(e),T}}function V(e){const{environment:t,spaceStore:i,spaceViewStore:n,append:a}=e,{performResult:s}=R.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const s=C.default.formatMessage(O.importTitle,{date:(0,g.Yx)(Date.now(),"medium",o.SP)}),r=D.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!a,title:`${s} Logs`,transaction:e}),l=f.UZ();return e.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,pageId:r.id}}});return s}async function U(e){const{environment:t,boards:i,spaceStore:n,spaceViewStore:a}=e;B.j({message:O.importingFromTrelloMessage,interpolatedValues:{importingCount:i.length}}),I.Z.setState({open:!1});const{performResult:{deferred:o,pages:s}}=R.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{const o=i.map((i=>D.KE({environment:t,spaceStore:n,spaceViewStore:a,isPrivate:!0,prepend:!0,loading:!0,title:i.name,transaction:e}))),s=f.UZ();return e.postSubmitCallbacks.push((e=>{e?s.reject(e):s.resolve()})),{deferred:s,pages:o}}});await o.promise;try{return await Promise.all(s.map((async(e,n)=>{const a=i[n],{value:o}=await P.importTrello(t,{boardId:a.id,block:{id:e.id,spaceId:(0,y.CG)(e.pointer.spaceId)}}).next();if(o.error)throw o.error}))),B.x(),s[0]}catch(l){throw R.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{for(const t of s)A.Od({parent:n.getPagesStore(),childToRemove:t,transaction:e})}}),F.showErrorMessage(C.default.formatMessage(O.trelloImportFailed)),B.x(),new Error((0,r.tg)(l).message)}}async function W(e){const{environment:t,projects:i,spaceStore:n,spaceViewStore:a}=e;B.j({message:O.importingFromAsanaMessage,interpolatedValues:{importingCount:i.length}}),k.Z.setState({open:!1});const{serverCommitResult:o,performResult:{pages:s}}=R.createAndCommit({userAction:"importActions.importAsana",environment:t,perform:e=>({pages:i.map((i=>D.KE({environment:t,spaceStore:n,spaceViewStore:a,isPrivate:!0,prepend:!0,loading:!0,title:i.name,transaction:e})))})});await o;try{for await(const e of s){const n=s.indexOf(e),a=i[n];let o=!0;for(;o;){const{value:i}=await P.importAsana(t,{block:{id:e.id,spaceId:(0,y.CG)(e.pointer.spaceId)},projectId:a.gid}).next();if(i.error)throw o=!1,i.error;i.value.isComplete?o=!1:(o=!0,B.j({message:i.value.status.message,interpolatedValues:{timeOfDelay:s.length<60?"minutes":"hours"}}))}}return B.x(),s[0]}catch(l){throw R.createAndCommit({userAction:"importActions.importAsana",environment:t,perform:e=>{for(const t of s)A.Od({parent:n.getPagesStore(),childToRemove:t,transaction:e})}}),F.showErrorMessage(C.default.formatMessage(O.asanaImportFailed)),B.x(),new Error((0,r.tg)(l).message)}}async function z(e){const{environment:t,spaceStore:i,spaceViewStore:n,notebooks:o,userSettingsStore:r}=e;if(0===o.length)throw new Error("Expected at least one notebook");B.j({message:O.importingFromEvernoteMessage,interpolatedValues:{importingCount:o.length}}),_.Z.setState({open:!1});const l=await async function(e){const{environment:t,spaceStore:i,spaceViewStore:n,notebooks:o}=e,{serverCommitResult:r,performResult:{blockStores:l}}=R.createAndCommit({userAction:"importActions.createStacks",environment:t,perform:e=>{const r=a().uniq(a().compact(o.map((e=>e.stack)))).sort().reverse(),l={};let d=e=>!0;return o.length>1&&r.length>0&&(r.forEach((a=>{const r=D.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!1,title:a,transaction:e}),d=r.getContentStore();o.filter((e=>e.stack===a)).forEach((i=>{const n=E.j4({environment:t,type:s.Ti.copyIndicator,inMemoryRecordCache:r.inMemoryRecordCache,transaction:e,spaceId:d.pointer.spaceId});A.R3({parent:d,append:n,transaction:e}),l[i.guid]=n}))})),d=e=>!Boolean(e.stack)),o.filter(d).reverse().forEach((a=>{const o=D.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!0,title:a.title,transaction:e});l[a.guid]=o})),{blockStores:l}}});return await r,l}({environment:t,spaceStore:i,spaceViewStore:n,notebooks:o}),d=l[o[0].guid];try{return await async function(e){const{environment:t,spaceStore:i,spaceViewStore:n,notebooks:a,waitForNotebook:o,notebookMapping:s,userSettingsStore:r}=e;let l;if(f.dC(a,2,(async e=>{await Promise.all(e.map((async e=>{const i=s[e.guid];if(!i)throw new Error(`Missing notebook page ${e.guid}`);const n=f.UZ();i===o&&(l=n),await async function(e){const{environment:t,notebookStore:i,notebook:n,firstCompleted:a}=e,o=P.importEvernote(t,{notebookId:n.guid,block:{id:i.id,spaceId:(0,y.CG)(i.pointer.spaceId)},timestamp:Date.now(),parentTable:b.iU}),{value:s}=await o.next();if(s.error)throw console.error(s.error),R.createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,perform:e=>{const t=i.getParentBlockStore();if(t){const n=t.getContentStore();A.Od({parent:n,childToRemove:i,transaction:e})}}}),s.error;a.resolve(void 0)}({environment:t,notebookStore:i,notebook:e,firstCompleted:n})})))})),!l)throw new Error("waitForNotebookFirstCompleted not defined.");const d=r.getSettings();null!=d&&d.created_evernote_getting_started||await D.FI({environment:t,type:"evernote",spaceStore:i,spaceViewStore:n,userSettingsStore:r});await l.promise}({environment:t,waitForNotebook:d,notebookMapping:l,notebooks:o,spaceStore:i,spaceViewStore:n,userSettingsStore:r}),B.x(),d}catch(c){throw F.showErrorMessage(C.default.formatMessage(O.evernoteImportFailed)),B.x(),c}}async function K(e){const{environment:t,spaceStore:i,spaceViewStore:n,space:a,flowId:s}=e;if(!t.currentUser.id)throw new Error("User does not exist.");B.j({message:O.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:a.name}}),T.Z.setState({open:!1});const d=V({environment:t,spaceStore:i,spaceViewStore:n});await d.deferred.promise;const c=d.pageId,{performResult:u}=R.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{const a=C.default.formatMessage(O.importTitle,{date:(0,g.Yx)(Date.now(),"medium",o.SP)}),s=D.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,title:a,transaction:e}),r=f.UZ();return e.postSubmitCallbacks.push((e=>{e?r.reject(e):r.resolve()})),{deferred:r,createdPage:s,pageId:s.id}}});await u.deferred.promise;const p=u.createdPage;try{if(!p)throw new Error("No root page");const e=P.parallelImportConfluenceViaApi(t,{userId:t.currentUser.id,confluenceSpaceKey:a.key,page:{id:u.pageId,spaceId:i.id},loggerPageId:c,flowId:s});for await(const t of e){if(t.error)throw t.error;t.value.isComplete||B.j(t.value.status)}return B.x(),p}catch(h){throw l.log({level:"error",from:"importConfluenceViaAPI",type:"importConfluenceViaAPIFailure",error:(0,m.Ui)(h),data:{spaceId:i.id}}),R.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{p&&A.Od({parent:i.getPagesStore(),childToRemove:p,transaction:e})}}),F.showErrorMessage(C.default.formatMessage(O.confluenceImportViaAPIFailed)),B.x(),new Error((0,r.tg)(h).message)}}},23999:(e,t,i)=>{i.d(t,{cP:()=>Fe,ZP:()=>Pe,a_:()=>Ze});var n=i(77094),a=i.n(n),o=i(67294),s=i(13991),r=i(480),l=i(81954),d=i(24405),c=i(3779),u=i(74181),p=i(61784),m=i(77420),g=i(9844),h=i(90965),f=i(5500),v=i(9038),y=i(97880),b=i(82990),S=i(7928),w=i(63143),M=i(5366),C=i(95477),k=i(38755),T=i(27832),_=i(85057),I=i(38484),x=i(97464),Z=i.n(x),P=i(8848),F=i(31942),A=i(19889),B=i(50906),E=i(76463),D=i(47307),R=i(5978),L=i(64964),O=i(30149),N=i(60709),V=i(33665),U=i(61766),W=i(74021),z=i(24736),K=i(26825),q=i(44758),H=i(28992);function G(e){window.__c={n:"BotCapabilitiesTooltip"};const{capabilities:t}=e,i=(0,M.useIntl)(),{device:n}=(0,r.O7)(),s=(0,K.uH)(t),l=(0,K.Rh)(t),d=(0,K.WM)(e.capabilities),c=[...(0,q.zq)(s),...(0,q.ac)(l),...(0,q.VR)(d)];return o.createElement(H.Z,Z()({},e,{title:i.formatMessage((0,K.Gx)(s,void 0).label),shouldWrapCaption:!0,style:n.isMobile?{padding:"12px 4px"}:{padding:4,marginTop:2,marginBottom:2},captionStyle:{marginTop:4},caption:a()("div",{},void 0,c)}))}var j=i(52275),$=i(31945),Y=i(68894),Q=i(78140),X=i(9342),J=i(22346),ee=i(63296),te=i(44532),ie=i(72495),ne=i(64369),ae=i(29302);function oe(e){window.__c={n:"AdminIntegrationSettingsActionMenu"};const{integrationId:t,integrationTable:i,isLegacy:n,disableDisconnectUser:s,disableDisconnectAll:d,disableDisallow:c,botIds:p}=e,v=(0,l.VK)((()=>T.default.state.currentSpaceStore),[]),b=(0,r.Fy)(),S=(0,r.O7)(),w=(0,M.useIntl)(),[k,x]=(0,o.useState)(void 0),[P,B]=(0,o.useState)(!1),[E,D]=(0,o.useState)(!1),[R,L]=(0,o.useState)(!1),[U,W]=(0,o.useState)(void 0),K=(0,l.VK)((()=>v&&i?(0,_.Kv)(v,{table:i,id:t}):void 0),[v,t,i]),q=(0,l.VK)((()=>{if(n){const e=u.ns.find((e=>e.id===t));return{name:null==e?void 0:e.name,url:(0,V.UY)("guides.connectedApps")}}if(v&&i){const n=v.getRecordValue({table:i,id:t});if(i===g.K2&&!(0,f.BP)({integrationId:t,env:C.Z.env})){var e,a;const t=n;return{name:null==n?void 0:n.name,url:null==t||null===(e=t.info)||void 0===e?void 0:e.website_url,email:null==t||null===(a=t.info)||void 0===a?void 0:a.email}}return{name:null==n?void 0:n.name}}}),[v,t,i,n]),H=(0,l.VK)((()=>p&&!s?p.map((e=>v&&K?_.t1.createChildStore(K,{table:m.cZ,id:e,spaceId:v.id}):void 0)):[]),[v,p,K,s]).filter(y.$K),G=(0,l.VK)((()=>H.filter((e=>e.getAlive()))),[H]),j=(0,l.VK)((()=>{if(v&&G&&!s){return G.map((e=>e.getCreatedById())).filter(y.$K).map((e=>I.U.createChildStore(v,{table:A.KJ,id:e}))).filter((e=>e.isDefined()))}return[]}),[G,v,s]),ee=(0,l.VK)((()=>null==v?void 0:v.getBotSettingsStore().getValue()),[v]),te=(0,l.VK)((()=>null==G?void 0:G.reduce(((e,t)=>{const i=j.find((e=>e.id===t.getCreatedById()));return e[t.id]={userStore:i,botCapabilities:t.getCapabilities()},e}),{})),[G,j]),ne=(0,l.VK)((()=>k?(0,F.ZP)(k,Object.entries(te),(e=>{let[,{userStore:t}]=e;return t.getSearchName()})):Object.entries(te)),[te,k]),ae=!s&&(null==p?void 0:p.length)&&a()(ie.Z,{isInput:!0,style:{padding:8}},void 0,a()(Y.ZP,{textWrapperStyle:{margin:0},focus:!b.isMobile||void 0,focusAfterAnimation:!0,value:k||"",onChange:e=>x(e.target.value),placeholder:w.formatMessage({id:"integrationInstallerFilter.userSearch.placeholder",defaultMessage:"Filter by user"})})),oe=ne.length?[{key:"disconnect user section",render:e=>o.createElement(ie.Z,e),items:re({users:ne,disableDisconnectUser:s,showDisplayModal:()=>D(!0),setSelectedUser:W,intl:w})}]:[],le=(null==q?void 0:q.url)||(null==q?void 0:q.email),Se=Boolean(null==p?void 0:p.length)||(0,h.CJ)(ee)&&!c,we=o.createElement(o.Fragment,null,le&&a()(ie.Z,{topBorder:Boolean(ne.length)},"app-links",(null==q?void 0:q.url)&&a()(de,{environment:S,developerWebsite:q.url}),(null==q?void 0:q.email)&&a()(ce,{environment:S,developerEmail:q.email})),Se&&a()(ie.Z,{topBorder:Boolean(ne.length||le)},void 0,Boolean(null==p?void 0:p.length)&&a()(ue,{showDisplayModal:()=>L(!0)}),(0,h.CJ)(ee)&&!c&&a()(pe,{showDisplayModal:()=>B(!0)})));return(le||Se)&&q?a()($.Z,{popupType:b.isMobile?$.Z.PopupType.SlideUp:$.Z.PopupType.Popup,renderOrigin:e=>o.createElement(z.Z,Z()({},e,{isMobile:b.isMobile,style:{marginLeft:8,marginRight:8}})),render:()=>o.createElement(o.Fragment,null,a()(Q.Z,{menuType:b.isMobile?N.og.ActionSheet:N.og.Popup,header:!s&&ae,footer:we,width:230},void 0,a()(X.Z,{type:X.i.Vertical,sections:oe,initialFocus:void 0})),a()(J.Z,{open:!s&&E,onDismiss:()=>{D(!1)},disableAnimation:!0,render:()=>a()(me,{title:a()(ye,{integrationName:q.name}),caption:a()(be,{integrationName:q.name,userName:null==U?void 0:U.userName}),type:"disconnect",handleCancel:()=>{D(!1),W(void 0)},handleConfirmation:async()=>{U&&(await se({botIds:[U.botId],environment:S}),W(void 0)),D(!1)}})}),a()(J.Z,{open:!d&&R,onDismiss:()=>{L(!1)},disableAnimation:!0,render:()=>a()(me,{title:a()(fe,{integrationName:q.name}),caption:a()(ve,{integrationName:q.name}),type:"disconnect",handleCancel:()=>L(!1),handleConfirmation:async()=>{await se({botIds:p,environment:S}),L(!1)}})}),a()(J.Z,{open:!c&&P,onDismiss:()=>{B(!1)},disableAnimation:!0,render:()=>a()(me,{title:a()(ge,{integrationName:q.name}),caption:a()(he,{integrationName:q.name,disableDisconnectAll:d}),type:"disapprove",handleCancel:()=>B(!1),handleConfirmation:async()=>{!function(e){const{currentSpaceStore:t,environment:i,integrationId:n}=e;t&&O.createAndCommit({userAction:"AdminIntegrationSettingsActionMenu.handleDisapproveIntegration",environment:i,perform:e=>{O.applyOperation({store:t,operation:{pointer:t.pointer,path:["bot_settings","integration_approval_statuses"],command:"update",args:{[n]:null}},transaction:e})}})}({currentSpaceStore:v,environment:S,integrationId:t}),d||await se({botIds:p,environment:S}),B(!1)}})}))}):null}async function se(e){let{botIds:t,environment:i}=e;t&&await Promise.all(t.map((e=>E.P0({environment:i,botId:e,onSuccess:()=>{B.IN8(i,{type:"public"})}}))))}function re(e){const{intl:t,disableDisconnectUser:i,users:n,showDisplayModal:o,setSelectedUser:s}=e;return i?[]:n.map((e=>{let[i,{userStore:n,botCapabilities:r}]=e;return{key:n.id,render:e=>a()(le,{buttonMenuProps:e,userStore:n,botCapabilities:r,selectAction:()=>{o(),s({botId:i,userName:n.getDisplayName(t)})}}),action:()=>{o(),s({botId:i,userName:n.getDisplayName(t)})}}}))}function le(e){window.__c={n:"UserMenuActionItem"};const{buttonMenuProps:t,userStore:i,botCapabilities:n,selectAction:s}=e,l=(0,r.Fy)(),[d,c]=(0,o.useState)(!1);return a()(te.ZP,{popupType:l.isMobile?$.Z.PopupType.SlideUp:$.Z.PopupType.Popup,placementToOrigin:$.Z.Placement.Right,open:d,onDismiss:()=>c(!1),origin:o.createElement(j.Z,Z()({},t,{title:a()("div",{style:{display:"flex",alignContent:"center",justifyContent:"space-between"}},void 0,a()(ae.Z,{userStore:i,avatarSize:18,inline:!0,avatarShouldShowShadow:!0,style:{flexShrink:1}})),textWrapperStyle:{marginLeft:12,marginRight:12},focused:!1,onClick:()=>c(!0)})),render:()=>a()(Q.Z,{width:240,menuType:l.isMobile?N.og.ActionSheet:N.og.Popup,header:a()("div",{style:{padding:2,marginTop:4,marginBottom:4}},void 0,a()(G,{capabilities:n}))},void 0,a()(X.Z,{type:X.i.Vertical,sections:[{key:"integration capabilities",render:e=>o.createElement(ie.Z,Z()({},e,{topBorder:!0})),items:[{key:"remove",render:e=>o.createElement(j.Z,Z()({},e,{focused:!1,title:a()("div",{style:{color:P.ZP.red}},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.revokeUserAccess.label",defaultMessage:"Disconnect user"}))})),action:s}]}],initialFocus:void 0}))})}function de(e){let{environment:t,developerWebsite:i}=e;return window.__c={n:"DeveloperWebsiteMenuItem"},a()(j.Z,{onClick:()=>{R.navigateToExternalURL({environment:t,url:i}),B.fco(t,{href:i,from:"integration-settings"})},title:a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.visitDeveloperWebsite.label",defaultMessage:"Visit developer website"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12}})}function ce(e){let{environment:t,developerEmail:i}=e;return window.__c={n:"ContactSupportMenuItem"},a()(j.Z,{onClick:()=>{R.navigateToExternalURL({environment:t,url:`mailto:${i}`}),B.Z9y(t,{from:"integration-settings"})},title:a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.contactDeveloperSupport.label",defaultMessage:"Contact support",description:"Label for a button that users can click to contact customer support for an integration that's been added to their workspace"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12}})}function ue(e){let{showDisplayModal:t}=e;return window.__c={n:"DisconnectAllMenuItem"},a()(j.Z,{onClick:t,title:a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.label",defaultMessage:"Disconnect all users"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12,color:P.ZP.red}})}function pe(e){let{showDisplayModal:t}=e;return window.__c={n:"DisapprovalMenuItem"},a()(j.Z,{onClick:t,title:a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.label",defaultMessage:"Remove from approved list"}),focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12,color:P.ZP.red}})}function me(e){let{title:t,caption:i,handleConfirmation:n,handleCancel:o,type:s}=e;return window.__c={n:"ModalContent"},a()("div",{style:{padding:20,width:333}},void 0,a()(ne.Z,{isMultiline:!0,style:{marginBottom:8,fontWeight:b.Z.fontWeight.semibold}},void 0,t),a()(ne.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginBottom:8}},void 0,i),a()("div",{style:{display:"flex",marginTop:12}},void 0,a()(ee.Z,{style:{width:140,marginRight:9},isLarge:!0,onClick:o},void 0,a()(ne.Z,{},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.cancel",defaultMessage:"Cancel"}))),a()(ee.Z,{style:{width:140},isLarge:!0,onClick:n,backgroundColor:P.ZP.red},void 0,a()(ne.Z,{style:{color:P.ZP.white}},void 0,"disconnect"===s&&a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.disconnect",defaultMessage:"Disconnect"}),"disapprove"===s&&a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.remove",defaultMessage:"Remove"})))))}function ge(e){let{integrationName:t}=e;return window.__c={n:"DisapproveModalTitle"},a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.title",defaultMessage:"Remove {integrationName} from approved integrations",values:{integrationName:t}})}function he(e){let{integrationName:t,disableDisconnectAll:i}=e;return a()(M.FormattedMessage,i?{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.caption",defaultMessage:"Prevent members from installing {integrationName}.",values:{integrationName:t}}:{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApprovalAndDisconnectAll.caption",defaultMessage:"Revoke access for {integrationName} for all users in this workspace and prevent members from installing {integrationName}.",values:{integrationName:t}})}function fe(e){let{integrationName:t}=e;return window.__c={n:"DisconnectAllModalTitle"},a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.modal.label",defaultMessage:"Disconnect {integrationName} for all users in workspace",values:{integrationName:t}})}function ve(e){let{integrationName:t}=e;return window.__c={n:"DisconnectAllModalCaption"},a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.modal.caption",defaultMessage:"Revoke access for {integrationName} for all users in this workspace.",values:{integrationName:t}})}function ye(e){let{integrationName:t}=e;return window.__c={n:"DisconnectUserModalTitle"},a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectUser.modal.label",defaultMessage:"Disconnect {integrationName}?",values:{integrationName:t}})}function be(e){let{integrationName:t,userName:i}=e;return window.__c={n:"DisconnectUserModalCaption"},a()(M.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectUser.modal.caption",defaultMessage:"Revoke access for {integrationName} for {userName}",values:{integrationName:t,userName:i}})}function Se(e){window.__c={n:"AdminComplianceIntegrationSettingsActionMenu"};const{webhookSubscription:t}=e,i=(0,r.Fy)(),n=(0,r.O7)(),s=(0,d.yK)((e=>({disconnect:{color:P.ZP.red}})),[]),l=(0,v.oh)(e.integrationId);if(!l)return null;const c=v.$C[l].info.developer_name;if(!c)return null;const u=new U.Z;return a()($.Z,{popupType:i.isMobile?$.Z.PopupType.SlideUp:$.Z.PopupType.Popup,renderOrigin:e=>o.createElement(z.Z,Z()({},e,{isMobile:i.isMobile,style:{marginLeft:8,marginRight:8}})),buttonPopupStore:u,render:()=>a()(Q.Z,{menuType:i.isMobile?N.og.ActionSheet:N.og.Popup,width:230},void 0,a()(X.Z,{type:X.i.Vertical,sections:[{key:"options",render:e=>o.createElement(ie.Z,e),items:[{key:"manage",action:()=>{W.Z.setState({open:!0,integrationId:e.integrationId,webhookSubscriptionId:null==t?void 0:t.id}),u.setState({open:!1})},render:e=>o.createElement(j.Z,Z()({},e,{title:a()(M.FormattedMessage,{id:"complianceIntegrationSettings.actionMenu.manage",defaultMessage:"Manage",description:"Manage an integration details"})}))},{key:"disconnect",action:()=>{const e=null==t?void 0:t.bot_id;e&&(u.setState({open:!1}),D.showDialog({items:[{label:"Disconnect",color:"red",onAccept:async()=>{await E.P0({environment:n,botId:e,onSuccess:()=>{}}),L.oV({label:a()(M.FormattedMessage,{id:"complianceIntegrationSettings.snackbar.title",defaultMessage:"{integrationName} successfully disconnected from your workspace.",description:"Success message after disconnecting integration",values:{integrationName:c}})})}}],keepFocus:!0,showCancel:!0,message:a()("b",{},void 0,a()(M.FormattedMessage,{id:"complianceIntegrationSettings.disconnectModal.title",defaultMessage:"Disconnect {integrationName}?",description:"Disconnect an integration from a workspace",values:{integrationName:c}}))}))},render:e=>o.createElement(j.Z,Z()({},e,{title:a()("span",{style:s.disconnect},void 0,a()(M.FormattedMessage,{id:"complianceIntegrationSettings.actionMenu.disconnect",defaultMessage:"Disconnect",description:"Disconnect an integration from a workspace"}))}))}]}],initialFocus:void 0}))})}var we=i(68785),Me=i(74136),Ce=i(31278),ke=i(69219),Te=i(58032),_e=i(45653),Ie=i(79826),xe=i(40235);const Ze={internal:a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.internal",defaultMessage:"INTERNAL",description:"This label indicates that an integration is internal to the workspace, as opposed to public."}),databaseSync:a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.sync",defaultMessage:"SYNC",description:"This label indicates that the integration type is database sync."}),linkPreview:a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.preview",defaultMessage:"LINK PREVIEW",description:"This label indicates that the integration type is link preview."}),importer:a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.importer",defaultMessage:"IMPORTER",description:"This label indicates that the integration type is a first-party / legacy importers."})};function Pe(e){const{integrationIdToBotIds:t,internalIntegrationIds:i,integrationIdToUsers:n}=e,s=(0,l.VK)((()=>T.default.state.currentSpaceStore),[]),r=(0,d.Fg)(),c=(0,l.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]),p=(0,l.VK)((()=>"approved_or_built_by_notion"===(null==c?void 0:c.integration_restrictions)),[c]),v=(0,l.VK)((()=>Boolean(null==c?void 0:c.integration_restrictions)),[c]),y=(0,l.VK)((()=>null!=c&&c.integration_approval_statuses?Object.keys(c.integration_approval_statuses):[]),[c]),b=y.filter((e=>!Object.keys(t).includes(e)&&!u.T2.includes(e))),S=b.some((e=>e===f.iK.google_drive.id)),w=(0,l.VK)((()=>null==s?void 0:s.id),[s]),C=t?Object.entries(t).map((e=>{let[t,i]=e;return Ae({integrationPointer:{table:g.K2,id:t},userStores:n[t],botIds:i,autoApproveBuiltByNotion:p})})):[],k=w?i.map((e=>Ae({integrationPointer:{table:m.cZ,id:e,spaceId:w},userStores:n[e],botIds:[e]}))):[],_=v?b.map((e=>Ae({integrationPointer:{table:g.K2,id:e},userStores:[],botIds:[],autoApproveBuiltByNotion:p}))):[],I=u.ns.filter((e=>!(0,h.CJ)(c)||y.includes(e.id)&&(e.id!==u._o||!S))).map((e=>function(e){const{legacyIntegration:t}=e,{id:i,name:n,info:o}=t;return{key:i,columns:[a()("div",{style:{display:"flex",alignItems:"center",maxWidth:300}},0,a()("img",{src:o.icon,style:{height:28}}),a()("div",{style:{minWidth:0,marginLeft:15}},void 0,a()("div",{style:{display:"flex"}},void 0,a()(ne.Z,{},void 0,n)),a()(ne.Z,{isSmall:!0,style:{display:"flex"}},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.legacy",defaultMessage:"Notion Connected App"})))),a()(Ne,{renderedUsers:void 0,displayUsers:!1},1),a()("div",{},2,a()(oe,{integrationId:i,isLegacy:!0,disableDisconnectAll:!0,disableDisconnectUser:!0}))]}}({botSettings:c,legacyIntegration:e}))),x=C.length+k.length+_.length+I.length;return o.createElement(o.Fragment,null,a()(xe.Z,{columns:[{key:"integration",header:a()(M.FormattedMessage,{id:"spaceConnectionsSettings.connectionsTable.connectionsColumn.title",defaultMessage:"Connection",description:"Table header for column that lists names of workspace connections"}),style:{width:"40%"}},{key:"added_by",header:a()(M.FormattedMessage,{id:"spaceConnectionsSettings.connectionsTable.creationInfoColumn.title",defaultMessage:"Users and access",description:"Table header for column that lists members who have access to a connection"})},{key:"more",header:void 0,style:{width:"5%"}}],rows:[...C,...k,..._,...I]}),0===x?a()("div",{style:{height:120,width:"100%",fontSize:12,color:r.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:`1px solid ${r.lightDividerColor}`}},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.emptyTable.message",defaultMessage:"No integration installed"})):void 0)}function Fe(e){const{botIdToWebhookSubscription:t}=e,i=(0,d.yK)((e=>({emptyTable:{height:120,width:"100%",fontSize:12,color:e.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:`1px solid ${e.lightDividerColor}`}})),[]),n=(0,l.VK)((()=>T.default.state.currentSpaceStore),[]),s=(0,l.VK)((()=>n?(0,w.m8)(Object.keys(t).map((e=>{var t;const i=_.Qx.createChildStore(n,{table:m.cZ,id:e,spaceId:n.id});return[i.id,null===(t=i.getIntegrationId())||void 0===t?void 0:t.toString()]}))):{}),[t,n]),r=Object.keys(t||[]).map((e=>{const i=s[e];if(i)return function(e){const{integrationPointer:t,botId:i,botIdToWebhookSubscription:n}=e,o=t.id,s=(0,v.oh)(o);if(!s)return;const r=v.$C[s];if(!r)return;const l=i?n[i]:void 0;return{key:`${o}:${i}`,columns:[a()(Be,{integrationTable:g.K2,integrationId:o},"integration-title"),a()(Le,{webhookSubscription:l},"integration-installer"),a()(Oe,{webhookSubscription:l},"integration-installed-at"),a()(Se,{integrationId:r.id,webhookSubscription:l},"integration-menu")]}}({integrationPointer:{table:g.K2,id:i},botId:e,botIdToWebhookSubscription:t})})).filter(y.$K);return o.createElement(o.Fragment,null,a()(xe.Z,{columns:[{key:"integration",header:a()(M.FormattedMessage,{id:"spaceConnectionsSettings.complianceConnectionsTable.connectionsColumn.title",defaultMessage:"Connection",description:"Table header for column that lists names of workspace compliance connections"}),style:{width:"40%"}},{key:"integration-installer",header:a()(M.FormattedMessage,{id:"spaceConnectionsSettings.complianceConnectionsTable.integrationInstallerColumn.title",defaultMessage:"Added by",description:"Table header for column that lists member who have added the workspace compliance connection"}),style:{width:"20%"}},{key:"integration-installed-at",header:a()(M.FormattedMessage,{id:"spaceConnectionsSettings.complianceConnectionsTable.integrationDateAdded.title",defaultMessage:"Date added",description:"Table header for column that lists the date when the workspace compliance connection was added"})},{key:"more",header:void 0,style:{width:"5%"}}],rows:r}),0===r.length?a()("div",{style:i.emptyTable},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.emptyTable.message",defaultMessage:"No integration installed"})):void 0)}function Ae(e){const{integrationPointer:t,userStores:i,botIds:n,autoApproveBuiltByNotion:o}=e;if(t.table===g.K2){const e=t.id,s=(0,f.BP)({integrationId:e,env:C.Z.env});return{key:e,columns:[a()(Be,{integrationTable:g.K2,integrationId:e},"integration-title"),a()(Ne,{renderedUsers:i,displayUsers:!s},"integration-installer-info"),a()(oe,{integrationId:e,integrationTable:g.K2,botIds:n,disableDisconnectUser:s||void 0,disableDisallow:s&&o},"admin-integration-settings-menu")]}}if(t.table===m.cZ)return{key:t.id,columns:[a()(Be,{integrationTable:m.cZ,integrationId:t.id},"integration-title"),a()(Ne,{renderedUsers:i,displayUsers:!1},"integration-installer-info"),a()(Ie.Z,{botId:t.id},"integration-settings-menu")]};(0,y.t1)(t)}function Be(e){window.__c={n:"IntegrationTitle"};const{integrationId:t,integrationTable:i}=e,n=(0,l.VK)((()=>T.default.state.currentSpaceStore),[]),o=(0,l.VK)((()=>{if(n)return n.getRecordValue({table:i,id:t})}),[n,t,i]);if(!o)return a()(we.Z,{});let s;const r=[];let d;if(i===m.cZ){const e=o;e.icon&&(s={pointer:{table:i,id:t},icon:e.icon}),r.push("internal"),d=a()(Ee,{botId:e.id})}else if(i===g.K2){const e=o;e.info.icon&&(s={pointer:{table:i,id:t},icon:e.info.icon}),(0,u.mo)(e)&&(r.push("linkPreview"),(0,u.zc)(e)&&r.push("databaseSync")),d=a()(De,{integrationId:e.id})}else(0,y.t1)(i);return a()("div",{style:{display:"flex",alignItems:"center",maxWidth:300}},void 0,a()(Ce.Z,{disabled:!0,icon:s,title:o.name,isEmptyPage:!1,size:28,isLarge:!0,useInvertedColors:!0}),a()("div",{style:{minWidth:0,marginLeft:15}},void 0,a()("div",{style:{display:"flex",marginRight:16}},void 0,a()(ne.Z,{},void 0,o.name),r.map((e=>e&&a()(Me.Z,{desktopStyle:{marginLeft:4}},void 0,Ze[e])))),d))}const Ee=e=>{let{botId:t}=e;window.__c={n:"InternalIntegrationDeveloperName"};const i=(0,l.VK)((()=>T.default.state.currentSpaceStore),[]),n=(0,M.useIntl)(),o=(0,l.VK)((()=>null==i?void 0:i.getRecordValue({table:m.cZ,id:t})),[i,t]),s=(0,l.VK)((()=>{if(i&&o)return i.getRecordValue({table:o.created_by_table,id:o.created_by_id})}),[i,o]);if(s){const e=(0,S.Nz)(n,s);return a()(ne.Z,{className:"notranslate",isSmall:!0},void 0,e)}return a()(Re,{})},De=e=>{let{integrationId:t}=e;window.__c={n:"PublicIntegrationDeveloperName"};const i=(0,l.VK)((()=>T.default.state.currentSpaceStore),[]),n=(0,d.Fg)(),s=(0,l.VK)((()=>{const e=null==i?void 0:i.getRecordValue({table:g.K2,id:t});return null==e?void 0:e.info.developer_name}),[i,t]);return(0,f.BP)({integrationId:t,env:C.Z.env})?a()(ne.Z,{isSmall:!0,style:{display:"flex",alignItems:"center"}},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.notion",defaultMessage:"Notion {icon}",values:{icon:a()(Te.Z,{renderTooltip:()=>a()("div",{},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfo.notion.tooltip",defaultMessage:"Developed by Notion"})),placement:Te.Z.Placement.Right,render:e=>o.createElement("div",e,c.Z.integrationSecurity({width:12,height:12,fill:n.invoiceGreen}))})}})):s?a()(ne.Z,{className:"notranslate",isSmall:!0},void 0,s):a()(Re,{})},Re=()=>(window.__c={n:"UnknownDeveloperName"},a()(ne.Z,{isSmall:!0},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.label.unverifiedDeveloper",defaultMessage:"Unverified developer",description:"The placeholder name of an integration developer if a name is not provided"})));function Le(e){window.__c={n:"AdminComplianceInstaller"};const{webhookSubscription:t}=e,i=(0,M.useIntl)(),n=(0,l.VK)((()=>{const e=T.default.state.currentSpaceStore;if(!e)return;const i=t?{id:t.created_by_id,table:t.created_by_table}:void 0;return e&&i?I.U.createChildStore(e,i):void 0}),[t]),o=(0,l.VK)((()=>null==n?void 0:n.getDisplayName(i)),[n,i]);return n&&o?a()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:8,alignItems:"center",width:"100%"}},void 0,a()(_e.Z,{userStore:n,size:18}),a()(ne.Z,{},void 0,o)):null}function Oe(e){window.__c={n:"AdminComplianceInstalledAt"};const{webhookSubscription:t}=e;return t?a()(ke.i,{useThinTitle:!0,title:(0,p.Yx)(Number(null==t?void 0:t.created_time),"medium_with_time",s.SP)}):null}function Ne(e){window.__c={n:"IntegrationInstallerInfo"};const{renderedUsers:t,displayUsers:i}=e,n=(0,l.VK)((()=>T.default.state.currentSpaceStore),[]),s=(0,M.useIntl)(),d=(0,r.O7)(),c=(0,l.VK)((()=>{if(n)return(0,k.rn)(d,n)}),[d,n]),u=(0,o.useMemo)((()=>t&&t.length),[t]),p=(0,l.VK)((()=>t&&t.length>0?t[0]:void 0),[t]),m=(0,l.VK)((()=>p?p.getDisplayName(s):void 0),[p,s]);return i&&void 0!==u?p?a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()(_e.Z,{userStore:p,avatarShouldShowShadow:!0,style:{marginRight:8},size:28}),a()(ne.Z,{},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.listOfUsers",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} +{remainingCount}} other {{firstUser} +{remainingCount}}}",values:{firstUser:m,remainingCount:u-1}}))):a()(ne.Z,{isSecondaryColor:!0,style:{display:"flex",alignItems:"center"}},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.noUsers",defaultMessage:"No users"})):a()(ne.Z,{style:{display:"flex",alignItems:"center"}},void 0,a()(M.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.anyone",defaultMessage:"Anyone in {spaceName}",values:{spaceName:a()(ne.Z,{style:{fontWeight:b.Z.fontWeight.medium}},void 0,c)}}))}},5592:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Qr});var n=i(77094),a=i.n(n),o=i(67294),s=i(83355),r=i(23537),l=i(81954),d=i(41046),c=i(77907),u=i(73008);const p={position:"fixed",right:"calc(50% - 160px)",bottom:0,width:"320px",color:"white",background:"rgba(0, 0, 0, 0.75)",padding:"8px"},m={fontWeight:600,fontSize:"14px"};function g(e){window.__c={n:"MessageStoreDebugPanel"};const t=(0,l.Kw)(u.Z).open;return a()(d.Z,{open:t},void 0,a()("div",{style:p},void 0,a()("div",{style:m},void 0,"MessageStore metrics"),a()(c.LazyMessageStoreDebugChart,{width:304,height:64})))}var h=i(27832),f=i(19671),v=i(13023),y=i(41464),b=i(54564),S=i(10663),w=i(45094),M=i(24229),C=i(41432),k=i(5366),T=i(78089),_=i(60709),I=i(65598),x=i(34859),Z=i(85908),P=i(97543),F=i(36488),A=i(72897),B=i(3386),E=i(78140),D=i(40721),R=i(37064),L=i(66957);const O=[M.u.Open,M.u.Resolved];class N extends s.Z{constructor(){super(...arguments),this.deepDiscussionsStores=this.createComputedStore((()=>{const{discussionIds:e}=this.props,{blockStore:t,recursivelyLoadAllDiscussions:i}=this.props;return I.al(t,{recursivelyLoadAllDiscussions:i}).filter((t=>!e||e.includes(t.id)||(0,T.De)(t)))})),this.handleChangeTab=e=>{const t=M.Z.state;t.open&&M.Z.setState({...t,tab:O[e]})},this.handleBackspace=e=>{null==e||e.preventDefault(),b.LZ()}}renderComponent(){if((0,w.Sx)(this.environment))return null;const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:_.og.Modal,title:a()(k.FormattedMessage,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:this.renderMenuHeader(),right:a()(D.DoneMenuText,{}),onClickRight:b.LZ,whiteBackground:!0}:{menuType:_.og.Popup,header:this.renderMenuHeader(),width:480,maxHeight:"50vh",onClickOutside:b.LZ},a()(A.Z,{capture:!0,preventType:x.Z.All},void 0,a()(F.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>a()(B.Z,{capture:!0,onEsc:b.LZ,onBackspace:this.handleBackspace,onDelete:this.handleBackspace},void 0,a()(R.Z,{store:this.props.blockStore,droppable:!0,render:()=>o.createElement(E.Z,t,this.renderMenuContent())},this.props.blockStore.id))}))}renderMenuHeader(){const{device:e}=this.environment,{resolved:t,unresolved:i}=I.bB(this.deepDiscussionsStores.state),n=i.length,o=t.length;return 0===o||0===n?null:a()(L.Z,{tabs:[a()(k.FormattedMessage,{defaultMessage:"Open ({numberOfOpenDiscussions})",id:"blockDiscussionMenu.openDiscussionsTab.title",values:{numberOfOpenDiscussions:n}}),a()(k.FormattedMessage,{defaultMessage:"Resolved ({numberOfResolvedDiscussions})",id:"blockDiscussionMenu.resolvedDiscussionsTab.title",values:{numberOfResolvedDiscussions:o}})],selectedIndex:O.indexOf(this.props.tab),onChange:this.handleChangeTab,style:{...e.isAndroid&&{borderBottom:"none"}}})}renderMenuContent(){const{device:e}=this.environment,{resolved:t,unresolved:i}=I.bB(this.deepDiscussionsStores.state);if(this.props.tab===M.u.Open){if(i.length){const t=i.map(((e,t,i)=>a()(P.Z,{store:e,format:T.O2.Menu,isFirst:0===t,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:b.LZ},e.id))),n=this.props.blockStore.getType(),s=n&&C.p2[n];if(e.isMobile&&s){const e=Z.h(this.props.blockStore);return e?a()(o.Fragment,{},void 0,a()("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1}},void 0,a()(e,{store:this.props.blockStore,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})),t):t}return t}return this.renderEmptyState(a()(k.FormattedMessage,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"}))}return t.length?t.map(((e,t,i)=>a()(P.Z,{store:e,format:T.O2.Menu,isFirst:0===t,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:b.LZ},e.id))):this.renderEmptyState(a()(k.FormattedMessage,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"}))}renderEmptyState(e){const{device:t}=this.environment;return a()("div",{style:{textAlign:"center",padding:t.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:this.theme.mediumTextColor}},void 0,e)}}N.displayName="BlockDiscussionMenu";const V=N;var U=i(44532);class W extends s.Z{constructor(){super(...arguments),this.renderDiscussionMenu=()=>{if(M.Z.state.open&&!(0,w.Sx)(this.environment))return a()(V,{rect:M.Z.state.rect,tab:M.Z.state.tab,blockStore:M.Z.state.blockStore,discussionIds:M.Z.state.discussionIds,recursivelyLoadAllDiscussions:M.Z.state.recursivelyLoadAllDiscussions})}}renderComponent(){const{device:e}=this.environment,{rect:t}=M.Z.state,i=!(0,w.Sx)(this.environment)&&M.Z.state.open&&!(0,S.az)(this.environment,M.Z.state.blockStore);return a()(U.ZP,{popupType:e.isMobile?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:i,originRect:t,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Center,disableMouseCapture:!0,originGap:4,render:this.renderDiscussionMenu,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:b.LZ})}}W.displayName="BlockDiscussionMenuPopup";const z=W;var K=i(96486),q=i.n(K),H=i(29369),G=i(50906),j=i(6404),$=i(75079),Y=i(33665),Q=i(35328),X=i(8949),J=i(85057),ee=i(27724),te=i(48494),ie=i(80209),ne=i(48019),ae=i(68894),oe=i(72495),se=i(83182);class re extends s.Z{constructor(){super(...arguments),this.renderOverlay=()=>{const{device:e}=this.environment,t=X.Z.state;if(!t.isActive)return;const{originBlockRect:i,actions:n,inputValue:s,publicEditMode:r}=t,l={environment:this.environment,blocks:t.stores,originRect:i,publicEditMode:r},d=t.showInput&&this.renderInputSection(),c=t.stores[0];let u;return u=e.isPhone?{menuType:_.og.Modal,title:a()(k.FormattedMessage,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:a()(D.DoneMenuText,{}),onClickRight:this.handleOverlayBgClick,header:d}:{menuType:_.og.Popup,width:265,header:d},a()(B.Z,{capture:!0,onBackspace:q().identity},void 0,o.createElement(E.Z,u,a()(ne.Z,{filter:s,context:l,sections:n,onAccept:this.handleAccept,initialFocus:s?0:void 0}),!s&&this.renderBlockAuthorInfo(),!s&&a()(ie.Z,{store:c}),!s&&c.isCollectionView()&&this.renderCollectionHelpButton()))},this.handleOverlayBgClick=()=>{j.xv()},this.handleAccept=e=>{const t=X.Z.state;if(!t.isActive)return;const{stores:i}=ee.default.state,{analyticsFrom:n,collectionContextStore:a}=t,o=i[0];if(o){const t=o.getParentTable(),i=o.getType();if(i&&t){let s;if(t===H.e0){const e=o.getParentId(),{currentSpaceStore:t}=h.default.getState();t&&void 0!==e&&(s=J.zX.createChildStore(t,{table:H.e0,id:e}))}const r=(0,$.Pn)(a)||{};G.dhV(this.environment,{analyticsName:e.analyticsName,from:n,block_id:o.id,block_type:i,parentTeamStore:s,is_toggleable:(0,Q._A)(i,o.getFormat()),...r})}}e.closeParentMenu&&j.xv()},this.handleInputChange=e=>{X.Z.state.isActive&&X.Z.setState({...X.Z.state,inputValue:e.target.value})}}renderComponent(){const{device:e}=this.environment,t=X.Z.state;return a()(U.ZP,{popupType:e.isPhone?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:this.handleOverlayBgClick,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Start,originGap:0,preventScaleTransition:!0,render:this.renderOverlay,preventBlockRenderQueueOnEnter:e.isMobile})}renderBlockAuthorInfo(){const e=X.Z.state;if(e.isActive&&!(e.stores.length>1))return a()(te.Z,{store:e.stores[0],isPageMoreButton:!1})}renderInputSection(){const{device:e}=this.environment,{intl:t}=this.props,i=X.Z.state;if(!i.isActive||e.isPhone)return;const{inputValue:n}=i;return a()(oe.Z,{isInput:!0},void 0,a()(ae.ZP,{value:n,onChange:this.handleInputChange,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0}))}renderCollectionHelpButton(){return a()(oe.Z,{topBorder:!0},void 0,a()(se.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,Y.UY)("guides.database"),analyticsFrom:"block_menu"}))}}re.displayName="BlockMenu";const le=(0,k.injectIntl)(re);var de=i(97464),ce=i.n(de),ue=i(62965),pe=i(79554),me=i(43250),ge=i(33929),he=i(61207),fe=i(52275),ve=i(9342);const ye=(0,k.defineMessages)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"}});class be extends s.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=he.Z.state;if(!t.open)return;const i=this.getSections(t);let n;return n=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:320,maxHeight:"40vh"},o.createElement(E.Z,ce()({},n,{className:me.srZ}),a()(ve.Z,{type:ve.i.Vertical,sections:i,initialFocus:0}))},this.handleDismiss=()=>{pe.xv()}}willMountOrUpdate(){const e=he.Z.state;if(e.open){const{stores:t,phase:i}=ee.default.state;(0,ue.Z)(t,e.blocks)&&i===ee.SelectionPhase.Selected||pe.xv()}}renderComponent(){const{device:e}=this.environment,t=he.Z.state;return a()(U.ZP,{popupType:e.isMobileNative&&!e.isTablet?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.rect:void 0,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}getSections(e){const{blocks:t}=e,i=[];if("blocks"===e.type){const{copiedStores:n,pageSource:a}=e;pe.H8({blocks:t,copiedStores:n})&&i.push({name:ge.default.formatMessage(ye.createTransclusion),action:async()=>{await pe.ry({environment:this.environment,blocks:t,copiedBlockIds:n.map((e=>e.id))})}}),pe.wK({blocks:t})&&i.push({name:ge.default.formatMessage(ye.linkToPage),action:async()=>pe.Dq({environment:this.environment,blocks:t,source:{type:"blocks",copiedStores:n,pageSource:a}})})}"links"===e.type&&i.push({name:ge.default.formatMessage(ye.linkToPage),action:async()=>pe.Dq({environment:this.environment,blocks:t,source:{type:"links",copiedLinks:e.copiedLinks}})});return[{key:"embed section",render:e=>o.createElement(oe.Z,e),items:[{key:"dismiss",render:e=>o.createElement(fe.Z,ce()({},e,{title:ge.default.formatMessage(ye.dismissItem)})),action:this.handleDismiss},...i.map((e=>{let{name:t,action:i}=e;return{key:`embed ${t}`,render:e=>o.createElement(fe.Z,ce()({},e,{title:t})),action:i}}))]}]}}be.displayName="BlockPasteMenu";const Se=be;var we=i(87143),Me=i(74194),Ce=i(64369);class ke extends s.Z{constructor(){super(...arguments),this.handleOverlayBgClick=e=>{we.Z.setState({...we.Z.state,active:!1,stringValue:""})}}renderComponent(){const{device:e}=this.environment,{active:t,stringValue:i}=we.Z.state,n=window.innerWidth/2-150,o=window.innerHeight/2;return a()(U.ZP,{popupType:e.isMobileNative?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:t,originRect:{top:o,left:n},onDismiss:this.handleOverlayBgClick,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Start,originGap:0,render:()=>a()(B.Z,{capture:!0,onEnter:q().identity,onCommandEnter:q().identity,onCommandShiftEnter:q().identity,onCommandSlash:q().identity,onDelete:q().identity,onBackspace:q().identity,onEsc:q().identity,onLeft:q().identity,onRight:q().identity,onUntab:q().identity,onTab:q().identity,onSelectAll:q().identity,onRedo:q().identity,onUndo:q().identity,onToggleBold:q().identity,onToggleItalics:q().identity,onToggleStrike:q().identity,onToggleCode:q().identity,onCut:q().identity,onCopy:q().identity,onPaste:q().identity,onKeypress:q().identity},void 0,a()("div",{style:{padding:8,width:300}},void 0,a()(Me.Z,{style:{width:"100%",fontSize:12},value:i,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),a()(Ce.Z,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"}},void 0,a()(k.FormattedMessage,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"}))))})}}ke.displayName="ClipboardInputRenderer";const Te=ke;var _e=i(83848),Ie=i(480),xe=i(24405),Ze=i(7476),Pe=i(13884),Fe=i(56940),Ae=i(62518),Be=i(35431);class Ee extends Be.Z{}const De=new Ee;var Re=i(49085);class Le extends Re.Z{getInitialState(){return{}}}const Oe=Le;class Ne extends s.Z{constructor(){super(...arguments),this.storeTypes={store:Oe},this.rootNode=void 0,this.observer=void 0,this.handleMutation=()=>{if(this.rootNode){const e=this.rootNode.getBoundingClientRect();this.stores.store.setState({rect:e})}}}get registries(){return[De]}didMount(){this.props.capture&&this.startListeners()}willUpdate(e){e.capture&&!this.props.capture?this.startListeners():!e.capture&&this.props.capture&&this.stopListeners()}willUnmount(){this.stopListeners()}startListeners(){const e=Ae.findDOMNode(this);e&&(this.rootNode=e,this.observer=new MutationObserver(this.handleMutation),this.observer.observe(this.rootNode,{attributes:!0,subtree:!0}))}stopListeners(){this.observer&&(this.observer.disconnect(),this.rootNode=void 0,this.observer=void 0)}renderComponent(){return o.Children.only(this.props.children)}}Ne.displayName="SlideUpInputArea";const Ve=Ne;var Ue=i(19195);const We=function(){window.__c={n:"NewDiscussionMenu"};const e=(0,Ie.O7)(),{device:t,WindowSizeStore:i}=e,n=(0,l.VK)((()=>Pe.Z.state.rect),[]),o=(0,l.VK)((()=>{if(Pe.Z.state.open){const{blockStore:t,discussionInputStore:i}=Pe.Z.state;return{blockStore:t,discussionInputStore:i,canMarginCommentsRender:(0,S.az)(e,t)}}return null}),[e]),s=(0,l.VK)((()=>({paddingLeft:t.isMobileNative?i.getSafePaddingLeftCSS(10):10,paddingRight:t.isMobileNative?i.getSafePaddingRightCSS(10):10})),[i,t.isMobileNative]),r=(0,xe.yK)((()=>({inputWrapper:{width:t.isMobileNative?"100%":470,maxWidth:t.isMobileBrowser?"90vw":"100%",paddingTop:8,paddingBottom:t.isAndroid?12:8,paddingLeft:s.paddingLeft,paddingRight:s.paddingRight}})),[t,s]),d=()=>{Ze.ZL(e)},c=()=>{o&&Ze.uK(o.discussionInputStore,e)};return null!=o&&o.canMarginCommentsRender?null:a()(U.ZP,{popupType:t.isMobileNative?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,keepFocus:!0,open:null!==o,originRect:n,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Center,originGap:4,onDismiss:c,render:()=>{if(o){const{blockStore:e,discussionInputStore:t}=o;return a()(Fe.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>a()(Ve,{capture:!0},void 0,a()(F.Z,{capture:!0,allowOpenLinkMenu:!0,render:()=>a()(R.Z,{store:e,droppable:!0,render:()=>a()("div",{style:r.inputWrapper},void 0,a()(Ue.Z,{showAvatar:!0,parentStore:e,onCancel:c,onSubmit:d,discussionInputStore:t,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:T.O2.Page,blockStore:e,canDrop:!0}))},e.id)}))})}}})};var ze=i(51454),Ke=i(86080),qe=i(47307),He=i(81700),Ge=i(22346),je=i(63296);class $e extends s.Z{constructor(){super(...arguments),this.lastOpenState=void 0,this.renderModal=()=>{if(!this.lastOpenState)return;const{acceptLabel:e,requiredInputValue:t}=this.lastOpenState,i=[{key:"accept",render:t=>o.createElement(je.Z,ce()({isRed:!0,isLarge:!0,style:$e.buttonStyle,hovered:t.focused},t),e),action:this.handleAccept},{key:"cancel",render:e=>o.createElement(je.Z,ce()({isLarge:!0,style:$e.buttonStyle,hovered:e.focused},e),a()(k.FormattedMessage,{id:"confirmationInputDialog.cancelButton.label",defaultMessage:"Cancel"})),action:this.handleCancel}];return a()(A.Z,{capture:!0,preventType:x.Z.All},void 0,a()("div",{},void 0,a()("div",{style:{minHeight:64,display:"flex",alignItems:"center",justifyContent:"center",marginBottom:16}},void 0,this.lastOpenState.message),a()(B.Z,{capture:!0,onLeft:q().identity,onRight:q().identity,onSelectAll:q().identity,onRedo:q().identity,onUndo:q().identity,onToggleBold:q().identity,onToggleItalics:q().identity,onToggleCode:q().identity,onCut:q().identity,onCopy:q().identity,onPaste:q().identity,onKeypress:q().identity,onDelete:q().identity,onBackspace:q().identity},void 0,a()(Me.Z,{value:this.lastOpenState.inputValue,onChange:this.handleInputChange,style:{height:38,marginBottom:2},placeholder:t})),a()(ve.Z,{type:ve.i.Vertical,initialFocus:void 0,sections:[{key:"dialog",render:e=>o.createElement(oe.Z,e),items:i}]})))},this.handleAccept=()=>{const e=He.Z.state;e.open&&(this.cleanAcceptInput(e.inputValue)===this.cleanAcceptInput(e.requiredInputValue)?Ke.x({didConfirm:!0}):qe.showErrorMessage(a()(k.FormattedMessage,{id:"confirmDialogInput.incorrectInputError.message",defaultMessage:'Please type "{requiredInputValue}" to continue',values:{requiredInputValue:e.requiredInputValue}})))},this.cleanAcceptInput=e=>e.trim().toLowerCase().replace(/’/g,"'"),this.handleCancel=()=>{Ke.x({didConfirm:!1})},this.handleInputChange=e=>{const t=He.Z.state;t.open&&He.Z.setState({...t,inputValue:e.target.value})}}renderComponent(){const e=He.Z.state;return e.open&&(this.lastOpenState={...e}),a()(Ge.Z,{open:e.open,keepFocus:!0,overlayZIndex:ze.Wd,onDismiss:this.handleCancel,preventHideChildrenWhileOpening:!0,innerStyle:{borderRadius:3,paddingTop:24,paddingBottom:16,paddingLeft:32,paddingRight:32,width:this.lastOpenState&&this.lastOpenState.width||336,fontSize:16,boxShadow:this.theme.largeBoxShadow,background:this.theme.modalBackground,maxHeight:"90vh",overflowY:"scroll",marginLeft:24,marginRight:24},render:this.renderModal})}}$e.displayName="ConfirmInputDialogRenderer",$e.buttonStyle={width:"100%",marginTop:16};const Ye=$e;var Qe=i(55367),Xe=i(8958);class Je extends s.Z{constructor(){super(...arguments),this.renderGhost=()=>{const e=Qe.ZP.state;if(!e.isDragging)return;const t=e.draggedStores.map(((t,i)=>a()(Xe.Z,{store:t,ghostElement:e.ghostElements[i]},`${i}`)));return a()("div",{style:this.getGhostStyle()},void 0,t)},this.isDragging=this.createComputedStore((()=>Qe.ZP.state.isDragging))}renderComponent(){return a()(d.Z,{open:this.isDragging.state},void 0,this.renderGhost())}getGhostStyle(){const e=Qe.ZP.state;if(!e.isDragging)return;const{startX:t,startY:i,currentX:n,currentY:a}=e;return{position:"absolute",top:0,left:0,transform:`translate3d(${n-t}px, ${a-i}px, 0)`}}}Je.displayName="DragOverlay";const et=Je;var tt=i(12534),it=i(12768);class nt extends s.Z{constructor(){super(...arguments),this.handleContextMenu=e=>{const{device:t}=this.environment;t.isAndroid||it.default.isOnboarding||(0,tt.ZP)({event:e,context:tt.Af.EditorContextMenu,callback:()=>{t.isElectron||this.environment.currentUser.isLoggedIn()&&e.preventDefault()}})},this.handleDragStart=e=>{e.preventDefault()}}didMount(){window.addEventListener("contextmenu",this.handleContextMenu),window.addEventListener("dragstart",this.handleDragStart)}willUnmount(){window.removeEventListener("contextmenu",this.handleContextMenu),window.removeEventListener("dragstart",this.handleDragStart)}}nt.displayName="PreventDefaultListener";const at=nt;var ot=i(70203),st=i(67133),rt=i(9953),lt=i(30149),dt=i(28020),ct=i(28748);class ut extends s.Z{constructor(){super(...arguments),this.handleChangeValue=e=>{if(!e)return void this.removeDateAnnotation();const t=this.getEverythingIWant();if(!t)return;const{date_format:i,time_format:n}=t;this.setDateAnnotationData({date_format:i,time_format:n,...e})},this.handleChangeDateFormat=e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:i,time_format:n}=t;this.setDateAnnotationData({date_format:e,time_format:n,...i})},this.handleChangeTimeFormat=e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:i,date_format:n}=t;this.setDateAnnotationData({date_format:n,time_format:e,...i})},this.setDateAnnotationData=e=>{const t=this.getEverythingIWant();if(!t)return;const{textStore:i,textValue:n,tokenIndex:a,annotations:o}=t,s=n.map(((t,i)=>{if(i===a){const i=o.map((t=>ot.fp(t)?["d",e]:t));return ot.V3(t[0],i)}return t}));lt.createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:this.environment,perform:e=>{rt.sO({store:i,value:s,transaction:e})}})},this.removeDateAnnotation=()=>{const e=this.getEverythingIWant();if(!e)return;const{textStore:t,textValue:i,tokenIndex:n}=e,a=i.filter(((e,t)=>t!==n));lt.createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:this.environment,perform:e=>{rt.sO({store:t,value:a,transaction:e})}})}}renderComponent(){const{device:e}=this.environment,t=ct.Z.state;return a()(U.ZP,{popupType:e.isMobile?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:t.open,originRect:t.originRect,onDismiss:st.x,render:()=>{const e=this.getEverythingIWant();if(!e)return null;const{date_format:i,time_format:n,dateValue:o}=e;return a()(c.DependencyConsumer,{dependency:c.deps.menus},void 0,(e=>{let{DatePropertyMenu:s}=e;return a()(s,{firstDayOfWeek:dt.AK.state,value:o,canConfigureCollection:!0,onChangeValue:this.handleChangeValue,dateFormat:i,onChangeDateFormat:this.handleChangeDateFormat,timeFormat:n,onChangeTimeFormat:this.handleChangeTimeFormat,onDismiss:st.x,disabled:!1,shouldShowReminder:!!t.open&&t.allowReminders})}))}})}getEverythingIWant(){const e=ct.Z.state;if(e.open){const{textStore:t,tokenIndex:i}=e,n=t.getValue();if(n){const e=n[i];if(e){const a=ot.hD(e),o=ot.K9(a);if(o){const{date_format:s,time_format:r,...l}=ot.Ot(o);return{textStore:t,textValue:n,tokenIndex:i,token:e,annotations:a,date_format:s,time_format:r,dateValue:l}}}}}}}ut.displayName="DateMentionMenu";const pt=ut;var mt=i(1302),gt=i(32739),ht=i(84908),ft=i(98104),vt=i(95477),yt=i(68056),bt=i(72133),St=i(758),wt=i(81212);class Mt extends Re.Z{getInitialState(){return{open:!1}}}const Ct=new Mt;var kt=i(24666),Tt=i(93405),_t=i(1743);class It extends s.Z{constructor(){super(...arguments),this.handleContextMenu=(e,t)=>{if(e.preventDefault(),t.misspelledWord){const e=kt.default.state,i="editing"===e.mode&&(0,yt.QY)(e.multiSelection);if(i&&i.selection.startIndex===i.selection.endIndex){const e=ot.Oq(i.store.getValue()||[],t.misspelledWord),n=i.selection.startIndex,a=ot.PE(e,n);a&&ft.Z5({store:i.store,selection:a})}}Ct.setState({open:!0,menuInfo:t})},this.handleDismiss=()=>{Ct.setState({...Ct.state,open:!1})}}willMount(){ht.electronApi&&ht.electronApi.contextMenu&&ht.electronApi.contextMenu.addListener(this.handleContextMenu)}willUnmount(){ht.electronApi&&ht.electronApi.contextMenu&&ht.electronApi.contextMenu.removeListener(this.handleContextMenu)}renderComponent(){const{menuInfo:e,open:t}=Ct.state,{device:i}=this.environment,{x:n,y:o}=this.getClickPosition(e),s=new DOMRect(n,o,0,0),r=e?this.getMenuSections(e):[],l=document.activeElement,d=bt.get();let c=null,u=null;(l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement)&&(c=l.selectionStart,u=l.selectionEnd);for(const a of r)for(const e of a.items){const t=e.action;e.action=e=>{l.focus(),l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement?(l.selectionStart=c,l.selectionEnd=u):d&&bt.set(d,i),mt.default.afterNextFlush((()=>{t(e)}))}}return a()(U.ZP,{open:t&&r.length>0,popupType:U.ZP.PopupType.Popup,originRect:s,render:()=>a()(_t.Z,{capture:!0,allowEsc:!0},void 0,a()(E.Z,{menuType:_.og.Popup},void 0,a()(ve.Z,{type:ve.i.Vertical,sections:r,initialFocus:void 0,onAccept:this.handleDismiss}))),onDismiss:this.handleDismiss,overlayContainerStore:wt.Z})}getClickPosition(e){const t=ht.getCurrentZoom();return{x:e?e.x/t:0,y:e?e.y/t:0}}getMenuSections(e){const t=[],i=this.getSpellingCorrectionItems(e);if(i.length>0){const e=t.length>0;t.push({key:"spellingCorrectionItems",items:i,render:t=>o.createElement(oe.Z,ce()({},t,{topBorder:e}))})}const n=this.getDisableSpellCheckItems(e);if(n.length>0){const e=t.length>0;t.push({key:"disableSpellCheckItems",items:n,render:t=>o.createElement(oe.Z,ce()({},t,{topBorder:e}))})}const a=this.getSearchItems(e);if(a.length>0){const e=t.length>0;t.push({key:"searchItems",items:a,render:t=>o.createElement(oe.Z,ce()({},t,{topBorder:e}))})}const s=this.getLinkMenuItems(e);if(s.length>0){const e=t.length>0;t.push({key:"linkMenuItems",items:s,render:t=>o.createElement(oe.Z,ce()({},t,{topBorder:e}))})}const r=this.getImageMenuItems(e);if(r.length>0){const e=t.length>0;t.push({key:"imageMenuItems",items:r,render:t=>o.createElement(oe.Z,ce()({},t,{topBorder:e}))})}const l=this.getTextEditingItems(e);if(l.length>0){const e=t.length>0;t.push({key:"textEditingItems",items:l,render:t=>o.createElement(oe.Z,ce()({},t,{topBorder:e}))})}const d=this.getEnableSpellCheckItem(e);if(d.length>0){const e=t.length>0;t.push({key:"enableSpellCheckItems",items:d,render:t=>o.createElement(oe.Z,ce()({},t,{topBorder:e}))})}return t}getLinkMenuItems(e){const t=[];return e.linkURL&&e.linkURL.length>0&&(e.linkURL.startsWith("mailto:")?t.push({key:"copy-email",action:()=>{ht.electronApi&&ht.electronApi.copyText&&ht.electronApi&&ht.electronApi.copyText(e.linkText)},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Copy email address",id:"desktop.rightClickMenu.copyEmailAddress"})}))}):t.push({key:"copy-link",action:()=>{ht.electronApi&&ht.electronApi.copyText&&ht.electronApi&&ht.electronApi.copyText(gt.b({url:e.linkURL,domainBaseUrl:vt.Z.domainBaseUrl,protocol:vt.Z.protocol}))},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Copy link",id:"desktop.rightClickMenu.copyLink"})}))}),t.push({key:"open-link",action:()=>{ht.electronApi&&ht.electronApi.openExternalUrl(gt.b({url:e.linkURL,domainBaseUrl:vt.Z.domainBaseUrl,protocol:vt.Z.protocol}))},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Open link in browser",id:"desktop.rightClickMenu.openLinkInBrowser",description:"Option in right click menu for a link that lets the user open it in the browser"})}))})),t}getImageMenuItems(e){const t=[];return e.hasImageContents&&e.srcURL&&e.srcURL.length>0&&(t.push({key:"copy-image",action:()=>{ht.electronApi&&ht.electronApi.copyImage&&ht.electronApi.copyImage(e.srcURL)},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Copy image",id:"desktop.rightClickMenu.copyImage"})}))}),t.push({key:"copy-image-address",action:()=>{ht.electronApi&&ht.electronApi.copyText&&ht.electronApi.copyText(e.srcURL)},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Copy image address",id:"desktop.rightClickMenu.copyImageAddress"})}))})),t}isEditing(e){return e.isEditable||e.inputFieldType&&"none"!==e.inputFieldType}hasMisspelling(e){return this.isEditing(e)&&e.misspelledWord&&e.misspelledWord.length>0}getSpellingCorrectionItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,i=[];if(this.hasMisspelling(e)&&t&&t.isEnabled()){const n=t.getCorrections(e);for(const e of n)i.push({key:e,action:()=>{ht.electronApi&&ht.electronApi.replaceMisspelling&&ht.electronApi.replaceMisspelling(e)},render:t=>o.createElement(fe.Z,ce()({},t,{title:e}))})}return i}getDisableSpellCheckItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,i=[];return this.hasMisspelling(e)&&t&&t.isEnabled()&&!(0,St.x)(t)&&i.push({key:"learn-spelling",action:()=>{t.addToDictionary(e.misspelledWord)},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Add to dictionary",id:"desktop.spellcheckMenuItem.addToDictionary.title",description:"Option in right click menu for a misspelled word that lets the user add it to the dictionary"})}))}),this.hasMisspelling(e)&&t&&t.isEnabled()&&i.push({key:"disable",action:()=>{t.setEnabled(!1)},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Disable spell check",id:"desktop.spellcheckMenuItem.disableSpellcheck.title"})}))}),i}getEnableSpellCheckItem(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,i=[];return this.isEditing(e)&&t&&!t.isEnabled()&&i.push({key:"enable",action:()=>{t.setEnabled(!0)},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Enable spell check",id:"desktop.spellcheckMenuItem.enableSpellcheck.title"})}))}),i}getSearchItems(e){const t=[];return e.selectionText&&e.selectionText.length>0&&t.push({key:"google",action:()=>{if(ht.electronApi){const t=`https://www.google.com/search?q=${encodeURIComponent(e.selectionText.trim())}`;ht.electronApi.openExternalUrl(t)}},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Search with Google",id:"desktop.searchMenuItem.searchWithGoogle.title"})}))}),t}getTextEditingItems(e){const t=[];return this.isEditing(e)&&(e.editFlags.canCut&&t.push({key:"cut",action:()=>{ht.electronApi&&ht.electronApi.cut&&ht.electronApi.cut()},render:e=>o.createElement(Tt.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Cut",id:"desktop.textEditingMenuItem.cutAction.title"}),shortcuts:["cut"]}))}),e.editFlags.canCopy&&t.push({key:"copy",action:()=>{ht.electronApi&&ht.electronApi.copy&&ht.electronApi.copy()},render:e=>o.createElement(Tt.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Copy",id:"desktop.textEditingMenuItem.copyAction.title"}),shortcuts:["copy"]}))}),e.editFlags.canPaste&&t.push({key:"paste",action:()=>{ht.electronApi&&ht.electronApi.paste&&ht.electronApi.paste()},render:e=>o.createElement(Tt.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Paste",id:"desktop.textEditingMenuItem.pasteAction.title"}),shortcuts:["paste"]}))})),t}}It.displayName="ElectronContextMenu";const xt=It;var Zt=i(95538),Pt=i(80984),Ft=i(21202),At=i(63143),Bt=i(89951),Et=i(64233),Dt=i(10161),Rt=i(88923);const Lt=(0,k.defineMessages)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Map",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Create embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing",description:"Unlikely to ever be shown in the UI"}}),Ot=(0,k.defineMessages)({linkToPage:{defaultMessage:"Link to page",id:"embedMenu.actions.linkToPage.title"},mentionPage:{defaultMessage:"Mention page",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention block",id:"embedMenu.actions.mentionBlock.title",description:"Mention a non-page block"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Create linked view of database",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Create bookmark",id:"embedMenu.actions.createBookmark.title"},createTransclusionItem:{defaultMessage:"Paste and sync",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"Dismiss",id:"embedMenu.actions.dismiss.title"}}),Nt={image:ge.default.formatMessage(Lt.image),video:ge.default.formatMessage(Lt.video),tweet:ge.default.formatMessage(Lt.tweet),drive:ge.default.formatMessage(Lt.drive),gist:ge.default.formatMessage(Lt.gist),figma:ge.default.formatMessage(Lt.figma),invision:ge.default.formatMessage(Lt.invision),abstract:ge.default.formatMessage(Lt.abstract),framer:ge.default.formatMessage(Lt.framer),whimsical:ge.default.formatMessage(Lt.whimsical),mixpanel:ge.default.formatMessage(Lt.mixpanel),miro:ge.default.formatMessage(Lt.miro),sketch:ge.default.formatMessage(Lt.sketch),excalidraw:ge.default.formatMessage(Lt.excalidraw),replit:ge.default.formatMessage(Lt.replit),audio:ge.default.formatMessage(Lt.audio),maps:ge.default.formatMessage(Lt.maps),loom:ge.default.formatMessage(Lt.loom),typeform:ge.default.formatMessage(Lt.typeform),codepen:ge.default.formatMessage(Lt.codepen),pdf:ge.default.formatMessage(Lt.pdf),embed:ge.default.formatMessage(Lt.embed),hex:ge.default.formatMessage(Lt.hex),deepnote:ge.default.formatMessage(Lt.deepnote),drawing:ge.default.formatMessage(Lt.drawing)};class Vt extends s.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=Et.Z.state;if(!t.open)return;const i=this.getSections(t);let n;return 0===i.length&&Bt.xv(),n=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:320,maxHeight:"40vh"},o.createElement(E.Z,ce()({},n,{className:me.srZ}),a()(ve.Z,{type:ve.i.Vertical,sections:i,initialFocus:0}))},this.handleDismiss=()=>{const e=Et.Z.state,{url:t}=e;G.X0y(this.environment,{url:t,type:"close"}),Bt.xv()},this.handleAccept=e=>{const t=Et.Z.state,{url:i}=t;Bt.RL({environment:this.environment,type:e}),G.X0y(this.environment,{url:i,type:e})}}willMountOrUpdate(){const e=Et.Z.state;if(e.open){const t=kt.default.state;if("editing"===t.mode){const{multiSelection:i}=t;(0,yt.qS)(i)&&i.start.store.id===e.textStore.id&&i.end.index===e.urlSelection.endIndex||Bt.xv()}}}renderComponent(){const{device:e}=this.environment,t=Et.Z.state;return a()(U.ZP,{popupType:e.isMobileNative&&!e.isTablet?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}isInCollection(e){const t=e.getRecordStoreAtRootPath();return t instanceof J.G&&void 0!==t.getParentCollectionStore()}isCollectionViewWithContent(e,t){const i=e.getCollectionViewStores(),n=q().find(i,(e=>e.id===t&&"page"===e.getType()));return Boolean(n)}getSections(e){const{device:t}=this.environment,{url:i,textStore:n}=e,a=Dt.default.checkGate("reorder_embed_menu"),s=[],r=(0,Pt.Wj)({url:i,baseUrl:vt.Z.domainBaseUrl,publicDomainName:vt.Z.publicDomainName,isMobile:t.isMobile,protocol:vt.Z.protocol,currentUrl:window.location.href});if("page"===r.name){const e=J.G.createChildStore(n,{table:Ft.iU,id:r.blockId}),t=r.scrollToBlockId?J.G.createChildStore(n,{table:Ft.iU,id:r.scrollToBlockId}):void 0;s.push({name:ge.default.formatMessage(Ot.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!this.isInCollection(n)&&(!e.isCollectionViewPageWithContent()||!this.isCollectionViewWithContent(e,r.collectionViewId))&&!Rt.default.isMiniPeekOpen(),type:C.Ti.collectionView}),a&&s.push({name:ge.default.formatMessage(void 0===t?Ot.mentionPage:Ot.mentionBlock),validator:()=>!0,type:"mention-page"}),s.push({name:ge.default.formatMessage(Ot.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!this.isInCollection(n)&&!t.isLocked()&&!t.isNavigableAncestorLocked()&&t.canEdit()),type:"create-transclusion"}),a||s.push({name:ge.default.formatMessage(void 0===t?Ot.mentionPage:Ot.mentionBlock),validator:()=>!0,type:"mention-page"}),s.push({name:ge.default.formatMessage(Ot.linkToPage),validator:()=>!t&&!e.isCollectionView()&&!this.isInCollection(n),type:C.Ti.page})}const l=At.XP(Nt);for(const o of l)"embed"!==o&&s.push({name:Nt[o],validator:Zt.Wb[o],type:o});s.push({name:ge.default.formatMessage(Ot.bookmarkMenuItem),validator:e=>!this.isInCollection(n)&&Zt.Cm(e),type:C.Ti.bookmark}),s.push({name:Nt.embed,validator:e=>!this.isInCollection(n)&&Zt.Wb.embed(e),type:"embed"});const d=q().compact(s.map((e=>{let{name:t,validator:n,type:a}=e;if(n({url:i,baseUrl:vt.Z.domainBaseUrl,publicDomainName:vt.Z.publicDomainName})){return{key:`embed ${t}`,render:e=>o.createElement(fe.Z,ce()({},e,{title:t})),action:()=>this.handleAccept(a)}}}))),c={key:"dismiss",render:e=>o.createElement(fe.Z,ce()({},e,{title:ge.default.formatMessage(Ot.dismissItem)})),action:this.handleDismiss};if(0===d.length)return[];a&&"page"===r.name?d.push(c):d.unshift(c);return[{key:"embed section",render:e=>o.createElement(oe.Z,e),items:d}]}}Vt.displayName="EmbedMenu";const Ut=Vt;var Wt=i(4727),zt=i(31352),Kt=i(88833),qt=i(38797);class Ht extends s.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=Kt.Z.state,i=o.createRef();if(!t.open)return;let n;return n=e.isMobileNative&&!e.isTablet?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:qt.ZP.desktopEmojiPickerOnlyPopupWidth,maxHeight:qt.ZP.desktopEmojiPickerOnlyPopupHeight,onClickOutside:Wt.xv},o.createElement(E.Z,ce()({innerRef:i},n),a()(qt.ZP,{filter:this.getFilter(t)||"",onSubmit:this.handleSubmit,onNoResults:this.handleNoResults,isCallout:!1,menuRef:i}))},this.handleNoResults=()=>{const e=Kt.Z.state;if(!e.open)return;const t=this.getFilter(e),i=q().last(t);i&&/\s/g.test(i)&&Wt.xv()},this.handleSubmit=e=>{lt.createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:this.environment,perform:t=>{Wt.RL({environment:this.environment,emoji:e,transaction:t})}})},this.handleCancel=()=>{Wt.xv()}}willMountOrUpdate(){const e=Kt.Z.state;if(e.open){var t;const i=kt.default.state,n=this.getFilter(e);if("editing"!==i.mode)return void Wt.xv();const a=ot.ee(i.multiSelection.start.store.getValue())[i.multiSelection.start.index-1];if(!n&&":"!==a)return void Wt.xv();((null===(t=(0,yt.QY)(i.multiSelection))||void 0===t?void 0:t.store)!==e.textStore||void 0===n||":"===n||n.startsWith("\n")||n.startsWith(" "))&&Wt.xv()}}renderComponent(){const{device:e}=this.environment,t=Kt.Z.state;let i=!1;if(t.open){const e=this.getFilter(t);e&&e.length>0&&(i=!0),t.showPopupWithEmptyFilter&&(i=!0)}return a()(U.ZP,{popupType:e.isMobileNative&&!e.isTablet?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:i,originRect:t.open?t.selectionRect:void 0,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.handleCancel,render:this.renderMenu,keepFocus:!0})}getFilter(e){return zt.zK(e.textStore,e.oldTextValue,!0)}}Ht.displayName="EmojiMenu";const Gt=Ht;var jt=i(8848),$t=i(43593),Yt=i(3779),Qt=i(54604),Xt=i(42858),Jt=i(24677),ei=i(39500),ti=i(17504),ii=i(58202),ni=i(38302),ai=i(12318),oi=i(23063),si=i(68785),ri=i(89728),li=i(58032),di=i(56813);class ci extends s.Z{constructor(){var e;super(...arguments),e=this,this.zoomFocusPercentageX=0,this.zoomFocusPercentageY=0,this.isListeningToWheel=!1,this.hideControlsTimeout=void 0,this.isMovingToPrevOrNextTimeout=void 0,this.isEditingZoom=new ai.default(!1),this.contentDimensions=new ai.default(void 0),this.showControls=new ai.default(!1),this.responsiveSettings=this.createComputedStore((()=>{const e=this.environment.WindowSizeStore.state.width;return{edgePadding:Qt.zp(e),backgroundOpacity:.8}})),this.renderOverlay=()=>{const{isOpen:e,renderFullScreenNode:t,fullScreenNodeRect:i,contentAspectRatio:n,zoomScale:s,panOffset:r,skipAnimations:l}=ni.Z.state;if(!i)return;e&&!this.isListeningToWheel?(window.addEventListener("wheel",this.handleWheel,{passive:!1}),this.isListeningToWheel=!0):!e&&this.isListeningToWheel&&(window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1);const{edgePadding:d,backgroundOpacity:c}=this.responsiveSettings.state,u=window.innerWidth,p=window.innerHeight-2*d;let m=u-2*d;const g=n||i.height/i.width;let h=m*g;if(h>p){const e=h/p;h/=e,m/=e}const f={opacity:0},v={scale:s,opacity:1,translateX:r.x,translateY:r.y};let y,b;return t&&(y=t()),b=this.showControls.get()?s>=1.5?"zoom-out":"zoom-in":"none",(0,ti.Z)((t=>a()(B.Z,{capture:e,onEsc:()=>{this.handleClose(!0)},onEnter:q().identity,onSpace:()=>this.handleClose(!0),onCommandEnter:()=>this.handleClose(!0),onCommandShiftEnter:q().identity,onCommandSlash:q().identity,onUp:q().identity,onDown:q().identity,onDelete:q().identity,onBackspace:q().identity,onLeft:()=>this.handlePrevious(!0),onRight:()=>this.handleNext(!0),onUntab:q().identity,onTab:q().identity,onSelectAll:q().identity,onRedo:q().identity,onUndo:q().identity,onToggleBold:q().identity,onToggleItalics:q().identity,onToggleStrike:q().identity,onToggleCode:q().identity,onCut:q().identity,onCopy:q().identity,onPaste:q().identity,onKeypress:this.handleKeypress},void 0,a()(A.Z,{capture:e,preventType:x.Z.All},void 0,o.createElement("div",ce()({style:this.getStyle({isOpen:e})},t,{onClick:this.handleBackgroundClick,onMouseMove:this.resetHideControlsTimeout}),a()(oi.Z,{isVisible:e,enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:c},render:()=>a()("div",{style:this.getBackgroundStyle()}),onAnimationEnd:this.handleBackgroundAnimationEnd}),a()(oi.Z,{isVisible:e,enterAnimationStyle:f,exitAnimationStyle:f,animationStyle:v,skipAnimation:l,springConfig:{scale:this.getSpringConfig(),translateX:this.getSpringConfig(),translateY:this.getSpringConfig()},render:()=>o.createElement("div",{style:{display:"flex",cursor:b,maxWidth:m,maxHeight:h,justifyContent:"center"},ref:e=>{e&&this.contentDimensions.set({width:e.clientWidth,height:e.clientHeight})},onClick:this.handleContentClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp,onMouseMove:this.handleMouseMove},y),onAnimationEnd:this.handleFullscreenNodeAnimationEnd}),this.renderBottomBar())))))},this.clearHideControlsTimeout=()=>{this.hideControlsTimeout&&clearTimeout(this.hideControlsTimeout)},this.resetHideControlsTimeout=()=>{const{isSaving:e}=ni.Z.state;this.showControls.set(!0),this.clearHideControlsTimeout(),this.isEditingZoom.get()||e||(this.hideControlsTimeout=setTimeout((()=>this.showControls.set(!1)),2e3))},this.enableZoomEditing=()=>{this.isEditingZoom.set(!0),this.clearHideControlsTimeout()},this.disableZoomEditing=()=>{this.isEditingZoom.set(!1),this.resetHideControlsTimeout()},this.handleBackgroundClick=e=>{(0,ei.uG)(e)||this.handleClose()},this.handleContentClick=e=>{const{zoomScale:t,panOffset:i}=ni.Z.state;if(e.stopPropagation(),(0,ei.uG)(e))return;let n,a;n=t<1?1:t<1.5?1.5:1,a=n<=1?{x:0,y:0}:this.clampPanOffset({x:(window.innerWidth/2-e.clientX)/(n/(n-1)),y:(window.innerHeight/2-e.clientY)/(n/(n-1))})??i,ni.Z.setState({...ni.Z.state,zoomScale:n,panOffset:a}),this.resetHideControlsTimeout(),this.disableZoomEditing()},this.handleClose=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Qt.xv(),e.resetControls(),G.Lfx(e.environment,{type:"close",triggered_by:t?"keypress":"click"}),Jt.ZH(e.environment)},this.handleResize=()=>{const{isOpen:e}=ni.Z.state;e&&this.enqueueForceUpdate()},this.handleBackgroundAnimationEnd=()=>{const{isOpen:e}=ni.Z.state;e||ni.Z.setState({...ni.Z.state,backgroundAnimationComplete:!0})},this.handleFullscreenNodeAnimationEnd=()=>{const{isOpen:e}=ni.Z.state;e||ni.Z.setState({...ni.Z.state,fullscreenNodeAnimationComplete:!0})},this.cancelBackgroundClick=e=>{e.stopPropagation()},this.handlePrevious=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(-1,t)},this.handleNext=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(1,t)},this.handleZoomInputSubmit=e=>{const t=e.target,i=parseInt(t.value);if(!isNaN(i)){const e=i/100;G.Lfx(this.environment,{type:"set_zoom",new_zoom:e}),this.setZoomScale(e)}this.disableZoomEditing()},this.handleZoomOut=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:i}=ni.Z.state;let n=Math.ceil((i-ci.ZOOM_STEP)*ci.INVERSE_ZOOM_STEP)/ci.INVERSE_ZOOM_STEP;i-n<ci.ZOOM_THRESHOLD&&(n-=ci.ZOOM_STEP),G.Lfx(e.environment,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),e.setZoomScale(n)},this.handleZoomIn=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:i}=ni.Z.state;let n=Math.floor((i+ci.ZOOM_STEP)*ci.INVERSE_ZOOM_STEP)/ci.INVERSE_ZOOM_STEP;n-i<ci.ZOOM_THRESHOLD&&(n+=ci.ZOOM_STEP),G.Lfx(e.environment,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),e.setZoomScale(n)},this.addDeltaToZoomScale=e=>{const{zoomScale:t}=ni.Z.state;this.setZoomScale(t+e)},this.setZoomScale=e=>{const{panOffset:t}=ni.Z.state;this.resetHideControlsTimeout();const i=Math.max(Math.min(e,ci.MAX_ZOOM),ci.MIN_ZOOM),n=i<=1?{x:0,y:0}:t;ni.Z.setState({...ni.Z.state,zoomScale:i,panOffset:n})},this.handleWheel=e=>{const{isOpen:t,panOffset:i}=ni.Z.state;t&&(e.preventDefault(),e.ctrlKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*ci.TRACK_PAD_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*ci.TRACK_PAD_SCALE):e.metaKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*ci.MOUSE_WHEEL_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*ci.MOUSE_WHEEL_SCALE):this.canPan()&&this.setPanOffset({x:i.x-e.deltaX,y:i.y-e.deltaY}))},this.handleMouseDown=e=>{const{panOffset:t,zoomScale:i}=ni.Z.state;ni.Z.setState({...ni.Z.state,panStartPosition:{x:e.clientX/i-t.x,y:e.clientY/i-t.y},skipAnimations:!0})},this.handleMouseUp=()=>{ni.Z.setState({...ni.Z.state,skipAnimations:!1})},this.handleMouseMove=e=>{const{panStartPosition:t,zoomScale:i}=ni.Z.state;this.contentDimensions.get()&&1===e.buttons&&this.canPan()&&this.setPanOffset({x:e.clientX/i-t.x,y:e.clientY/i-t.y})},this.handleDownload=e=>{const{block:t,imageUrl:i}=ni.Z.state;if(!t||!this.canDownload())return;ni.Z.setState({...ni.Z.state,isSaving:!0}),this.clearHideControlsTimeout();const n=null==t?void 0:t.getProperties();let a;if(a=i||ot.Q(null==n?void 0:n.source),!a)return;const o=ot.Q(null==n?void 0:n.caption);(0,$t.GN)(a,null==t?void 0:t.pointer,vt.Z.domainBaseUrl,this.environment.currentUser.id,o).then((()=>{ni.Z.setState({...ni.Z.state,isSaving:!1}),G.Lfx(this.environment,{type:"download",triggered_by:"click"}),this.resetHideControlsTimeout()}))},this.handleKeypress=e=>{switch(e.key){case"+":case"=":this.handleZoomIn(!0);break;case"-":case"_":this.handleZoomOut(!0)}}}didMount(){super.didMount(),window.addEventListener("resize",this.handleResize)}willUnmount(){super.willUnmount(),window.removeEventListener("resize",this.handleResize),window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1}renderComponent(){const{isOpen:e,fullscreenNodeAnimationComplete:t,backgroundAnimationComplete:i}=ni.Z.state;return a()(d.Z,{open:e||!t||!i},void 0,this.renderOverlay())}getAllImageBlocksOnPage(){const e=ee.default.getCurrentRootStore();return ii.R.getMembersByDOMOrder({filter:t=>t instanceof di.Z&&Boolean(t.props.store.findRecordStoreUIAncestor((t=>Boolean(e&&t===e))).ancestor)}).map((e=>e.props.store)).filter((e=>Boolean(e.getProperties().source)))}renderBottomBar(){const{isOpen:e}=ni.Z.state;if(!this.environment.device.isMobile)return a()(oi.Z,{isVisible:this.showControls.get(),enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>a()("div",{style:this.getBottomContainerStyle(e),onClick:e=>{this.cancelBackgroundClick(e),this.resetHideControlsTimeout(),this.disableZoomEditing()}},void 0,a()("div",{style:{...ci.controlBarStyle,marginRight:10}},void 0,this.renderPrevNextButtons()),a()("div",{style:ci.controlBarStyle},void 0,this.renderZoomControls(),this.renderVerticalLine(),this.canDownload()?o.createElement(o.Fragment,null,this.renderDownloadButton(),this.renderVerticalLine()):void 0,this.renderCloseButton()))})}renderZoomControls(){const{zoomScale:e}=ni.Z.state,t=(100*e).toFixed(0);return a()("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"}},void 0,a()(li.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(k.FormattedMessage,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out",description:"Label for a button to zoom out an image"}),secondaryText:"-"}),disableTooltip:e<=ci.MIN_ZOOM,render:t=>o.createElement(ri.Z,ce()({},t,{disabled:e<=ci.MIN_ZOOM,style:{...this.getButtonStyle(e<=ci.MIN_ZOOM),...ci.firstButtonPadding},onClick:()=>this.handleZoomOut(),icon:e=>Yt.Z.minus({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}),this.isEditingZoom.get()?a()(ui,{initialValue:t,onSubmit:this.handleZoomInputSubmit,onCancel:this.disableZoomEditing,primaryColor:this.getBottomBarPrimaryColor(),secondaryColor:this.getBottomBarSecondaryColor()}):a()(ri.Z,{onClick:e=>{e.stopPropagation(),this.enableZoomEditing()},style:{color:this.getBottomBarSecondaryColor(),margin:0,width:46,padding:0,justifyContent:"center"}},void 0,`${t}%`),a()(li.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(k.FormattedMessage,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in",description:"Label for a button to zoom in an image"}),secondaryText:"+"}),disableTooltip:e>=ci.MAX_ZOOM,render:t=>o.createElement(ri.Z,ce()({},t,{disabled:e>=ci.MAX_ZOOM,style:this.getButtonStyle(e>=ci.MAX_ZOOM),onClick:()=>this.handleZoomIn(),icon:e=>Yt.Z.plus({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}))}renderPrevNextButtons(){const{block:e}=ni.Z.state,t=this.getAllImageBlocksOnPage(),i=(null==t?void 0:t.length)??0,n=(null==t?void 0:t.findIndex((t=>t===e)))??-1;return i<=1||n<0?a()("div",{}):o.createElement(o.Fragment,null,a()(li.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(k.FormattedMessage,{id:"fullScreenRenderer.previous",defaultMessage:"Back",description:"Label for a button in a slideshow of images to go back to the previous image"}),secondaryText:this.renderPrevNextSecondaryText(n-1,i)}),disableTooltip:0===n,render:e=>o.createElement(ri.Z,ce()({},e,{disabled:n<=0,style:{...this.getButtonStyle(n<=0),...ci.firstButtonPadding},hoveredStyle:ci.hoveredButtonStyle,onClick:()=>this.handlePrevious(),icon:e=>Yt.Z.arrowLeft({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}),a()(li.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(k.FormattedMessage,{id:"fullScreenRenderer.next",defaultMessage:"Next",description:"Label for a button in a slideshow of images to go to the next image"}),secondaryText:this.renderPrevNextSecondaryText(n+1,i)}),disableTooltip:n+1===i,render:e=>o.createElement(ri.Z,ce()({},e,{disabled:n>=i-1,style:{...this.getButtonStyle(n>=i-1),...ci.lastButtonPadding},hoveredStyle:ci.hoveredButtonStyle,onClick:()=>this.handleNext(),icon:e=>Yt.Z.arrowRight({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}))}renderDownloadButton(){const{isSaving:e}=ni.Z.state;return a()(li.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(k.FormattedMessage,{id:"fullScreenRenderer.download",defaultMessage:"Download",description:"Label for a button to download an image"})}),render:t=>o.createElement(ri.Z,ce()({},t,{disabled:e,onClick:this.handleDownload,style:this.getButtonStyle(!1),hoveredStyle:ci.hoveredButtonStyle}),e?a()(si.Z,{style:{width:16}}):Yt.Z.download({fill:this.getBottomBarPrimaryColor(),width:16}))})}renderCloseButton(){return a()(li.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(k.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label",description:"Shown in the top right corner when viewing an asset (image, file, etc.) in full screen mode, to close out of full screen mode."}),secondaryText:"esc"}),render:e=>o.createElement(ri.Z,ce()({},e,{onClick:()=>this.handleClose(),style:{...this.getButtonStyle(!1),...ci.lastButtonPadding},hoveredStyle:ci.hoveredButtonStyle,icon:e=>Yt.Z.collapse({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))})}renderPrevNextSecondaryText(e,t){return a()(k.FormattedMessage,{values:{currentIndex:e+1,totalCount:t},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label",description:"Description stating what image number this is in a list of images. For example, 3 of 14"})}renderTooltip(e){const{primaryText:t,secondaryText:i}=e;return o.createElement(o.Fragment,null,a()("span",{style:{marginRight:i?4:void 0}},void 0,t),i?a()("span",{style:{color:this.getBottomBarSecondaryColor()}},void 0,i):void 0)}renderVerticalLine(){return a()("span",{style:{borderLeft:`1px solid ${jt.ZP.whiteWithAlpha(.25)}`,height:"100%"}})}scrollToZoomFocus(e){const t=window.innerWidth/2,i=window.innerHeight/2,n=e.scrollWidth*this.zoomFocusPercentageX,a=e.scrollHeight*this.zoomFocusPercentageY;e.scrollLeft=n-t,e.scrollTop=a-i}resetControls(){this.isEditingZoom.set(!1),ni.Z.setState({...ni.Z.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}canPan(){const{zoomScale:e}=ni.Z.state;return e>1}clampPanOffset(e){const t=this.contentDimensions.get();if(!t)return;let i,n;i=t.width*ci.MAX_ZOOM>window.innerWidth?(t.width*ci.MAX_ZOOM-window.innerWidth)/(2*ci.MAX_ZOOM):(window.innerWidth-t.width*ci.MAX_ZOOM)/(2*ci.MAX_ZOOM),n=t.height*ci.MAX_ZOOM>window.innerHeight?(t.height*ci.MAX_ZOOM-window.innerHeight)/(2*ci.MAX_ZOOM):(window.innerHeight-t.height*ci.MAX_ZOOM)/(2*ci.MAX_ZOOM);return{x:Math.min(Math.max(e.x,-1*i),i),y:Math.min(Math.max(e.y,-1*n),n)}}setPanOffset(e){const{panStartPosition:t}=ni.Z.state,i=this.clampPanOffset(e);i&&(e.x!==i.x&&(t.x=t.x+(e.x-i.x)),e.y!==i.y&&(t.y=t.y+(e.y-i.y)),ni.Z.setState({...ni.Z.state,panOffset:i,panStartPosition:t}))}canDownload(){var e;const{block:t,imageUrl:i}=ni.Z.state;return t&&(i||(null===(e=t.getProperties())||void 0===e?void 0:e.source)&&ot.Q(t.getProperties().source))}moveToImageOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{block:i}=ni.Z.state,n=this.getAllImageBlocksOnPage();if(!n)return;const a=n.findIndex((e=>e===i));if(a+e<0||a+e>=n.length)return;G.Lfx(this.environment,{type:e>0?"next":"previous",image_count:n.length,image_index:a+e,triggered_by:t?"keypress":"click"}),ni.Z.setState({...ni.Z.state,skipAnimations:!0}),this.isMovingToPrevOrNextTimeout&&clearTimeout(this.isMovingToPrevOrNextTimeout),this.isMovingToPrevOrNextTimeout=setTimeout((()=>{ni.Z.setState({...ni.Z.state,skipAnimations:!1})}),250);const o=n[a+e];Xt.dK({blocks:[o]}),this.resetControls()}getSpringConfig(){return{stiffness:100,damping:10,precision:.001}}getStyle(e){const{isOpen:t}=e;return{zIndex:ze.mJ,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:this.showControls.get()?void 0:"none"}}getBackgroundStyle(){return{position:"absolute",top:0,left:0,right:0,bottom:0,background:jt.ZP.black}}getBottomContainerStyle(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}getBottomBarPrimaryColor(){return jt.ZP.white}getBottomBarSecondaryColor(){return jt.ZP.whiteWithAlpha(.5)}getButtonStyle(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}}function ui(e){window.__c={n:"ZoomInput"};const[t,i]=(0,o.useState)(e.initialValue);return a()(Me.Z,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:3,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;i(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:Me.B.Transparent,right:a()("span",{style:{color:e.secondaryColor}},void 0,"%"),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}ci.displayName="FullScreenRenderer",ci.MAX_ZOOM=2,ci.MIN_ZOOM=.5,ci.ZOOM_STEP=.5,ci.INVERSE_ZOOM_STEP=1/ci.ZOOM_STEP,ci.ZOOM_THRESHOLD=.25,ci.MOUSE_WHEEL_SCALE=-.002,ci.TRACK_PAD_SCALE=-.004,ci.controlBarStyle={display:"flex",borderRadius:4,background:jt.ZP.blackWithAlpha(.65)},ci.firstButtonPadding={padding:"6px 6px 6px 10px"},ci.lastButtonPadding={padding:"6px 10px 6px 6px"},ci.hoveredButtonStyle={background:"rgba(255, 255, 255, 0.055)"};const pi=ci;var mi=i(67206),gi=i(98459),hi=i(70279),fi=i(19889),vi=i(36280),yi=i(73959),bi=i(89086),Si=i(66949),wi=i(3702);class Mi extends s.Z{constructor(){super(...arguments),this.input=o.createRef(),this.handleInputChange=(e,t)=>{Si.Z.isOpen()&&Si.Z.setState({...Si.Z.state,value:e,error:t})},this.handleSubmit=()=>{lt.createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:this.environment,perform:e=>{vi.gt({environment:this.environment,equationStore:Si.Z,transaction:e})}})},this.handleClose=()=>{vi.Wj()},this.handleLeft=e=>{if(!this.input.current)return;const t=this.input.current.getSelection();t&&"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===t.startIndex&&0===t.endIndex&&(this.handleSubmit(),vi.Wj(Si.P.Backward))},this.handleRight=e=>{if(!Si.Z.isOpen())return;if(!this.input.current)return;const t=this.input.current.getSelection();if(!t)return;const i=Si.Z.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&t.startIndex===i&&t.endIndex===i&&(this.handleSubmit(),vi.Wj())},this.isDisabled=()=>{var e;if("editing"!==kt.default.state.mode&&!Si.Z.isOpen())return!0;const t=Si.Z.isOpen()?null===(e=(0,yt.QY)(Si.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,yi.J2)(t);if(e&&e.isLocked())return!0}if(t&&t.table===hi.x_){const e=J.T5.createChildStore(t,{table:hi.x_,id:t.id,spaceId:(0,gi.CG)(t.pointer.spaceId)}),i=e.isDefined(),{currentUserStore:n}=h.default.state;if(!i||!n)return!0;const a=e.getCreatedByTable(),o=e.getCreatedById();if(a!==fi.KJ||n.id!==o)return!0}const i={[ot.GK.User]:ot.GK.User,[ot.GK.Page]:ot.GK.Page,[ot.GK.Comment]:ot.GK.Comment,[ot.GK.Bot]:ot.GK.Bot,[ot.GK.Date]:ot.GK.Date,[ot.GK.ExternalObjectInstance]:ot.GK.ExternalObjectInstance,[ot.GK.TemporaryPage]:ot.GK.TemporaryPage,[ot.GK.TemplateVariable]:ot.GK.TemplateVariable,[ot.GK.FormulaPageProperty]:ot.GK.FormulaPageProperty,[ot.GK.FormulaUserProperty]:ot.GK.FormulaUserProperty,[ot.GK.FormulaContextValue]:ot.GK.FormulaContextValue,[ot.GK.Group]:ot.GK.Group};for(const n of Object.values(i))if((0,bi.J6)(n))return!0;return!1},this.INPUT_ORIGIN_GAP_PX=8}renderComponent(){if(!Si.Z.isOpen())return;const e=!Si.Z.isOpen(),t=this.isDisabled(),i=this.getInputOriginRect(),n=Si.Z.state.value,s=Si.Z.state.error;return a()(c.DependencyConsumer,{dependency:c.deps.prismjs},void 0,(a=>{if(!e)return o.createElement(wi.Z,{Prism:a,ref:this.input,isOpen:!0,equationValue:n,error:s,displayMode:"inline",disabled:t,originRect:i,originGap:this.INPUT_ORIGIN_GAP_PX,onDismiss:this.handleClose,onChange:this.handleInputChange,onSubmit:this.handleSubmit,onLeft:this.handleLeft,onRight:this.handleRight})}))}getInputOriginRect(){if(Si.Z.isOpen())return Si.Z.state.savedTextSelectionRect}}Mi.displayName="InlineEquationOverlay";const Ci=Mi;var ki=i(94416);class Ti extends s.Z{constructor(){super(...arguments),this.handleOpen=()=>{ki.Z.setState({open:!0})},this.handleClose=()=>{ki.Z.setState({open:!1})}}willMount(){ht.inPageSearch.started.addListener(this.handleOpen),ht.inPageSearch.stopped.addListener(this.handleClose)}willUnmount(){ht.inPageSearch.started.removeListener(this.handleOpen),ht.inPageSearch.stopped.removeListener(this.handleClose)}}Ti.displayName="InPageSearchListener";const _i=Ti;var Ii=i(97880),xi=i(96313),Zi=i(73744),Pi=i(70726),Fi=i(48863),Ai=i(33411);function Bi(e){switch(e){case Pi.Z.Preview:return a()(k.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview",description:"Label to unfurl pasted link as a preview"});case Pi.Z.Mention:return a()(k.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention",description:"Label to unfurl pasted link as an inline mention"});case Pi.Z.Link:return a()(k.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link",description:"Label to paste link as a normal URL"});default:(0,Ii.t1)(e)}}const Ei=function(){window.__c={n:"InternalUnfurlingMenu"};const e=(0,Ie.O7)(),t=(0,o.useRef)(null),[i]=(0,l.AF)(Fi.Z),n=(0,o.useCallback)((t=>{if(i.open){var n;if(!t)xi.pg({actionType:i.focusedIndex,environment:e,commentStore:null===(n=i.args.commentStore)||void 0===n?void 0:n.state,useTempStores:!1});Fi.Z.setState({open:!1})}}),[e,i]),s=(0,o.useCallback)((e=>{i.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&n(void 0)}),[n,i.open]),r=(0,o.useCallback)((e=>{const a=t.current;if(!i.open||!e.target||!a)return;const o=Ae.findDOMNode(a);o&&(o.contains(e.target)||n(void 0))}),[n,i.open]);(0,o.useEffect)((()=>((0,Zi.lj)(window,"keydown",s),(0,Zi.lj)(window,"mousedown",r),()=>{(0,Zi.ZV)(window,"keydown",s),(0,Zi.ZV)(window,"mousedown",r)})),[s,r]);const d=(0,o.useRef)(!1);function c(t){var n;i.open&&void 0!==t.indexGlobal&&(Fi.Z.setState({...i,focusedIndex:t.indexGlobal}),xi.pg({actionType:t.indexGlobal,environment:e,commentStore:null===(n=i.args.commentStore)||void 0===n?void 0:n.state,useTempStores:!0}))}(0,l.VK)((()=>{var t,n;const a=(i.open&&(null===(t=i.args.commentStore)||void 0===t?void 0:t.state)&&(null===(n=i.args.commentStore.state)||void 0===n?void 0:n.isReady()))??!1;var o;a&&!d.current&&i.open&&xi.pg({actionType:i.focusedIndex,environment:e,commentStore:null===(o=i.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0});d.current=a}),[e,i]);const u=(0,l.VK)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),p=e.device.isMobile;return a()(U.ZP,{popupType:u?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:i.open,originRect:i.open?i.selectionRect:void 0,placementToOrigin:U.ZP.Placement.Top,alignmentToOrigin:U.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:p,keepFocus:p,render:function(){var n;const{device:s}=e;if(!i.open)return;const r=function(t){const{url:i,args:n}=t,a=[];a.push({title:Bi(Pi.Z.Preview),validator:()=>!0,type:Pi.Z.Preview}),a.push({title:Bi(Pi.Z.Mention),validator:()=>!0,type:Pi.Z.Mention}),a.push({title:Bi(Pi.Z.Link),validator:()=>!0,type:Pi.Z.Link});return[{key:"menu section",render:e=>o.createElement(oe.Z,e),items:q().compact(a.map((t=>{let{title:a,validator:s,type:r}=t;if(s({url:i,baseUrl:vt.Z.domainBaseUrl,publicDomainName:vt.Z.publicDomainName})){return{key:`item ${r}`,render:t=>o.createElement(fe.Z,ce()({},t,{title:a,onMouseEnter:i=>{var a;t.onMouseEnter(i),xi.pg({actionType:r,environment:e,commentStore:null===(a=n.commentStore)||void 0===a?void 0:a.state,useTempStores:!0})}})),action:()=>{var t;return xi.pg({actionType:r,environment:e,commentStore:null===(t=n.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(i);let l;return l=s.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:320,maxHeight:"40vh"},null!==(n=i.args.commentStore)&&void 0!==n&&n.state&&i.args.commentStore.state.isReady()?o.createElement(E.Z,ce()({},l,{className:me.srZ,ref:t}),a()(ve.Z,{type:ve.i.Vertical,sections:r,onKeyboardArrow:c,initialFocus:0,priority:1})):a()(Ai.Z,{show:!0,showDelay:500,showHold:0,render:()=>o.createElement(E.Z,ce()({},l,{className:me.srZ,ref:t}),a()(oe.Z,{style:{display:"flex",justifyContent:"center"}},void 0,a()(si.Z,{})))})},onDismiss:()=>n(void 0)})};var Di=i(64572),Ri=i(88295),Li=i(45990),Oi=i(21325),Ni=i(48709),Vi=i(64002),Ui=i(64921),Wi=i(31278),zi=i(76798);function Ki(e){window.__c={n:"RecordButton"};const{store:t,onClick:i}=e,n=(0,Ie.O7)(),o=(0,Ie.MO)(),s=(0,l.VK)((()=>t.getIcon()),[t]),r=(0,l.VK)((()=>t instanceof J.G&&t.isEmptyPage()),[t]),d=(0,xe.yK)((e=>({container:{display:"flex",alignItems:"center",padding:"4px 6px",marginLeft:12,marginRight:12,borderRadius:3,boxShadow:e.inputBoxShadow,background:e.inputBackground,height:28,fontSize:14,lineHeight:"120%"},phoneContainer:{display:"flex",alignItems:"center",padding:"4px 16px",boxShadow:`${e.regularDividerColor} 0px 1px 0px`,background:e.modalBackground,height:46}})),[]);return a()(Ui.Z,{style:o?d.phoneContainer:d.container,onClick:i},void 0,a()(Wi.Z,{disabled:!0,icon:s,isEmptyPage:r,size:n.device.isMobile?24:20,style:{marginRight:4}}),a()(zi.ZP,{store:t}))}var qi=i(23178);function Hi(e){const{state:t,focusInitial:i,defaultValue:n,onBlur:o,onKeyDown:s,style:r}=e,l=(0,Ie.MO)(),d=(0,k.useIntl)(),c=d.formatMessage({defaultMessage:"Paste link or search pages",id:"selectionLinkButton.search.createNewLinkPlaceholder",description:"Placeholder text in the link input field when there is no current link"}),u=d.formatMessage({defaultMessage:"Edit link or search pages",id:"selectionLinkButton.search.editLinkPlaceholder",description:"Placeholder text in the link input field when there is an existing link that will be modified"}),p=!l||!t.showCreateIn,m=l?void 0:!t.showCreateIn&&t.focusLinkInput,g=t.editingToken?u:c;return p?a()(ae.ZP,{onFocus:Ni.FV,placeholder:g,value:n||t.url,onChange:Gi,onBlur:o,onKeyDown:s,focus:m,focusInitial:i,focusAfterAnimation:!0,preventCaptureArrowShortcuts:!0,style:r}):null}const Gi=e=>{const t=qi.Z.state;t.open&&qi.Z.setState({...t,url:e.target.value,focusLinkInput:!0})};function ji(e){const{state:t,showPreview:i,store:n}=e,o=(0,Ie.MO)(),s=(0,Ni.Fs)(t),{editingToken:r,focusTitleInput:l}=t;return i&&n?a()(Ki,{store:n,onClick:Ni.FV}):a()(Hi,{state:t,onBlur:Ni.cX,onKeyDown:$i,defaultValue:i?s:void 0,style:r?void 0:{marginTop:6},focusInitial:!Boolean(r)||o&&!l})}const $i=e=>{"Escape"===e.key&&(e.stopPropagation(),(0,Ni.hy)())};function Yi(e){window.__c={n:"LinkMenuTitleInput"};const{title:t,focus:i,defaultTitle:n}=e,s=(0,Ie.O7)(),r=(0,Ie.MO)(),[l,d]=(0,o.useState)(),c=(0,o.useRef)(!1),u=(0,o.useMemo)((()=>({environment:s,defaultTitle:n,setPlaceholder:d,hasTitleChanged:c})),[n,s]);return(0,o.useEffect)((()=>{const e=c.current;return()=>{e&&G.pZG(s)}}),[c,s]),a()(ae.ZP,{focus:i,focusInitial:r,onFocus:Ji,onBlur:()=>en(u),onChange:e=>Qi(e,u),onKeyDown:e=>tn(e,u),value:l?"":t,placeholder:l,preventCaptureArrowShortcuts:!0,style:{paddingBottom:8}})}const Qi=(e,t)=>{Xi(e.target.value,t)},Xi=(e,t)=>{const i=qi.Z.state;if(!i.open)return;const{editingToken:n,savedTextSelectionState:a}=i;if(!n)return;if(!e)return void qi.Z.setState({...i,title:""});const{environment:o,setPlaceholder:s,hasTitleChanged:r}=t;lt.createAndCommit({userAction:"LinkMenu.updateTitle",environment:o,perform:t=>{const l=Li.iX({environment:o,title:e,transaction:t,editingToken:n,savedTextSelectionState:a});l&&qi.Z.setState({...i,...l,title:e}),s(void 0),r.current=!0}})},Ji=()=>{(0,Ni.ZG)(!0)},en=e=>{nn(e),(0,Ni.ZG)(!1)},tn=(e,t)=>{"Enter"!==e.key&&"Escape"!==e.key||(e.stopPropagation(),en(t))},nn=e=>{const t=qi.Z.state;if(!t.open)return;const{defaultTitle:i,setPlaceholder:n}=e;t.title||(Xi(i,e),n(i))};var an=i(88632),on=i(18466),sn=i(59054),rn=i(49044),ln=i(11470),dn=i(15447);function cn(e){const{state:t}=e,i=(0,o.useMemo)((()=>(0,Ni.uP)(t)),[t]),n=(0,o.useMemo)((()=>(0,Ni.dY)(i)),[i]),s=function(e){const{state:t,inputUrl:i,query:n,handleLinkSelection:s}=e,{url:r}=t,d=(0,Ie.O7)(),c=(0,Ie.MO)(),u=(0,l.VK)((()=>an.Z.state.online),[]),p=!!r;return(0,o.useMemo)((()=>{let e,l=!1;if(!i&&p)e=a()(k.FormattedMessage,{defaultMessage:"Type a complete URL to link",id:"selectionLinkButton.invalidUrl",description:"Caption for the disabled link to URL menu item when the user has typed an incomplete URL"}),l=!0;else{if(!i)return;if("notion"===i.type&&u)return;"web"===i.type?e=a()(k.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===i.type?e=a()(k.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===i.type?e=a()(k.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):(0,Ii.t1)(i.type)}return{key:"link to url",action:()=>s(d,t,n,c),render:t=>o.createElement(fe.Z,ce()({},t,{title:r,caption:e,icon:Yt.Z.globe2({width:16,paddingTop:4}),disabled:l}))}}),[t,n,d,c,u,i,s,p,r])}({state:t,inputUrl:n,query:i,handleLinkSelection:un}),r=function(e){const{state:t,inputUrl:i,query:n,additionalItem:s}=e,{editingToken:r}=t,d=function(e){const{state:t,inputUrl:i,query:n,handleLinkSelection:s,disableEmptyQueryResults:r}=e,{savedTextSelectionState:d}=t,c=(0,Ie.O7)(),u=(0,Ie.MO)(),[{online:p}]=(0,l.AF)(an.Z),m=(0,o.useMemo)((()=>{var e;const t=null===(e=(0,yt.QY)(d.multiSelection))||void 0===e?void 0:e.store;if(t&&(0,I.NZ)(t))return t}),[d]),[{value:g,status:h}]=(0,sn.r5)((async()=>p?n?(await rn.WL({nearBlock:m,environment:c,query:n,source:"mention_menu",limit:10})).map((e=>e.id)):r?[]:dn.X4.state.map((e=>e.pageId)):[]),[n,m,c,p,r]),f=(0,o.useMemo)((()=>{if(i&&"notion"===i.type){const e=g?q().without(g,i.notionPage.blockId):[];return[i,...e]}return g}),[g,i]);return(0,o.useMemo)((()=>{if(!f||0===f.length)return;if(i&&"web"===i.type&&i.url===n)return;const e=on.Z.withListenerIgnored(dt.RM);if(!e)return;const r=t.url?5:3,l=a()(k.FormattedMessage,{id:"selectionLinkButton.linkToPage.linkToBlock",defaultMessage:"Link to block",description:"Shown beneath a page title if linking to a block inside that page"}),d=a()(k.FormattedMessage,{defaultMessage:"Link to page",id:"selectionLinkButton.linkToPageSection.title"});return{items:f.map(((i,n)=>{const r="object"==typeof i?i.notionPage.peekViewBlockId||i.notionPage.blockId:i,d=J.G.createChildStore(e,{table:Ft.iU,id:r});return{key:n,action:()=>{if("object"==typeof i){const e=(0,Di.nR)({pageId:i.notionPage.blockId,peekViewBlockId:i.notionPage.peekViewBlockId,peekMode:i.notionPage.peekMode,discussionId:i.notionPage.discussionId,collectionViewId:i.notionPage.collectionViewId,scrollToBlockId:i.notionPage.scrollToBlockId});s(c,t,e,u)}else s(c,t,(0,Di.nR)({pageId:r}),u)},render:e=>{const t="object"==typeof i&&i.notionPage.scrollToBlockId;return o.createElement(ln.Z,ce()({},e,{store:d,caption:t?l:void 0,placeholder:a()(Ai.Z,{showHold:300,showDelay:300,show:"resolved"===h,render:e=>a()(k.FormattedMessage,e?{id:"selectionLinkButton.linkToPage.unknownBlock",defaultMessage:"Unknown block"}:{id:"selectionLinkButton.linkToPage.loading",defaultMessage:"Loading..."})})}))}}})).slice(0,r),title:f.some((e=>Boolean("object"==typeof e&&e.notionPage.scrollToBlockId)))?l:d}}),[f,t,c,u,n,i,h,s])}({state:t,inputUrl:i,query:n,handleLinkSelection:un,disableEmptyQueryResults:!!r});return(0,o.useMemo)((()=>{if(d||s){return{key:"results",items:q().compact([...(null==d?void 0:d.items)||[],s]),render:e=>o.createElement(oe.Z,ce()({},e,{title:r||n?void 0:a()(k.FormattedMessage,{id:"selectionLinkButton.recents.title",defaultMessage:"Recents",description:"Header for suggested recent pages"})}))}}}),[d,s,r,n])}({state:t,inputUrl:n,query:i,additionalItem:s}),d=(0,Ni.Fs)(t),c=d&&(0,Di.A5)({url:d,baseUrl:vt.Z.domainBaseUrl,publicDomainName:vt.Z.publicDomainName}),u=(0,l.VK)((()=>{if(!c)return;const e=(0,dt.RM)();return e?J.G.createChildStore(e,{table:Ft.iU,id:c}):void 0}),[c]),p=function(e){const{state:t,url:i,isEmptyResults:n,pageStore:s}=e;return(0,o.useMemo)((()=>{let e=a()(k.FormattedMessage,{defaultMessage:"Page or URL",id:"selectionLinkButton.currentInfo.pageOrUrl",description:"Section title for the currently linked page or URL"});const r=!t.focusLinkInput&&n;let l;return s?l={key:"link to page",action:()=>{},render:()=>a()(ji,{state:t,showPreview:r,store:s})}:i?l={key:"link to web",action:()=>{},render:()=>a()(ji,{state:t,showPreview:!0})}:(e=void 0,l={key:"create link",action:()=>{},render:()=>a()(ji,{state:t,showPreview:r})}),{key:"page or url",render:t=>o.createElement(oe.Z,ce()({title:e},t)),items:[l]}}),[t,i,n,s])}({state:t,url:d,isEmptyResults:!Boolean(r),pageStore:u}),m=function(e){const{state:t,url:i,pageStore:n}=e,{editingToken:s,title:r,focusTitleInput:d}=t,c=(0,l.VK)((()=>n?ot.Q(n.getTitleValue()):void 0),[n]);return(0,o.useMemo)((()=>{if(s)return{key:"link title",render:e=>o.createElement(oe.Z,ce()({title:a()(k.FormattedMessage,{defaultMessage:"Link title",id:"selectionLinkButton.currentInfo.linkTitle",description:"Section title for the currently linked page or URL's title"})},e)),items:[{key:"update title",action:()=>{},render:()=>a()(Yi,{title:r,defaultTitle:c??i,focus:d})}]}}),[s,r,d,i,c])}({state:t,url:d,pageStore:u}),g=function(e){const{state:t}=e,i=function(e){const{state:t}=e,i=(0,Ie.O7)();return(0,o.useMemo)((()=>{if(t.editingToken)return{key:"unlink",action:()=>{Li.PP(i);const e=(0,Ni.Fs)(t);G.oSR(i,{type:"remove_link",url:e})},render:e=>o.createElement(fe.Z,ce()({},e,{title:a()(k.FormattedMessage,{id:"selectionLinkButton.removeLink",defaultMessage:"Remove link"}),icon:Yt.Z.trash({width:16})}))}}),[t,i])}({state:t});return(0,o.useMemo)((()=>{const e=q().compact([i]);if(0!==e.length)return{key:"link actions",render:e=>o.createElement(oe.Z,ce()({topBorder:!0},e)),items:e}}),[i])}({state:t});let h,f;return r?(f=1,h=q().compact([p,r])):(f=void 0,h=q().compact([p,m,g])),{initialFocus:f,sections:h}}function un(e,t,i,n){const a=(0,Vi.D5)(i);if(!a)return;const{editingToken:o,savedTextSelectionState:s,title:r}=t;lt.createAndCommit({userAction:"LinkMenu.handleLinkSelection",environment:e,perform:i=>{const l=Li.gp({environment:e,transaction:i,url:a,title:r,editingToken:o,savedTextSelectionState:s});l?(G.oSR(e,{type:"edit_link",url:a}),qi.Z.setState({...t,...l,url:"",focusLinkInput:!1,focusTitleInput:Boolean(n)})):(G.oSR(e,{type:"create_link",url:a}),qi.Z.reset())}})}var pn=i(52358);function mn(){window.__c={n:"LinkMenu"};const e=(0,l.VK)((()=>qi.Z.state),[]),t=(0,Ie.Fy)(),i=(0,l.VK)(r.bq,[]),n=(0,l.VK)((()=>{if(!e.open)return!1;if(e.focusLinkInput||e.focusTitleInput)return!1;const t=kt.default.state;if("editing"!==t.mode)return!0;const i=(0,yt.QY)(t.multiSelection);if(!i)return!0;const{store:n,selection:a}=i;return(0,bi.wd)(a)?!ot.oP(n.getValue(),a.startIndex,a.endIndex,ot.GK.Link):!(0,yt._v)(t.multiSelection,e.savedTextSelectionState.multiSelection)}),[e]);return(0,o.useEffect)((()=>{n&&Li.F5()}),[n]),a()(U.ZP,{popupType:t.isMobile?t.isTablet?U.ZP.PopupType.Popup:U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,style:{width:bn(i)},keepFocus:t.isPhone,open:e.open,originRect:e.open?e.selectionRect:void 0,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Center,originGap:8,disableContentScroll:!0,onDismiss:Li.F5,render:()=>e.open?a()(gn,{state:e}):void 0,preventBlockRenderQueueOnEnter:!t.isMobile})}function gn(e){window.__c={n:"LinkMenuContent"};const{state:t}=e,i=(0,Ie.MO)(),[n,s]=(0,o.useState)(!0);if((0,o.useEffect)((()=>s(!1)),[]),t.showCreateIn&&!i)return a()(fn,{state:t});let r;return r=i?{menuType:_.og.Modal,title:a()(k.FormattedMessage,{defaultMessage:"Link",id:"selectionLinkButton.mobile.title"}),right:a()(D.CancelMenuText,{}),onClickRight:Li.F5,footer:a()(U.ZP,{popupType:U.ZP.PopupType.SlideUp,open:t.showCreateIn||!1,render:()=>a()(fn,{state:t})})}:{menuType:_.og.Popup},a()(_t.Z,{capture:t.open&&(n||t.focusLinkInput||t.focusTitleInput),allowEsc:!0},void 0,o.createElement(E.Z,r,a()(Fe.Z,{capture:i&&!t.focusLinkInput&&!t.focusTitleInput,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!0,render:()=>a()(hn,{state:t,useMenuList:cn})})),a()(B.Z,{capture:!0,onCommandSlash:Ni.FV}))}function hn(e){window.__c={n:"LinkMenuList"};const{state:t,useMenuList:i}=e,{initialFocus:n,sections:o}=i({state:t});return a()(ve.Z,{type:ve.i.Vertical,initialFocus:n,sections:o})}function fn(e){var t;window.__c={n:"LinkCreateInMenu"};const{state:i}=e,n=(0,Ie.O7)(),s=(0,o.useCallback)((async e=>{var t;if(!Oi.M_(n))return;const a=null===(t=(0,yt.QY)(i.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;if(!a)return;const{performResult:{createInState:o}}=await lt.createAndCommitAsync({environment:n,userAction:"LinkMenu.LinkCreateInMenu",waitForServerCommit:!0,perform:async t=>{const o=Ri.f8({environment:n,transaction:t,titleText:i.url||"",createInValue:e,recordStoreParent:a}),[s]=o.createdPages;return s&&(Li.gp({environment:n,url:(0,Di.nR)({pageId:s.id}),transaction:t,editingToken:i.editingToken,savedTextSelectionState:i.savedTextSelectionState}),qi.Z.reset()),await o.moveToStorePromise,{createInState:o}}});await Ri.c_({analyticsFrom:"link_menu",createInState:o})}),[i,n]),d=null===(t=(0,yt.QY)(i.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,c=d&&"block"===d.table?d.id:void 0,u=(0,l.VK)(r.bq,[]);return a()(pn.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:s,captureSelection:!1,restoreSelection:!1,parentBlockId:c,onAutocompleteQueryChange:vn,autocompleteQuery:i.createInQuery||"",desktopWidth:bn(u),onCancel:yn})}function vn(e){const t=qi.Z.state;t.open&&qi.Z.setState({...t,createInQuery:e})}function yn(){const e=qi.Z.state;e.open&&qi.Z.setState({...e,showCreateIn:!1,createInQuery:""})}function bn(e){return e?400:330}var Sn=i(27153),wn=i(91390),Mn=i(65792),Cn=i.n(Mn),kn=i(79362),Tn=i(47425),_n=i(54642),In=i(91584),xn=i(96802),Zn=i(45766),Pn=i(64964),Fn=i(53471),An=i(34809),Bn=i(5385);const En="fileTypeAnyFiles",Dn="fileTypeImages",Rn="fileTypeVideos",Ln="fileTypeNone";var On=i(4323),Nn=i(21115),Vn=i(78609);class Un extends Re.Z{getInitialState(){return{random_id:""}}}const Wn=Un;var zn=i(4391),Kn=i(33846),qn=i(78291),Hn=i(73657),Gn=i(42922),jn=i(55118);function $n(e){let{type:t,dropTargetKey:i,children:n,dropzoneStyle:s,onDropFile:r}=e;window.__c={n:"FileDropTarget"};const d=(0,l.VK)((()=>h.default.state.currentSpaceStore),[]);if(!d)return o.createElement(o.Fragment,null,n);const c=e=>1===e.length&&function(e){let{fileMimeType:t,allowedType:i}=e;switch(i){case En:return!0;case Dn:return function(e){return e.startsWith("image")&&!e.includes("photoshop")}(t);case Rn:return function(e){return e.startsWith("video")}(t);case Ln:return!1;default:(0,Ii.t1)(i)}}({allowedType:t,fileMimeType:e[0]}),u=e=>{let{files:t}=e;c(t.map((e=>e.type)))?r({type:"validFileDrop",file:t[0]}):r({type:"invalidFileDrop",file:t[0]})};return a()(R.Z,{store:d,droppable:!0,render:()=>a()(jn.G,{dropTargetKey:i,canNativeDropOnto:!0,onNativeDrop:u,keepTextSelectionOnDrop:!0,shouldShowDropZone:!0,dropzoneStyle:s,canAcceptDrop:e=>e.isNativeDrag},void 0,n)})}var Yn=i(71669),Qn=i(16354),Xn=i(81865),Jn=i(77137),ea=i(62385),ta=i(30506),ia=i(91718),na=i(43001),aa=i(23321),oa=i(37181),sa=i(98742),ra=i(61766),la=i(31945),da=i(73063),ca=i(86825),ua=i(57670);const pa=(0,k.defineMessages)({selectSpecificIconColor:{defaultMessage:"Select icon color {iconColor}",id:"iconPickerColorPicker.selectSpecificColor",description:"Aria label for button in Icon Picker that lets the user select a default color for their icons"},selectIconColor:{defaultMessage:"Select icon color",id:"iconPickerColorPicker.selectColor",description:"Tooltip for button in Icon Picker, that when pressed, lets the user select a default color for their icons"},selectIconColorWithCurrentColor:{defaultMessage:"Select icon color, {iconColor} selected",id:"iconPickerColorPicker.selectColorWithCurrentColor",description:"Aria label for button in Icon Picker, that when pressed, lets the user select a default color for their icons"},noIconColor:{defaultMessage:"no color",id:"iconPickerColorPicker.noColor",description:"Aria label in Icon picker that indicates that no icon color is currently selected as a default"}});function ma(){window.__c={n:"IconPickerColorPicker"};const e=(0,l.VK)((()=>{var e,t,i;return null===(e=h.default.state)||void 0===e||null===(t=e.currentUserSettingsStore)||void 0===t||null===(i=t.getSettings())||void 0===i?void 0:i.icon_picker_color}),[]),t=(0,k.useIntl)(),i=(0,Ie.O7)(),n=(0,xe.Fg)(),s=(0,Ie.Fy)(),r=(0,l.qz)(void 0,ra.Z);return a()(li.Z,{renderTooltip:()=>t.formatMessage(pa.selectIconColor),placement:li.Z.Placement.Bottom,render:l=>a()(la.Z,{preventBlockRenderQueueOnEnter:!0,buttonPopupStore:r,popupType:la.Z.PopupType.Popup,renderOrigin:i=>o.createElement(ae.DO,ce()({ariaLabel:t.formatMessage(pa.selectIconColorWithCurrentColor,{iconColor:t.formatMessage(e?kn.RR[e]:pa.noIconColor)}),icon:t=>Yt.Z.colorPickerCircle({...t,stroke:e?kn.Lr[n.mode][e]:kn.Lr[n.mode].lightgray,fill:e?kn.Lr[n.mode][e]:n.lightIconColor})},(0,sa.Z)(i,l))),render:r=>function(e){window.__c={n:"renderIconColorMenu"};const{parent:t,environment:i,currentIconPickerColor:n,theme:s,device:r,intl:l}=e,d=kn.Oe.map((e=>({key:e,action:n=>{t.close(),ga({environment:i,color:e})},render:t=>a()(li.Z,{renderTooltip:()=>l.formatMessage(kn.RR[e]),placement:li.Z.Placement.Bottom,render:i=>o.createElement(da.Z,ce()({},(0,sa.Z)(i,t),{ariaLabel:l.formatMessage(pa.selectSpecificIconColor,{iconColor:l.formatMessage(kn.RR[e])}),style:{...r.isMobile?{width:ua.Z.mobileButtonSize,height:ua.Z.mobileButtonSize}:{width:ua.Z.desktopButtonSize,height:ua.Z.desktopButtonSize}},icon:t=>Yt.Z.colorPickerCircle({...t,height:r.isMobile?18:14,width:r.isMobile?18:14,stroke:kn.Lr[s.mode][e],fill:kn.Lr[s.mode][e]})}))})})));return d.push({key:"askEveryTime",action:()=>{t.close(),ga({environment:i,color:void 0})},render:e=>o.createElement(ca.Z,ce()({},e,{title:a()(k.FormattedMessage,{id:"iconPickerColorPicker.askEveryTime",defaultMessage:"Ask every time",description:"Text of toggle button in icon color picker, that when enabled, makes it so that the user will select the icon color every time they choose an icon, instead of relying on a default icon color."}),onClick:()=>{ga(void 0!==n?{environment:i,color:void 0}:{environment:i,color:"gray"})},on:void 0===n,style:{boxShadow:void 0},textWrapperStyle:{marginLeft:r.isMobile?10:6},rightStyle:{marginRight:4}}))}),a()(_t.Z,{capture:!0,allowEsc:!0},void 0,a()(ve.Z,{type:ve.i.Grid,itemsPerRow:5,initialFocus:n?Math.max(kn.Oe.indexOf(n),0):10,sections:[{key:"variations",render:e=>o.createElement("div",e),items:d}],renderRow:(e,t)=>a()("div",{style:{display:"flex",padding:4,...t<2&&void 0===n&&{opacity:.5},...2===t&&{padding:"0 0 4px 0",flexDirection:"row-reverse"}}},t,e)}))}({parent:r,environment:i,currentIconPickerColor:e,theme:n,device:s,intl:t})})})}function ga(e){const{environment:t,color:i}=e,{currentUserSettingsStore:n}=h.default.state;n&&lt.createAndCommit({userAction:"mediaPicker.setIconPickerColor",environment:t,perform:e=>{const t=void 0!==i?i:null;oa.d2({userSettingsStore:n,transaction:e,data:{icon_picker_color:t}})}})}var ha=i(42402),fa=i(78948),va=i(6202);const ya=(0,k.defineMessages)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://…"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filter…"},unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an image…"},giphyPlaceholder:{id:"mediaPicker.giphyPlaceholder.text",description:"Placeholder message for Input",defaultMessage:"Search GIPHY"}});class ba extends s.Z{constructor(){super(...arguments),this.menuRef=o.createRef(),this.storeTypes={embedInputStore:Kn.Z,emojiInputStore:Kn.Z,iconInputStore:Kn.Z,iconPickerStore:zn.Z,unsplashInputStore:Kn.Z,giphyInputStore:Kn.Z,giphyRandomIdStore:Wn},this.renderUnsplashResults=(e,t,i,n)=>n?!i||i&&!i.length?a()(Hn.Z,{shouldWrapCaption:!0,caption:a()(k.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):a()(o.Fragment,{},void 0,i.map((t=>this.renderUnsplashImage(e,t))),a()(Hn.Z,{shouldWrapCaption:!0,caption:a()(k.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}})):a()("div",{style:this.getLoadingContainerStyle()},void 0,a()(si.Z,{})),this.renderUnsplashImage=(e,t)=>{const{device:i}=this.environment;return a()("div",{style:{width:i.isMobile?"33%":"25%",padding:3}},t.id,a()(Ui.Z,{hoveredStyle:{opacity:.85},onClick:()=>this.handleSelectUnsplashImage(e,t)},void 0,a()(Yn.Z,{src:t.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:3}})),a()(Ce.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4}},void 0,a()(k.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",description:"Caption attributing the author of the Unsplash image",values:{authorName:t.authorName,inlinetextlink:e=>a()(ha.Z,{external:!0,href:t.unsplashUrl},void 0,e)}})))},this.renderGiphyResults=(e,t,i,n)=>n?!i||i&&!i.length?a()(Hn.Z,{shouldWrapCaption:!0,caption:a()(k.FormattedMessage,{defaultMessage:"No results found.",description:"Placeholder message when no results found",id:"mediaPicker.giphy.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):a()(o.Fragment,{},void 0,i.map((t=>this.renderGiphyImage(e,t))),a()(Hn.Z,{shouldWrapCaption:!0,caption:a()(k.FormattedMessage,{defaultMessage:"Search to find more results.",description:"Callout for nudging the user to search",id:"mediaPicker.giphy.searchText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}})):a()("div",{style:this.getLoadingContainerStyle()},void 0,a()(si.Z,{})),this.renderGiphyImage=(e,t)=>{const{device:i}=this.environment;return a()("div",{style:{width:i.isMobile?"33%":"25%",padding:3}},t.id,a()(Ui.Z,{hoveredStyle:{opacity:.85},onClick:()=>this.handleSelectGiphyImage(e,t)},void 0,a()(Yn.Z,{src:t.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:3}})),a()(Ce.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4}},void 0,a()(k.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.giphy.byAuthor",description:"Caption attributing the author of the Giphy image",values:{authorName:t.authorName||"GIPHY",inlinetextlink:e=>a()(ha.Z,{external:!0,href:t.imageUrl},void 0,e)}})))},this.handleEmbedSubmit=e=>()=>{const t=this.stores.embedInputStore.state.inputValue;if(t){const i=(0,$t.Wv)(t,vt.Z.secureFileS3.url,vt.Z.secureFileConfig.rootPath,vt.Z.secureFileConfig.hostname),n=i?i.link:t;e.onChange(n),G.bOx(this.environment,{pastedText:n,source:"media_picker"})}},this.handleSelectUnsplashImage=async(e,t)=>{const i=await(0,An.Z)({environment:this.environment,url:t.downloadUrl,method:"GET",format:"json"});"success"===i.type&&e.onChange({url:i.data.url})},this.performGiphyGetRandomIdRequest=async()=>{const{giphyRandomIdStore:e}=this.stores;if(!q().isEmpty(e.getState().random_id))return e.getState().random_id;const t=await _n.getGiphyRandomId(this.environment,{});return"success"===t.type?(e.setState({...e.state,random_id:t.data.random_id}),t.data.random_id):void 0},this.handleSelectGiphyImage=async(e,t)=>{var i;if(e.onChange({url:t.imageUrl}),null!==(i=t.analytics)&&void 0!==i&&i.onclick)try{var n;await _n.postGiphyAnalytics(this.environment,{url:null===(n=t.analytics)||void 0===n?void 0:n.onclick.url,timestamp:Date.now(),random_id:this.stores.giphyRandomIdStore.state.random_id})}catch(a){}},this.handleSwipeLeft=()=>{if(!wn.Z.state.isActive)return;const e=this.getTabs(),t=e.map((e=>e.type)).indexOf(wn.Z.state.currentTab),i=e[t+1];void 0!==i&&this.handleTabChange(i.type)},this.handleSwipeRight=()=>{if(!wn.Z.state.isActive)return;const e=this.getTabs(),t=e.map((e=>e.type)).indexOf(wn.Z.state.currentTab),i=e[t-1];void 0!==i&&this.handleTabChange(i.type)},this.handleTabChange=e=>{if(wn.Z.state.isActive&&(wn.Z.setState({...wn.Z.state,currentTab:e}),"icon"===e)){const{currentUserSettingsStore:e}=h.default.state;Zn.D({environment:this.environment,currentUserSettingsStore:e}),wn.Z.state.recordIconLoggingData&&G.kz9(this.environment,"select_icon_tab",wn.Z.state.recordIconLoggingData)}},this.handleRandomEmojiClick=()=>{const{device:e}=this.environment,t=this.getTabs().find((e=>e.type===this.props.currentTab));if(t&&"emoji"===t.type){const i=xn.zM();t.onChange(i,{keepVisible:!e.isMobile})}},this.handleRandomIconClick=()=>{const{device:e}=this.environment,{iconPickerStore:t}=this.stores,i=this.getTabs().find((e=>e.type===this.props.currentTab));if(i&&"icon"===i.type){const n=i.enforceIconColor??Bn.x(),a=`/icons/${q().sample(Object.keys(t.getState().allIcons))}_${n??q().sample(kn.Oe)}.svg`;i.onChange(a,{keepVisible:!e.isMobile})}},this.handleFilterChange=e=>{const{emojiInputStore:t,iconInputStore:i,iconPickerStore:n}=this.stores,a=this.getNumIconPerRow()*(this.environment.device.isMobile?qt.pq:qt.II),o=this.getNumIconPerRow()*(this.environment.device.isMobile?aa.L6:aa.OF);t.setState({...t.state,inputValue:e.currentTarget.value}),Vn.Z.setState({...Vn.Z.state,loadEmojiCount:a}),i.setState({...i.state,inputValue:e.currentTarget.value}),n.setState({...n.state,loadIconCount:o})}}renderComponent(){const{device:e}=this.environment,t=this.renderTabsHeader(),i=this.renderInputHeader(),n=(t||i)&&a()(o.Fragment,{},void 0,t,i);let s;if(e.isMobile)s={menuType:_.og.Modal,title:this.props.title,header:n,right:a()(k.FormattedMessage,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:this.props.onCancel,left:this.props.onDelete&&a()(k.FormattedMessage,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:this.props.onDelete};else{s={menuType:_.og.Popup,header:n};const e=this.getTabs().find((e=>e.type===this.props.currentTab)),t=e&&"custom"===e.type?e.tabHeight:void 0;s.width=this.props.popupWidth||300,s.height=t||this.props.popupHeight,s.maxHeight=this.props.maxHeight,s.maxWidth=this.props.maxWidth}return a()(ta.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>o.createElement(E.Z,ce()({},s,e,{className:me.tQh,innerRef:this.menuRef}),this.renderCurrentTab())})}renderTabsHeader(){const{device:e}=this.environment;if(!(this.getTabs().length<=1)||this.props.onDelete){const t={gallery:a()(k.FormattedMessage,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:a()(k.FormattedMessage,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:a()(k.FormattedMessage,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:a()(k.FormattedMessage,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),icon:a()(k.FormattedMessage,{id:"mediaPicker.tabs.icon",defaultMessage:"Icon",description:"Icon tab heading"}),custom:a()(k.FormattedMessage,{id:"mediaPicker.tabs.custom",defaultMessage:"Custom",description:"Upload or embed a custom image"}),unsplash:a()(o.Fragment,{},void 0,Yt.Z.unsplashLogo({width:12,marginRight:4,height:12}),a()("span",{},void 0,"Unsplash")),giphy:a()(o.Fragment,{},void 0,Yt.Z.giphyLogo({width:12,marginRight:4,height:12}),a()("span",{},void 0,"GIPHY")),drive:a()(k.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),box:a()(k.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"})},i=this.getTabs(),n=i.findIndex((e=>e.type===this.props.currentTab)),s=i.map((e=>e.title||t[e.type])),r=i.find((e=>e.type===this.props.currentTab)),l=r&&"emoji"!==r.type&&e.isAndroid;return a()(L.Z,{tabs:s,selectedIndex:n,onChange:e=>{const t=i[e];this.handleTabChange(t.type)},right:this.props.onDelete&&!e.isMobile&&a()(ri.Z,{isGray:!0,onClick:this.props.onDelete},void 0,a()(k.FormattedMessage,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"})),style:{...l&&{borderBottom:"none"}}})}}renderInputHeader(){const{isPhone:e,isMobile:t,isAndroid:i}=this.environment.device,n=this.getTabs().find((e=>e.type===this.props.currentTab));if(n&&("emoji"===n.type||"icon"===n.type)){const s="emoji"===n.type?this.stores.emojiInputStore.state.inputValue:this.stores.iconInputStore.state.inputValue,r="emoji"===n.type?this.handleRandomEmojiClick:this.handleRandomIconClick,l=this.renderColorPicker({hasRandomButtonOnLeft:!n.hideRandomButton});return a()("div",{style:{display:"flex",...e?{}:{marginTop:16,marginBottom:10}}},void 0,a()(ae.ZP,{value:s,placeholder:ge.default.formatMessage(ya.filterPlaceholder),autoFocus:!t||void 0,focus:!t||void 0,showClearButton:!0,inputLeft:a()(ae.f_,{icon:Yt.Z.searchThick}),onChange:this.handleFilterChange,right:a()("div",{style:{display:"flex"}},void 0,null!=n&&n.hideRandomButton?void 0:a()(li.Z,{renderTooltip:()=>a()(k.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:li.Z.Placement.Bottom,render:e=>o.createElement(ae.DO,ce()({icon:Yt.Z.shuffle,onClick:r},e))}),l),isRightLastElementOfInput:!0,style:{...i&&{borderBottom:"none"}}}))}}renderColorPicker(e){const t=this.getTabs().find((e=>e.type===this.props.currentTab));if(!t)return null;let i;return"emoji"===(null==t?void 0:t.type)?i=a()(na.Z,{}):"icon"===(null==t?void 0:t.type)&&void 0===t.enforceIconColor&&(i=a()(ma,{})),e.hasRandomButtonOnLeft&&i?a()("div",{style:{marginLeft:6}},void 0,i):i}renderCurrentTab(){const e=this.getTabs().find((e=>e.type===this.props.currentTab));if(!e)return a()(k.FormattedMessage,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(e.type){case"embed":return this.renderEmbedTab(e);case"file":return this.renderUploadTab(e);case"emoji":return this.renderEmojiTab(e);case"icon":return this.renderIconTab(e);case"gallery":return this.renderGalleryTab(e);case"unsplash":return this.renderUnsplashTab(e);case"giphy":return this.renderGiphyTab(e);case"drive":return this.renderGoogleDriveTab(e);case"box":return this.renderBoxTab(e);case"custom":return this.renderCustomEmbedUploadTab(e)}}renderEmojiTab(e){return a()(qt.ZP,{onSubmit:e.onChange,filter:this.stores.emojiInputStore.state.inputValue||"",isCallout:this.props.isCallout,iconLoggingData:this.props.recordIconLoggingData,menuRef:this.menuRef})}renderIconTab(e){return a()(aa.ZP,{store:this.stores.iconPickerStore,filter:this.stores.iconInputStore.state.inputValue||"",onSubmit:e.onChange,iconLoggingData:this.props.recordIconLoggingData,enforceIconColor:e.enforceIconColor,menuRef:this.menuRef})}renderGalleryTab(e){return a()("div",{style:{paddingBottom:8}},void 0,q().map(On.Z,((t,i)=>a()(oe.Z,{title:a()(Qn.Z,{style:{marginLeft:-5},href:t.url,external:!0},void 0,a()(ea.Z,{},void 0,ge.default.formatMessage(t.title))),isTitleUppercase:!0,noTextOverflow:!0},i,a()("div",{style:this.getGalleryWrapStyle()},void 0,t.items.map(((t,i)=>{let{coverUrl:n,title:s,subtitle:r,position:l}=t;return a()("div",{style:{width:"25%",padding:3}},i,a()(li.Z,{originGap:0,placement:li.Z.Placement.Bottom,delayThreshold:600,renderTooltip:()=>a()("div",{style:{maxWidth:180,whiteSpace:"normal"}},void 0,a()("span",{style:{color:this.theme.regularInvertedTextColor}},void 0,ge.default.formatMessage(s))," ",a()("span",{style:{color:this.theme.mediumInvertedTextColor}},void 0,r&&ge.default.formatMessage(r))),render:t=>o.createElement(Ui.Z,ce()({hoveredStyle:{opacity:.85}},t,{onClick:()=>{e.onChange({url:n,position:l})}}),a()(Xn.Z,{url:n,width:200,isAuthenticated:!1,render:(e,t)=>t&&a()(Yn.Z,{src:t,style:{width:"100%",height:64,objectFit:"cover",objectPosition:`center ${100*(l||0)}%`,borderRadius:3}})}))}))})))))))}renderUnsplashTab(e){const{device:t}=this.environment;return a()("div",{style:{paddingBottom:8}},void 0,a()(oe.Z,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,a()(ae.ZP,{value:this.stores.unsplashInputStore.state.inputValue,placeholder:ge.default.formatMessage(ya.unsplashPlaceholder),showClearButton:!0,focus:!t.isMobile||void 0,onChange:e=>{this.stores.unsplashInputStore.setState({...this.stores.unsplashInputStore.state,inputValue:e.target.value})}})),a()("div",{style:this.getGalleryWrapStyle()},void 0,a()(Jn.Z,{request:this.stores.unsplashInputStore.state.inputValue,debounce:rn.vp,performRequest:async e=>{const t=await _n.searchUnsplashImages(this.environment,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(t,i,n)=>this.renderUnsplashResults(e,t,i,n)})))}renderGiphyTab(e){const{device:t}=this.environment;return a()("div",{style:{paddingBottom:8}},void 0,a()(oe.Z,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,a()(ae.ZP,{value:this.stores.giphyInputStore.state.inputValue,placeholder:ge.default.formatMessage(ya.giphyPlaceholder),showClearButton:!0,focus:!t.isMobile||void 0,onChange:e=>{this.stores.giphyInputStore.setState({...this.stores.giphyInputStore.state,inputValue:e.target.value})}})),a()("div",{style:this.getGalleryWrapStyle()},void 0,a()(Jn.Z,{request:this.stores.giphyInputStore.state.inputValue,debounce:rn.vp,performRequest:async e=>{await this.performGiphyGetRandomIdRequest();const t=await _n.searchGiphyImages(this.environment,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(t,i,n)=>this.renderGiphyResults(e,t,i,n)})))}renderCustomEmbedUploadTab(e){const{device:t}=this.environment,{data:i}=qn.default.state,n=a()(Gn.Z,{onClick:this.handleEmbedSubmit(e),disabled:0===this.stores.embedInputStore.state.inputValue.length,hovered:!1},void 0,e.buttonText||a()(k.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"})),s=a()(oe.Z,{desktopStyle:{marginTop:16,display:"flex",paddingTop:0,paddingBottom:12}},void 0,a()(ae.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||ge.default.formatMessage(ya.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})},inputRight:t.isPhone?n:void 0,right:t.isPhone?void 0:n,isRightLastElementOfInput:!0})),r=a()($n,{type:this.getAllowedFileTypeFromTab(e)??Ln,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):Pn.oV({label:a()(k.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",description:"Error message that shows when a user tries to drop an invalid file type into the image upload modal.",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,jt.fn)([jt.ZP.blueWithAlpha(.14),Cn()(this.theme.contentBackground).alpha(.5).css()])}},void 0,a()("div",{style:{marginTop:-24,paddingTop:24}},void 0,e.fileUpload&&a()(oe.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24}},void 0,a()(va.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>this.handleUpload(e),fullWidth:this.props.isSmallWidth})),this.renderMediaCapture(e),e.caption&&a()(Hn.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||i&&Nn.YK(i)&&a()("div",{style:{height:8}}),i&&!e.preventUploadLimitFreeFileSize&&!Nn.YK(i)&&a()(Hn.Z,{shouldWrapCaption:!0,caption:a()("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"}},void 0,a()("div",{style:{marginRight:6,color:this.theme.mediumTextColor}},void 0,a()(k.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:Fn.K_}})),!it.default.isOnboarding.state&&a()(ia.Z,{subscriptionTier:Nn.M9(this.environment)||Tn.$M,onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}}))})));return o.createElement(o.Fragment,null,s,r)}renderUploadTab(e){const{data:t}=qn.default.state;return a()($n,{type:this.getAllowedFileTypeFromTab(e)??Ln,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):Pn.oV({label:a()(k.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",description:"Error message that shows when a user tries to drop an invalid file type into the image upload modal.",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,jt.fn)([jt.ZP.blueWithAlpha(.14),Cn()(this.theme.contentBackground).alpha(.5).css()])}},void 0,a()("div",{style:{marginTop:-24,paddingTop:24}},void 0,e.fileUpload&&a()(oe.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24}},void 0,a()(va.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>this.handleUpload(e),fullWidth:this.props.isSmallWidth})),this.renderMediaCapture(e),e.caption&&a()(Hn.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||t&&Nn.YK(t)&&a()("div",{style:{height:8}}),t&&!e.preventUploadLimitFreeFileSize&&!Nn.YK(t)&&a()(Hn.Z,{shouldWrapCaption:!0,caption:a()("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"}},void 0,a()("div",{style:{marginRight:6,color:this.theme.mediumTextColor}},void 0,a()(k.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:Fn.K_}})),!it.default.isOnboarding.state&&a()(ia.Z,{subscriptionTier:Nn.M9(this.environment)||Tn.$M,onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}}))})))}renderMediaCapture(e){if(e.imageUpload||e.videoUpload)return a()(oe.Z,{desktopStyle:{marginTop:4,display:"flex",justifyContent:"center",marginRight:12,marginLeft:12}},void 0,e.imageUpload&&a()(je.Z,{isLarge:!0,onClick:()=>this.handleUpload(e,"image/*"),style:{width:"100%"}},void 0,a()(k.FormattedMessage,{defaultMessage:"Upload file",id:"mediaPicker.chooseImage.buttonText"})),e.videoUpload&&a()(va.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),onClick:()=>this.handleUpload(e,"video/*"),fullWidth:this.props.isSmallWidth}))}renderEmbedTab(e){const{device:t}=this.environment;return a()(o.Fragment,{},void 0,a()(oe.Z,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,a()(ae.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||ge.default.formatMessage(ya.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})}})),a()(oe.Z,{},void 0,a()(va.Z,{onClick:this.handleEmbedSubmit(e),title:e.buttonText||a()(k.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:this.props.isSmallWidth})),e.caption&&a()(Hn.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:t.isMobile?"left":"center"}}))}renderGoogleDriveTab(e){return"accounts"in e?this.renderGoogleDriveAccounts(e):a()(Jn.Z,{request:this.environment,performRequest:In.vQ,render:(t,i,n)=>{if(!n)return a()(oe.Z,{},void 0,a()(fa.Z,{}));const o=i&&i.accounts?i.accounts:[];return this.renderGoogleDriveAccounts(e,o)}})}renderGoogleDriveAccounts(e,t){return"accounts"in e?e.accounts&&0===e.accounts.length?this.renderGoogleDriveConnectAccountOption(e):a()(o.Fragment,{},void 0,a()(oe.Z,{},void 0,e.accounts.map(((t,i)=>a()(fe.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.account_name}}),onClick:()=>e.onSelect(t),focused:!1},t.account_key)))),a()(oe.Z,{topBorder:!0},void 0,a()(fe.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1}))):t?0===t.length?this.renderGoogleDriveConnectAccountOption(e):a()(o.Fragment,{},void 0,a()(oe.Z,{},void 0,t.map(((t,i)=>a()(fe.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.accountName}}),onClick:()=>e.onSelect(t),focused:!1},t.accountId)))),a()(oe.Z,{topBorder:!0},void 0,a()(fe.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1}))):void 0}renderGoogleDriveConnectAccountOption(e){return a()(oe.Z,{},void 0,a()(fe.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),a()(Hn.Z,{shouldWrapCaption:!1,caption:a()(k.FormattedMessage,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})}))}renderBoxTab(e){const{accounts:t}=e;return 0===t.length?a()(oe.Z,{},void 0,a()(fe.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Connect Box account",id:"mediaPicker.menuItem.connectFirstBoxAccount.label",description:"Connect first box account"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),a()(Hn.Z,{shouldWrapCaption:!1,caption:a()(k.FormattedMessage,{defaultMessage:"Find and embed your Box files.",id:"mediaPicker.menuItem.connectFirstBoxAccount.caption",description:"Caption attributing user to connect their box account"})})):o.createElement(o.Fragment,null,a()(oe.Z,{},void 0,t.map((t=>a()(fe.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.account_name}}),onClick:()=>e.onSelect(t),focused:!1},t.account_key)))),a()(oe.Z,{topBorder:!0},void 0,a()(fe.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreBoxAccounts.label",description:"Add another box account"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})))}getTabs(){return this.props.tabs}getAllowedFileTypeFromTab(e){return e.fileUpload?En:e.imageUpload?Dn:e.videoUpload?Rn:void 0}async handleUpload(e,t){const i=await Fn.y({multiple:!1,accept:t});i.length&&e.onUpload(i[0])}getNumIconPerRow(){var e,t,i,n;return null!==(e=this.menuRef)&&void 0!==e&&null!==(t=e.current)&&void 0!==t&&t.offsetWidth?((null===(i=this.menuRef)||void 0===i||null===(n=i.current)||void 0===n?void 0:n.offsetWidth)-24)/32:12}getLoadingContainerStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1}}getGalleryWrapStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:this.theme.popoverBackground,paddingTop:e.isPhone?12:0,paddingBottom:e.isPhone?12:0,paddingLeft:e.isPhone?t.getSafePaddingLeftCSS(14):12,paddingRight:e.isPhone?t.getSafePaddingRightCSS(14):12,boxShadow:e.isPhone?`0 1px 0 ${this.theme.regularDividerColor}`:""}}}ba.displayName="MediaPicker";const Sa=ba;class wa extends s.Z{constructor(){super(...arguments),this.handleCloseOverlay=()=>{Sn.Z()}}renderComponent(){const{device:e}=this.environment,{state:t}=wn.Z;return a()(U.ZP,{popupType:e.isMobile?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originRect:void 0,originGap:t.isActive?t.originGap:void 0,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Center,preventScaleTransition:!0,onDismiss:this.handleCloseOverlay,render:()=>{if(t.isActive)return a()(B.Z,{capture:!0,onUp:q().identity,onDown:q().identity},void 0,o.createElement(Sa,ce()({},t,{onCancel:this.handleCloseOverlay})))}})}}wa.displayName="MediaMenu";const Ma=wa;var Ca=i(97762),ka=i(66897),Ta=i(41892),_a=i(32918),Ia=i(31942),xa=i(42875),Za=i(61784),Pa=i(89837),Fa=i(16953),Aa=i(92338),Ba=i(44805),Ea=i(7928),Da=i(47798),Ra=i(5978),La=i(993),Oa=i(17731),Na=i(80084),Va=i(83089),Ua=i(68890),Wa=i(63334),za=i(19111),Ka=i(69454),qa=i(72087),Ha=i(43765),Ga=i(82990);const ja={...Ga.Z.textOverflowStyle,fontWeight:Ga.Z.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function $a(e){const{pageTitle:t}=e;return a()(k.FormattedMessage,t?{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:a()("span",{style:ja},void 0,t)}}:{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function Ya(e){const{pageTitle:t}=e;return a()(k.FormattedMessage,t?{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:a()("span",{style:ja},void 0,t)}}:{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var Qa=i(85215),Xa=i(60442),Ja=i(97680);function eo(e){window.__c={n:"SvgWorkaroundForChromiumBug"};const{svg:t,viewBox:i,fill:n}=e,s=(0,o.useMemo)((()=>{const e=(0,Ca.renderToString)(a()("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:i},void 0,t));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,i]);return a()("div",{style:{width:"100%",height:"100%",backgroundColor:n,WebkitMaskImage:s,maskImage:s}})}const to=(0,k.defineMessages)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"},addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}}),io=(0,k.defineMessages)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime",description:"dateTime will be a message representing the date (with or without time) that the user wants to be reminded at, like 'Tomorrow 3pm' or 'Mar 1, 2020'"},noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title",description:"A label describing that no results have been found."},groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption",description:"a caption in the mention menu for group mentions indicating how many members are in the group"}});class no extends s.Z{constructor(){super(...arguments),this.storeTypes={ignoreSelectionAreaStore:Wa.Z,localPageMentionRequestStore:qa.Z,localCachePageMentionRequestStore:qa.Z},this.renderMentionResult=(e,t)=>{const{intl:i}=this.props,n=za.Z.state,s=n.open&&n.insertionType,r={sections:[],nextSectionShouldHaveTopBorder:()=>r.sections.length>0,addSection(e){e&&this.sections.push(e)}};"+"===s&&r.addSection(this.getCreatePageMenuSection(r.nextSectionShouldHaveTopBorder())),r.addSection(this.getDateResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),r.addSection(this.getUserResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),r.addSection(this.getGroupResultsMenuSection(t,r.nextSectionShouldHaveTopBorder(),this.props.intl)),r.addSection(this.getPageResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),("@"===s&&this.filterStore.state||"[["===s)&&r.addSection(this.getCreatePageMenuSection(r.nextSectionShouldHaveTopBorder()));const{sections:l}=r;let d,c;if(an.Z.state.online){const e=n.mentionTypes.user,t=n.mentionTypes.page,a=n.mentionTypes.date;let o="";const s=to;e&&t&&a?o=i.formatMessage(s.mentionAll):e&&t?o=i.formatMessage(s.mentionPersonPage):e&&a?o=i.formatMessage(s.mentionPersonDate):t&&a?o=i.formatMessage(s.mentionPageDate):e?o=i.formatMessage(s.mentionPerson):a?o=i.formatMessage(s.mentionDate):t&&n&&(o=n.open&&"+"===n.insertionType?i.formatMessage(to.addPage):i.formatMessage(s.mentionPage)),this.setTemporaryInputData({title:o,icon:this.renderTemporaryInputEmptyIcon(),allowTabCompletion:!1}),d=void 0}else d=a()(Ha.Z,{title:a()(k.FormattedMessage,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})});0===l.length&&(c=a()(oe.Z,{},void 0,a()(Ha.Z,{title:o.createElement(k.FormattedMessage,io.noResults)})));const{device:u}=this.environment;let p;return p=this.isActionSheet()?{menuType:_.og.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${Ka.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:_.og.Popup,width:this.getMenuDesktopWidth(),maxHeight:u.isMobile?"30vh":"40vh",onClickOutside:this.makeHandleCancelCallback()},o.createElement(E.Z,ce()({},p,{header:d}),a()(B.Z,{capture:za.Z.state.open,onBackspace:this.shouldCaptureBackspace()?this.handleEmptyBackspace:void 0,onTab:this.handleTab}),a()(ve.Z,{type:ve.i.Vertical,initialFocus:this.getMenuInitialFocus(),sections:l,onEmptyEnter:this.makeHandleCancelCallback()}),c)},this.handleCreateInAutocompleteQueryChange=e=>{this.updateOpenState({createInQuery:e})},this.renderCreateInMenu=()=>{const e=za.Z.state;if(!e.open)return;const t="block"===e.textStore.table?e.textStore.id:void 0;return a()(pn.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{Da.Br({environment:this.environment,titleText:this.getNormalizedFilter(),ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,createInValue:e,menuListItemAction:void 0})},captureSelection:!0,restoreSelection:!0,parentBlockId:t,onAutocompleteQueryChange:this.handleCreateInAutocompleteQueryChange,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,autocompleteQuery:e.createInQuery,desktopWidth:this.getMenuDesktopWidth(),onCancel:this.handleCreateInCancel})},this.handleCreateInStart=()=>{this.updateOpenState({showCreateIn:!0})},this.handleCreateInCancel=()=>{this.updateOpenState({showCreateIn:!1,createInQuery:""})},this.handleEmptyBackspace=e=>{this.shouldCaptureBackspace()&&e.preventDefault(),this.makeHandleCancelCallback()()},this.makeHandleCancelCallback=()=>{const e=za.Z.state,t=this.getNormalizedFilter(),i=Da.WI();let n=Date.now();return e.open&&(n=e.openTime),()=>{G.ewV(this.environment,{timeToAbandonInMs:Date.now()-n,queryLength:t.length,analyticsFrom:i}),Da.xv()}},this.handleTab=e=>{e.preventDefault();const t=this.tabCompletionString;if(!t)return;const i=kt.default.state;if("editing"!==i.mode)return;const n=(0,yt.QY)(i.multiSelection);if(!n)return;const a=za.Z.state;a.open&&a.textStore===n.store&&lt.createAndCommit({userAction:"MentionMenu.handleTab",environment:this.environment,perform:e=>{La.hJ({environment:this.environment,transaction:e,string:t,store:n.store,selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0})}})},this.tabCompletionString=void 0,this.inputSelectionsStore=this.createComputedStore((()=>{const e=za.Z.state;if(e.open)return zt.O2(e.textStore,e.oldTextValue,e.isEmptyPageTitle?"":e.insertionType)})),this.filterStore=this.createComputedStore((()=>{const e=this.inputSelectionsStore.state,t=za.Z.state;if(e&&t.open)return zt.ug(t.textStore,e)})),this.popupOpenStore=this.createComputedStore((()=>{const e=za.Z.state;return!!e.open&&("+"!==e.insertionType||""!==this.getNormalizedFilter())})),this.performUserMentionRequest=async e=>{const t=za.Z.state;if(!t.open)return;const i=t.mentionTypes.user?await this.getUserResults(e):[];return""===e?i.slice(0,2):i.slice(0,20)},this.performLocalCachePageMentionRequest=async()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=h.default.state;if(!e)return;return Na.hb({environment:this.environment,currentSpaceStore:e,currentSpaceViewStore:t})},this.performLocalPageMentionRequest=async e=>{const{localCachePageMentionRequestStore:t}=this.stores,i=t.state.result;if(!i)return;const n=dt.RM();return n&&this.getNormalizedFilter()?Promise.resolve(Na.Y_({query:e,localCachedPages:i,parentStore:n,isOnline:an.Z.state.online,environment:this.environment,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0})):void 0},this.performServerPageMentionRequest=async e=>{const t=za.Z.state;return t.open&&this.getNormalizedFilter()&&t.mentionTypes.page?await this.getPageResults(e):[]},this.getUserResults=async e=>{if(an.Z.state.online){return await rn.Yu({environment:this.environment,query:e,membersOnly:!1})}return[]},this.getGroupResults=e=>{var t;if(!za.Z.state.open)return[];const i=(null===(t=h.default.state.currentSpaceStore)||void 0===t?void 0:t.getPermissionGroups())||[];return(0,Ia.ZP)(e,i,(e=>e.name||""))},this.getPageResults=async e=>{if(!an.Z.state.online)return[];const t=za.Z.state,i=t.open&&(0,I.NZ)(t.textStore)&&t.textStore;return await rn.WL({nearBlock:i||void 0,environment:this.environment,query:e,source:"mention_menu",limit:20})},this.getDateResults=e=>{const t=za.Z.state;if(!t.open)return[];const{intl:i}=this.props,n=t.mentionTypes.reminder;return t.mentionTypes.date?function(e,t,i){if(0===e.length)return q().compact([{label:i.formatMessage(io.autocompleteToday),value:()=>Pa.Lg((0,xa.r)())},t?void 0:{label:i.formatMessage(io.autocompleteNextTuesday),value:()=>{const e=Pa.Uu((0,xa.r)()),t=e.set({weekday:2,hour:15}),i=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:i.toFormat(Pa.Iq),start_time:i.toFormat(_a.jK),time_zone:(0,xa.r)()}}},t?{label:i.formatMessage(io.autocompleteReminder),value:()=>({type:"datetime",start_date:Pa.Ro((0,xa.r)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:_a.HZ,defaultTimeZone:(0,xa.r)()},time_zone:(0,xa.r)()})}:void 0]);const n=e.normalize("NFKD"),a=t?Fa.parsePersistedDateWithOptionalReminder(n,i):Fa.parsePersistedDate(n,i);if(a){let e=(0,Za.ZV)({value:a,date_format:"relative",userTimeZone:(0,xa.r)(),intl:i,allowRelativeDates:!0});return a.reminder&&(e=i.formatMessage(io.reminder,{dateTime:e})),[{label:e,value:()=>a}]}return[]}(e,n,i).slice(0,6):[]},this.getTemplateVariableResults=e=>{const t=za.Z.state;if(!t.open)return[];if(!t.mentionTypes.templateVariable)return[];const{intl:i}=this.props;return ot.XV(e,i)}}willMountOrUpdate(){const e=za.Z.state,t=this.filterStore.state;if(e.open){var i;const n=kt.default.state,a="editing"===n.mode?(0,yt.QY)(n.multiSelection):void 0,o=(null==a?void 0:a.store)===e.textStore,s=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,r=s&&"editing"===s.mode&&(null===(i=(0,yt.QY)(s.multiSelection))||void 0===i?void 0:i.store)===e.textStore;if(!o&&!r)return void Da.xv();const l=o&&(null==a?void 0:a.selection),d=this.inputSelectionsStore.state;if(d&&l&&(l.startIndex<d.filter.startIndex||l.endIndex>d.filter.endIndex))return void Da.xv();const c=this.filterStore.state&&this.filterStore.state[0];if("+"===e.insertionType&&c&&!c.match(Va.Ff))return void Da.xv();if(void 0===t&&!e.isEmptyPageTitle)return void Da.xv()}}renderComponent(){const{device:e}=this.environment,t=za.Z.state,i=De.find((e=>e.props.capture)),n=this.popupOpenStore.state;let s;if(i&&e.isMobile){const e=i.stores.store.state.rect;e&&(s={height:`calc(100vh - ${e.height}px)`})}const r=t.open&&t.showCreateIn;return a()(U.ZP,{popupType:this.isActionSheet()?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:n,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:s,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Start,originGap:8,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.makeHandleCancelCallback(),disableDarkOverlayBackground:e.isMobile,keepFocus:!0,render:()=>e.isMobile?o.createElement(o.Fragment,null,this.renderMentionSearch(),a()(U.ZP,{popupType:U.ZP.PopupType.SlideUp,render:this.renderCreateInMenu,open:r,keepFocus:!0})):r?this.renderCreateInMenu():this.renderMentionSearch()})}renderMentionSearch(){const e=this.getNormalizedFilter(),t=za.Z.state,i=Ua.default.mark("rum.mention_menu_ready"),n={field:"relevance"};return a()(Jn.Z,{requestStore:t.userRequestStore,request:e,performRequest:this.performUserMentionRequest,render:o=>a()(Jn.Z,{requestStore:t.pageRequestStore,request:e,performRequest:this.performServerPageMentionRequest,debounce:rn.vp,render:t=>a()(Jn.Z,{requestStore:this.stores.localCachePageMentionRequestStore,request:h.default.state.currentSpaceStore&&h.default.state.currentSpaceStore.id,performRequest:this.performLocalCachePageMentionRequest,render:s=>a()(Jn.Z,{requestStore:this.stores.localPageMentionRequestStore,debounce:rn.E5,request:{query:{text:e,filters:Aa.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,requireEditPermissions:void 0}),sort:n},limit:5},performRequest:this.performLocalPageMentionRequest,render:e=>this.renderMentionResult(o||t||e,this.getCurrentMentionResults(i))})})})})}getDateResultsMenuSection(e,t){const{dateResults:i}=e,{intl:n}=this.props,s=this.getNormalizedFilter(),r=this.getTemplateVariableMenuItems(e,"date");if(0===i.length&&0===r.length)return;const l=i.map((e=>{let{label:t,value:i}=e;return{key:t,render:e=>{if(e.focused&&this.setTemporaryInputData({title:t,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),Fa.parseRelativeDate(t,n)){const a=(0,Za.ZV)({value:i(),userTimeZone:(0,xa.r)(),intl:n,allowRelativeDates:!1});return o.createElement(fe.Z,ce()({},e,{title:t,caption:a,inline:!0}))}return o.createElement(fe.Z,ce()({},e,{title:t}))},action:e=>{lt.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:t=>{Da.RL({environment:this.environment,annotation:["d",{...i(),date_format:"relative"}],transaction:t,menuListItemAction:e,query:s,mentionType:"date"})}})}}}));return this.applySectionLimit("date",{key:"date results",render:e=>o.createElement(oe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:t,isTitleUppercase:!0})),items:r.concat(l)})}getTemplateVariableMenuItems(e,t){const{templateVariableResults:i}=e,{intl:n}=this.props,a=this.getNormalizedFilter();return i.filter((e=>ot.i6(e,t))).map((e=>({key:e,render:t=>{const i=ot.U$(e,n),a=ot.Z0(e,n);return t.focused&&this.setTemporaryInputData({title:i,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),o.createElement(fe.Z,ce()({},t,{title:i,caption:a,inline:!0}))},action:t=>{lt.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:i=>{Da.RL({environment:this.environment,annotation:["tv",{type:e}],transaction:i,menuListItemAction:t,query:a,mentionType:"templateVariable"})}})}})))}renderSpinner(e){return a()(Ai.Z,{show:e,showDelay:500,showHold:300,render:e=>a()(si.Z,{style:{textAlign:"center",visibility:e?"visible":"hidden",display:"inline",marginLeft:8}})})}renderTemporaryInputEmptyIcon(){const e=za.Z.state;if(e.open)return"+"===e.insertionType?this.renderTemporaryInputAddIcon():a()("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"}},void 0,o.createElement(eo,ce()({},Yt.X.searchThick,{fill:this.theme.mediumIconColor})))}renderTemporaryInputAddIcon(){return a()("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"}},void 0,o.createElement(eo,ce()({},Yt.X.plus,{fill:this.theme.mediumIconColor})))}renderTemporaryInputPageIcon(e){return(0,Ba.tp)({pageModel:e.getModel(),pageRole:e.getRole(),showEmojiInline:!0,emojiType:(0,Oa.e_)(this.environment),baseUrl:vt.Z.domainBaseUrl,getRecordModel:e.getRecordModel,isClient:!0,isSafariOrIOS:this.environment.device.isSafari||this.environment.device.isIOS,currentUserId:this.environment.currentUser.id,theme:this.theme})}renderTemporaryInputAtMentionIcon(){return a()("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"}},void 0,o.createElement(eo,ce()({},Yt.X.at,{fill:this.theme.mediumIconColor})))}getUserResultsMenuSection(e,t){const{userResults:i}=e,n=this.getNormalizedFilter(),s=this.getTemplateVariableMenuItems(e,"user");if(0===i.length&&0===s.length)return;const r=q().compact(i.map((e=>({key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:(0,Ea.Nz)(this.props.intl,e),icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),o.createElement(Ja.Z,ce()({},t,{actor:(0,ka.dp)(e),useEmailAsTooltip:!0}))),action:t=>{lt.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:i=>{Da.RL({environment:this.environment,annotation:(0,ot.tE)(e.id),transaction:i,menuListItemAction:t,query:n,mentionType:"user"})}})}}))));return this.applySectionLimit("user",{key:"user results",render:e=>o.createElement(oe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t,isTitleUppercase:!0})),items:s.concat(r)})}getGroupResultsMenuSection(e,t,i){const{groupResults:n}=e;if(0===n.length)return;const s=this.getNormalizedFilter(),r=q().compact(n.map((e=>{var t;const n=i.formatMessage(io.groupMentionCaption,{numMembersInGroup:(null===(t=e.user_ids)||void 0===t?void 0:t.length)||0});return{key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:e.name||"",icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),a()(Qa.l,{menuListItemProps:{...t,caption:n},group:e})),action:t=>{var i;const n=null===(i=h.default.state.currentSpaceStore)||void 0===i?void 0:i.id;n&&lt.createAndCommit({userAction:"MentionMenu.groupMention",environment:this.environment,perform:i=>{Da.RL({environment:this.environment,annotation:ot.XI(e.id,n),transaction:i,menuListItemAction:t,query:s,mentionType:"group"})}})}}})));return this.applySectionLimit("group",{key:"group results",render:e=>o.createElement(oe.Z,ce()({},e,{title:a()(k.FormattedMessage,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title",description:"The description of the section in the mention menu where users can mention permission groups"}),topBorder:t,isTitleUppercase:!0})),items:r})}getPageResultsMenuSection(e,t){const{pageResults:i}=e,n=this.getNormalizedFilter(),s=o.createElement(o.Fragment,null,0===i.length?o.createElement(k.FormattedMessage,io.noResults):a()(k.FormattedMessage,{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}),this.renderSpinner(za.Z.state.pageRequestStore.state.loading));return this.applySectionLimit("page",{key:"page results",render:e=>o.createElement(oe.Z,ce()({},e,{title:s,topBorder:t,isTitleUppercase:!0})),items:q().compact(i.map((e=>{const t=dt.RM();if(!t)return;const i=J.G.createChildStore(t,{table:Ft.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=i.getModel();if(e){const t=e.getRenderTitle({getRecordModel:i.getRecordModel,userTimeZone:(0,xa.r)(),intl:this.props.intl});this.setTemporaryInputData({title:t||"",icon:this.renderTemporaryInputPageIcon(i),allowTabCompletion:!0})}}return o.createElement(ln.Z,ce()({},e,{store:i}))},action:t=>{lt.createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:this.environment,perform:i=>{Da.RL({environment:this.environment,annotation:["p",e],transaction:i,menuListItemAction:t,query:n,mentionType:"page"})}})}}})))})}getCreatePageMenuSection(e){if(!this.canCreatePage())return;const t=za.Z.state;if(!t.open)return;const{intl:i}=this.props,n=this.getNormalizedFilter(),s="@"===t.insertionType?a()(k.FormattedMessage,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:t=>o.createElement(oe.Z,ce()({title:s,isTitleUppercase:!0},t,{topBorder:e})),items:[{key:"add new subpage",action:async e=>{const i=Ri.gt(t.textStore);i&&await Da.Br({environment:this.environment,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,titleText:this.getNormalizedFilter(),createInValue:i.createInValue,onPageCreated:e=>{e&&""===ot.Q(e.getTitleValue())&&Ra.navigateToBlock({environment:this.environment,store:e})},menuListItemAction:e})},render:e=>{e.focused&&this.setTemporaryInputData({title:0===n.length?i.formatMessage(to.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=t=>o.createElement(fe.Z,ce()({},(0,sa.Z)(t||{},e),{icon:Yt.Z.plus({width:16}),title:a()(Ya,{pageTitle:this.getNormalizedFilter()})}));return this.environment.device.isMobile?t():a()(li.Z,{renderTooltip:()=>a()(Xa.Z,{imageURL:Ta.Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:o.createElement(k.FormattedMessage,pn.s.createSubpage)}),placement:li.Z.Placement.Right,delayThreshold:0,render:e=>t(e)})}},{key:"open create in menu",action:this.handleCreateInStart,render:e=>{e.focused&&this.setTemporaryInputData({title:0===n.length?i.formatMessage(to.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=a()($a,{pageTitle:this.getNormalizedFilter()}),s=i=>o.createElement(fe.Z,ce()({},(0,sa.Z)(i||{},e),{icon:Yt.Z.alias({width:16}),title:t}));return this.environment.device.isMobile?s():a()(li.Z,{renderTooltip:()=>a()(Xa.Z,{imageURL:Ta.Z.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:o.createElement(k.FormattedMessage,pn.s.newPageIn)}),placement:li.Z.Placement.Right,delayThreshold:0,render:e=>s(e)})}}]}}applySectionLimit(e,t){const i=za.Z.state;if(!i.open)return t;if(i.expandSection&&i.expandSection===e)return t;const{items:n}=t,s=this.environment.device.isPhone?3:5;if(n.length<=s)return t;const r=[...n.slice(0,s),{key:"show more",render:e=>o.createElement(fe.Z,ce()({},e,{icon:Yt.Z.dots({width:16,fill:this.theme.mediumTextColor}),title:a()("span",{style:{color:this.theme.mediumTextColor}},void 0,a()(k.FormattedMessage,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:n.length-s}}))})),action:()=>{this.updateOpenState({expandSection:e})}}];return{...t,items:r}}updateOpenState(e){const t=za.Z.state;t.open&&za.Z.setState({...t,...e})}getNormalizedFilter(){const e=this.filterStore.state;return e?za.Z.state.open&&"@"===za.Z.state.insertionType&&this.environment.device.isAndroid&&e.startsWith("@")?e.slice(1).trim():za.Z.state.open&&"[["===za.Z.state.insertionType&&e.endsWith("]]")?e.slice(0,-2).trim():e.trim():""}setTemporaryInputData(e){const t=za.Z.state;if(!t.open)return;if(!e)return void t.temporaryInputData.set(void 0);const{device:i}=this.environment,{title:n,icon:a,allowTabCompletion:o}=e,s=this.filterStore.state||"",r=n.toLowerCase().startsWith(s)?n.slice(s.length):"";this.tabCompletionString=o?r:void 0;const l=i.isFirefox?void 0:a;t.temporaryInputData.set({prefix:t.insertionType,suffix:"[["===t.insertionType&&s.endsWith("]]")?"]]":"",completion:r,prefixIcon:l})}getCurrentMentionResults(e){const t=za.Z.state,i=t.userRequestStore.state.result||[],n=t.pageRequestStore.state.result||[],a=this.getDateResults(this.getNormalizedFilter()),o=this.getTemplateVariableResults(this.getNormalizedFilter()),s=t.mentionTypes.group?this.getGroupResults(this.getNormalizedFilter()):[];let r=n;const{result:l}=this.stores.localPageMentionRequestStore.state;if(l&&!l.error){const e=l.value.results,t=dt.RM();r=t?Na.oO({results:{local:e,server:n.map(((e,i)=>({...e,originalPosition:i,store:J.G.createChildStore(t,{table:Ft.iU,id:e.id})})))}})||[]:e}let d;d=this.getNormalizedFilter()?r.map((e=>e.id)):dn.X4.state.map((e=>e.pageId));const c=t.userRequestStore.state.ready&&t.pageRequestStore.state.ready;return c&&Ua.default.measure(e,{environment:this.environment}),{userResults:i,groupResults:s,pageResults:d,dateResults:a,templateVariableResults:o,ready:c}}canCreatePage(){return!!za.Z.state.mentionTypes.createPage}isActionSheet(){const{device:e}=this.environment;return e.isMobileNative&&!e.isTablet}shouldCaptureBackspace(){return""===this.filterStore.state}getMenuInitialFocus(){if(""!==this.getNormalizedFilter())return 0}getMenuDesktopWidth(){return(0,r.bq)()?400:330}}no.displayName="MentionMenu";const ao=(0,k.injectIntl)(no);var oo=i(42239);class so extends s.Z{constructor(){super(...arguments),this.cancelDragTimeout=void 0,this.handleDragOver=e=>{e.preventDefault(),this.startDrag(e),this.continueDragThrottled(e)},this.handleDrop=e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files);t.length>0&&lt.createAndCommit({userAction:"NativeDragHandler.handleDrop",environment:this.environment,perform:e=>{oo._4({environment:this.environment,files:t,analyticsFrom:"native_drag",transaction:e})}})},this.startDrag=e=>{oo.f$(this.environment,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0})&&Jt.ZH(this.environment)},this.continueDrag=e=>{this.cancelDragTimeout&&window.clearTimeout(this.cancelDragTimeout),this.cancelDragTimeout=window.setTimeout(this.cancelDrag,this.getCancelDragTimeoutMS()),oo.td(this.environment,{currentX:e.clientX,currentY:e.clientY})},this.continueDragThrottled=q().throttle(this.continueDrag,so.dragOverThrottleMS),this.cancelDrag=()=>{oo.cQ(this.environment)}}didMount(){super.didMount(),window.addEventListener("dragover",this.handleDragOver),window.addEventListener("drop",this.handleDrop)}willUnmount(){super.willUnmount(),window.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("drop",this.handleDrop)}getCancelDragTimeoutMS(){const{device:e}=this.environment;return e.isLinux?2e3:200}}so.displayName="NativeDragHandler",so.dragOverThrottleMS=62.5;const ro=so;var lo=i(40902),co=i(15145),uo=i(44615),po=i(65311),mo=i(19719),go=i(2688),ho=i(12252),fo=i(76487);class vo extends s.Z{constructor(){super(...arguments),this.lastEmitValue=-1,this.lastSentBadgeNumber=void 0,this.lastSentCurrentSpaceBadgeNumber=void 0,this.handleNotificationEmit=async(e,t)=>{if(t===this.lastEmitValue)return;if(this.lastEmitValue=t,!this.shouldFetchUserNotifications(String(t)))return;const i=await _n.getUserNotifications(this.environment,{size:1e3});if("failed"===i.type)return;const{results:n}=i.data;fo.Z.setState({results:n}),this.syncInitialBadgeNumber();const a=q().union.apply(null,n.map((e=>e.unreceived.notificationIds)));for(const o of a)this.displayNotification(o)},this.handleNotificationEmitThrottled=q().throttle(this.handleNotificationEmit,1e3),this.handleNotificationEmitWhenActive=(e,t)=>{ho.Z.whenActive((()=>{this.handleNotificationEmitThrottled(e,t)}))},this.listenerReference=void 0,this.updateBadgeNumbers=()=>{const{mobileNative:e}=this.environment,{allSpaces:t,currentSpace:i}=this.getBadgeCounts();e&&(t===this.lastSentBadgeNumber&&i===this.lastSentCurrentSpaceBadgeNumber||e.setBadgeNumber(t,i),this.lastSentCurrentSpaceBadgeNumber=i),t!==this.lastSentBadgeNumber&&(t>0?ht.setBadge(`${t}`):ht.setBadge("")),this.lastSentBadgeNumber=t},this.syncInitialBadgeNumber=q().once(this.updateBadgeNumbers)}willMount(){this.startMessageListeners(),fo.Z.addListener(this.updateBadgeNumbers),this.environment.mobileNative&&h.default.addListener(this.updateBadgeNumbers)}didUpdate(e){e.rootStore.userId!==this.props.rootStore.userId&&(this.stopMessageListeners(),this.startMessageListeners(),this.handleNotificationEmit("initializeListener",-1))}willUnmount(){this.stopMessageListeners(),fo.Z.removeListener(this.updateBadgeNumbers),this.environment.mobileNative&&h.default.removeListener(this.updateBadgeNumbers)}startMessageListeners(){const{currentUserStore:e}=h.default.state;if(e){const t=(0,uo.Lp)(e.id);this.listenerReference=go.Z.addListener(t,this.handleNotificationEmitWhenActive,void 0,this.environment)}}stopMessageListeners(){this.listenerReference&&go.Z.removeListener(this.listenerReference,this.environment)}getBadgeCounts(){return{allSpaces:fo.Z.getTotalUnreadMentionsCount(),currentSpace:fo.Z.getUnreadCountForCurrentSpace().mentions}}async displayNotification(e){const t=(0,J.Kv)(this.props.rootStore,{table:po.uX,id:e});await t.load();const i=t.getValue();if(!i)return;const n=(0,I.No)(t,i.activity_id,i.space_id);await n.load();const a=n.getValue(),{currentUserStore:o,currentSpaceViewStore:s}=h.default.state;if(o&&s&&a&&!a.invalid&&!lo.BX(a,o.id)&&await ht.isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await s.load(),!s.isDefined())return;if(!lo.OJ(a))return;if(!s.getNotifyDesktop())return;if(!this.environment.device.isDesktop)return;const e=(0,(await c.deps.desktop.loader()).PushNotification)({activity:a,getRecordValue:t.getRecordValue,userTimeZone:(0,xa.r)(),intl:this.props.intl});if(!e)return;const{subject:i,body:o}=e,r=new Notification(i,{body:o,silent:!0}),l=lo.Fb(a),d={medium:"desktop_push",type:l,badge_number:this.getBadgeCounts().allSpaces,notification_id:t.id,activity_id:n.id},u=e=>mo.b2({environment:this.environment,args:d,action:e});u("sent"),r.addEventListener("show",(()=>u("shown"))),r.addEventListener("close",(()=>u("closed"))),r.addEventListener("click",(()=>{const e=lo.hY({activity:a,getRecordValue:t.getRecordValue,baseUrl:vt.Z.domainBaseUrl}),i=(0,co.k6)(e,[l,"desktop_push"]);Ra.navigate({environment:this.environment,url:i}),u("clicked")}))}}shouldFetchUserNotifications(e){return 0===fo.Z.state.results.length||(!document.hasFocus()||!e.includes("unreadCount"))}}vo.displayName="NotificationListener";const yo=(0,k.injectIntl)(vo);var bo=i(22889),So=i(58261);class wo extends s.Z{constructor(){super(...arguments),this.renderTooltip=()=>a()(B.Z,{capture:!0,onEnter:this.handleEnter,onCommandEnter:this.handleCommandEnter},void 0,o.createElement(o.Fragment,null,a()(k.FormattedMessage,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),a()("div",{},void 0,a()(So.Z,{onlyShowFirst:!0,name:"enter",style:{color:this.theme.mediumInvertedTextColor}})))),this.handleEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:i,store:n}=t;if(!i)return;e.preventDefault&&e.preventDefault();const a=J.G.createChildStore(n,{table:Ft.iU,id:i});Ra.navigateToBlock({store:a,environment:this.environment,visitType:bo.vu.Link})},this.handleCommandEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:i,store:n}=t;if(!i)return;e.preventDefault();const a=J.G.createChildStore(n,{table:Ft.iU,id:i});Ra.navigateToBlock({store:a,environment:this.environment,visitType:bo.vu.Link,openInNew:"tab"})},this.pageMentionTokenStore=this.createComputedStore((()=>{const e=kt.default.state;if("editing"!==e.mode)return;const t=(0,yt.QY)(e.multiSelection);if(!t)return;const{store:i,selection:n}=t;if(n.endIndex!==n.startIndex+1)return;const a=i.getValue(),o=ot.b1(a,n.startIndex);if(!o||!ot.eO(o))return;const[s]=ot.jD([o]);return{pageId:s,store:i}}))}renderComponent(){if(this.environment.device.isMobile)return;const e=bt.getSelectionRect(),t=this.pageMentionTokenStore.state;return a()(li.Z,{render:()=>{},renderTooltip:this.renderTooltip,originRect:e,forceVisibleState:Boolean(t&&e),placement:li.Z.Placement.Bottom})}}wo.displayName="PageMentionOverlay";const Mo=wo;var Co=i(52989),ko=i(69784);class To extends s.Z{constructor(){super(...arguments),this.handleKey=e=>{ko.Z.state.isActive&&(e.preventDefault(),Co.MZ({environment:this.environment,currentX:ko.Z.state.currentX,currentY:ko.Z.state.currentY,toggle:e.shiftKey}))},this.handleMouseMove=e=>{ko.Z.state.isActive&&(e.preventDefault(),Co.MZ({environment:this.environment,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))},this.handleMouseUp=e=>{ko.Z.state.isActive&&((0,ei.N9)(e)||e.preventDefault(),Co.qw(this.environment))}}willMount(){window.addEventListener("keydown",this.handleKey),window.addEventListener("keyup",this.handleKey),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}willUnmount(){window.removeEventListener("keydown",this.handleKey),window.removeEventListener("keyup",this.handleKey),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}renderComponent(){return null}}To.displayName="RectangularSelectionListener";const _o=To;var Io=i(43008),xo=i(64951),Zo=i(65187);class Po extends s.Z{constructor(){super(...arguments),this.renderPopupContent=()=>a()(Ao,{})}renderComponent(){const{device:e}=this.environment,{blockStore:t,originRect:i}=xo.Z.state;return a()(U.ZP,{popupType:e.isMobile?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:Boolean(t),originRect:i,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Center,originGap:4,onDismiss:()=>Io.x(this.environment),render:this.renderPopupContent})}}Po.displayName="RenameFileMenuPopup";class Fo extends s.Z{didMount(){const{blockStore:e}=xo.Z.state;if(!e)return;const t=e.getTitleStore();t&&ft.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{blockStore:t}=xo.Z.state;if(!t)return;const i=t.getTitleStore();if(!i)return;let n;return n=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:380},o.createElement(E.Z,n,a()("div",{style:this.getWrapStyle()},void 0,a()(Zo.Z,{store:i,disabled:!t.canEdit(),onEsc:()=>Io.x(this.environment),onEnter:()=>Io.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:this.props.intl.formatMessage({defaultMessage:"Untitled",id:"renameFileMenuPopup.input.placeholder"}),style:this.getInputStyle(),pasteBehavior:"inline"})))}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}Fo.displayName="LocalizableRenameFileMenu";const Ao=(0,k.injectIntl)(Fo),Bo=Po;var Eo=i(52771),Do=i(82187);class Ro extends s.Z{constructor(){super(...arguments),this.renderPopupContent=()=>{const{renderDelete:e}=Do.Z.state;return a()(Oo,{renderDelete:Boolean(e)})}}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t,originRect:i}=Do.Z.state;return a()(U.ZP,{popupType:e.isMobile?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:Boolean(t),originRect:i,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Center,originGap:4,onDismiss:()=>Eo.x(this.environment),render:this.renderPopupContent})}}Ro.displayName="RenamePageMenuPopup";class Lo extends s.Z{constructor(){super(...arguments),this.handleRecordIconChange=e=>{const{clonedBlockStore:t}=Do.Z.state;if(t){const i=t.getIconStore();i&&lt.createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:this.environment,perform:t=>{rt.sO({store:i,value:e,transaction:t})}})}}}didMount(){const{clonedBlockStore:e}=Do.Z.state;if(!e)return;const t=e.getTitleStore();t&&ft.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t}=Do.Z.state;if(!t)return;const i=t.getTitleStore();if(!i)return;const{renderDelete:n}=this.props;let s;return s=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:380},o.createElement(E.Z,s,a()("div",{style:this.getWrapStyle()},void 0,this.renderIcon(t),a()(Zo.Z,{store:i,disabled:!t.canEdit(),onEsc:()=>Eo.x(this.environment),onEnter:()=>Eo.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,placeholder:this.renderEmptyTitlePlaceholder(),style:this.getInputStyle(),pasteBehavior:"inline"}),n&&t.canEdit()&&this.renderDeleteButton()))}renderDeleteButton(){return a()(da.Z,{icon:e=>Yt.Z.trash({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:e}=Do.Z.state;e&&await Xt.Qw({environment:this.environment,blocks:[e]}),Eo.x(this.environment)}})}renderIcon(e){const t={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${this.theme.darkDividerColor}`};if(e.canEdit()){var i,n;const o=null===(i=e.getIconStore())||void 0===i?void 0:i.table;return a()(Wi.Z,{disabled:!1,bucket:"secure",store:e,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t,iconLoggingData:{recordTable:o,source:"breadcrumb",block_type:e.getType(),collection_id:"collection"===o?null===(n=e.getIconStore())||void 0===n?void 0:n.id:void 0},onChange:this.handleRecordIconChange})}return a()(Wi.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t})}renderEmptyTitlePlaceholder(){const{clonedBlockStore:e}=Do.Z.state,{intl:t}=this.props;if(null!=e&&e.isDefined())return e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,xa.r)(),intl:t})}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}Lo.displayName="LocalizableRenamePageMenu";const Oo=(0,k.injectIntl)(Lo),No=Ro;var Vo=i(4083),Uo=i(13264);class Wo extends s.Z{constructor(){super(...arguments),this.renderDiscussion=()=>{const{device:e}=this.environment;if(Uo.Z.state.open){const{discussionStore:t,discussionInputStore:i,blockStore:n,discussionLocation:s}=Uo.Z.state;let r;return r=e.isMobile?{menuType:_.og.Modal,title:a()(k.FormattedMessage,{defaultMessage:"Comments",id:"discussion.mobileReplyMenu.title"}),right:a()(k.FormattedMessage,{defaultMessage:"Close",id:"discussion.mobileReplyMenu.closeButton.label"}),onClickRight:()=>Vo.UZ(this.environment),whiteBackground:!0}:{menuType:_.og.Popup,width:420,maxWidth:e.isMobileBrowser?"80vw":"100%"},o.createElement(E.Z,r,a()(F.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>a()(P.Z,{store:t,discussionInputStore:i,onDismiss:()=>Vo.UZ(this.environment),format:T.O2.Menu,isFirst:!0,isOnly:!0,discussionLocation:s,showResolveButtonByDefaultIfPossible:!0,blockStore:n})}))}}}renderComponent(){const{device:e}=this.environment,{open:t,rect:i}=Uo.Z.state;return a()(U.ZP,{popupType:e.isMobile?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:t,originRect:i,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Center,originGap:4,onDismiss:()=>Vo.UZ(this.environment),render:this.renderDiscussion})}}Wo.displayName="ReplyDiscussionMenu";const zo=Wo;var Ko=i(6287),qo=i(80503),Ho=i(95182),Go=i(56863),jo=i(92022),$o=i(23223),Yo=i(99417),Qo=i(40959),Xo=i(87078),Jo=i(45162),es=i(67669),ts=i(72444),is=i(15723),ns=i(17903),as=i(4548),os=i(42057),ss=i(49557),rs=i(4935),ls=i(99757),ds=i(13966),cs=i(64131),us=i(82945),ps=i(40464),ms=i(32404),gs=i(73383);class hs extends s.Z{constructor(){super(...arguments),this.mouseIsDownExternally=!1,this.lastRenderState=void 0,this.completionContextOnOpen=void 0,this.renderOverlay=()=>{const{isActive:e}=ss.Z.state;return a()(oi.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:{stiffness:100,damping:10,precision:1e-4}},render:this.renderAnimated,onAnimationEnd:this.handleAnimationEnd})},this.renderAnimated=()=>{const{top:e,left:t}=ss.Z.state,i=this.canOnlyDiscussStore.state,n=Math.max(i?t:t-hs.leftOffset,0),s=i?"12px 0":12;return a()("div",{className:me.Qcf,style:{pointerEvents:"none",position:"absolute",top:e,left:0,display:"flex",width:"100%"}},void 0,a()("div",{style:{flexShrink:1,width:n,minWidth:24}}),(0,ti.Z)((e=>o.createElement("div",ce()({style:{pointerEvents:"none",padding:s}},e),this.lastRenderState&&this.renderMenu(this.lastRenderState)))),a()("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}}))},this.updateRichTextState=()=>{const e=ss.Z.state;if(qi.Z.state.open||rs.Z.state.open)return;if(ls.n.state)return Go.w();const t=kt.default.state;if("empty"===t.mode)return Go.w();const i=(0,Jo.L5)(t.multiSelection);if(0===i.length)return Go.w();if(!i.every((e=>{let{store:t}=e;return t.table===Ft.iU||t.table===hi.x_||t.table===Ko.v})))return Go.w();if(!this.environment.currentUser.isLoggedIn()||!i.every((e=>{let{store:t}=e;return t.canComment()})))return;const n=bt.get();if(dt.JE())return Go.w();if(i.some((e=>{let{editable:t}=e;return t.props.disableAnnotation})))return Go.w();if(i.some((e=>{let{editable:t}=e;return t.props.disabled})))return Go.w();const a=i.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(a.some(((e,t)=>e&&i[t].store.table!==hi.x_&&(e.isLocked()||e.isNavigableAncestorLocked()))))return Go.w();if(this.mouseIsDownExternally&&e.blockTarget!==a[0])return Go.w();const o=i.some((e=>{let{store:t}=e;const i=t.getRecordStoreAtRootPath();if(!(i instanceof J.G))return!1;const n=i.getValue();return!!n&&hs.richTextMenuBlockTypesDenylist[n.type]}));if(o)return Go.w();const s=n?bt.getRect(n):void 0;if(s&&!is.kK(s,(0,Xo.Z)()))return Go.w();if(Do.Z.isActive()||xo.Z.isActive()||Si.Z.isOpen()||o||!n||!this.hasNonCollapsedTextSelection()||Ct.state.open)return Go.w();let r=0,l=0;if(s){r=s.left;const e=25,t=s.top-hs.height-e,i=qo.R6(this.environment.device.isElectronMac),n=this.environment.WindowSizeStore.state.height-hs.height-e;l=Math.min(Math.max(t,i),n)}0===Math.abs(ss.Z.state.top-l)&&Math.abs(ss.Z.state.left-r)<10&&(l=ss.Z.state.top,r=ss.Z.state.left),ss.Z.setState({...ss.Z.state,isActive:!0,isAnimatingClosed:!1,top:l,left:r,blockTarget:ee.default.state.stores[0]})},this.updateRichTextStateThrottled=q().throttle(this.updateRichTextState,200,{leading:!1}),this.handleAnimationEnd=()=>{ss.Z.state.isActive||ss.Z.setState({...ss.Z.state,isAnimatingClosed:!1}),this.lastRenderState=this.renderStateStore.state},this.renderStateStore=this.createComputedStore((()=>{const{isActive:e,blockTarget:t}=ss.Z.state,i=kt.default.state;if(!e||"empty"===i.mode)return;const{multiSelection:n}=i,a=(0,yt.qS)(n),o=kt.default.isEditingComment(),s=kt.default.isEditingCaption(),r=t&&t.getParentTable()===Ko.v,l=a&&t&&n.start.store===t.getCollectionViewSourceDescriptionStore(),d=this.pageContext&&this.pageContext.publicEditModeStore.state,c=!(0,es.YF)(d)&&(n.start.store.canEdit()&&n.end.store.canEdit()),u=t&&t.getType(),p=u&&hs.richTextMenuActionsDenylist[u],m=null==t?void 0:t.isType("button"),g=(0,$o.td)(n.start.store)||(0,$o.td)(n.end.store),h=(0,ts.qk)(null==t?void 0:t.getParentBlockStore()),f={isSingleStoreSelection:a,showTurnInto:Boolean(a&&!o&&!r&&!l&&!s&&t&&c&&!m&&!h&&!Rt.default.isMiniPeekOpen()),showBold:Boolean(c),showItalic:Boolean(c),showStrikethrough:Boolean(c),showUnderline:Boolean(c),showCode:Boolean(c),showLink:Boolean(a&&c),showHighlight:Boolean(c&&!o),showDiscuss:Boolean(!o&&t&&!r&&!l&&!g&&!Rt.default.isMiniPeekOpen()),showEquation:Boolean(a&&c),showMention:Boolean(a&&!o&&t&&!r&&c),showActionButton:Boolean(a&&!o&&!s&&t&&!r&&!Rt.default.isMiniPeekOpen()),blockTarget:t,isComment:o,showCompletions:Boolean((0,Yo.GD)(this.environment,d)&&c&&!o&&!s&&t&&!r&&!l&&!m&&!g)};if(p&&p.size>0)for(const v of p)f[v]=!1;return f})),this.canOnlyDiscussStore=this.createComputedStore((()=>{const e=this.renderStateStore.state;return e&&e.showDiscuss&&!e.showBold}))}didMount(){ee.default.addListener(this.updateRichTextStateThrottled),kt.default.addListener(this.updateRichTextStateThrottled),ns.Z.addListener(this.updateRichTextState),os.Z.addListener(this.updateRichTextState),as.Z.addListener(this.updateRichTextState)}willUnmount(){kt.default.removeListener(this.updateRichTextStateThrottled),ee.default.removeListener(this.updateRichTextStateThrottled),ns.Z.removeListener(this.updateRichTextState),os.Z.removeListener(this.updateRichTextState),as.Z.removeListener(this.updateRichTextState)}willMountOrUpdate(){const e=this.renderStateStore.state;e&&(this.lastRenderState=e)}renderComponent(){const{isActive:e,isAnimatingClosed:t}=ss.Z.state;return a()(d.Z,{open:e||t},void 0,this.renderOverlay())}renderMenu(e){const{isActive:t}=ss.Z.state;return a()("div",{style:{display:"inline-flex",alignItems:"stretch",height:hs.height,background:this.theme.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,pointerEvents:t?"auto":"none"},onMouseDown:e=>e.preventDefault()},void 0,e.showCompletions&&this.renderCompletionsButton(),e.showTurnInto&&e.blockTarget&&this.renderTurnInto(e.blockTarget),e.showLink&&this.renderLinkButton(!0),e.showDiscuss&&e.blockTarget&&this.renderCommentButton(e.blockTarget),a()("div",{style:{display:"flex"}},void 0,e.showBold&&this.renderBoldButton(),e.showItalic&&this.renderItalicButton(),e.showUnderline&&this.renderUnderlineButton(),e.showStrikethrough&&this.renderStrikethroughButton(),e.showCode&&this.renderCodeButton(),e.showEquation&&this.renderEquationButton()),e.showHighlight&&a()(cs.Z,{style:this.getBorderRight()}),e.showMention&&this.renderMention(),e.showActionButton&&e.blockTarget&&this.renderActionButton(e.blockTarget))}renderTurnInto(e){let t=a()(k.FormattedMessage,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const{intl:i}=this.props,n=e.getType();if(n){const e=Qo.Hc[n];t=e&&e.displayName||t}return a()(la.Z,{popupType:la.Z.PopupType.Popup,buttonPopupStore:rs.Z,originGap:4,renderOrigin:e=>a()(li.Z,{renderTooltip:()=>i.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:i=>o.createElement(Ui.Z,ce()({style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()}},(0,sa.Z)(e,i)),t,Yt.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))}),render:()=>a()(E.Z,{menuType:_.og.Popup},void 0,a()(ne.Z,{context:{blocks:[e],environment:this.environment,publicEditMode:void 0},sections:[Ho.gH],onAccept:t=>{const i=e.getType(),n=e.getFormat();Go.w(),G.dhV(this.environment,{analyticsName:t.analyticsName,from:"rich_text_menu",block_id:e.id,block_type:i,is_toggleable:i?(0,Q._A)(i,n):void 0})}})),onClick:()=>{G.mt_(this.environment,{action:"turn_into"})}})}renderBoldButton(){return a()(ps.Z,{type:"b",tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(k.FormattedMessage,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})),a()("div",{},void 0,a()(So.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleBold"})))},void 0,a()("span",{style:{fontWeight:Ga.Z.fontWeight.semibold}},void 0,"B"))}renderItalicButton(){return a()(ps.Z,{type:"i",tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(k.FormattedMessage,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})),a()("div",{},void 0,a()(So.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleItalics"})))},void 0,a()("span",{style:{fontStyle:"italic"}},void 0,"i"))}renderStrikethroughButton(){return a()(ps.Z,{type:"s",tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(k.FormattedMessage,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})),a()("div",{},void 0,a()(So.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleStrike"})))},void 0,a()("span",{style:{textDecoration:"line-through"}},void 0,"S"))}renderUnderlineButton(){return a()(ps.Z,{type:"_",tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(k.FormattedMessage,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})),a()("div",{},void 0,a()(So.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleUnderline"})))},void 0,a()("span",{style:{textDecoration:"underline"}},void 0,"U"))}renderCodeButton(){return a()(ps.Z,{type:"c",style:{padding:"0 6px"},tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(k.FormattedMessage,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})),a()("div",{},void 0,a()(So.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleCode"})))},void 0,Yt.Z.code({width:15,height:15}))}renderLinkButton(e){const t=this.environment.device.isMobile;return a()(gs.Z,{style:this.getBorderRight()},void 0,e&&Yt.Z.alias({width:t?18:16,height:t?18:16,marginRight:4,fill:this.theme.regularIconColor}),a()("span",{style:{borderBottom:`1px solid ${this.theme.linkDecorationColor}`}},void 0,a()(k.FormattedMessage,{defaultMessage:"Link",id:"richTextMenu.linkButton.tooltip"})))}renderCompletionsButton(){const{intl:e}=this.props;return a()(li.Z,{renderTooltip:()=>o.createElement(o.Fragment,null,a()("div",{},void 0,e.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip",description:"AI rich text menu tooltip."})),a()("div",{},void 0,a()(So.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"commandJ"}))),render:e=>o.createElement(Ui.Z,ce()({style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()}},e,{onClick:()=>{(0,jo.hr)({from:"rich_text_menu",environment:this.environment}),G.mt_(this.environment,{action:"completions"})}}),Yt.Z.sparkles({width:16,height:16,fill:jt.FN.light.purple[400],marginRight:4}),a()("span",{style:{color:jt.FN.light.purple[400],fontWeight:500}},void 0,a()(k.FormattedMessage,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label",description:"Button for AI rich text menu"})))})}renderEquationButton(){return a()(ms.Z,{style:this.getBorderRight(),onClick:()=>{G.mt_(this.environment,{action:"e"}),Go.w()}},void 0,Yt.Z.equation({width:16,height:16}))}renderMention(){return a()(li.Z,{renderTooltip:()=>a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(k.FormattedMessage,{defaultMessage:"Mention a person,{br}page, or date",id:"richTextMenu.mentionButton.tooltip",values:{br:a()("br",{})}})),a()("div",{style:{color:this.theme.mediumInvertedTextColor}},void 0,"@")),render:e=>o.createElement(Ui.Z,ce()({style:{...this.getBorderRight(),padding:"0 8px"}},e,{onClick:()=>{Da.lZ(this.environment,{page:!0,createPage:!0,user:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0,group:!0}),G.mt_(this.environment,{action:"mention"})}}),Yt.Z.mention({width:14,fill:this.theme.regularTextColor}))})}renderCommentButton(e){return a()(us.Z,{style:this.getBorderRight(),blockStore:e})}renderActionButton(e){return a()(ds.Z,{store:e,style:{borderRight:"none",borderRadius:0,padding:0,width:30,height:"none"},iconStyle:{fill:this.theme.regularTextColor},fadeIn:!1,onClick:()=>{G.mt_(this.environment,{action:"more"})}})}hasNonCollapsedTextSelection(){const e=bt.get();return!!e&&!e.collapsed&&"empty"!==kt.default.state.mode&&!(0,yt.iG)(kt.default.state.multiSelection)}getBorderRight(){return{boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`,marginRight:1}}}hs.displayName="RichTextMenu",hs.richTextMenuBlockTypesDenylist={[C.Ti.factory]:!0},hs.richTextMenuActionsDenylist={[C.Ti.code]:new Set(["showMention","showCode","showCompletions"]),[C.Ti.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[C.Ti.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},hs.leftOffset=60,hs.height=32;const fs=(0,k.injectIntl)(hs);var vs=i(14248),ys=i(14714),bs=i(617),Ss=i(93959),ws=i(78316),Ms=i(92628),Cs=i(12211),ks=i(50628);const Ts=200;var _s;function Is(e){return e.type===_s.Selectable?{type:Qe.Dl.Selectable,store:e.target.props.store,direction:e.direction}:{type:Qe.Dl.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function xs(e){const{target:t,device:i,direction:n,points:a}=e;return n===Qe.vh.Onto||!i.isPhone||t.props.dropzoneShouldNeverUseOrigin?a.mousePoint:{x:a.originPoint.x,y:a.mousePoint.y}}function Zs(e){return e instanceof Ms.Z?{type:_s.Selectable,target:e}:{type:_s.DropTarget,target:e}}function Ps(e){if(!(e&&e instanceof Ms.Z))return!1;let t=e;const i=Qe.ZP.state;if(!i.isDragging)return!1;const{draggedStores:n}=i;for(;t;){if(n.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Fs(e){const{dropzoneMustBeWithinHorizontalBound:t,device:i}=e;return t?0:i.isPhone?9999:0}function As(e){switch(e.direction){case Qe.vh.Onto:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,canAcceptDrop:r}=e,l=Qe.vh.Onto,d=xs({device:t,target:a,direction:l,points:o});if((i?a.props.canNativeDropOnto:a.props.canDropOnto)&&Es(d,n)&&!Ps(a)&&r(a,l))return{...Zs(a),direction:l,left:n.left,top:n.top,width:n.width,height:n.height,priority:s}}(e);case Qe.vh.Left:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,optionKeyDown:r,canAcceptDrop:l}=e,d=Qe.vh.Left,c=xs({device:t,target:a,direction:d,points:o});if((i?a.props.canNativeDropLeft:a.props.canDropLeft)&&n&&c.y>=n.top&&c.y<=n.bottom&&Math.abs(c.x-n.left)<=200&&(r||!Ps(a))&&l(a,d))return{...Zs(a),direction:d,left:n.left,top:n.top,width:0,height:n.height,priority:s}}(e);case Qe.vh.Right:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,optionKeyDown:r,canAcceptDrop:l}=e,d=Qe.vh.Right,c=xs({device:t,target:a,direction:d,points:o});if((i?a.props.canNativeDropRight:a.props.canDropRight)&&n&&c.y>=n.top&&c.y<=n.bottom&&Math.abs(c.x-n.right)<=Ts&&(r||!Ps(a))&&l(a,d))return{...Zs(a),direction:d,left:n.right,top:n.top,width:0,height:n.height,priority:s}}(e);case Qe.vh.Above:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,optionKeyDown:r,canAcceptDrop:l}=e,d=Fs({dropzoneMustBeWithinHorizontalBound:a.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=Qe.vh.Above,u=xs({device:t,target:a,direction:c,points:o});if((i?a.props.canNativeDropAbove:a.props.canDropAbove)&&n&&u.x>=n.left-14-d&&u.x<=n.right+d&&(r||!Ps(a))&&l(a,c))return{...Zs(a),direction:c,left:n.left,top:n.top,width:n.width,height:0,priority:s}}(e);case Qe.vh.Below:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,optionKeyDown:r,canAcceptDrop:l}=e,d=Fs({dropzoneMustBeWithinHorizontalBound:a.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=Qe.vh.Below,u=xs({device:t,target:a,direction:c,points:o});if((i?a.props.canNativeDropBelow:a.props.canDropBelow)&&n&&u.x>=n.left-14-d&&u.x<=n.right+d&&(r||!Ps(a))&&l(a,Qe.vh.Below))return{...Zs(a),direction:Qe.vh.Below,left:n.left,top:n.bottom,width:n.width,height:0,priority:s}}(e)}}function Bs(e){const{device:t,rect:i,target:n,points:a,optionKeyDown:o}=e;return Es(xs({device:t,target:n,direction:Qe.vh.Onto,points:a}),i)&&Ps(n)&&!o}function Es(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}!function(e){e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget"}(_s||(_s={}));var Ds=i(28314),Rs=i(19109),Ls=i(35026),Os=i(17031),Ns=i(27406),Vs=i(81844),Us=i(16339),Ws=i(95802),zs=i(91681),Ks=i(86486);class qs extends s.Z{constructor(){super(...arguments),this.isUpdatingDragState=!1,this.didTouchEnd=!1,this.lastMouseInfo=void 0,this.handleWindowMouseMove=e=>{if(this.didTouchEnd)return void(this.didTouchEnd=!1);e&&(this.lastMouseInfo={target:e.target,x:e.clientX,y:e.clientY});const{isDragging:t}=Qe.ZP.state;if(t)this.updateDragState();else{if(!this.lastMouseInfo)return;this.updateHoverState(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}},this.handleDragBlockStoreChange=()=>{this.isUpdatingDragState||this.handleWindowMouseMoveThrottled(void 0)},this.handleWindowMouseMoveThrottled=q().throttle((e=>on.Z.withListenerIgnored((()=>this.handleWindowMouseMove(e)))),60),this.handleSelectionChange=()=>{const{isDragging:e}=Qe.ZP.state;mt.default.afterNextFlush((()=>{this.lastMouseInfo&&!e&&this.updateHoverState(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}))},this.handleSelectionChangeThrottled=q().throttle(this.handleSelectionChange,60),this.handleWindowKeyEvent=()=>{const{isDragging:e}=Qe.ZP.state;e&&this.updateDragState()},this.handleWindowTouchEnd=()=>{this.didTouchEnd=!0},this.handleWindowScroll=()=>{Jt.Ch(),this.clearHoverState()},this.handleWindowResize=()=>{Jt.Ch(),this.clearHoverState()},this.handleGlobalMenuIsOpenChange=()=>{const e=Ks.default.state,t=dt.kw.state;e.isOpen&&!e.menuIsOpen&&t&&Ks.default.reset()},this.memoizedCanDragCache=new WeakMap,this.memoizedCanDrag=e=>{const t=this.memoizedCanDragCache.get(e);if(this.memoizedCanDragCache.has(e))return t;const i=(0,bs.OO)({environment:this.environment,blocks:e,publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state});return this.memoizedCanDragCache.set(e,i),i},this.getDropZonePriority=e=>(null==e?void 0:e.priority)??0}didMount(){super.didMount();const{device:e}=this.environment;Zi.lj(window,"mousemove",this.handleWindowMouseMoveThrottled),ee.default.addListener(this.handleSelectionChangeThrottled),e.isIOS&&Zi.lj(window,"touchend",this.handleWindowTouchEnd),Zi.lj(window,"keydown",this.handleWindowKeyEvent),Zi.lj(window,"keyup",this.handleWindowKeyEvent),Qe.ZP.addListener(this.handleDragBlockStoreChange),Zi.lj(window,"scroll",this.handleWindowScroll,!0),Zi.lj(window,"resize",this.handleWindowResize),dt.kw.addListener(this.handleGlobalMenuIsOpenChange),Jt.Jy()}willUnmount(){super.willUnmount();const{device:e}=this.environment;Zi.ZV(window,"mousemove",this.handleWindowMouseMoveThrottled),ee.default.removeListener(this.handleSelectionChangeThrottled),e.isIOS&&Zi.ZV(window,"touchend",this.handleWindowTouchEnd),Zi.ZV(window,"keydown",this.handleWindowKeyEvent),Zi.ZV(window,"keyup",this.handleWindowKeyEvent),Qe.ZP.removeListener(this.handleDragBlockStoreChange),Zi.ZV(window,"scroll",this.handleWindowScroll,!0),Zi.ZV(window,"resize",this.handleWindowResize),dt.kw.removeListener(this.handleGlobalMenuIsOpenChange)}updateDragState(){if(this.isUpdatingDragState)throw new Error("Assertion failure, updateDragState() called when this.isUpdatingDragState === true!");this.isUpdatingDragState=!0;try{this.updateDragStateInner()}finally{this.isUpdatingDragState=!1}}updateDragStateInner(){const e=Qe.ZP.state;if(!e.isDragging)return;const{draggedStores:t,currentX:i,currentY:n,offsetX:a,offsetY:o,isNativeDrag:s}=e,r={x:i,y:n},l={x:i-a,y:n-o},d=this.findNearbyDropZones({mousePoint:r,originPoint:l},t[0],s);if(d.ontoDropZone)Qe.ZP.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)Qe.ZP.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],i=q().tail(d.horizontalDropZones);if(t.type===Qe.Dl.Selectable){const n=Ws.C.findSelectableFromStore(t.store);if(n){const a=n.getContextClosestSelectable();let o;return a&&a.props.store!==t.store&&a.props.shouldShowParentHalo&&(o=a.props.store),void Qe.ZP.setState({...e,currentDropZone:t,currentHintDropZones:i,currentParentStore:o})}}else{if(Ns.Z.findDropTargetFromKey(t.key))return void Qe.ZP.setState({...e,currentDropZone:t,currentHintDropZones:i,currentParentStore:void 0})}}Qe.ZP.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}clearHoverState(){const e=Ks.default.state;e.isOpen&&!e.menuIsOpen&&Ks.default.reset()}updateHoverState(e,t,i){const n=Ks.default.state;if(!n.isOpen||!n.menuIsOpen){const a=this.findHoverMenuTarget(e,t,i);a?n.isOpen&&a.selectable.props.store===n.currentStore||Ks.default.setState({isOpen:!0,currentStore:a.selectable.props.store,container:a.container,menuIsOpen:!1}):Ks.default.reset()}}getHighestDropZonePriorityRects(e){const t=this.getDropZonePriority(q().maxBy(e,this.getDropZonePriority));return e.filter((e=>this.getDropZonePriority(e)===t))}getSelectableContainerPriority(e){return(ee.default.state.droppableContainerStack||[]).indexOf(e)}findNearbyDropZones(e,t,i){const{device:n}=this.environment,a=Ds.yA(),o=function(){const{selectableRectMap:e}=ks.Z.state,{dropTargetRectMap:t}=Cs.Z.state,i=new Map;return e.forEach(((e,t)=>{i.set(t,e)})),t.forEach(((e,t)=>{i.set(t,e)})),i}(),s=o.keys();let r=s.next();const l=Ws.C.findSelectableFromStore(t),d=l?l.getContextSelectableContainer():void 0;let c=[];for(;!r.done;){const t=r.value;r=s.next();const l=o.get(t),u=t.getContextSelectableContainer();if(n.isPhone&&u!==d)continue;if(!u||u.props.disable)continue;const p=this.getSelectableContainerPriority(u),m={device:this.environment.device,isNativeDrag:i,rect:l,target:t,points:e,priority:p,optionKeyDown:a.option,canAcceptDrop:(e,t)=>this.selectableCanAcceptDrop(e,t,a.option)};if(Bs(m))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};c.push(...q().compact([As({...m,direction:Qe.vh.Onto}),As({...m,direction:Qe.vh.Left}),As({...m,direction:Qe.vh.Right}),As({...m,direction:Qe.vh.Above}),As({...m,direction:Qe.vh.Below})]))}c=this.getHighestDropZonePriorityRects(c);const u=c.filter((e=>e.direction===Qe.vh.Above||e.direction===Qe.vh.Below)),p=q().minBy(u,(t=>Math.abs(t.top-this.getReferencePointForRect(t,e).y)));let m=u.filter((e=>{let{top:t}=e;return Math.abs(t-(p?p.top:0))<=qs.competingHorizontalDropZoneMinDist}));if(m.length>1){m=m.filter((t=>{const i=this.getReferencePointForRect(t,e).x,n=Fs({device:this.environment.device});return i>=t.left-n&&i<=t.left+t.width+n})),m=q().sortBy(m,(e=>{let{left:t}=e;return t}));let t=0;for(;t<m.length-1;t++){const i=m[t+1],n=this.getReferencePointForRect(i,e).x;if(i.left>n)break}m=m.slice(0,t+1),m.reverse()}const g=m.map(Is);let h;const f=c.filter((e=>e.direction===Qe.vh.Onto)),v=q().minBy(f,(e=>e.height));if(v){u.some((t=>{const i=this.getReferencePointForRect(t,e).y;return Math.abs(t.top-i)<qs.competingOntoDropZoneVerticalOffset}))||(h=Is(v))}let y;const b=c.filter((e=>e.direction===Qe.vh.Left||e.direction===Qe.vh.Right));let S=q().minBy(b,(t=>{const i=this.getReferencePointForRect(t,e).x;return Math.abs(t.left-i)}));if(S){const e=S,t=b.filter((t=>Math.abs(t.left-e.left)<qs.verticalDropZoneAmbiguousDist));t.length>0&&(S=q().minBy(t,(e=>e.left)))}if(S){const e=S;u.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(y=Is(S))}return{ontoDropZone:h,verticalDropZone:y,horizontalDropZones:g}}findHoverMenuTarget(e,t,i){if(zs.Z.state.isResizing||Qe.ZP.state.isDragging||ko.Z.state.isActive||dt.kw.state)return;const{selectableRectMap:n}=ks.Z.state,a=Us.Z.getMembersByDOMOrder({filter:t=>{const i=t.getNode();return Boolean(i&&i.contains(e))}})[0],o=ee.default.getCurrentDefaultContainer(),s=a||o;if(!s)return;const r=n.keys();let l=r.next();const d=[];for(;!l.done;){const e=l.value,a=n.get(e);(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===s&&a&&i>=a.top&&i<=a.bottom&&t>=a.left-qs.hoverMaxHorizontalOffset&&t<=a.right&&d.push(e),l=r.next()}const c=q().sortBy(d,(e=>{const t=n.get(e);return t?-t.left:1/0})),u=c.find((e=>{const t=e.getNode();if(t){if(c.find((i=>{if(i!==e){const e=i.getNode();return Boolean(e&&t.contains(e))}return!1})))return!1}return!0}));return u?{selectable:u,container:s}:void 0}selectableCanAcceptDrop(e,t,i){if(f.Z.state.isOpen&&!Rt.default.state.open)return!1;if(v.Z.state.isOpen)return!1;const n=Qe.ZP.state,a=n.isDragging?n.draggedStores:[],o=!!n.isDragging&&n.isNativeDrag;let s,r,l,d=!1,c=!1;a.find((e=>{const t=Vs.Z.findOutlinerItemFromStore(e);return!!t&&(s=t,r=t.type,d=t.isTopLevelItem,!0)}));const u=e instanceof Ms.Z?Vs.Z.findOutlinerItemFromStore(e.props.store):void 0,p=null==u?void 0:u.parentStore;var m;u&&(l=u.type,c=u.isTopLevelItem||"team"===(null===(m=u.parentStore)||void 0===m?void 0:m.table));if(this.isDraggingSharedPageOutOfTopLevelTeamSection({draggingOutlinerItem:s,selectableOutlinerItemParent:p,direction:t}))return!1;if(!(e instanceof Ms.Z))return e.props.canAcceptDrop({direction:t,draggingStores:a,isNativeDrag:o});const g=e.props.store,h=g.getAssociatedCollectionStore();if(t===Qe.vh.Onto&&h){const e=h.id,t=(0,ws.fm)(g),i=null==t?void 0:t.collectionViewStore();if(i&&"page"!==i.getType()){if(a.find((t=>{const i=t.getAssociatedCollectionStore();return Boolean(t instanceof J.G&&i&&i.id===e)})))return!1}}if(e.props.groupsPointer){if(e.props.groupsPointer.find((e=>!(0,vs.WL)(e)))){if(a.find((t=>{var i;const n=Ws.C.findSelectableFromStore(t);return(null==n||null===(i=n.props)||void 0===i?void 0:i.groupsPointer)&&e.props.groupsPointer&&!(0,ys.HH)(n.props.groupsPointer,e.props.groupsPointer)})))return!1}}if((0,Rs.ru)({targets:a,destination:g,direction:t}))return!1;if(i&&a.find((e=>e.isTypedCollectionViewBlock()||(0,Ss.h7)(e))))return!1;if(u&&t!==Qe.vh.Onto&&!c&&!(0,bs.M)({environment:this.environment,blocks:[u.store],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(l&&o)return!1;if("bookmarks"===r&&d&&("bookmarks"!==l||!c||t===Qe.vh.Onto))return!1;if("bookmarks"===l&&c&&t!==Qe.vh.Onto&&("bookmarks"!==r||!d))return!1;if(s&&s.isTopLevelItem&&"team"===s.type&&s.parentStore&&s.parentStore.table===H.e0){const e=s.parentStore,t=J.zX.createChildStore(e,{...e.pointer,table:H.e0});if(t&&!(0,Ls.si)({teamStore:t,environment:this.environment}))return!1}if(u&&u.isTopLevelItem&&"team"===u.type&&u.parentStore&&u.parentStore.table===H.e0){const e=u.parentStore,t=J.zX.createChildStore(e,{...e.pointer,table:H.e0});if(t&&!(0,Ls.si)({teamStore:t,environment:this.environment}))return!1}if("shared"===l&&c&&("shared"!==r||!d))return!1;if(l&&c&&t!==Qe.vh.Onto){if(a.find((e=>{const t=e.getType();return Boolean(!t||!C.Z7[t])})))return!1}const{device:y}=this.environment;if(l&&y.isMobile&&t===Qe.vh.Onto&&c)return!1;if(a.find((e=>Boolean(e instanceof J.G&&e.isInlineCollectionView())))&&(t===Qe.vh.Left||t===Qe.vh.Right))return!1;if(a.some((e=>Boolean(Os.Z.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(Os.Z.findCollectionTemplatePickerItemFromStore(g)))return!1;if(t===Qe.vh.Onto&&g&&!(0,bs.J5)({environment:this.environment,blocks:[g],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(!this.memoizedCanDrag(a))return!1;if(a.some((e=>e.isTransclusionType()))){if(g.findRecordStoreUIAncestor((e=>{if(e===g)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getValue();return Boolean(t&&(0,C.nq)(t.type))})).ancestor)return!1}return!0}getReferencePointForRect(e,t){return xs({device:this.environment.device,target:e.target,points:t})}isDraggingSharedPageOutOfTopLevelTeamSection(e){var t;const{draggingOutlinerItem:i,selectableOutlinerItemParent:n,direction:a}=e;if(i&&"team"===i.type&&i.isTopLevelItem&&(null===(t=i.parentStore)||void 0===t?void 0:t.pointer.table)===H.e0){const e=i.parentStore;if(!(i.store.getParentId()===e.pointer.id||n&&n.pointer.id===e.pointer.id&&a!==Qe.vh.Onto))return!0}return!1}}qs.displayName="SelectableOrDropTargetListener",qs.hoverMaxHorizontalOffset=150,qs.competingOntoDropZoneVerticalOffset=7,qs.verticalDropZoneAmbiguousDist=20,qs.competingHorizontalDropZoneMinDist=2;const Hs=qs;var Gs=i(74647),js=i(49427),$s=i(7755);class Ys extends s.Z{constructor(){super(...arguments),this.cachedPageViewRect=void 0,this.previousMousePosition=void 0,this.mouseSpeed=1/0,this.timerId=void 0,this.setPreviousMousePosition=(e,t)=>{this.previousMousePosition={x:e,y:t},clearTimeout(this.timerId),this.timerId=setTimeout((()=>{this.previousMousePosition=void 0}),100)},this.handleWindowMouseMove=e=>{(0,tt.ZP)({event:e,context:tt.Af.SidebarMouseMove,callback:()=>{if(this.updatePageViewRectThrottled(),void 0!==this.previousMousePosition&&(this.mouseSpeed=Math.sqrt(Math.pow(e.clientX-this.previousMousePosition.x,2)+Math.pow(e.clientY-this.previousMousePosition.y,2))),this.setPreviousMousePosition(e.clientX,e.clientY),this.cachedPageViewRect){const{sidebarMinTriggerWidth:t,sidebarOpenWidthPercent:i}=Ys,n=$s.TC.state,a=(0,w.Wk)(this.environment),o=e.clientX,s=this.cachedPageViewRect.left,r=Math.max(s*i,t,$s.Ic.get());o<r&&!Rt.default.isMiniOrCenterPeekOpen()&&this.mouseSpeed<Ys.mouseSpeedThreshold&&0!==this.mouseSpeed&&!n&&Gs.open(),o>a&&o>r&&n&&Gs.close()}}})},this.handleWindowMouseOut=e=>{e.toElement||e.relatedTarget||Gs.close()},this.handleWindowResize=e=>{this.environment.WindowSizeStore.state.width<Gs.OnlyOneSidebarVisibleWidthThreshold&&(0,w.Sx)(this.environment)&&(0,w.in)(this.environment)&&Gs.setExpand({environment:this.environment,isExpanded:!1})},this.updatePageViewRectThrottled=q().throttle(this.updatePageViewRect,500)}didMount(){window.addEventListener("mousemove",this.handleWindowMouseMove),window.addEventListener("mouseout",this.handleWindowMouseOut),window.addEventListener("resize",this.handleWindowResize)}willUnmount(){window.removeEventListener("mousemove",this.handleWindowMouseMove),window.removeEventListener("mouseout",this.handleWindowMouseOut),window.removeEventListener("resize",this.handleWindowResize)}updatePageViewRect(){const e=this.getPageViewWrapEl();this.cachedPageViewRect=e?e.getBoundingClientRect():document.body.getBoundingClientRect()}getPageViewWrapEl(){const{mainEditorCurrentBlockStore:e}=h.default.state,t=js.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}}Ys.displayName="SidebarListener",Ys.sidebarOpenWidthPercent=.38,Ys.sidebarMinTriggerWidth=18,Ys.mouseSpeedThreshold=5;const Qs=Ys;var Xs=i(13991),Js=i(15944),er=i(84084),tr=i(68204),ir=i(64286),nr=i(10743);class ar extends s.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=nr.Z.state;if(!t.open)return;const i=this.getSections(t),n=this.getFilter(t);let s;return s=e.isMobileNative&&!e.isTablet?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:this.getWidth(),maxHeight:"40vh",onClickOutside:er.xv},o.createElement(E.Z,s,a()(ne.Z,{sections:i,onAccept:this.handleAccept,context:{environment:this.environment,blocks:ee.default.state.stores,originRect:t.selectionRect,publicEditMode:void 0},filter:n,initialFocus:0,onEmptyEnter:this.handleCancel,useLimit:!0}))},this.handleCancel=()=>{er.xv()},this.handleAccept=(e,t,i,n)=>{const a=ee.default.state.stores[0];if(a){const t=a.getType(),i=a.getFormat();G.dhV(this.environment,{analyticsName:e.analyticsName,from:"slash_menu",block_id:a.id,block_type:t,is_toggleable:t?(0,Q._A)(t,i):void 0,slash_menu_filter_length:this.filterLength(),slash_menu_section:n})}lt.createAndCommit({userAction:"SlashMenu.handleAccept",environment:this.environment,perform:e=>{er.RL({environment:this.environment,transaction:e})}})},this.filterLength=()=>{const e=nr.Z.state;return e.open?e.filter.length:0}}willMountOrUpdate(){let e=nr.Z.state;if(e.open){var t;const i=kt.default.state;if("editing"!==i.mode)return!1;const n=this.getFilter(e),a=(0,tr.sG)({sections:this.getSections(e),context:{blocks:ee.default.state.stores,environment:this.environment,publicEditMode:void 0},query:n||""});let o=0;if(n)if(0===a.length)o=n.length-e.lettersAtLastResult;else{const t={...e,lettersAtLastResult:(null==n?void 0:n.length)??0,filter:n};nr.Z.setState(t),e=t}const{currentUserSettingsStore:s}=h.default.state;!s||null!==(t=s.getSettings())&&void 0!==t&&t.pressed_slash_tooltip||!(0,ir.u)(this.environment)||Js.q6(this.environment);const{multiSelection:r}=i;(0,yt.qS)(r)&&r.start.store===e.textStore&&!zt.Ye(n,!0,a.length,o,e.textStore)||er.xv()}}renderComponent(){const{device:e}=this.environment,t=nr.Z.state;return a()(U.ZP,{popupType:e.isMobileNative&&!e.isTablet?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:U.ZP.Placement.Bottom,alignmentToOrigin:U.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,preventBlockRenderQueueOnEnter:!0,onDismiss:this.handleCancel,render:this.renderMenu})}getFilter(e){return zt.zK(e.textStore,e.oldTextValue,!e.isAddMenu)}getSections(e){const{insertActions:t,slashActions:i}=Ho.wg.state;return e.isAddMenu?t:i}getWidth(){return"fr-FR"===Xs.SP?375:324}}ar.displayName="SlashMenu";const or=ar;var sr=i(1310),rr=i(10339),lr=i(84076);class dr extends s.Z{constructor(){super(...arguments),this.showingAnimatedList=new ai.default(!1),this.handleShow=()=>{this.showingAnimatedList.set(!0)},this.handleHide=()=>{this.showingAnimatedList.set(!1)}}renderComponent(){const{currentItem:e}=sr.ZP.state,t=Boolean(e||this.showingAnimatedList.get());return a()(d.Z,{open:t,zIndex:201},void 0,a()(rr.Z,{render:()=>q().compact([this.renderCurrentItem()]),onShow:this.handleShow,onHide:this.handleHide}))}renderCurrentItem(){const{currentItem:e}=sr.ZP.state;if(!e)return;const t=(null==e?void 0:e.position)??"bottom",{WindowSizeStore:i,device:n}=this.environment;let o=24;if(n.isMobileNative&&n.isIOS){o=Ka.Z.state.estimatedKeyboardWebViewOverlap>0?24+Ka.Z.estimatedNativeWebBottomOverlap():i.getSafePaddingBottomCSS(24+Ka.Z.estimatedNativeWebBottomOverlap())}const s="top"===t?{top:24}:{bottom:o};return a()(oi.Z,{isVisible:!0,enterAnimationStyle:{translateY:"top"===t?-50:50,opacity:1,scale:1},animationStyle:{translateY:0,opacity:1,scale:1},exitAnimationStyle:{translateY:0,opacity:0,scale:.95},render:()=>a()("div",{style:{...s,position:"fixed",left:0,width:"100%",display:"flex",zIndex:ze.E,padding:4}},void 0,a()("div",{style:{background:this.theme.tooltipBackground,color:this.theme.regularInvertedTextColor,borderRadius:8,padding:"11px 16px",boxShadow:this.theme.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",...null==e?void 0:e.style}},void 0,e.label,e.helpUrl&&a()(lr.Z,{href:e.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:this.theme.regularInvertedTextColor}},void 0,Yt.Z.help({fill:this.theme.mediumInvertedTextColor})),a()("div",{style:{marginLeft:4,marginRight:-4}},void 0,e.right)))},e.key)}}dr.displayName="SnackbarRenderer";const cr=dr;var ur=i(6906),pr=i(24684),mr=i(37834),gr=i(93678),hr=i(52533),fr=i(8323),vr=i(46096),yr=i(84787),br=i(18647),Sr=i(46247),wr=i(26263),Mr=i(16691),Cr=i(7424),kr=i(4615),Tr=i(45953),_r=i(77420),Ir=i(13493),xr=i(66213),Zr=i(82136),Pr=i(84315);class Fr extends s.Z{constructor(){super(...arguments),this.handleOverrideLinkClick=e=>{mr.U4(),Ra.navigate({environment:this.environment,url:e})},this.loadSnapshot=async e=>{const{timestamp:t}=e,i=e.block.id,n=await _n.getSnapshotContents(this.environment,e);if("failed"===n.type)throw n.error;const a=Tr.PF.create(n.data.contentMap),o=this.environment.currentUser.id,s=new wr.Z;for(const{pointer:u,value:p}of a)p&&s.setRecord({pointer:u,userId:o},{value:p,role:"reader"});s.snapshotData={blockId:i,timestamp:t};const r=new Map,l=e=>{const t=s.getRecord({pointer:e,userId:o}),i=(0,Mr.dn)(e);t||!(0,kr.e)(e.id)||r.has(i)||r.set(i,(0,J.Kv)(this.props.blockStore,e))};for(const u of a)if(u.value)if((0,Tr.l0)(u,Ft.iU)){const{value:e}=u,t=Cr.kk.fromBlock(e),i=t.getProperties(),n=Tr.dr.uniq(q().flatten(Object.keys(i).map((e=>i[e])).map(ot.cC)));for(const r of n)l(r);const a=t.isNavigableBlock()?[]:t.getContentIds()||[];for(const r of a)l({table:Ft.iU,id:r});const o=t.getCollectionPointer();o&&l(o);const s=q().uniq(q().flatten(Object.keys(i).map((e=>i[e])).map(ot.lc)));for(const r of s)l({table:fi.KJ,id:r});e.created_by_table&&e.created_by_id&&(e.created_by_table===fi.KJ?l({table:fi.KJ,id:e.created_by_id}):l({table:_r.cZ,id:e.created_by_id})),e.last_edited_by_table&&e.last_edited_by_id&&(e.last_edited_by_table===fi.KJ?l({table:fi.KJ,id:e.last_edited_by_id}):l({table:_r.cZ,id:e.last_edited_by_id}))}else if((0,Tr.l0)(u,Ir.n)){var d;const{value:e}=u,t=null===(d=e.format)||void 0===d?void 0:d.collection_pointer;t&&l(t)}else if((0,Tr.l0)(u,hi.x_)){const{value:e}=u;e.created_by_id&&e.created_by_table&&(e.created_by_table===fi.KJ?l({table:fi.KJ,id:e.created_by_id}):l({table:_r.cZ,id:e.created_by_id}))}const c=Array.from(r.values());return await Promise.all(c.map((async e=>{await e.load();const t=e.getValue();t&&s.setRecord({pointer:e.pointer,userId:o},{role:"reader",value:t})}))),{blockStore:new J.G(this.environment,{table:Ft.iU,id:i},{inMemoryRecordCache:s}),timestamp:t}}}getChildContext(){return{...this.context,overrideLinkClick:this.handleOverrideLinkClick}}renderComponent(){const e=this.props.blockStore.id,t=this.props.timestamp,i={request:{block:{id:e,spaceId:(0,gi.CG)(this.props.blockStore.pointer.spaceId)},timestamp:t},performRequest:this.loadSnapshot,render:(e,t,i)=>a()(Ai.Z,{show:!i||!t,showDelay:400,showHold:400,render:i=>i?a()("div",{style:this.getSpinnerWrapperStyles()},void 0,a()(si.Z,{})):e?a()("div",{style:{padding:32}},void 0,a()(k.FormattedMessage,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})):t?a()(R.Z,{store:t.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:i}=e;return o.createElement(br.Z,ce()({style:{background:this.theme.contentBackground,zIndex:1,flexGrow:1},type:(0,dt.Zy)({environment:this.environment,store:t.blockStore})},i),a()(Pr.Z,{store:t.blockStore,disabled:!0,loadingContainerStore:void 0,context:Zr.S.InAppTemplatePreview,paddingBottom:Pr.Z.paddingBottom(this.environment),paddingLeft:(0,dt.ui)(this.environment),paddingRight:(0,dt.ui)(this.environment),pageCoverHeight:Pr.Z.defaultPageCoverHeight(this.environment)}))}},t.timestamp):void 0})};return a()(xr.LF,{value:this.handleOverrideLinkClick},void 0,o.createElement(Jn.Z,i))}getSpinnerWrapperStyles(){return{padding:32,display:"flex",alignItems:"center",justifyContent:"center"}}}Fr.displayName="PageSnapshotPreview",Fr.contextTypes=s.w,Fr.childContextTypes={...xr.wK,...s.w};const Ar=Fr;class Br extends s.Z{constructor(){super(...arguments),this.renderSnapshotsListRequest=()=>{const{device:e}=this.environment,t=vr.Z.state;if(!t.open)return;const i={request:{block:{id:t.blockStore.id,spaceId:(0,gi.CG)(t.blockStore.pointer.spaceId)},size:t.size},performRequest:e=>this.loadSnapshotsList(e,t),render:(i,n,o)=>a()(Ai.Z,{show:Boolean(!n||n.snapshots.length>=t.size&&t.openSnapshotNearTimestamp),showDelay:400,showHold:100,render:a=>e.isMobile?this.renderMobileHistory({snapshotValues:n?n.snapshots:[],menuState:t,error:i,initialLoading:a,loadingMore:!o}):this.renderDesktopHistory({snapshotValues:n?n.snapshots:[],menuState:t,error:i,initialLoading:a,loadingMore:!o})})};return o.createElement(Jn.Z,i)},this.renderMobileHistory=e=>{let t,i;return e.loadingMore||0!==e.snapshotValues.length||(t=this.renderUnavailableMessage(Br.noSnapshotsMessage,!1)),i=e.error?a()("div",{style:Br.wrapStyle},void 0,a()(k.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})):e.initialLoading?a()("div",{style:Br.wrapStyle},void 0,a()(si.Z,{})):a()(o.Fragment,{},void 0,a()(br.Z,{type:x.Z.Y},void 0,this.renderSnapshotsMenuList(e)),this.renderMobileSnapshotPreview(e.menuState)),a()(E.Z,{menuType:_.og.Modal,title:a()(k.FormattedMessage,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:this.renderMobileHelpButton(),right:a()(D.DoneMenuText,{}),onClickRight:mr.U4,header:t},void 0,i)},this.renderDesktopHistory=e=>{let t;if(e.error)t=a()("div",{style:Br.wrapStyle},void 0,a()(k.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"}));else if(e.initialLoading)t=a()("div",{style:Br.wrapStyle},void 0,a()(si.Z,{}));else{const i=e.menuState.snapshot&&this.getSnapshotUpsell({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot});t=i?this.renderUnavailableMessage(i.message,i.tier):e.loadingMore||0!==e.snapshotValues.length?this.renderDesktopSnapshotPreview(e.menuState):this.renderUnavailableMessage(Br.noSnapshotsMessage,!1)}return a()(o.Fragment,{},void 0,a()("div",{style:{display:"flex",flexDirection:"column",width:`calc(100% - ${Br.sidebarWidth}px)`,boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`}},void 0,t),this.renderDesktopSidebar(e))},this.renderSnapshotsMenuList=e=>{const{device:t}=this.environment,{menuState:i,loadingMore:n}=e,s=q().compact(e.snapshotValues.map(((n,s)=>{const r=s>0?e.snapshotValues[s-1]:void 0,l=this.getSnapshotUpsell({snapshot:n,nextFutureSnapshot:r}),d=!l;return{key:n.id,action:()=>{mr.gs({environment:this.environment,snapshot:n,nextFutureSnapshot:r})},render:e=>{const s=n.authors||[],r=this.props.intl.formatList(q().compact(s.map((e=>{if(e.table===fi.KJ){const t=J.t1.createChildStore(i.blockStore,e);if(!t.isDefined())return;return(0,Ea.Nz)(this.props.intl,t.getModel())}{const t=J.t1.createChildStore(i.blockStore,e);if(!t.isDefined())return;return t.getName()}}))),{type:"conjunction",style:"narrow"}),c=a()("div",{style:{...Ga.Z.textOverflowStyle}},void 0,r),u=Boolean(i.snapshot&&i.snapshot.id===n.id),p=parseInt(n.timestamp),m=p>Date.now()-6*At.A0?(0,Za.$b)(p,Xs.SP,this.props.intl):(0,Za.Yx)(p,"medium",Xs.SP),g=(0,Za.Yx)(p,"medium_with_time",Xs.SP);return a()(li.Z,d?{render:i=>o.createElement(fe.Z,ce()({},(0,sa.Z)(e,i),{title:m,focused:!t.isMobile&&u,caption:c})),renderTooltip:()=>a()("div",{style:{maxWidth:270,whiteSpace:"normal"}},void 0,a()("div",{},void 0,g),a()("div",{},void 0,r))}:{render:i=>o.createElement(fe.Z,ce()({},(0,sa.Z)(i,e),{title:a()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,a()("div",{style:{...t.isMobile&&{display:"flex",flex:1},...Ga.Z.textOverflowStyle}},void 0,m),a()(ia.Z,{subscriptionTier:l.tier,analyticsName:"history_modal",desktopStyle:{marginLeft:8},onClick:()=>this.handleUpgrade(l.tier)})),focused:!t.isMobile&&u,caption:c})),renderTooltip:()=>a()(k.FormattedMessage,{defaultMessage:"Upgrade to view this snapshot.",id:"historyModal.snapshotsMenuList.upgrade.tooltip"}),disableTooltip:!Tn.QM},e.key)}}}))),r=i.snapshot&&i.snapshot.id,l=s.findIndex((e=>r===e.key)),d=[{key:"snapshots",render:e=>o.createElement(oe.Z,e),items:s}];return a()(o.Fragment,{},void 0,a()(ve.Z,{type:ve.i.Vertical,initialFocus:l,sections:d}),a()(yr.Z,{loading:n,fetchSize:i.size,resultSize:e.snapshotValues.length,onLoadMore:mr.FF}),a()(Ai.Z,{show:n,showDelay:300,showHold:100,render:e=>e&&a()("div",{style:Br.wrapStyle},void 0,a()(si.Z,{}))}))},this.handleUpgrade=e=>{gr.y(this.environment,{from:"history_modal",for:e})},this.loadSnapshotsList=async(e,t)=>{const{device:i}=this.environment,n=await _n.getSnapshotsList(this.environment,e);if("failed"===n.type)throw n.error;const{snapshots:a}=n.data;if(t.pageHasCollection=a.some((e=>{var t;const i=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return i&&0!==i})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),i=a.findIndex((t=>parseInt(t.timestamp)<e));0===a.length||(0===i?mr.gs({environment:this.environment,snapshot:a[i],nextFutureSnapshot:void 0}):i>0?mr.gs({environment:this.environment,snapshot:a[i-1],nextFutureSnapshot:i>1?a[i-2]:void 0}):a.length<t.size?mr.gs({environment:this.environment,snapshot:a[a.length-1],nextFutureSnapshot:a.length>1?a[a.length-2]:void 0}):mr.FF())}else Boolean(t.snapshot)||i.isMobile||vr.Z.setState({...t,snapshot:a[0],nextFutureSnapshot:void 0});return n.data},this.iconSize=()=>{const{device:e}=this.environment;return e.isMobile?24:20}}renderComponent(){const{device:e}=this.environment,t=vr.Z.state;return e.isMobile?a()(U.ZP,{popupType:U.ZP.PopupType.SlideUp,open:t.open,render:this.renderSnapshotsListRequest,onDismiss:mr.U4}):a()(Ge.Z,{open:t.open,innerStyle:{height:"80vh",width:"80vw",overflow:"hidden",display:"flex"},onDismiss:mr.U4,render:this.renderSnapshotsListRequest,className:me.Nn$})}renderMobileSnapshotPreview(e){return a()(U.ZP,{popupType:U.ZP.PopupType.SlideUp,open:Boolean(e.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!e.snapshot)return;const t=this.getSnapshotUpsell({snapshot:e.snapshot,nextFutureSnapshot:e.nextFutureSnapshot}),i=!t,n=i?a()(Ar,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}):this.renderUnavailableMessage(t.message,t.tier);return a()(E.Z,{menuType:_.og.Modal,title:(0,Za.$b)(parseInt(e.snapshot.timestamp),Xs.SP,ge.default.getIntl()),right:a()(D.DoneMenuText,{}),onClickRight:mr.zb,leftDisabled:!i,left:a()(k.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>mr.xx(this.environment),whiteBackground:i,forceFullScreenSlideUp:!0},void 0,n)}})}hasPermissionToRestore(e){return(0,bs.k5)({environment:this.environment,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}renderDesktopSidebar(e){const{menuState:t}=e,i=Boolean(t.snapshot&&!this.getSnapshotUpsell({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot})&&this.hasPermissionToRestore(t));return a()("div",{style:this.getSidebarStyle()},void 0,a()(br.Z,{type:x.Z.Y,style:{flex:1}},void 0,this.renderSnapshotsMenuList(e)),a()("div",{style:{display:"flex",padding:14,borderTop:`\n\t\t\t\t\t\t\t1px solid ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`}},void 0,a()(li.Z,{renderTooltip:()=>a()(k.FormattedMessage,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:e=>o.createElement(Gn.Z,ce()({isLarge:!0,onClick:()=>mr.xx(this.environment),disabled:!i},e),a()(k.FormattedMessage,{defaultMessage:"Restore version",id:"historyModal.desktopModal.restoreButton.label"}))}),a()(je.Z,{isLarge:!0,style:{marginLeft:12},onClick:mr.U4},void 0,a()(k.FormattedMessage,{defaultMessage:"Cancel",id:"historyModal.desktopModal.cancelButton.label"}))),a()(oe.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,a()(se.Z,{title:a()(k.FormattedMessage,{id:"historyModal.desktopModal.learnMoreButton.label",defaultMessage:"Learn about page history"}),href:(0,Y.UY)("guides.pageHistory"),analyticsFrom:"page_history"})))}renderDesktopSnapshotPreview(e){if(e.snapshot)return a()(o.Fragment,{},void 0,a()("div",{style:{display:"flex",alignItems:"center",flexShrink:0,height:45,fontSize:14,paddingLeft:14}},void 0,e.blockStore.hasIcon()&&a()(Wi.Z,{disabled:!0,icon:e.blockStore.getIcon(),isEmptyPage:e.blockStore.isEmptyPage(),size:this.iconSize(),style:{marginRight:6}}),a()(zi.ZP,{store:e.blockStore})),a()(Ar,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}))}deviceSupportsUpgrade(e){const{device:t}=this.environment;return!t.isMobile||"personal"===e&&(0,hr.S$)({environment:this.environment})}renderUnavailableMessage(e,t){const{device:i}=this.environment,n=qn.default.state.data;let o=this.deviceSupportsUpgrade(t);const s=n&&Nn.GJ(n);return o&&(0,hr.S$)({environment:this.environment})&&"personal"===t&&!s&&(o=!1),a()("div",{style:this.getUnavailableMessageStyle()},void 0,this.deviceSupportsUpgrade(t)&&this.renderVersionHistoryIcon(),a()("div",{style:{...!i.isMobile&&{maxWidth:340}}},void 0,e),o&&t&&a()(Gn.Z,{isLarge:!0,onClick:()=>this.handleUpgrade(t),style:{marginTop:16}},void 0,a()(k.FormattedMessage,{defaultMessage:"Upgrade",id:"historyModal.upgradeForHistoryButton.label"})))}renderVersionHistoryIcon(){return Yt.Z.versionHistory({width:64,height:"auto",fill:this.theme.lightIconColor,marginBottom:12})}renderMobileHelpButton(){return a()(Sr.Z,{href:(0,Y.UY)("guides.pageHistory"),analyticsFrom:"page_history"})}getSnapshotUpsell(e){var t;if(vt.Z.isAdminMode)return;const{nextFutureSnapshot:i}=e;if(!i)return;const n=this.snapshotDaysOld(i);if((0,fr.Aw)()&&n<=pr.hy.team.days)return;const o=this.getTiersSupportingSnapshotAge(n);if((0,fr.p4)(o))return;const s=o[0]??"enterprise";return(0,Tn.QM)(s)?void 0:{tier:s,message:a()(k.FormattedMessage,{defaultMessage:"Please upgrade to the {upsellTier} Plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",description:"Prompt the user to upgrade their plan to access an old page version.",values:{upsellTier:(0,ur.Z)((0,Tn.eR)(s)?"plus":s),snapshotLimitDays:(null===(t=this.getPlanBelow(s))||void 0===t?void 0:t.days)??Math.floor(n)}})}}getTiersSupportingSnapshotAge(e){return this.getAvailablePlansWithHistories().filter((t=>t.days>e)).map((e=>e.tier))}getPlanBelow(e){const t=this.getAvailablePlansWithHistories(),i=t.findIndex((t=>t.tier===e));if(!(i<=0))return t[i-1]}getAvailablePlansWithHistories(){return pr.sb.filter((e=>"personal"!==e.tier))}snapshotDaysOld(e){return(Date.now()-parseInt(e.timestamp))/At.A0}getSidebarStyle(){return{display:"flex",flexDirection:"column",flexShrink:0,width:Br.sidebarWidth}}getUnavailableMessageStyle(){const{device:e}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,...e.isMobile?{position:"relative",zIndex:1,background:this.theme.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t0 -1px 0 ${this.theme.regularDividerColor},\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`}:{height:"100%"}}}}Br.displayName="HistoryModal",Br.sidebarWidth=240,Br.noSnapshotsMessage=a()(k.FormattedMessage,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"}),Br.wrapStyle={display:"flex",justifyContent:"center",padding:32};const Er=(0,k.injectIntl)(Br);var Dr=i(94507),Rr=i(61464);function Lr(){const e=(0,Ie.O7)(),{currentSpaceStore:t}=(0,l.Kw)(h.default),i=e.currentUser.id,n=(0,l.VK)((()=>null==t?void 0:t.id),[t]);return(0,o.useEffect)((()=>{if(!n||!i)return;const t=go.Z.addListener((0,uo.pD)({userId:i,spaceId:n}),(async(t,a)=>{(function(e){var t;let{spaceId:i,userId:n,emitValue:a}=e;const o=null===(t=Rr.Z.getUserJoinedTeamsState({userId:n,spaceId:i}))||void 0===t?void 0:t.lastEmitValue;if(o===a)return!1;if(void 0===o&&Rr.Z.getHasFetched({userId:n,spaceId:i}))return!1;return!0})({spaceId:n,userId:i,emitValue:a})&&await Dr.m({environment:e,spaceId:n,userId:i,emitValue:a});const o=Rr.Z.getUserJoinedTeamsState({userId:i,spaceId:n});o&&Rr.Z.setUserJoinedTeamsState({userId:i,spaceId:n,state:{...o,lastEmitValue:a}})}),void 0,e);return function(){t&&go.Z.removeListener(t,e)}}),[e,i,n]),null}var Or=i(30397);const Nr=function(){const e=(0,Ie.O7)(),{currentSpaceStore:t,currentUserStore:i}=(0,l.Kw)(h.default),[,n,a]=(0,l.AF)(Or.Z),s=null==i?void 0:i.id;return(0,o.useEffect)((()=>{if(!t||!s)return;const i=go.Z.addListener((0,uo.je)(t.id),(async(i,o)=>{if(!a.shouldRefetchTeamsInSpace({currentUserId:s,currentSpaceId:t.id,emitValue:o}))return;const l=await(0,r.qX)({environment:e,spaceStore:t,includeArchived:!1,currentUserId:s});n({teams:l,lastEmitData:{spaceId:t.id,userId:s,value:o}})}),void 0,e);return function(){i&&go.Z.removeListener(i,e)}}),[t,s,e,n,a]),null};var Vr=i(77719),Ur=i(4926),Wr=i(1634),zr=i(51077);class Kr extends s.Z{constructor(){super(...arguments),this.handleConnectClick=async()=>{const e=Wr.Z.state,{currentSpaceStore:t}=h.default.state;e.open&&t&&(await Vr.hM({environment:this.environment,integration:e.integration,spaceId:t.id,unfurlUrl:e.unfurlUrl,externalObjectInstanceBlockId:e.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),this.markPopupAsDismissed(e.integration.id),Wr.Z.reset())},this.handleCloseClick=()=>{const e=Wr.Z.state;e.open&&this.markPopupAsDismissed(e.integration.id),Wr.Z.reset()},this.markPopupAsDismissed=e=>{const{currentUserSettingsStore:t}=h.default.state;t&&lt.createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:this.environment,perform:i=>{oa.GK({transaction:i,userSettingsStore:t,integrationId:e})}})}}renderComponent(){const e=Wr.Z.state;if(!e.open)return;const t=e.integration.info.icon;return t?a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:this.theme.popoverBackground,borderRadius:3,boxShadow:this.theme.lightBoxShadow,position:"absolute",bottom:65+Ur.Z.state,right:16+Ur.Z.state,width:240,zIndex:ze.hT,clipPath:"inset(-10px -10px -10px -10px)"}},void 0,a()(zr.Z,{type:"image_url",imageURL:t,size:38,style:{marginBottom:6}}),a()("div",{style:{color:this.theme.regularTextColor,fontSize:14,fontWeight:Ga.Z.fontWeight.semibold,marginBottom:6,textAlign:"center"}},void 0,a()(k.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:e.integration.name}})),a()("div",{style:{color:this.theme.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},void 0,a()(k.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live.",description:"Displays the first time a user pastes a link that we have a Link Preview integration for."}),a()(ha.Z,{href:(0,Y.UY)("guides.unfurling"),external:!0},void 0,a()(k.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"}))),a()(Gn.Z,{onClick:this.handleConnectClick,style:{width:"100%"}},void 0,a()(k.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})),a()(da.Z,{icon:Yt.Z.close,onClick:this.handleCloseClick,style:{position:"absolute",top:6,right:6}})):void 0}}Kr.displayName="UnfurlingInformationPopup";const qr=(0,k.injectIntl)(Kr);var Hr=i(761),Gr=i(80064);class jr extends s.Z{constructor(){super(...arguments),this.menuRef=(0,o.createRef)(),this.renderMenu=()=>{const{device:e}=this.environment,t=Gr.Z.state;if(!t.open)return;const{allOptionTypes:i}=t,n={key:"embed section",render:e=>o.createElement(oe.Z,e),items:i.map((e=>({key:e,render:t=>o.createElement(fe.Z,ce()({},t,{title:this.renderTitleForOptionType(e),onMouseEnter:i=>{t.onMouseEnter(i),this.updateUnfurlingOptionType(e)}})),action:()=>this.handleDismiss(e)})))};let s;return s=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:320,maxHeight:"40vh"},o.createElement(E.Z,ce()({},s,{className:me.b_f,ref:this.menuRef}),a()(ve.Z,{type:ve.i.Vertical,sections:[n],initialFocus:0,onKeyboardArrow:this.handleMenuListKeyboardArrow,priority:1}))},this.handleDefaultDismiss=()=>{this.handleDismiss(void 0)},this.handleDismiss=e=>{lt.createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:this.environment,perform:t=>{Hr.xv({environment:this.environment,setType:e,transaction:t})}})},this.updateUnfurlingOptionType=e=>{lt.createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:this.environment,perform:t=>{Hr.hJ({environment:this.environment,type:e,useTemporaryRecordCache:!0,transaction:t,intl:this.props.intl})}})},this.handleMenuListKeyboardArrow=e=>{const t=Gr.Z.state;if(!t.open||void 0===e.indexGlobal)return;const i=t.allOptionTypes[e.indexGlobal];i&&this.updateUnfurlingOptionType(i)},this.handleWindowKeydown=e=>{Gr.Z.state.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&this.handleDismiss(void 0)},this.handleWindowMousedown=e=>{const t=Gr.Z.state,i=this.menuRef.current;if(!t.open||!e.target||!i)return;const n=Ae.findDOMNode(i);n&&(n.contains(e.target)||this.handleDismiss(void 0))}}willMount(){(0,Zi.lj)(window,"keydown",this.handleWindowKeydown),(0,Zi.lj)(window,"mousedown",this.handleWindowMousedown)}willUnmount(){(0,Zi.ZV)(window,"keydown",this.handleWindowKeydown),(0,Zi.ZV)(window,"mousedown",this.handleWindowMousedown)}renderComponent(){const{device:e}=this.environment,t=Gr.Z.state;return a()(U.ZP,{popupType:e.isMobileNative&&!e.isTablet?U.ZP.PopupType.SlideUp:U.ZP.PopupType.Popup,open:Boolean(t.open&&t.renderRect),originRect:t.open?t.renderRect:void 0,placementToOrigin:U.ZP.Placement.Top,alignmentToOrigin:U.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDefaultDismiss})}renderTitleForOptionType(e){return"preview"===e?a()(k.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"}):"mention"===e?a()(k.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"}):"link"===e?a()(k.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"}):"collection"===e?a()(k.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Paste as database"}):void(0,Ii.t1)(e)}}jr.displayName="UnfurlingMenu";const $r=(0,k.injectIntl)(jr);class Yr extends s.Z{willMount(){this.environment.device.isMobile&&document.addEventListener("gesturestart",(function(e){e.preventDefault()}))}renderComponent(){const e=this.environment.currentUser.isLoggedIn(),{isMobile:t,isElectron:i}=this.environment.device,{currentSpaceStore:n}=h.default.state;return a()(o.Fragment,{},void 0,a()(_i,{}),a()(z,{}),a()(We,{}),a()(zo,{}),a()(g,{}),a()(at,{}),a()(y.Z,{priority:-1,capture:!0}),a()(Hs,{}),e&&!t&&a()(Qs,{}),e&&n&&a()(yo,{rootStore:n}),e&&a()(Nr,{}),e&&(0,r.bq)()&&a()(Lr,{}),a()(et,{}),a()(ro,{}),a()(le,{}),a()(No,{}),a()(Bo,{}),a()(pi,{}),a()(Te,{}),!t&&a()(fs,{}),a()(Ci,{}),a()(Mo,{}),a()(Ma,{}),a()(_e.ZP,{store:f.Z}),a()(_e.ZP,{store:v.Z}),a()(ao,{}),a()(or,{}),a()(Gt,{}),a()(Ut,{}),a()($r,{}),a()(Ei,{}),a()(qr,{}),a()(Se,{}),a()(cr,{}),a()(mn,{}),i&&a()(xt,{}),a()(pt,{}),a()(Ye,{}),a()(_o,{}),e&&a()(Er,{}),a()(mi.s,{}))}}Yr.displayName="AppComponents";const Qr=Yr},74687:(e,t,i)=>{i.r(t),i.d(t,{default:()=>O});var n=i(77094),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(83355),d=i(41892),c=i(8848),u=i(3779),p=i(30845),m=i(82990),g=i(5366),h=i(50906),f=i(33929),v=i(49085);class y extends v.Z{getInitialState(){return{step:"initial"}}}const b=y;var S=i(73796),w=i(97464),M=i.n(w),C=i(52275),k=i(63296),T=i(14871);class _ extends l.Z{renderComponent(){const{intl:e,question:t}=this.props,i={setup_trial:a()(g.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial",description:"Shown as an option in the form to contact sales about setting up an enterprise trial before purchasing."}),setup_enterprise_trial:a()(g.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial",description:"Shown as an option in the form to contact sales about setting up an enterprise trial before purchasing."}),setup_business_trial:a()(g.FormattedMessage,{id:"contactModalQuestionSelect.question.setup_business_trial",defaultMessage:"Setup a business trial",description:"Shown as an option in the form to contact sales about setting up a business trial before purchasing."}),live_demo:a()(g.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.live_demo",defaultMessage:"Schedule a live demo"}),plan_help:a()(g.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.plan_help",defaultMessage:"Need help choosing a plan"}),other:a()(g.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.other",defaultMessage:"Other"})},n={menuTitle:e.formatMessage({defaultMessage:"Your question",id:"enterpriseContactModal.yourQuestion.title"}),items:["setup_enterprise_trial","setup_business_trial","live_demo","plan_help","other"],width:"auto",minWidth:280,getKey:e=>e,selectedItem:t,originGap:4,onSelect:e=>{this.props.onSelect(e)},renderItem:e=>r.createElement(C.Z,M()({title:i[e.key]},e)),renderOrigin:e=>r.createElement(k.Z,M()({},e,{isLarge:!0,style:{...this.getInputStyle(),...this.props.invalid&&{border:`1px solid ${c.ZP.red}`}}}),a()("div",{style:{display:"flex",alignItems:"center",color:t?this.theme.regularTextColor:this.theme.lightTextColor}},void 0,t?i[t]:a()(g.FormattedMessage,{defaultMessage:"Select question",id:"enterpriseContactModal.selectQuestion.label"})),u.Z.expand({width:10,fill:this.theme.lightIconColor}))};return r.createElement(T.Z,M()({key:"onboarding"},n))}getInputStyle(){const{device:e}=this.environment;return{backgroundColor:this.theme.whiteButtonBackground,height:31,...e.isMobile&&{height:42},padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:3,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${this.theme.outlineButtonBorder}`,background:this.theme.buttonBackground}}}_.displayName="ContactModalQuestionSelect";const I=(0,g.injectIntl)(_);var x=i(23063),Z=i(42922),P=i(64921),F=i(74194),A=i(3386),B=i(22346),E=i(89728),D=i(29551);const R=(0,g.defineMessages)({additionalFeedbackPlaceholder:{id:"enterpriseContactModal.additionalFeedback.placeholder",defaultMessage:"What would you like to learn more about?"}});class L extends l.Z{constructor(){super(...arguments),this.storeTypes={store:b},this.renderMenu=()=>a()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),a()(D.gq,{style:this.getInnerContainerStyle(),alignItems:"center",alignContent:"center"},void 0,this.renderStep())),this.renderInitial=()=>{const{invalidField:e}=this.stores.store.state;if(S.Z.state.open)return a()("div",{style:{...this.getSlideUpStyle(),padding:20}},void 0,u.Z.speechBubbleThin({width:"100%",height:24}),a()("div",{style:{fontSize:14,fontWeight:m.Z.fontWeight.semibold,paddingTop:6,paddingBottom:4}},void 0,a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.header",defaultMessage:"Get in touch with sales"})),a()("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:200,margin:"0 auto"}},void 0,a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.caption",defaultMessage:"We'll work with you on your setup and help you land on the best plan."})),a()("div",{style:{...this.getLabelStyle(),marginTop:24}},void 0,a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.nameLabel",defaultMessage:"Your name"})),a()(F.Z,{focusInitial:!0,value:this.getName(),placeholder:"Ada Lovelace",style:{marginRight:4,...this.getInputStyle(),..."name"===e&&this.getInvalidInputStyle()},onChange:e=>{S.Z.setState({...S.Z.state,open:!0,name:void 0}),this.stores.store.setState({...this.stores.store.state,name:e.target.value}),h.QOK(this.environment,{contactFieldType:"name",contactFieldValue:e.target.value})}}),a()("div",{style:this.getLabelStyle()},void 0,a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.emailLabel",defaultMessage:"Your work email"})),a()(F.Z,{value:this.getEmail(),placeholder:"ada@lovelace.app",type:"email",style:{marginRight:4,...this.getInputStyle(),..."email"===e&&this.getInvalidInputStyle()},onChange:e=>{S.Z.setState({...S.Z.state,open:!0,email:void 0}),this.stores.store.setState({...this.stores.store.state,email:e.target.value}),h.QOK(this.environment,{contactFieldType:"email",contactFieldValue:e.target.value})}}),a()("div",{style:this.getLabelStyle()},void 0,a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.companySizeLabel",defaultMessage:"Company size"})),a()(D.gq,{},void 0,this.getCompanySizeButtonData().map((e=>{let{type:t,message:i,style:n}=e;return a()(E.Z,{isLightGray:!0,isLarge:!0,style:{...this.getBaseButtonStyle(),...this.stores.store.state.companySize===t&&this.getSelectedButtonStyle(),...n},onClick:()=>{this.stores.store.setState({...this.stores.store.state,companySize:t}),h.QOK(this.environment,{contactFieldType:"companySize",contactFieldValue:t})}},t,i)}))),a()("div",{style:this.getLabelStyle()},void 0,a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.questionLabel",defaultMessage:"Your question"})),a()(I,{question:this.getQuestion(),invalid:"question"===e,onSelect:e=>{this.stores.store.setState({...this.stores.store.state,question:e,step:"other"===e?"additional_input":"initial"}),h.QOK(this.environment,{contactFieldType:"question",contactFieldValue:"other"===e?"additional_input":"initial"})}}),a()(F.Z,{textarea:!0,textareaElementAttributes:{style:this.getInnerTextAreaStyle()},style:this.getTextAreaStyle(),focus:"additional_input"===this.stores.store.state.step,value:this.stores.store.state.additionalFeedback,placeholder:f.default.formatMessage(R.additionalFeedbackPlaceholder),onChange:e=>{this.stores.store.setState({...this.stores.store.state,additionalFeedback:e.target.value}),h.QOK(this.environment,{contactFieldType:"additionalFeedback",contactFieldValue:e.target.value})}}))},this.renderCancel=()=>a()(P.Z,{onClick:()=>{h.g3X(this.environment),this.handleCancel()},style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,u.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})),this.renderThanks=()=>a()("div",{},void 0,a()("img",{style:{width:165,height:80},src:d.Z.images.feedbackThankYouPng}),a()("div",{style:this.getThanksHeaderStyle()},void 0,a()(g.FormattedMessage,{id:"enterpriseContactModal.thanks.caption",defaultMessage:"We've received your inquiry and will be contacting you via email shortly."}))),this.handleCancel=()=>{S.Z.setState({open:!1})}}renderComponent(){return a()(B.Z,{preventHideChildrenWhileOpening:!0,open:S.Z.state.open,render:this.renderMenu,onDismiss:this.handleCancel})}renderStep(){const{step:e}=this.stores.store.state;return r.createElement(r.Fragment,null,a()(x.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>a()(A.Z,{capture:!0,onBackspace:s().identity,onLeft:s().identity,onRight:s().identity,onSelectAll:s().identity,onRedo:s().identity,onUndo:s().identity,onCut:s().identity,onCopy:s().identity,onPaste:s().identity,onKeypress:s().identity,onDelete:s().identity,onTab:s().identity},void 0,this.renderInitial())}),a()(x.Z,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}),a()(x.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>a()(Z.Z,{isLarge:!0,style:{marginTop:17,width:284,position:"absolute",bottom:20},onClick:()=>{const e=this.getInvalidField();if(e){const{question:t}=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,step:"initial",invalidField:e,question:"other"===t?this.getQuestion():t})}else this.stores.store.setState({...this.stores.store.state,invalidField:void 0,step:"thanks"}),S.Z.state.open&&h.Ls9(this.environment,{email:S.Z.state.email,name:S.Z.state.name,question:S.Z.state.question,...this.stores.store.state}),s().delay((()=>{S.Z.reset(),s().delay((()=>{this.stores.store.reset()}),1e3)}),2e3)}},void 0,a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.sendLabel",defaultMessage:"Send"}))}))}getName(){if(S.Z.state.open)return this.stores.store.state.name||S.Z.state.name}getEmail(){if(S.Z.state.open)return this.stores.store.state.email||S.Z.state.email}getQuestion(){if(S.Z.state.open)return this.stores.store.state.question||S.Z.state.question}getInvalidField(){const e=this.getEmail(),t=this.getName(),{companySize:i}=this.stores.store.state;return t?e&&p.B(e,"email")?i?this.getQuestion()?void 0:"question":"company_size":"email":"name"}getCompanySizeButtonData(){return[{type:"1_100",message:a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:a()(g.FormattedMessage,{id:"enterpriseContactModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}]}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:m.Z.fontWeight.semibold,fontSize:14}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getInnerContainerStyle(){return{width:320,height:470,overflow:"hidden",position:"relative",padding:20,cursor:"default",textAlign:"center",justifyContent:"center"}}getLabelStyle(){return{marginTop:17,fontSize:12,color:this.theme.mediumTextColor,fontWeight:m.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getInputStyle(){return{backgroundColor:this.theme.whiteButtonBackground,height:31}}getInvalidInputStyle(){return{border:`1px solid ${c.ZP.red}`}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getBaseButtonStyle(){return{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center"}}getSelectedButtonStyle(){return{color:c.ZP.blue,border:`1px solid ${c.ZP.blue}`}}getSlideUpStyle(){const{step:e}=this.stores.store.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(153px)":"translateY(-180px)"}}getInnerTextAreaStyle(){return{width:"100%",height:"100%",background:"none",border:"none",resize:"none"}}getTextAreaStyle(){return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:"7px 10px",height:310,marginTop:17,marginBottom:17,transition:"opacity 200ms ease-in",opacity:"additional_input"===this.stores.store.state.step?1:.001}}}L.displayName="ContactModal";const O=L},85324:(e,t,i)=>{i.r(t),i.d(t,{default:()=>I});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(480),d=i(24405),c=i(41892),u=i(86658),p=i(82990),m=i(63143),g=i(5366),h=i(92108),f=i(36867),v=i(45293),y=i(10182),b=i(42922),S=i(89728),w=i(92660),M=i(29551);function C(){window.__c={n:"SaveAllButton"};const e=(0,d.yK)(_,[]),t=(0,l.O7)();return s()(b.Z,{isLarge:!0,style:e.acceptAllButton,onClick:()=>{h.a9(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),v.Z.setState({open:!1}),h.qo()}},void 0,r.createElement(g.FormattedMessage,u.ze.acceptAllButtonLabel))}function k(){window.__c={n:"RejectAllButton"};const e=(0,d.yK)(_,[]),t=(0,l.O7)();return s()(S.Z,{isLarge:!0,isGray:!0,style:e.moreOptionsButton,onClick:()=>{h.a9(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),v.Z.setState({open:!1}),h.qo()}},void 0,r.createElement(g.FormattedMessage,u.ze.rejectAllButtonLabel))}function T(){window.__c={n:"MoreOptionsButton"};const e=(0,d.yK)(_,[]);return s()(y.Z,{hasDismissButton:!0,onDismiss:()=>{v.Z.setState({open:!1})},renderOrigin:t=>r.createElement(S.Z,a()({},t,{isLarge:!0,isGray:!0,style:e.moreOptionsButton}),r.createElement(g.FormattedMessage,u.ze.moreOptionsButtonLabel))})}function _(e){return{modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:p.Z.fontWeight.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}}const I=(0,g.injectIntl)((function(){window.__c={n:"CookieModal"};const e=(0,l.O7)().currentUser.id;(0,r.useEffect)((()=>{if(!e)return;(0,f._)(e);const t=window.setInterval((()=>{(0,f._)(e)}),m.A0);return()=>{window.clearInterval(t)}}),[e]);const t=(0,d.yK)(_,[]);return s()(w.Z,{onDismiss:()=>{},render:()=>s()("div",{style:t.modal},void 0,s()(M.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center"},void 0,s()("img",{style:t.image,src:c.Z.images.feedbackThankYouPng}),s()("div",{style:t.title},void 0,s()(g.FormattedMessage,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences",description:"Title of the modal shown when requesting cookie consent."})),s()("div",{style:t.description},void 0,(0,u.Fd)(h.Tz,"banner")),s()(C,{}),s()(k,{}),s()(T,{}))),requireOnline:!0,modalStore:v.Z})}))},42333:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var n=i(77094),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(83355),d=i(18466),c=i(41892),u=i(3779),p=i(82990),m=i(51454),g=i(5366),h=i(54642),f=i(73409),v=i(10482);function y(e,t,i){if(i){const{templateId:n}=i;return e.some((e=>e.milestone===t&&e.template_id===n))}return e.some((e=>e.milestone===t))}var b=i(33929),S=i(38755),w=i(8323),M=i(27832),C=i(4926),k=i(49085);const T="rate",_="send",I="thanks";class x extends k.Z{getInitialState(){return{starRating:void 0,step:T}}}const Z=x;var P=i(5188),F=i(23063),A=i(42922),B=i(64921),E=i(74194),D=i(3386),R=i(31278),L=i(29551);const O=(0,g.defineMessages)({additionalFeedbackPlaceholder:{id:"csatPopup.additionalFeedback.placeholder",defaultMessage:"Tell us more..."}});class N extends l.Z{constructor(){super(...arguments),this.storeTypes={csatPopupStore:Z},this.renderCancel=()=>a()(B.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,u.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})),this.renderStep=()=>{const{step:e}=this.stores.csatPopupStore.state,{currentSpaceStore:t}=M.default.state;let i;if(t){const e=t.getInitialUseCases();e&&(i=s().sample(e))}return r.createElement(r.Fragment,null,a()(F.Z,{isVisible:e===T,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0,translateY:-120},render:()=>a()("div",{style:{paddingBottom:40}},void 0,this.renderIcon(),this.renderFeedbackPrompt(i))}),a()(F.Z,{isVisible:e===T||e===_,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>a()("div",{style:this.getSlideContainerStyle()},void 0,this.renderStars(i),this.renderInput(),this.renderSendButton())}),a()(F.Z,{isVisible:e===I,animationStyle:this.getAnimationStyle(e===I),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}))},this.renderThanks=()=>a()("div",{},void 0,a()("img",{style:{width:165,height:80},src:c.Z.images.feedbackThankYouPng}),a()("div",{style:this.getThanksHeaderStyle()},void 0,a()(g.FormattedMessage,{defaultMessage:"Thanks for your feedback!",id:"csatPopup.thanks.header"})),a()("div",{style:this.getThanksDescriptionStyle()},void 0,a()(g.FormattedMessage,{defaultMessage:"Your feedback will help us make Notion better.",id:"csatPopup.thanks.description"}))),this.renderIcon=()=>{const{mainEditorCurrentBlockStore:e}=M.default.state;if(e){const t=e.getIcon();if(t)return a()(L.gq,{justifyContent:"center",alignItems:"center"},void 0,a()(R.Z,{icon:t,isEmptyPage:!1,size:32,disabled:!0}))}return a()(L.gq,{justifyContent:"center",alignItems:"center"},void 0,u.Z.notionLogo({width:32,height:32}))},this.renderFeedbackPrompt=e=>{switch(e){case"doc_notes":return a()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",a()(g.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for notes & docs?",id:"csatPopup.feedbackPrompt.docNotesLabel"}));case"project_management":return a()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",a()(g.FormattedMessage,{defaultMessage:"How satisfied are you with managing projects and tasks in Notion?",id:"csatPopup.feedbackPrompt.projManagementLabel"}));case"wiki":return a()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",a()(g.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for team wikis?",id:"csatPopup.feedbackPrompt.wikiLabel"}));default:const t=this.shouldRenderAsNPS(e);return a()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",a()(g.FormattedMessage,t?{defaultMessage:"How likely are you to recommend Notion to a friend?",id:"csatPopup.feedbackPrompt.enterpriseDefaultLabel"}:{defaultMessage:"How satisfied are you with using Notion? ",id:"csatPopup.feedbackPrompt.defaultlabel"}))}},this.renderInput=()=>{const{step:e,additionalFeedback:t}=this.stores.csatPopupStore.state;return a()(D.Z,{capture:!0,onBackspace:s().identity,onLeft:s().identity,onRight:s().identity,onSelectAll:s().identity,onRedo:s().identity,onUndo:s().identity,onCut:s().identity,onCopy:s().identity,onPaste:s().identity,onKeypress:s().identity,onDelete:s().identity,onTab:s().identity},void 0,a()(E.Z,{textarea:!0,style:this.getInputContainerStyle(),focus:e===_,value:t,placeholder:b.default.formatMessage(O.additionalFeedbackPlaceholder),onChange:e=>{this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,additionalFeedback:e.target.value})}}))},this.renderSendButton=()=>a()(A.Z,{isLarge:!0,style:this.getButtonStyle(),onClick:this.handleSend},void 0,a()(g.FormattedMessage,{id:"csatPopup.sendButton.label",defaultMessage:"Send"})),this.renderStars=e=>{const{starRating:t,step:i}=this.stores.csatPopupStore.state,n=e=>{let{rating:n}=e;return a()("div",{style:this.getStarStyle(),onMouseEnter:()=>{i===T&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:n})},onClick:()=>{this.stores.csatPopupStore.setState({starRating:n,step:_})}},void 0,u.Z.star({width:18,fill:this.theme.mediumIconColor,position:"absolute",opacity:t&&t>=n?0:1}),u.Z.starFilled({width:18,fill:"#F6C050",position:"absolute",opacity:t&&t>=n?1:0}))},o=()=>{const i=this.shouldRenderAsNPS(e);switch(t){case 1:return a()(g.FormattedMessage,i?{defaultMessage:"Very unlikely",id:"csatPopup.stars.1StarLabelNps"}:{defaultMessage:"Very dissatisfied",id:"csatPopup.stars.1StarLabel"});case 2:return a()(g.FormattedMessage,i?{defaultMessage:"Somewhat unlikely",id:"csatPopup.stars.2StarLabelNps"}:{defaultMessage:"Somewhat dissatisfied",id:"csatPopup.stars.2StarLabel"});case 3:return a()(g.FormattedMessage,i?{defaultMessage:"Not likely nor unlikely",id:"csatPopup.stars.3StarLabelNps"}:{defaultMessage:"Not dissatisfied nor satisfied",id:"csatPopup.stars.3StarLabel"});case 4:return a()(g.FormattedMessage,i?{defaultMessage:"Somewhat likely",id:"csatPopup.stars.4StarLabelNps"}:{defaultMessage:"Somewhat satisfied",id:"csatPopup.stars.4StarLabel"});case 5:return a()(g.FormattedMessage,i?{defaultMessage:"Very likely",id:"csatPopup.stars.5StarLabelNps"}:{defaultMessage:"Very satisfied",id:"csatPopup.stars.5StarLabel"});default:return a()(g.FormattedMessage,{defaultMessage:"Select an option",id:"csatPopup.stars.notSpecifiedLabel"})}};return a()("div",{onMouseLeave:()=>{s().delay((()=>{this.stores.csatPopupStore.state.step===T&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:void 0})}),500)},style:this.getStarsContainerStyle()},void 0,a()("div",{style:this.getStarsStyle()},void 0,a()(n,{rating:1}),a()(n,{rating:2}),a()(n,{rating:3}),a()(n,{rating:4}),a()(n,{rating:5})),a()("div",{style:this.getStarLabelStyle()},void 0,a()(o,{})))},this.handleCancel=async()=>{const{state:e}=P.Z;if(!e.open)return;const{open:t,...i}=e;if(t&&"trigger"===i.type){const{currentSpaceStore:e}=M.default.state;if(!e)return;await h.submitCsatFeedback(this.environment,{spaceId:e.id,rating:void 0,additionalFeedback:void 0,templateId:void 0,...i})}P.Z.setState({...P.Z,open:!1})},this.handleSend=async()=>{const{additionalFeedback:e,starRating:t}=this.stores.csatPopupStore.state,{currentSpaceStore:i}=M.default.state;if(!i||!t)return;const{state:n}=P.Z;if(!n.open)return;const{open:a,...o}=n,r="passive"===o.type?await h.submitCsatFeedback(this.environment,{spaceId:i.id,rating:t,additionalFeedback:e,type:o.type,milestone:void 0,templateId:void 0}):await h.submitCsatFeedback(this.environment,{spaceId:i.id,rating:t,additionalFeedback:e,templateId:void 0,...o});if("success"!==r.type)throw r.error;this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,step:I}),s().delay((()=>{P.Z.setState({...P.Z,open:!1}),s().delay((()=>{this.stores.csatPopupStore.reset()}),1e3)}),2e3)},this.flexCenteredStyle={display:"flex",alignItems:"center",flexDirection:"column"}}willMount(){const{userSettingsStore:e,blockStore:t,spaceStore:i}=this.props;if(e&&t&&i){const n=this.environment;if("CsatMilestoneStore"in n){const a=d.Z.withListenerIgnored((()=>function(e,t){const{userSettingsStore:i,blockStore:n,spaceStore:a}=t,o=i.getSettings(),r=null==o?void 0:o.signup_time,{CsatMilestoneStore:l}=e,{data:d}=l.state,c=864e5,u=e=>Math.floor((Date.now()-e)/c);if(!a.isDefined()||!d)return;const{milestones:p}=d;if(!p)return;if(Math.max(...p.map((e=>e.created_time)))>Date.now()-24192e5)return;if(r){const e=u(r),t=s().sample(a.getInitialUseCases())||"legacy";if(e>=180){if(!y(p,f.Hf))return{milestone:f.Hf,useCase:t}}else if(e>=90){if(!y(p,f.Vx))return{milestone:f.Vx,useCase:t}}else if(e>=28){if(!y(p,f.Sh))return{milestone:f.Sh,useCase:t}}else if(e>=7&&!y(p,f.zK))return{milestone:f.zK,useCase:t}}const m=n.getCopiedFromPointer();return n.isDefined()&&m&&(0,v.JY)(m)&&u(n.getCreatedTime())>=7&&!y(p,f.a0,{templateId:m.id})?{milestone:f.a0,useCase:"legacy",templateId:m.id}:void 0}(n,{userSettingsStore:e,blockStore:t,spaceStore:i})));if(a){const{milestone:e,useCase:t,templateId:i}=a;s().delay((()=>{P.Z.setState({open:!0,milestone:e,type:"trigger",useCase:t,templateId:i})}),2e3)}}}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const{currentSpaceStore:t}=M.default.state;return t&&!(0,S.Cx)(t)?a()(F.Z,{isVisible:P.Z.state.open,animationStyle:this.getAnimationStyle(P.Z.state.open),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),springConfig:this.getSpringConfig(),render:()=>a()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),a()("div",{style:this.getInnerContainerStyle()},void 0,this.renderStep()))}):void 0}shouldRenderAsNPS(e){const t=(0,w.zt)(),{state:i}=P.Z,n=i.open&&"trigger"===i.type;return"enterprise"===t&&!e&&n}getSpringConfig(){return{scale:{stiffness:58,damping:4.3}}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:p.Z.fontWeight.semibold,fontSize:14}}getThanksDescriptionStyle(){return{color:this.theme.mediumTextColor,fontSize:12}}getButtonStyle(){return{width:"calc(100% - 30px)"}}getInputContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{width:"calc(100% - 30px)",display:"block",background:this.theme.popoverBackground,height:80,marginTop:10,marginBottom:10,opacity:e===T?0:1}}getStarLabelStyle(){return{fontSize:12,color:this.theme.mediumTextColor,paddingTop:4}}getFeedbackPromptStyle(){return{paddingTop:12,paddingBottom:12,color:this.theme.regularTextColor,fontWeight:p.Z.fontWeight.semibold,fontSize:14,lineHeight:1.4,width:188}}getStarStyle(){return{display:"inline-flex",position:"relative",width:20,height:20,marginRight:3}}getSlideContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{...this.flexCenteredStyle,position:"absolute",transition:"transform 200ms ease",width:240,transform:e===T?"translateY(120px)":"translateY(0px)"}}getStarsContainerStyle(){return{width:"100%",...this.flexCenteredStyle}}getStarsStyle(){return{display:"flex",cursor:"pointer"}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"absolute",bottom:65+C.Z.state,right:16+C.Z.state,zIndex:m.hT}}getInnerContainerStyle(){return{...this.flexCenteredStyle,width:240,height:195,overflow:"hidden",position:"relative",padding:12,cursor:"default",textAlign:"center",justifyContent:"center"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}}N.displayName="CsatPopup";const V=(0,g.injectIntl)(N)},1459:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Y});var n=i(77094),a=i.n(n),o=i(67294),s=i(83355),r=i(5366),l=i(79257),d=i(11599),c=i(27832),u=i(85680),p=i(88923),m=i(44532),g=i(97464),h=i.n(g),f=i(96486),v=i.n(f),y=i(6695),b=i(3779),S=i(82990),w=i(50906),M=i(96802),C=i(30149),k=i(84210),T=i(60709),_=i(33665),I=i(92547),x=i(85057),Z=i(81870),P=i(26909),F=i(44514),A=i(79131),B=i(84076),E=i(78140),D=i(28992),R=i(40721),L=i(89728),O=i(31278),N=i(76798),V=i(72495),U=i(61766),W=i(12318),z=i(43700),K=i(69872);class q extends s.Z{constructor(){super(...arguments),this.storeTypes={hovered:W.default.of(!1),buttonPopupStore:W.default.of(new U.Z)}}renderComponent(){const{schema:e,property:t,format:i,showAsSectionMenu:n,handlePageSectionClick:o}=this.props,s=e[t];if(!s)return;const r=this.getPropertyVisibility(s);return a()(K.Z,{onMouseEnter:()=>this.stores.hovered.set(!0),onMouseLeave:()=>this.stores.hovered.set(!1),focused:this.stores.hovered.get(),showDragHandle:!this.environment.device.isMobile,showExtensionArrow:!1,propertySchema:s,format:K.Z.DisplayFormat.Name,dontShrinkRight:!0,ignoreLocalHoverState:!0,locked:this.props.locked,onClick:()=>{if(!this.props.locked){const e=this.stores.buttonPopupStore.get();e.setState({open:!e.state.open})}},right:a()(z.Z,n&&o?{buttonPopupStore:this.stores.buttonPopupStore.get(),visibility:r,visibilityLevels:["show","hide","hide_if_empty","inline","minimal"],locked:this.props.locked,onSelect:e=>o(e,t,i),onClose:()=>this.stores.hovered.set(!1),type:"relation_property",propertySchema:s,showAsMenu:!0}:{buttonPopupStore:this.stores.buttonPopupStore.get(),visibility:r,locked:this.props.locked,onSelect:e=>this.handleVisibilitySelectClick(e),onClose:()=>this.stores.hovered.set(!1),type:"property",propertySchema:s})},t)}getPropertyVisibility(e){const{visibility:t}=this.props;switch(t){case"hide_if_empty":return d.kq({propertySchema:e})?"hide_if_empty":"show";default:return t}}handleVisibilitySelectClick(e){const{property:t,format:i,store:n}=this.props;C.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:this.environment,perform:a=>{l.M0({property:t,visibility:e,format:i,store:n,transaction:a})}})}}q.displayName="CustomizePageMenuPropertyMenuItem";const H=q;class G extends s.Z{constructor(){super(...arguments),this.storeTypes={lockStore:I.Z},this.handleDraggableDrop=e=>{const t=this.getCollectionPageProperties(),i=this.props.store;if(t){const n=e.map((e=>t.find((t=>t.property===e))));l.D2({environment:this.environment,properties:n,store:i})}},this.handleDraggableDropSections=e=>{const t=this.getCollectionPageSections(),i=this.props.store;if(t){const n=e.map((e=>t.find((t=>t.section===e))));t&&C.createAndCommit({userAction:"CustomizePageMenu.handleDraggableDropSections",environment:this.environment,perform:e=>{l.Do({environment:this.environment,pageSectionFormats:n,store:i,transaction:e})}})}},this.handleShowAsClick=(e,t,i,n)=>{const a=d.$0();if(!a)return!1;let o=n.collection_page_sections?v().cloneDeep(n.collection_page_sections):[];if(!i[t])return;const s=o.findIndex((e=>e.section===t));-1!==s?o[s]={section:t,visibility:e}:o=[...o,{section:t,visibility:e}];const r="inline"===e||"minimal"===e?"section":"show";o&&(C.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:this.environment,perform:e=>{l.Do({environment:this.environment,pageSectionFormats:o,store:a,transaction:e}),l.M0({property:t,visibility:r,store:a,format:n,transaction:e})}}),w.K1b(this.environment,{from:"page_properties",mode:"inline"===e?"page_section":"minimal"===e?"minimal_page_section":"property"}))},this.handleShowAsSectionMenuClick=(e,t,i)=>{const n=d.$0();if(!n)return;let a=i.collection_page_sections?v().cloneDeep(i.collection_page_sections):[];if("inline"===e||"minimal"===e){const o=a.findIndex((e=>e.section===t));-1!==o?a[o]={section:t,visibility:e}:a=[...a,{section:t,visibility:e}];const s="inline"===e||"minimal"===e?"section":"show";a&&(C.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPageSectionClick",environment:this.environment,perform:e=>{l.Do({environment:this.environment,pageSectionFormats:a,store:n,transaction:e}),l.M0({property:t,visibility:s,store:n,format:i,transaction:e})}}),w.K1b(this.environment,{from:"page_properties",mode:"minimal"===e?"minimal_page_section":"page_section"}))}else{const a=y.AX.find((t=>t===e));if(!a)return;C.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPropertyClick",environment:this.environment,perform:e=>{l.M0({property:t,visibility:a,store:n,format:i,transaction:e})}}),w.K1b(this.environment,{from:"page_properties",mode:"property"})}},this.handleToggleLockClick=()=>{const e=d.$0();if(!e)return!1;const t=e.getParentBlockStore();t&&(C.createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:this.environment,perform:e=>{M.Wq({environment:this.environment,store:t,isLocked:!d.p1(),transaction:e})}}),this.stores.lockStore.setState({justUnlocked:!this.stores.lockStore.state.justUnlocked}))}}renderComponent(){const{device:e}=this.environment,t=this.createComputedStore((()=>"page"===this.props.type?this.props.store.isExternalObjectInstancePageBlockStore():this.props.store.isSyncedCollection()));let i;i=e.isMobile?{menuType:T.og.Modal,right:a()(R.DoneMenuText,{}),onClickRight:l.xv,title:this.props.intl.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:T.og.Popup,minWidth:400};const n=this.getNormalizedFormat();return o.createElement(E.Z,h()({},i,{header:this.renderHeader()}),(this.props.locked||this.stores.lockStore.state.justUnlocked)&&this.renderLockControls(),this.renderPageSectionsSectionMenuItem(n,t.state),this.renderPropertiesSectionMenuItem(n))}renderLockControls(){return a()("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${this.theme.regularDividerColor}`,borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.sidebarBackground,color:this.theme.mediumTextColor,paddingTop:6,paddingBottom:6}},void 0,a()("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6}},void 0,this.stores.lockStore.state.justUnlocked?b.Z.unlocked({height:12,width:12,fill:this.theme.mediumIconColor}):b.Z.locked({height:12,width:12,fill:this.theme.mediumIconColor})),this.stores.lockStore.state.justUnlocked?a()(r.FormattedMessage,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):a()(r.FormattedMessage,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),a()(L.Z,{style:{fontSize:12,color:this.theme.mediumTextColor,fontWeight:S.Z.fontWeight.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:this.handleToggleLockClick},void 0,this.stores.lockStore.state.justUnlocked?a()(r.FormattedMessage,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):a()(r.FormattedMessage,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})))}renderPropertiesSectionMenuItem(e){if(!this.getSchema()||"page"===this.props.type)return;const t=this.getPageCustomization(e);if(!t)return;const{propertyVisibility:i}=t;if(!i)return;const n=i.reduce(((e,t)=>(e[t.property]=t.visibility,e)),{}),o=this.getCollectionPageSections().filter((e=>"inline"===e.visibility||"minimal"===e.visibility)).map((e=>e.section)),s=v().difference(this.getCollectionPageProperties().map((e=>e.property)),o);return a()(V.Z,{style:{opacity:this.props.locked?.5:1},title:a()(r.FormattedMessage,{id:"customizePageMenu.propertiesSection.header",defaultMessage:"Properties"})},void 0,this.renderDraggablePageProperties(s,n,e,this.handleDraggableDrop))}renderPageSectionsSectionMenuItem(e,t){const i=this.props.store,n=this.getSchema();if(!n||!i)return;const s=this.getPageCustomization(e);if(!s)return;const{pageSectionVisibility:c}=s;if(!c)return;const u=this.getCollectionPageSections().map((e=>e.section)),p={topLevelDiscussions:!t,backLinks:!0,pageComments:!t};return o.createElement(o.Fragment,null,a()(V.Z,{style:{opacity:this.props.locked?.5:1},title:a()(r.FormattedMessage,{id:"customizePageMenu.sectionsSection.header",defaultMessage:"Sections"}),topBorder:!this.props.locked&&!this.stores.lockStore.state.justUnlocked},void 0,a()("div",{style:{marginLeft:8}},void 0,u.length>0&&a()(V.Z,{style:{opacity:this.props.locked?.5:1,width:"100%",paddingBottom:0,paddingTop:0}},void 0,a()(A.ZP,{direction:"vertical",keys:u,renderKey:t=>{if("collection"===this.props.type&&"inline"===(0,d.ab)(void 0,t))return this.renderRelationSectionMenuItem(n,t,e)},onDrop:this.handleDraggableDropSections}),a()(A.ZP,{direction:"vertical",keys:u,renderKey:t=>{if("collection"===this.props.type&&"minimal"===(0,d.ab)(void 0,t))return this.renderRelationSectionMenuItem(n,t,e)},onDrop:this.handleDraggableDropSections})),p.topLevelDiscussions&&a()(D.Z,{title:a()(r.FormattedMessage,{id:"customizePageMenu.pageSections.topLevelPageDiscussionsTitle",defaultMessage:"Top-level page discussions"}),icon:b.Z.speechBubbleThick({height:16,width:16}),right:a()(z.Z,{visibility:c.comments,visibilityLevels:["section_show","section_hide"],locked:this.props.locked,onSelect:t=>{l.W4({environment:this.environment,pageSection:"comments",visibility:t,store:i,format:e})},type:"page"})}),p.backLinks&&a()(D.Z,{title:a()(r.FormattedMessage,{id:"customizePageMenu.pageSections.backlinksTitle",defaultMessage:"Backlinks"}),icon:b.Z.alias({height:16,width:16,transform:"rotate(180deg)"}),right:a()(z.Z,{visibility:c.backlinks,locked:this.props.locked,visibilityLevels:["section_show","section_hide","section_collapsed"],onSelect:t=>{l.W4({environment:this.environment,pageSection:"backlinks",visibility:t,store:i,format:e})},type:"page"})}),p.pageComments&&a()(D.Z,{title:a()(r.FormattedMessage,{id:"customizePageMenu.pageSections.pageCommentsTitle",defaultMessage:"Page comments"}),icon:b.Z.speechBubbleThick({height:16,width:16}),right:a()(z.Z,{visibility:(0,d.ab)(c,"margin_comments"),visibilityLevels:["inline","minimal"],locked:this.props.locked,onSelect:t=>{l.W4({environment:this.environment,pageSection:"margin_comments",visibility:t,store:i,format:e})},type:"page"})}))))}renderRelationSectionMenuItem(e,t,i){var n;return a()("div",{style:{display:"inline-flex",width:"100%"}},void 0,a()(D.Z,{title:null===(n=e[t])||void 0===n?void 0:n.name,icon:b.Z.typesRelation({height:14,width:14,color:this.theme.mediumIconColor,fill:this.theme.mediumIconColor,fontWeight:S.Z.fontWeight.medium}),disabled:this.props.locked,showDragHandle:!this.environment.device.isMobile,right:a()(z.Z,{visibility:(0,d.ab)(void 0,t),visibilityLevels:["section_hide","inline","minimal"],locked:this.props.locked,onSelect:n=>{this.handleShowAsClick(n,t,e,i)},type:"page",showAsMenu:!0})}))}renderHeader(){if(this.environment.device.isMobile)return;const{store:e}=this.props;if(e){const t=e.getIcon(),i="collection"===this.props.type?this.props.store.getParentBlockStore():void 0,n=t&&a()(O.Z,{icon:t,isEmptyPage:!1,size:14,disabled:!0,style:{display:"inline-flex",marginRight:2}}),s=a()(N.ZP,{store:e,style:{display:"inline"}}),d=i?a()(F.Q,{prefix:a()(r.FormattedMessage,{id:"customizePageMenu.header.allPages.label",defaultMessage:"Customize all pages in",description:"Text to tell the user that their changes will apply to all pages in the database"}),viewName:i?o.createElement(o.Fragment,null,a()(B.Z,{onClick:l.xv,href:(0,k.ZP)({store:i,fullyQualified:!1}),inline:!0},void 0,n,s)):o.createElement(o.Fragment,null,n,s)}):a()(r.FormattedMessage,{id:"customizePageMenu.header.singlePage.label",defaultMessage:"Customize this page view",description:"Header text showing in the customize page menu for pages that aren't part of a database"});return a()(D.Z,{style:{...P.ZP.headingStyle},title:d,right:a()(Z.Z,{helpButtonContext:"customize_page_menu",href:(0,_.UY)("guides.customizePageView")})})}}renderDraggablePageProperties(e,t,i,n){const o=this.getSchema(),s=this.props.store;return s instanceof x.NW?a()(A.ZP,{direction:"vertical",keys:e,renderKey:e=>{var n;const r=null===(n=o[e])||void 0===n?void 0:n.type;if("collection"===this.props.type)return a()(H,"relation"===r?{schema:o,visibility:t[e],property:e,format:i,store:s,locked:this.props.locked,showAsSectionMenu:!0,handlePageSectionClick:this.handleShowAsSectionMenuClick}:{schema:o,visibility:t[e],property:e,format:i,store:s,locked:this.props.locked})},onDrop:n}):null}getSchema(){return this.props.type,this.props.store.getSchema()}getNormalizedFormat(){const{store:e}=this.props,t=e.getFormat(),i=this.getSchema();if(!i)return{};return y.iB(t,i,void 0,y.j5.Collection)}getCollectionPageProperties(){if("collection"!==this.props.type)return[];return this.getNormalizedFormat().collection_page_properties||[]}getCollectionPageSections(){if("collection"!==this.props.type)return[];return this.getNormalizedFormat().collection_page_sections||[]}getPageCustomization(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}isWikiPage(){const e=this.props.store.getParentStore();return!!(e&&e instanceof x.G)&&e.isAssociatedCollectionAPageTree()}}G.displayName="CustomizePageMenu";const j=G;class $ extends s.Z{constructor(){super(...arguments),this.renderModal=()=>{if(!u.Z.state.isOpen)return;const e=d.$0(),{mainEditorCurrentBlockStore:t}=c.default.state,i=p.default.state.open&&p.default.state.target||t;return e?a()(j,{store:e,type:"collection",intl:this.props.intl,locked:d.p1()}):i?a()(j,{store:i,type:"page",intl:this.props.intl,locked:!1}):void 0}}renderComponent(){const{device:e}=this.environment,t=u.Z.state;return a()(m.ZP,{popupType:e.isMobile?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup,alignmentToOrigin:m.ZP.Alignment.Center,open:t.isOpen,render:this.renderModal,originRect:t.isOpen?t.rect:void 0,onDismiss:()=>l.xv()})}}$.displayName="CustomizePageMenuRenderer";const Y=(0,r.injectIntl)($)},7588:(e,t,i)=>{i.r(t),i.d(t,{default:()=>$});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(96486),l=i.n(r),d=i(17126),c=i(67294),u=i(83355),p=i(13991),m=i(8421),g=i(8848),h=i(5366),f=i(32918);const v=(0,h.defineMessages)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function y(e){const{reminder:t,shouldShowTime:i,intl:n,formatTime:a}=e;if(!t)return n.formatMessage(v.none);if(f.vJ(t)){const{unit:e,value:o,time:s}=t,r=a({start_time:s,time_format:"LT",humanReadable:!0,intl:n}),l=i?`(${r})`:"";return 0===o?n.formatMessage(v.onTheDay,{formattedTimeText:l}):"day"===e?n.formatMessage(v.daysBefore,{formattedTimeText:l,numberOfDays:o}):"year"===e?n.formatMessage(v.yearsBefore,{formattedTimeText:l,numberOfYears:o}):"month"===e?n.formatMessage(v.monthsBefore,{formattedTimeText:l,numberOfMonths:o}):n.formatMessage(v.weeksBefore,{formattedTimeText:l,numberOfWeeks:o})}{const{unit:e,value:i}=t;return 0===i?n.formatMessage(v.atTimeOf):"hour"===e?n.formatMessage(v.hoursBefore,{numberOfHours:i}):n.formatMessage(v.minutesBefore,{numberOfMinutes:i})}}var b=i(42875),S=i(11843),w=i(3779),M=i(61784),C=i(89837),k=i(16953),T=i(63143),_=i(50906),I=i(60709),x=i(33665),Z=i(77907),P=i(76150),F=i(12318),A=i(52275),B=i(31945),E=i(37601),D=i(88359),R=i(1743),L=i(74194),O=i(78140),N=i(9342),V=i(72495),U=i(14871),W=i(24006),z=i(58032),K=i(64369),q=i(83182),H=i(46247),G=i(29572);class j extends u.Z{constructor(){super(...arguments),this.storeTypes={store:P.ZP,timezoneQuery:F.default.of("")},this.handleWindowKeyDown=e=>{"Escape"===e.key&&this.maybePreEmptivelyBlurInput()},this.handleWindowMouseDown=e=>{e.target instanceof HTMLInputElement&&e.target===document.activeElement||this.maybePreEmptivelyBlurInput()},this.handleDateFormatChange=e=>{var t,i;null===(t=(i=this.props).onChangeDateFormat)||void 0===t||t.call(i,e)},this.handleTimeFormatChange=e=>{var t,i;const n=this.getTimeFormatOptions()[e];null===(t=(i=this.props).onChangeTimeFormat)||void 0===t||t.call(i,n)},this.handleChangeReminder=e=>{const t=this.getDateValue();var i,n;if(e){if(f.vJ(e)){var a,o;null===(a=(o=this.props).onChangeValue)||void 0===a||a.call(o,{...t,reminder:{...e,defaultTimeZone:(0,b.r)()}})}else if("datetime"===t.type||"datetimerange"===t.type){var s,r;null===(s=(r=this.props).onChangeValue)||void 0===s||s.call(r,{...t,reminder:e})}}else null===(i=(n=this.props).onChangeValue)||void 0===i||i.call(n,{...t,reminder:e});_.IMD(this.environment,{date:t,reminder:e})},this.handleInputChange=e=>{const{device:t}=this.environment,{store:i}=this.stores;i.setState({...i.state,inputTemporaryValue:{...i.state.inputTemporaryValue,[i.state.focus]:e.target.value||""}}),t.isAndroid&&this.handleInputBlur()},this.handleStartDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startDate;if(!t)return;const i=this.parseInputDateValue(t);if(!i)return P.pd.InvalidDate;const n={...this.getDateValue(),start_date:i},a=C.XI(n);if(!a)return P.pd.InvalidRange;this.applyValidDateState({newDate:n,currentMonth:a.start,resetField:P.Hv.StartDate})},this.handleStartTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startTime;if(!t)return;const i=this.parseInputTimeValue(t);if(!i)return P.pd.InvalidTime;const n=this.getDateValue();if(f.qg(n)){const{newDate:e,currentMonth:t}=C.vz({previous:n,updatedStartTime:i});this.applyValidDateState({newDate:e,currentMonth:t,resetField:P.Hv.StartTime}),this.resetInputState(P.Hv.EndDate),this.resetInputState(P.Hv.EndTime)}else{const e={...n,start_time:i},t=C.XI(e);this.applyValidDateState({newDate:e,currentMonth:t.start,resetField:P.Hv.StartTime})}},this.handleEndDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endDate;if(!t)return;const i=this.parseInputDateValue(t);if(!i)return P.pd.InvalidDate;const n={...this.getDateValue(),end_date:i},a=C.XI(n);if(!a)return P.pd.InvalidRange;this.applyValidDateState({newDate:n,currentMonth:a.end,resetField:P.Hv.EndDate})},this.handleEndTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endTime;if(!t)return;const i=this.parseInputTimeValue(t);if(!i)return P.pd.InvalidTime;const n={...this.getDateValue(),end_time:i},a=C.XI(n);if(!a)return P.pd.InvalidRange;this.applyValidDateState({newDate:n,currentMonth:a.end,resetField:P.Hv.EndTime})},this.handleInputBlur=e=>{const{focus:t}=this.stores.store.state;let i;t===P.Hv.StartDate?i=this.handleStartDateInputChange():t===P.Hv.StartTime?i=this.handleStartTimeInputChange():t===P.Hv.EndDate?i=this.handleEndDateInputChange():t===P.Hv.EndTime&&(i=this.handleEndTimeInputChange()),i?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[t]:i}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleInputSubmit=()=>{const{focus:e}=this.stores.store.state;let t;e===P.Hv.StartDate?t=this.handleStartDateInputChange():e===P.Hv.StartTime?t=this.handleStartTimeInputChange():e===P.Hv.EndDate?t=this.handleEndDateInputChange():e===P.Hv.EndTime&&(t=this.handleEndTimeInputChange()),t?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[e]:t}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleDayPickerDayClick=e=>{if(this.props.disabled)return;let t=l().cloneDeep(this.getDateValue());const{focus:i}=this.stores.store.state,n=d.ou.fromJSDate(e).setLocale(f.ah).toFormat(C.Iq);if("daterange"===t.type||"datetimerange"===t.type){var a,o;i===P.Hv.StartDate||i===P.Hv.StartTime?t={...t,start_date:n}:i!==P.Hv.EndDate&&i!==P.Hv.EndTime||(t={...t,end_date:n});const e=C.NK(t,(0,b.r)());if(e.end&&e.end<e.start){if("datetimerange"===t.type){const{start_date:e,start_time:i,end_date:n,end_time:a}=t;t={...t,start_date:n,start_time:a,end_date:e,end_time:i}}else{const{start_date:e,end_date:i}=t;t={...t,start_date:i,end_date:e}}this.stores.store.setState({...this.stores.store.state,focus:i===P.Hv.StartDate||i===P.Hv.StartTime?P.Hv.EndDate:P.Hv.StartDate})}null===(a=(o=this.props).onChangeValue)||void 0===a||a.call(o,t),this.resetInputState(i);const s=i===P.Hv.StartDate||i===P.Hv.StartTime?P.Hv.EndDate:P.Hv.StartDate;this.stores.store.setState({...this.stores.store.state,focus:s})}else{var s,r;const e={...t,start_date:n};null===(s=(r=this.props).onChangeValue)||void 0===s||s.call(r,e),this.resetInputState(i)}},this.handleDayPickerMonthChange=e=>{this.stores.store.setState({...this.stores.store.state,currentMonth:d.ou.fromJSDate(e)})},this.handleEndDateControlChange=()=>{const e=this.getDateValue();if("datetimerange"===e.type){var t,i;const n={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null===(t=(i=this.props).onChangeValue)||void 0===t||t.call(i,n)}else if("daterange"===e.type){var n,a;const t={type:"date",start_date:e.start_date,reminder:e.reminder};null===(n=(a=this.props).onChangeValue)||void 0===n||n.call(a,t)}else if("datetime"===e.type){var o,s;const t={type:"datetimerange",start_date:e.start_date,start_time:e.start_time,end_date:e.start_date,end_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null===(o=(s=this.props).onChangeValue)||void 0===o||o.call(s,t),this.stores.store.setState({...this.stores.store.state,focus:P.Hv.EndDate})}else{var r,l;const t={type:"daterange",start_date:e.start_date,end_date:e.start_date,reminder:e.reminder};null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,t),this.stores.store.setState({...this.stores.store.state,focus:P.Hv.EndDate})}},this.handleAllDayChange=()=>{const e=this.getDateValue();if("date"===e.type){var t,i;const n={type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,b.r)(),reminder:e.reminder&&f.AE(e.reminder)};null===(t=(i=this.props).onChangeValue)||void 0===t||t.call(i,n)}else if("daterange"===e.type){var n,a;const t={type:"datetimerange",start_date:e.start_date,start_time:"00:00",end_date:e.end_date,end_time:"00:00",time_zone:(0,b.r)(),reminder:e.reminder&&f.AE(e.reminder)};null===(n=(a=this.props).onChangeValue)||void 0===n||n.call(a,t)}else if("datetime"===e.type){var o,s;const t={type:"date",start_date:e.start_date,reminder:e.reminder&&f.wg(e.reminder,(0,b.r)())};null===(o=(s=this.props).onChangeValue)||void 0===o||o.call(s,t)}else{var r,l;const t={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:e.reminder&&f.wg(e.reminder,(0,b.r)())};null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,t)}},this.handleTimeZoneChange=e=>{const t=this.getDateValue();if("datetime"===t.type||"datetimerange"===t.type){var i,n;const a={...t,time_zone:e};null===(i=(n=this.props).onChangeValue)||void 0===i||i.call(n,a)}},this.handleStartInputDateFocus=()=>{const e=this.getDateValue(),t=C.NK(e,(0,b.r)());this.stores.store.setState({...this.stores.store.state,focus:P.Hv.StartDate,inputIsFocused:!0,currentMonth:t.start})},this.handleStartInputTimeFocus=()=>{const e=this.getDateValue(),t=C.NK(e,(0,b.r)());this.stores.store.setState({...this.stores.store.state,focus:P.Hv.StartTime,inputIsFocused:!0,currentMonth:t.start})},this.handleEndInputDateFocus=()=>{const e=this.getDateValue(),t=C.NK(e,(0,b.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:P.Hv.EndDate,inputIsFocused:!0,currentMonth:t.end})},this.handleEndInputTimeFocus=()=>{const e=this.getDateValue(),t=C.NK(e,(0,b.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:P.Hv.EndTime,inputIsFocused:!0,currentMonth:t.end})},this.handleClearClick=()=>{var e,t;null===(e=(t=this.props).onChangeValue)||void 0===e||e.call(t,void 0)},this.getTimeFormatOptions=()=>(0,S.E)(p.SP).time,this.getSelectedTimeFormatType=()=>{const e=this.getTimeDisplayFormat(),t=this.getTimeFormatOptions();for(const i in t)if(t[i]===e)return i;return"12h"},this.tooltipOriginGap=12}willMount(e){super.willMount(e),this.openTimeFormat=C.Lg((0,b.r)()),window.addEventListener("mousedown",this.handleWindowMouseDown),window.addEventListener("keydown",this.handleWindowKeyDown,!0)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}maybePreEmptivelyBlurInput(){const{inputIsFocused:e}=this.stores.store.state;e&&this.handleInputBlur()}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,{disabled:i,canConfigureCollection:n,shouldShowReminder:a,header:o}=this.props,{inputIsFocused:r}=this.stores.store.state,l=this.getDateValue(),d="datetime"===l.type||"datetimerange"===l.type,u="daterange"===l.type||"datetimerange"===l.type,p=s()("div",{style:{paddingTop:e.isMobile?16:8,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:d?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0}},void 0,this.renderStartInput(),u&&s()("div",{style:{width:12,height:8}}),this.renderEndInput(),this.renderTimeZone());let m;return m=e.isMobile?{menuType:I.og.Modal,title:s()(h.FormattedMessage,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),right:s()(h.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),left:a?this.renderRemindersHelp():void 0,onClickRight:this.props.onDismiss,header:p}:{menuType:I.og.Popup,maxHeight:"none",width:270,header:o},s()(R.Z,{capture:r,allowEsc:!0},void 0,s()(R.Z,{capture:!0,allowUndo:!0,allowEsc:!0},void 0,c.createElement(O.Z,m,s()(E.Z,{show:r}),s()(V.Z,{},void 0,!e.isMobile&&p,s()("div",{style:{padding:e.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...e.isMobile&&{borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}}},void 0,this.renderCalendar())),!i&&this.renderControls(),!i&&n&&s()(V.Z,{topBorder:!0},void 0,this.renderFormatPopup()),!i&&s()(V.Z,{topBorder:!0},void 0,this.renderClearButton()),!i&&!e.isMobile&&a&&s()(V.Z,{topBorder:!0},void 0,this.renderRemindersHelp()))))}getLocale(){return this.props.locale||this.props.intl.locale}renderStartInput(){const{device:e}=this.environment,{disabled:t}=this.props,{focus:i,inputTemporaryValue:n,error:a}=this.stores.store.state,o=this.getDateValue(),r=C.NK(o,(0,b.r)(),this.getLocale()),l=Boolean(a.startDate||a.startTime),d="datetime"===o.type||"datetimerange"===o.type,c="daterange"===o.type||"datetimerange"===o.type,u=i===P.Hv.StartDate||i===P.Hv.StartTime,p=(0,T.z4)(n.startDate)?r.start.toFormat(this.getDateDisplayFormat()):n.startDate,m=(0,T.z4)(n.startTime)?r.start.toFormat(this.getTimeDisplayFormat()):n.startTime,g=(0,T.z4)(n.startDate)?r.start.toFormat(C.Iq):n.startDate,h=(0,T.z4)(n.startTime)?r.start.toFormat(f.jK):n.startTime;return s()("div",{style:{...l?this.getInputWrapErrorStyle():u&&c?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14}},void 0,s()(z.Z,{renderTooltip:()=>this.getInputErrorMessage(a.startDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(a.startDate),placement:z.Z.Placement.Left,render:()=>e.isMobile?s()(L.Z,{type:"date",format:L.B.Transparent,value:g,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1}):s()(L.Z,{format:L.B.Transparent,value:p,focusInitial:i===P.Hv.StartDate,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1})}),d&&this.getInputSeparator(),d&&s()(z.Z,{renderTooltip:()=>this.getInputErrorMessage(a.startTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(a.startTime),placement:z.Z.Placement.Right,render:()=>e.isMobile?s()(L.Z,{type:"time",format:L.B.Transparent,value:h,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):s()(L.Z,{format:L.B.Transparent,value:m,focusInitial:i===P.Hv.StartTime,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}))}renderEndInput(){const{device:e}=this.environment,{disabled:t}=this.props,i=this.getDateValue(),n=C.NK(i,(0,b.r)(),this.getLocale()),a="datetime"===i.type||"datetimerange"===i.type;if(n.end){const{focus:i,error:o,inputTemporaryValue:r}=this.stores.store.state,l=Boolean(o.endDate||o.endTime),d=i===P.Hv.EndDate||i===P.Hv.EndTime,c=(0,T.z4)(r.endDate)?n.end.toFormat(this.getDateDisplayFormat()):r.endDate,u=(0,T.z4)(r.endTime)?n.end.toFormat(this.getTimeDisplayFormat()):r.endTime,p=(0,T.z4)(r.endDate)?n.end.toFormat(C.Iq):r.endDate,m=(0,T.z4)(r.endTime)?n.end.toFormat(f.jK):r.endTime,g=this.getDateRangeBounds(),h=g&&g.earliestValidEnd;return s()("div",{style:{...l?this.getInputWrapErrorStyle():d?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14}},void 0,s()(z.Z,{renderTooltip:()=>this.getInputErrorMessage(o.endDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(o.endDate),placement:z.Z.Placement.Left,render:()=>e.isMobile?s()(L.Z,{type:"date",format:L.B.Transparent,value:p,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t,inputElementAttributes:{min:h}}):s()(L.Z,{format:L.B.Transparent,value:c,focusInitial:i===P.Hv.EndDate,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}),a&&this.getInputSeparator(),a&&s()(z.Z,{renderTooltip:()=>this.getInputErrorMessage(o.endTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(o.endTime),placement:z.Z.Placement.Right,render:()=>e.isMobile?s()(L.Z,{type:"time",format:L.B.Transparent,value:m,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):s()(L.Z,{format:L.B.Transparent,value:u,focusInitial:i===P.Hv.EndTime,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}))}}renderTimeZone(){const{device:e}=this.environment,{intl:t}=this.props,i=this.getDateValue();if(("datetime"===i.type||"datetimerange"===i.type)&&i.time_zone!==(0,b.r)())return s()(K.Z,{isSmall:!0,isMobile:e.isMobile,style:{marginTop:8}},void 0,(0,m.E)(t)[i.time_zone])}renderCalendar(){const{firstDayOfWeek:e}=this.props,t=this.getDateValueForceCurrentTimeZone(),i=C.NK(t,(0,b.r)()),n=this.stores.store.state.currentMonth||i.start,{focus:a}=this.stores.store.state;if(i.end){const t=i.start.toJSDate(),o=i.end.toJSDate(),r=a===P.Hv.StartDate||a===P.Hv.StartTime;return s()(Z.LazyDayPicker,{className:"notion-date-property-menu notranslate",weekStartsOn:e,numberOfMonths:1,defaultMonth:n.toJSDate(),month:n.toJSDate(),locale:p.SP,modifiers:{range:{from:t,to:o},...r?{end:o,start:t}:{start:t,end:o}},modifiersStyles:{range:j.dayPickerRangeDayStyle,start:r?this.getDayPickerActiveDayStyle():this.getDayPickerInactiveDayStyle(),end:r?this.getDayPickerInactiveDayStyle():this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}{const t=i.start.toJSDate();return s()(Z.LazyDayPicker,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:e,defaultMonth:n.toJSDate(),month:n.toJSDate(),locale:p.SP,selected:[t],modifiers:{start:t},modifiersStyles:{start:this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}}renderControls(){const{device:e}=this.environment,{shouldShowReminder:t}=this.props;return e.isMobile?s()(V.Z,{topBorder:!0},void 0,t&&this.renderReminderControl(),this.renderEndDateControl(),this.renderAllDayControl()):s()(c.Fragment,{},void 0,t&&s()(V.Z,{topBorder:!0},void 0,this.renderReminderControl()),s()(V.Z,{topBorder:!0},void 0,this.renderEndDateControl(),this.renderAllDayControl()))}renderEndDateControl(){const e=this.getDateValue();return s()(A.Z,{focused:!1,onClick:this.handleEndDateControlChange,title:s()(h.FormattedMessage,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:s()(W.Z,{on:"daterange"===e.type||"datetimerange"===e.type,onClick:this.handleEndDateControlChange})})}renderAllDayControl(){const e=this.getDateValue();return s()(A.Z,{focused:!1,onClick:this.handleAllDayChange,title:s()(h.FormattedMessage,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label",description:"Shown in the date property menu as an option for whether this date includes a time."}),right:s()(W.Z,{on:"date"!==e.type&&"daterange"!==e.type,onClick:this.handleAllDayChange})})}renderReminderControl(){const{device:e}=this.environment,{intl:t}=this.props,i=this.getDateValue();return s()(B.Z,{popupType:e.isMobile?B.Z.PopupType.SlideUp:B.Z.PopupType.Popup,placementToOrigin:B.Z.Placement.Right,renderOrigin:n=>c.createElement(D.Z,a()({},n,{icon:w.Z.alarmClock({width:14}),title:s()(h.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:e.isMobile,right:y({reminder:i.reminder,intl:t,formatTime:M.mr})})),render:n=>{let o;o=e.isMobile?{menuType:I.og.Modal,title:s()(h.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),right:s()(h.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:n.close}:{menuType:I.og.Popup,width:250};const r=("date"===i.type||"daterange"===i.type?f.PI:f.dG).map((e=>{const i=y({reminder:e,shouldShowTime:!0,intl:t,formatTime:M.mr});return{key:i,action:t=>{this.handleChangeReminder(e),n.close()},render:(e,t)=>c.createElement(A.Z,a()({},e,{title:i}))}}));return c.createElement(O.Z,o,s()(N.Z,{type:N.i.Vertical,sections:[{key:"reminder section",render:e=>c.createElement(V.Z,e),items:r}],initialFocus:void 0}))}})}renderFormatPopup(){const{device:e}=this.environment;return s()(B.Z,{popupType:e.isMobile?B.Z.PopupType.SlideUp:B.Z.PopupType.Popup,placementToOrigin:B.Z.Placement.Right,renderOrigin:t=>c.createElement(A.Z,a()({},t,{icon:w.Z.sidebarSettings({width:14}),title:s()(h.FormattedMessage,{defaultMessage:"Date format & timezone",id:"LuxonDatePropertyMenu.menuItem.formatAndTimezone.label"}),focused:!1,showExtensionArrow:e.isMobile})),render:t=>{let i;return i=e.isMobile?{menuType:I.og.Modal,title:s()(h.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),right:s()(h.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),onClickRight:t.close}:{menuType:I.og.Popup,width:250},c.createElement(O.Z,i,s()(V.Z,{},void 0,this.renderDateFormatControl(),this.showTimeFormatControl()&&this.renderTimeFormatControl(),this.renderTimeZoneControl()))}})}renderDateFormatControl(){const e=this.props.dateFormat||f.sF,{intl:t}=this.props,i={menuTitle:t.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:f.Zy,getKey:e=>e,selectedItem:e,onSelect:this.handleDateFormatChange,renderItem:e=>c.createElement(A.Z,a()({},e,{title:t.formatMessage(f.fy[e.value])})),renderOrigin:i=>c.createElement(D.Z,a()({focused:!1,title:s()(h.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),right:e?t.formatMessage(f.fy[e]):s()(h.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"})},i))};return c.createElement(U.Z,i)}renderTimeFormatControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,i=this.getTimeDisplayFormat(),{intl:n}=this.props,o=this.getSelectedTimeFormatType(),r={menuTitle:n.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:f.L7,getKey:e=>e,selectedItem:o,onSelect:this.handleTimeFormatChange,renderItem:e=>c.createElement(A.Z,a()({},e,{title:n.formatMessage(f.Fi[e.value])})),disabled:t,renderOrigin:e=>c.createElement(D.Z,a()({focused:!1,title:s()(h.FormattedMessage,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:t,right:!t&&(i?n.formatMessage(f.Fi[o]):s()(h.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"}))},e))};return c.createElement(U.Z,r)}renderTimeZoneControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,i=this.getTimeZone();return s()(G.Z,{renderOrigin:e=>c.createElement(D.Z,a()({},e,{focused:!1,title:s()(h.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.menuItem.time.label"}),disabled:t,right:!t&&C.er(i)})),onSelect:e=>this.handleTimeZoneChange(e)})}renderClearButton(){return s()(A.Z,{focused:!1,onClick:this.handleClearClick,title:s()(h.FormattedMessage,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}renderRemindersHelp(){const{device:e}=this.environment;return e.isMobile?s()(H.Z,{href:(0,x.UY)("guides.reminders"),analyticsFrom:"date_selector"}):s()(q.Z,{title:s()(h.FormattedMessage,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,x.UY)("guides.reminders"),analyticsFrom:"date_selector"})}getDateValue(){const{value:e}=this.props;return e&&!l().isNaN(e)?e:this.openTimeFormat}getDateRangeBounds(){const e=this.getDateValue();if(f.h(e)||f.qg(e)){const t=C.NK(e,(0,b.r)());return{earliestValidEnd:t.start.toFormat(C.Iq),latestValidStart:t.end.toFormat(C.Iq)}}}getDateValueForceCurrentTimeZone(){const{value:e}=this.props;return e&&!l().isNaN(e)?"datetime"===e.type||"datetimerange"===e.type?{...e,time_zone:(0,b.r)()}:e:this.openTimeFormat}getDateDisplayFormat(){const{dateFormat:e}=this.props;return void 0===e||"relative"===e||"ll"===e?f.oq(this.getLocale()):f.jG(e)}getTimeDisplayFormat(){const{timeFormat:e}=this.props;return e?f._F(e):f.Sc}showTimeFormatControl(){return!S.S.includes(p.SP)}getTimeZone(){const e=this.getDateValue();return"datetime"===e.type||"datetimerange"===e.type?e.time_zone:(0,b.r)()}parseInputDateValue(e){const{intl:t}=this.props;return this.environment.device.isMobile?(0,k.parseDateValueWithInputFormat)(e,C.Iq,t):(0,k.parseDateValueWithInputFormat)(e,this.getDateDisplayFormat(),t)}parseInputTimeValue(e){return(0,k.parseTimeValueWithInputFormat)(e,this.getTimeDisplayFormat(),this.props.intl)}applyValidDateState(e){var t,i;const{newDate:n,currentMonth:a,resetField:o}=e;null===(t=(i=this.props).onChangeValue)||void 0===t||t.call(i,n),this.stores.store.setState({...this.stores.store.state,currentMonth:a}),this.resetInputState(o)}resetInputState(e){const{state:t}=this.stores.store;this.stores.store.setState({...t,error:{...t.error,[t.focus]:void 0},inputTemporaryValue:{...t.inputTemporaryValue,[t.focus]:void 0}})}getInputErrorMessage(e){const{intl:t}=this.props;switch(e){case P.pd.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case P.pd.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case P.pd.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}getInputSeparator(){return s()("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})}getInputWrapStyle(){return{display:"flex",alignItems:"center",borderRadius:3,height:28,lineHeight:1.2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%"}}getInputWrapInactiveStyle(){return{...this.getInputWrapStyle(),boxShadow:this.theme.inputBoxShadow,flexGrow:1}}getInputWrapErrorStyle(){return{...this.getInputWrapStyle(),boxShadow:`inset 0 0 0 2px ${g.ZP.red}`,background:g.ZP.redWithAlpha(.15),flexGrow:1}}getInputWrapActiveStyle(){return{...this.getInputWrapStyle(),boxShadow:`inset 0 0 0 2px ${g.ZP.blue}`,background:g.ZP.blueWithAlpha(.15),flexGrow:1}}getDayPickerActiveDayStyle(){return{backgroundColor:g.ZP.blue,color:g.ZP.white}}getDayPickerInactiveDayStyle(){return{backgroundColor:g.ZP.blueWithAlpha(.43)}}}j.displayName="DatePropertyMenu",j.dayPickerRangeDayStyle={backgroundColor:g.ZP.blueWithAlpha(.15)};const $=(0,h.injectIntl)(j)},92660:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(77094),a=i.n(n),o=(i(67294),i(83355)),s=i(22346),r=i(44532);class l extends o.Z{renderComponent(){const{render:e}=this.props,{device:t}=this.environment,i=this.props.modalStore.state;return t.isMobile?a()(r.ZP,{open:i.open,popupType:r.ZP.PopupType.SlideUp,origin:this.props.origin,onDismiss:this.props.onDismiss,render:e,style:this.props.style}):a()(s.Z,{open:i.open,preventHideChildrenWhileOpening:!0,render:e,onDismiss:this.props.onDismiss,style:this.props.style,innerStyle:this.props.innerStyle})}}l.displayName="DefaultPopupOrModal"},31154:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Y});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(96486),l=i.n(r),d=i(67294),c=i(83355),u=i(41892),p=i(43593),m=i(32056),g=i(98459),h=i(90468),f=i(5366),v=i(70630),y=i(93678),b=i(60709),S=i(98742),w=i(61766),M=i(88632),C=i(71071),k=i(42922),T=i(52275),_=i(1743),I=i(74194),x=i(78140),Z=i(9342),P=i(89728),F=i(72495),A=i(54368),B=i(24006),E=i(24405),D=i(64369);const R=e=>{let{title:t,subtitle:i,on:n,onChange:a,disabled:o,style:r}=e;window.__c={n:"SwitcherRow"};const l=(0,E.yK)((()=>({container:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1}})),[]);return s()("div",{style:{...l.container,...r}},void 0,s()("div",{style:l.title},void 0,t,s()(D.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"}},void 0,i)),s()(B.Z,{on:n,disabled:o,onClick:a}))};R.defaultProps={disabled:!1,style:{}};const L=R;var O=i(33411),N=i(58032),V=i(92660),U=i(6202),W=i(60442),z=i(42115);const K=["pdf","html","markdown"],q=["currentView","all"],H=e=>e>.1&&e<2,G=["everything","no_files"];class j extends c.Z{constructor(){super(...arguments),this.storeTypes={includeContentsPopupStore:w.Z,exportTypePopupStore:w.Z,pdfFormatPopupStore:w.Z,collectionViewExportTypePopupStore:w.Z},this.renderMenu=()=>{const{device:e}=this.environment;if(!M.Z.state.online)return this.renderOffline();const t=C.ZP.state;return t.open&&e.isMobile?this.renderMobileModal(t):t.open?this.renderDesktopModal(t):void 0},this.handleSelectExportType=(e,t)=>{const i=C.ZP.state;if(!i.open)return;const{exportOptions:n}=i;if(e===n.exportType)return;let a;a="pdf"===e?{...n,exportType:"pdf",pdfFormat:v.GI(t)}:{...n,exportType:e},v.BO(this.environment,{...i,exportOptions:a})},this.handleSelectPaperFormat=e=>{const t=C.ZP.state;t.open&&C.Sw(t)&&v.BO(this.environment,{...t,exportOptions:{...t.exportOptions,pdfFormat:e}})},this.handleSelectIncludeContents=e=>{const t=C.ZP.state;t.open&&v.BO(this.environment,{...t,exportOptions:{...t.exportOptions,includeContents:e}})},this.handleSelectCollectionExportType=e=>{const t=C.ZP.state;t.open&&v.BO(this.environment,{...t,exportOptions:{...t.exportOptions,collectionViewExportType:e}})},this.handleToggleFlattenExportFiletree=()=>{const e=C.ZP.state;e.open&&v.BO(this.environment,{...e,exportOptions:{...e.exportOptions,flattenExportFiletree:!e.exportOptions.flattenExportFiletree}})},this.handleToggleRecursive=()=>{const e=C.ZP.state;if(e.open){if(C.Sw(e)&&!v.y1(this.environment))return y.y(this.environment,{from:"export_modal",for:"enterprise"}),void this.handleUpgrade();v.BO(this.environment,{...e,recursive:!e.recursive})}},this.handleSetScalePercent=e=>{const t=C.ZP.state;t.open&&C.Sw(t)&&v.BO(this.environment,{...t,exportOptions:{...t.exportOptions,scale:e}})},this.handleCancel=()=>{v.Qr()},this.handleSubmit=()=>{if(!this.canSubmit())return;const e=C.ZP.state;e.open&&(v.Qr(),e.root.table===h.bx?v.AW(this.environment,{spaceId:e.root.id,exportOptions:e.exportOptions}):v.ZO(this.environment,{block:{id:e.root.id,spaceId:(0,g.CG)(e.root.spaceId)},recursive:e.recursive,exportOptions:e.exportOptions}))},this.handleUpgrade=()=>{v.Qr()}}renderComponent(){return s()(V.Z,{onDismiss:this.handleCancel,render:this.renderMenu,requireOnline:!0,modalStore:C.ZP})}renderOffline(){return s()("div",{style:this.getOfflineStyle()},void 0,s()(f.FormattedMessage,{defaultMessage:"Please go online to export.",id:"exportModal.offlineMessage.description"}))}renderMobileModal(e){const t={menuType:b.og.Modal,title:s()(f.FormattedMessage,{id:"exportModal.title",defaultMessage:"Export"}),right:s()(f.FormattedMessage,{id:"exportModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return d.createElement(x.Z,t,s()(Z.Z,{type:Z.i.Vertical,initialFocus:void 0,sections:[{key:"exportOptions",render:e=>d.createElement(F.Z,e),items:this.getMobileExportOptionsMenuItems(e)},{key:"actions",render:e=>{let{children:t,...i}=e;return d.createElement(F.Z,a()({isSubmitButton:!0},i),t)},items:[{key:"submit",render:e=>{const{onClick:t,...i}=e;return d.createElement(U.Z,a()({},i,{onClick:t||this.handleSubmit,disabled:!this.canSubmit(),title:s()(f.FormattedMessage,{id:"exportModal.exportButton.label",defaultMessage:"Export"})}))},action:this.handleSubmit}]}]}))}renderDesktopModal(e){const{device:t,currentUser:i}=this.environment,n=C.Sw(e)&&!v.y1(this.environment)&&"business",o=this.environment.device.isWindows;return s()("div",{style:this.getModalWrapStyle()},void 0,s()(A.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:s()(f.FormattedMessage,{id:"exportModal.exportFormat.description",defaultMessage:"Export format"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>d.createElement(F.Z,e),items:K.map((t=>this.getBlockExportTypeMenuListItem(t,e,i.id)))}]}),e.exportOptions.collectionViewExportType&&s()(A.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.collectionViewExportTypePopupStore,label:s()(f.FormattedMessage,{id:"exportModal.includeDatabases.description",defaultMessage:"Include databases",description:"Let the user select if they want to export just the current view of each database or everything in each database."}),selectedTitle:this.getCollectionViewExportTypeTitle(e.exportOptions.collectionViewExportType||"currentView"),renderMenuSections:e=>[{key:"exportCollection",render:e=>d.createElement(F.Z,e),items:q.map((t=>this.getCollectionViewExportTypeMenuListItem(t,e)))}]}),s()(A.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.includeContentsPopupStore,label:s()(f.FormattedMessage,{id:"exportModal.includeContents.description",defaultMessage:"Include content"}),selectedTitle:this.getBlockIncludeContentsTitle(e.exportOptions.includeContents||"everything"),renderMenuSections:e=>[{key:"includeContents",render:e=>d.createElement(F.Z,e),items:G.map((t=>this.getIncludeContentsMenuListItem(t,e)))}]}),C.Sw(e)&&d.createElement(d.Fragment,null,s()(A.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:s()(f.FormattedMessage,{id:"exportModal.pageFormat.description",defaultMessage:"Page format"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>d.createElement(F.Z,e),items:p.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>d.createElement(F.Z,a()({topBorder:!0},e)),items:p.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]}),this.renderScalePercent()),"space"!==e.root.table&&s()(z.Z,{requireUpgradeToTier:n,analyticsName:"export_modal",onClick:this.handleToggleRecursive,render:(t,i)=>d.createElement("div",a()({},t,{style:{display:"flex",alignItems:"center",height:32}}),s()("div",{style:{display:"flex",alignItems:"center",marginRight:"auto",color:this.theme.lightTextColor,fontSize:14}},void 0,s()(f.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",i&&s()("div",{style:{marginLeft:8}},void 0,i)),s()(B.Z,{on:e.recursive,disabled:Boolean(n)})),renderUpgradeTooltip:()=>s()(W.Z,{imageURL:u.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:s()(f.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:s()(f.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:N.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade}),s()(L,{title:s()(f.FormattedMessage,{id:"exportModal.flattenExportFiletree.description",defaultMessage:"Create folders for subpages",description:"Toggle for whether or not to creates folders for each block hierarchy in recursive export"}),subtitle:"",style:{color:this.theme.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:void 0===e.exportOptions.flattenExportFiletree?!o:!e.exportOptions.flattenExportFiletree,disabled:!e.recursive,onChange:()=>this.handleToggleFlattenExportFiletree()}),s()("div",{style:{display:"flex",alignItems:"center",marginTop:16}},void 0,s()(P.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleCancel},void 0,s()(f.FormattedMessage,{defaultMessage:"Cancel",id:"exportModal.cancelButton.label"})),s()(k.Z,{onClick:this.handleSubmit,disabled:!this.canSubmit()},void 0,s()(f.FormattedMessage,{defaultMessage:"Export",id:"exportModal.exportButton.label"}))))}renderScalePercent(){const e=this.getScalePercent();return d.createElement(d.Fragment,null,s()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:32}},void 0,s()(D.Z,{style:{color:this.theme.lightTextColor}},void 0,s()(f.FormattedMessage,{id:"exportModal.pageScale.description",defaultMessage:"Scale percent"})),s()($,{value:e,onChange:this.handleSetScalePercent})),!H(e)&&s()(O.Z,{show:!0,showDelay:500,showHold:100,render:e=>e&&s()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:32,padding:"4px 0"}},void 0,s()(D.Z,{isSmall:!0,isMultiline:!0,style:{color:this.theme.errorText}},void 0,s()(f.FormattedMessage,{id:"exportModal.pageScale.invalidScaleError",defaultMessage:"Scale percent must be a number between 10 and 200",description:"Shown if the scale percent for pdf export is outside of range."})))}))}getMobileExportOptionsMenuItems(e){const{currentUser:t,device:i}=this.environment;return l().compact([{key:"export type",render:n=>d.createElement(A.Z,a()({},n,{isMenuItem:i.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:s()(f.FormattedMessage,{defaultMessage:"Export format",id:"exportModal.exportFormat.description"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>d.createElement(F.Z,e),items:K.map((i=>this.getBlockExportTypeMenuListItem(i,e,t.id)))}]})),action:()=>{this.stores.exportTypePopupStore.setState({open:!0})}},C.Sw(e)&&{key:"pdf format",render:t=>d.createElement(A.Z,a()({},t,{isMenuItem:i.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:s()(f.FormattedMessage,{defaultMessage:"Page format",id:"exportModal.pageFormat.description"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>d.createElement(F.Z,e),items:p.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>d.createElement(F.Z,a()({topBorder:!0},e)),items:p.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]})),action:()=>{this.stores.pdfFormatPopupStore.setState({open:!0})}},"space"!==e.root.table&&{key:"recursive",render:t=>{let{onClick:i,key:n,...o}=t;const r=C.Sw(e)&&!v.y1(this.environment)&&"business";return s()(z.Z,{requireUpgradeToTier:r,analyticsName:"export_modal",onClick:i,render:(t,i)=>{const n=(0,S.Z)(o,t);return d.createElement(T.Z,a()({},n,{title:s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()(f.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",i&&s()("div",{style:{marginLeft:8}},void 0,i)),right:d.createElement(B.Z,a()({},n,{on:e.recursive,disabled:Boolean(r)}))}))},renderUpgradeTooltip:()=>s()(W.Z,{imageURL:u.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:s()(f.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:s()(f.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:N.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade},n)},action:this.handleToggleRecursive}])}getBlockExportTypeTitle(e){switch(e){case"pdf":return s()(f.FormattedMessage,{id:"exportModal.exportFormatButton.pdf.label",defaultMessage:"PDF"});case"markdown":return s()(f.FormattedMessage,{id:"exportModal.exportFormatButton.markdownAndCSV.label",defaultMessage:"Markdown & CSV"});case"html":return s()(f.FormattedMessage,{id:"exportModal.exportFormatButton.html.label",defaultMessage:"HTML"})}}getBlockIncludeContentsTitle(e){switch(e){case"everything":return s()(f.FormattedMessage,{id:"exportModal.includeContentTypes.everything.label",defaultMessage:"Everything"});case"no_files":return s()(f.FormattedMessage,{id:"exportModal.includeContentTypes.no_files.label",defaultMessage:"No files or images"})}}getCollectionViewExportTypeTitle(e){switch(e){case"all":return s()(f.FormattedMessage,{id:"exportModal.includeDatabases.all.label",defaultMessage:"Everything",description:"Shown if user is choosing to export every page in the collection."});case"currentView":return s()(f.FormattedMessage,{id:"exportModal.includeDatabases.currentView.label",defaultMessage:"Current view",description:"Shown if user is choosing to export only the pages in the current view of the collection."})}}getPDFFormatTitle(e){switch(e){case"Letter":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.letter.label",defaultMessage:"Letter"});case"A3":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.a3.label",defaultMessage:"A3"});case"A4":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.a4.label",defaultMessage:"A4"});case"Legal":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.legal.label",defaultMessage:"Legal"});case"Tabloid":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.tabloid.label",defaultMessage:"Tabloid"})}}getBlockExportTypeMenuListItem(e,t,i){const n=C.ZP.state,o=n.open&&"pdf"===e&&"space"===n.root.table&&!v.y1(this.environment)&&"business";return{key:e,action:()=>{if(t.close(),o)return y.y(this.environment,{from:"export_modal",for:o}),void this.handleUpgrade();this.handleSelectExportType(e,i)},render:i=>{let{onClick:n,key:r,...l}=i;return s()(z.Z,{requireUpgradeToTier:o,analyticsName:"export_modal",onClick:n,onUpgradeClick:()=>{t.close(),this.handleUpgrade()},render:(t,i)=>d.createElement(T.Z,a()({},(0,S.Z)(l,t),{title:this.getBlockExportTypeTitle(e),right:i})),renderUpgradeTooltip:()=>s()(W.Z,{imageURL:u.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:s()(f.FormattedMessage,{defaultMessage:"Upgrade to export the workspace as PDFs",id:"exportModal.workspacePdfUpgradeTooltip.title"}),caption:s()(f.FormattedMessage,{defaultMessage:"Creates a zip file containing all pages in the workspace as PDF files.",id:"exportModal.workspacePdfUpgradeTooltip.caption"})}),tooltipPlacement:N.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2}},r)}}}getIncludeContentsMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectIncludeContents(e)},render:t=>d.createElement(T.Z,a()({},t,{title:this.getBlockIncludeContentsTitle(e)}))}}getCollectionViewExportTypeMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectCollectionExportType(e)},render:t=>d.createElement(T.Z,a()({},t,{title:this.getCollectionViewExportTypeTitle(e)}))}}getPaperFormatMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectPaperFormat(e)},render:t=>d.createElement(T.Z,a()({},t,{title:this.getPDFFormatTitle(e)}))}}getScalePercent(){const e=C.ZP.state;return e.open&&C.Sw(e)?void 0===e.exportOptions.scale?1:e.exportOptions.scale:1}canSubmit(){return H(this.getScalePercent())}getModalWrapStyle(){return{width:320,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}}function $(e){let{value:t,onChange:i}=e;window.__c={n:"PercentInput"};const n=(0,f.useIntl)(),a=d.useCallback((e=>{const t=e.target.value,n=(0,m._g)(t)||(0,m.p3)(t);let a;"object"==typeof n?a="percent"===n.format?n.value:n.value/100:"number"==typeof n&&(a=n/100),void 0!==a&&i(a)}),[i]),[o,r]=d.useState(!1),l=d.useMemo((()=>(0,m.uf)(Math.round(100*t),"number",n)),[t,n]);return s()(_.Z,{capture:o},void 0,s()(I.Z,{value:l,onChange:a,onFocus:()=>r(!0),onBlur:()=>r(!1),style:{width:60},inputStyle:{textAlign:"right"}}))}j.displayName="ExportModal";const Y=j},79027:(e,t,i)=>{i.r(t),i.d(t,{default:()=>v});var n=i(77094),a=i.n(n),o=i(67294),s=i(83355),r=i(41892),l=i(82990),d=i(5366),c=i(91376),u=i(17311),p=i(7844),m=i(42922),g=i(22346),h=i(62385);class f extends s.Z{constructor(){super(...arguments),this.handleModalDismiss=()=>{p.Z.state.open&&p.Z.state.onDecline&&p.Z.state.onDecline(),p.Z.setState({open:!1})},this.handleConnectClick=()=>{p.Z.state.open&&p.Z.state.onConfirm(),p.Z.setState({open:!1})},this.handleConnectedAppsClick=()=>{this.handleModalDismiss(),c.r({currentTab:"connected_apps"})}}renderComponent(){const{device:e}=this.environment,t=p.Z.state;return a()(g.Z,{open:t.open,innerStyle:f.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>a()(o.Fragment,{},void 0,a()("div",{style:f.modalHeaderWrapStyle},void 0,a()("img",{src:r.Z.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),a()("div",{style:this.getModalMessageStyle()},void 0,a()(d.FormattedMessage,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})),e.isMobileNative?a()("div",{style:this.getModalMessageStyle()},void 0,a()(d.FormattedMessage,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})):a()(m.Z,{isLarge:!0,onClick:this.handleConnectClick},void 0,a()(d.FormattedMessage,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})),!e.isMobile&&this.renderConnectedAccountsLink())),onDismiss:this.handleModalDismiss})}renderConnectedAccountsLink(){return a()("div",{style:{display:"block",marginTop:u.Z.vertical.tiny}},void 0,a()(h.Z,{underlined:!0,onClick:this.handleConnectedAppsClick},void 0,a()(d.FormattedMessage,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})))}getModalMessageStyle(){return{fontSize:16,lineHeight:1.5,fontWeight:l.Z.fontWeight.medium,marginTop:15,marginBottom:20,color:this.theme.mediumTextColor}}}f.displayName="GoogleAuthPromptModal",f.wrapStyle={padding:"24px 36px 24px",minWidth:300,maxWidth:400},f.modalHeaderWrapStyle={textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"};const v=f},24326:(e,t,i)=>{i.r(t),i.d(t,{default:()=>T});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(3779),p=i(82990),m=i(51454),g=i(5366),h=i(27832),f=i(93278);var v=i(37190),y=i(92639),b=i(10161),S=i(42922),w=i(64921),M=i(28451);const C=(0,g.defineMessages)({title:{id:"guidedTutorialPopup.title",defaultMessage:"Learn Notion in 3 steps",description:"Title of the shadow cursor tutorial popup."},subtitle:{id:"guidedTutorialPopup.subtitle",defaultMessage:"We'll show you how to quickly customize {workspacename}.",description:"Subtitle of the shadow cursor tutorial popup."},cta:{id:"guidedTutorialPopup.cta",defaultMessage:"Get started",description:"CTA of the shadow cursor tutorial popup."}}),k={display:"flex",alignItems:"center",flexDirection:"column"};function T(){window.__c={n:"GuidedTutorialPopup"};const e=(0,c.Fg)(),t=(0,l.O7)(),i=(0,d.VK)((()=>h.default.state.currentUserSettingsStore),[]),n=(0,d.VK)((()=>h.default.state.guidedTutorialStore),[]),o=(0,d.VK)((()=>{var e;return null===(e=h.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),T=(0,c.yK)((e=>({container:{background:e.popoverBackground,borderRadius:5,boxShadow:e.mediumBoxShadow,position:"absolute",bottom:65,right:16,zIndex:m.hT},cancel:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},content:{...k,width:299,height:204,overflow:"hidden",position:"relative",padding:12,cursor:"default",justifyContent:"center"},contentTextFlex:{display:"flex",flexDirection:"column",gap:8,padding:8},subtitle:{fontSize:14,color:e.mediumTextColor,paddingBottom:8,textAlign:"center"}})),[]),_=(0,d.VK)((()=>f.default.state.open&&h.default.state.inAppCalloutStore.canShow("guided_tutorial_popup")&&(0,y.TL)(t)),[t]),I=(0,r.useCallback)((e=>{if(!i)return;const a={x:window.innerWidth/2,y:window.innerHeight/2};switch(b.default.getEligibleGroup({experimentId:"tooltip_vs_shadow_cursor",defaultGroup:"control"})){case"shadow_cursor":v.startShadowCursorTutorial(t,{position:a,userSettingsStore:i,guidedTutorialStore:n});break;case"tooltip":!function(){f.default.setState({open:!1});const{guidedTutorialStore:e}=h.default.state;e.setState({...h.default.state.guidedTutorialStore.state,currentCursorElement:"new-page-sidebar",type:"tooltip"})}()}}),[t,i,n]),x=(0,r.useCallback)((e=>{v.updateShadowCursorSubpagePhase({environment:t,userSettingsStore:i,phase:"dismissed_modal"})}),[t,i]);return _?s()(M.P,{calloutId:"guided_tutorial_popup"},void 0,s()("div",{style:T.container},void 0,s()(w.Z,{onClick:x,style:T.cancel},void 0,u.Z.closeSmall({width:14,fill:e.mediumTextColor})),s()("div",{style:T.content},void 0,s()("div",{style:T.contentTextFlex},void 0,u.Z.graduationCapInvert({width:24,height:24,fill:e.blueColor,alignSelf:"center"}),s()("div",{style:{fontWeight:p.Z.fontWeight.medium,fontSize:16,alignSelf:"center"}},void 0,r.createElement(g.FormattedMessage,C.title)),s()("div",{style:T.subtitle},void 0,r.createElement(g.FormattedMessage,a()({},C.subtitle,{values:{workspacename:o}}))),s()(S.Z,{isLarge:!0,style:{width:"calc(100% -30px)"},onClick:I},void 0,r.createElement(g.FormattedMessage,C.cta)))))):null}},7523:(e,t,i)=>{i.r(t),i.d(t,{default:()=>S});var n=i(77094),a=i.n(n),o=i(67294),s=i(83355),r=i(3779),l=i(82990),d=i(5366),c=i(50906),u=i(5978),p=i(33665),m=i(27832),g=i(47593),h=i(16354),f=i(22346),v=i(89728),y=i(95543);class b extends s.Z{constructor(){super(...arguments),this.handleModalDismiss=()=>{g.Z.setState({open:!1})},this.handleImportComplete=e=>{g.Z.setState({open:!1}),u.navigateToBlock({environment:this.environment,store:e})}}renderComponent(){const e=g.Z.state;return a()(f.Z,{open:e.open,innerStyle:b.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>a()(o.Fragment,{},void 0,a()("div",{style:b.modalTopbarWrapStyle},void 0,a()("div",{style:b.modalTopbarHeaderStyle},void 0,a()(d.FormattedMessage,{id:"importModal.importButton.label",defaultMessage:"Import"})),this.renderHelpButton()),a()("div",{},void 0,this.renderImportOptions(e))),onDismiss:this.handleModalDismiss})}renderHelpButton(){return a()(h.Z,{href:(0,p.UY)("guides.import"),onClick:()=>c.Fsx(this.environment,{from:"import"}),external:!0},void 0,a()(v.Z,{isSmall:!0,icon:r.Z.help,isGray:!0},void 0,a()(d.FormattedMessage,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})))}renderImportOptions(e){const{mainEditorCurrentBlockStore:t,currentSpaceStore:i,currentSpaceViewStore:n,currentUserSettingsStore:o}=m.default.state;if(t&&i&&n&&o)return a()(y.Z,{pageStore:e.open&&e.pageStore?e.pageStore:t,spaceStore:i,spaceViewStore:n,userSettingsStore:o,analyticsFrom:"modal",onComplete:this.handleImportComplete,readOnlyCreditButton:!1})}}b.displayName="ImportModal",b.wrapStyle={padding:"24px 36px 24px",minWidth:300},b.modalTopbarWrapStyle={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},b.modalTopbarHeaderStyle={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:l.Z.fontWeight.bold,marginRight:"auto"};const S=b},95543:(e,t,i)=>{i.d(t,{Z:()=>Ge});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(83355),d=i(41892),c=i(3779),u=i(4615),p=i(5366),m=i(50906),g=i(30738),h=i(68821),f=i(72340),v=i(54642);async function y(e){const t=await v.getTrelloBoards(e,{});return"success"===t.type?t.data:(console.error(t.error),{boards:[]})}async function b(e){const t=await v.getAsanaWorkspaces(e,{});if("success"===t.type){const{account:e}=t.data;return e?t.data:{workspaces:[],projects:{}}}return console.error(t.error),{workspaces:[],projects:{}}}async function S(e){try{const t=await v.getEvernoteNotebooks(e,{});if("success"===t.type){const{notebooks:e,userInfo:i}=t.data;return{notebooks:e,userInfo:i}}return console.error(t.error),{notebooks:[],userInfo:void 0}}catch(t){return console.error(t),{notebooks:[],userInfo:void 0}}}var w=i(60709),M=i(33665),C=i(88632),k=i(67940),T=i(72087),_=i(96486),I=i.n(_),x=i(51582),Z=i(46190),P=i(31945),F=i(8848),A=i(82990),B=i(64921);class E extends l.Z{renderComponent(){const{title:e,actionButton:t,onClick:i}=this.props;return s()(B.Z,{onClick:i,style:this.getButtonStyle()},void 0,this.renderIcon(),s()("div",{style:{minWidth:0,width:"100%"}},void 0,s()("div",{style:{display:"flex"}},void 0,s()("div",{style:E.titleStyle},void 0,e),s()("div",{style:{marginLeft:"auto"}},void 0,t)),this.renderCaption()))}renderIcon(){const{icon:e,logo:t}=this.props;return t?s()("img",{style:E.imageIconStyle,src:t}):e?s()("div",{style:this.getIconWrapStyle()},void 0,e(this.getIconStyle())):void 0}renderCaption(){const{caption:e}=this.props;if(e)return s()("div",{style:this.getCaptionStyle()},void 0,e)}getButtonStyle(){return{display:"flex",alignItems:"center",padding:10,paddingRight:8,borderRadius:3,marginBottom:12,cursor:"pointer",boxShadow:this.theme.lightBoxShadow,transition:"background 200ms ease-out",background:this.theme.importOptionsButtonBackground}}getIconWrapStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",width:E.iconSize,height:E.iconSize,borderRadius:3,marginRight:8,color:this.theme.mediumTextColor,background:this.theme.importOptionsIconWrapBackground}}getIconStyle(){return{flexShrink:0,width:E.iconSize,height:E.iconSize}}getCaptionStyle(){return{fontSize:12,color:this.theme.mediumTextColor,wordBreak:"keep-all",...!this.props.shouldWrapCaption&&{...A.Z.textOverflowStyle}}}}E.displayName="ImportOptionsItem",E.iconSize=28,E.imageIconStyle={flexShrink:0,width:E.iconSize,height:E.iconSize,borderRadius:3,marginRight:10,background:F.ZP.white},E.titleStyle={fontSize:16,fontWeight:A.Z.fontWeight.medium};const D=E;var R=i(31942),L=i(49085);class O extends L.Z{getInitialState(){return{searchQuery:"",selection:new Set}}}const N=O;var V=i(42922),U=i(52275),W=i(12508),z=i(68894),K=i(78140),q=i(28992),H=i(9342),G=i(43765),j=i(72495),$=i(62385),Y=i(64369);class Q extends l.Z{renderComponent(){return s()("div",{style:this.getStyle()},void 0,"·")}getStyle(){return{display:"inline-block",textAlign:"center",color:this.props.disabled?this.theme.lightTextColor:this.theme.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8}}}Q.displayName="DotSeparator";const X=Q;class J extends l.Z{constructor(){super(...arguments),this.storeTypes={store:N},this.handleSelectAllClick=()=>{const{sections:e,analyticsName:t}=this.props,{store:i}=this.stores,{selection:n}=i.state;for(const a of e)for(const e of a.items)n.add(e.key);i.emit(),m.VfZ(this.environment,{integration_name:t})},this.handleDeselectAllClick=()=>{const{analyticsName:e}=this.props,{store:t}=this.stores,{selection:i}=t.state;i.clear(),t.emit(),m.FIS(this.environment,{integration_name:e})},this.handleToggleItem=e=>{const{analyticsName:t}=this.props,{store:i}=this.stores,{selection:n}=i.state;n.has(e.key)?(n.delete(e.key),m.Z36(this.environment,{integration_name:t})):(n.add(e.key),m.Glf(this.environment,{integration_name:t})),i.emit()},this.handleImport=()=>{const{sections:e}=this.props,{selection:t}=this.stores.store.state,i=I().flatten(e.map((e=>e.items))),n=[];t.forEach((e=>{const t=i.find((t=>t.key===e));t&&n.push(t)})),this.props.onComplete(n)}}willMount(e){const t=this.stores.store.state.selection,[i]=e.sections;if(i){const[e]=i.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return s()(K.Z,{menuType:w.og.Popup,header:this.renderMenuHeader(),footer:this.renderMenuFooter(),width:280,maxHeight:350},void 0,this.renderMenuList())}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state,i=Boolean(t);return s()(j.Z,{isInput:!0,desktopStyle:{paddingBottom:2}},void 0,s()(z.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e}),s()(q.Z,{isTokenTitle:!0,style:{marginTop:2},title:s()("div",{style:{marginLeft:-3}},void 0,s()($.Z,{onClick:this.handleSelectAllClick,disabled:i,disabledFeedback:!0},void 0,s()(p.FormattedMessage,{id:"importPopup.selectAll",defaultMessage:"Select all"})),s()(X,{disabled:i}),s()($.Z,{onClick:this.handleDeselectAllClick,disabled:i,disabledFeedback:!0},void 0,s()(p.FormattedMessage,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})))}))}renderMenuFooter(){const e=0===this.stores.store.state.selection.size;return s()(j.Z,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8}},void 0,s()(q.Z,{title:s()(V.Z,{disabled:e,onClick:this.handleImport},void 0,s()(p.FormattedMessage,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"}))}))}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:i}=this.stores,{searchQuery:n,selection:o}=i.state,l=e.map((e=>{const t=(0,R.ZP)(n,e.items,(t=>`${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===l.length)return s()(j.Z,{},void 0,s()(G.Z,{title:t}));const d=l.map((t=>({key:t.name,render:i=>r.createElement(j.Z,a()({},i,{title:e.length>1?t.name:void 0})),items:t.items.map((e=>{const t=()=>this.handleToggleItem(e);return{key:e.key,render:i=>r.createElement(U.Z,a()({},i,{title:e.name,icon:s()(W.Z,{checked:o.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&s()(Y.Z,{isSmall:!0},void 0,e.count)})),action:t}}))})));return s()(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:d})}}J.displayName="IntegrationImportPopup";const ee=J;class te extends l.Z{constructor(){super(...arguments),this.handleClickImportAsana=()=>{m.ays(this.environment,{import_source:"asana",from:this.props.analyticsFrom})},this.handleAsanaAuth=async()=>{await x.w({environment:this.environment,requestStore:this.props.requestStore})},this.handleRemoveAsana=async()=>{await v.disconnectAsana(this.environment,{}),await this.props.requestStore.refresh(),m.qJZ(this.environment,{integration_name:"asana"})},this.handleImportAsanaComplete=async(e,t)=>{const i=I().flatten(I().values(e.projects)).filter((e=>Boolean(t.find((t=>t.key===e.gid.toString())))));let n;for(const o of Object.keys(e.projects)){const t=e.projects[o];for(const e of t)if(I().isEqual(e,i[0])){n=o;break}if(n)break}m.G7t(this.environment,{integration_name:"asana",count:t.length});const a=await g.T5({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,projects:i,workspaceId:n});a&&this.props.onComplete(a)}}renderComponent(){const{asanaResult:e,intl:t}=this.props,{account:i,workspaces:n,projects:o}=e,l=n.map((e=>{const t=o[e.gid]||[];return{key:e.gid.toString(),name:e.name,items:t.map((e=>({key:e.gid.toString(),name:e.name})))}})),c={title:"Asana",logo:d.Z.images.import.asanaPng,caption:i&&i,actionButton:i&&this.props.renderItemActionsButton([{name:t.formatMessage({id:"asanaImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>Z.Z.setState({open:!0})},{name:t.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleAsanaAuth},{name:t.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveAsana}]),onClick:()=>{}},{device:u}=this.environment;return s()(P.Z,{popupType:u.isMobile?P.Z.PopupType.SlideUp:P.Z.PopupType.Popup,buttonPopupStore:Z.Z,onClick:this.handleClickImportAsana,render:()=>s()(ee,{searchInputPlaceholder:t.formatMessage({id:"asanaImportOption.search.placeholder",defaultMessage:"Search for a project…",description:"'Project' is an Asana term."}),noSearchResultsPlaceholder:t.formatMessage({id:"asanaImportOption.search.noResultsPlaceholder",defaultMessage:"No projects",description:"'Project' is an Asana term."}),analyticsName:"asana",sections:l,onComplete:t=>this.handleImportAsanaComplete(e,t)}),renderOrigin:e=>{let{onClick:t}=e;return r.createElement(D,a()({},c,{onClick:i?t:this.handleAsanaAuth}))}})}}te.displayName="AsanaImportOption";const ie=(0,p.injectIntl)(te);var ne=i(480),ae=i(81954),oe=i(41311),se=i(27832),re=i(22756);const le=new(i(61766).Z);var de=i(73063),ce=i(16354),ue=i(44532),pe=i(58032);function me(e,t){return window.__c={n:"renderHelpButtonToURL"},s()(pe.Z,{renderTooltip:()=>s()(Y.Z,{style:{color:F.ZP.white},isSmall:!0},void 0,s()(p.FormattedMessage,{id:"AsanaImportOption.helpButton.tooltip",defaultMessage:"Learn about how to import",description:"help center to learn about asana importer"})),render:i=>r.createElement(ce.Z,a()({},i,{external:!0,href:e,style:{marginLeft:"auto"}}),s()(de.Z,{icon:c.Z.help,ariaLabel:t.formatMessage({id:"AsanaImportOption.helpButton.ariaLabel",defaultMessage:"Learn about how to asana import help icon",description:"help center to learn about asana importer"})}))})}const ge=function(){window.__c={n:"AsanaV2ImportOption"};const e=(0,ae.VK)((()=>re.Z.state),[]),t=(0,ae.VK)((()=>k.Z.state),[]),{account:i,isLoadingAsanaWorkspaces:n,isAccountDelinkingInProgress:o,isAccountLinkingInProgress:l}=e,g=(0,ne.O7)(),h=(0,p.useIntl)(),{device:f}=g,v=t.flowId||(0,u.ZP)();t.flowId||k.Z.setState({flowId:v});const y={title:h.formatMessage({id:"asanaImportOption.asanaButton.title",defaultMessage:"Asana",description:"Asana button label."}),logo:d.Z.images.import.asanaPng,caption:l?h.formatMessage({id:"asanaImportOption.asanaButton.accountLinkingInProgress",defaultMessage:"Authenticating...",description:"Authenticating loader message."}):o?h.formatMessage({id:"asanaImportOption.asanaButton.accountDelinkingInProgress",defaultMessage:"Removing account...",description:"Delinking loader message."}):i,actionButton:i?(b=[{name:h.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),hoverText:h.formatMessage({id:"asanaImportOption.connectAnotherAccount.hoverText",defaultMessage:"Ensure you are logged into the new Asana account in your browser",description:"User guide for connect another account for asana import"}),action:()=>oe.w1({environment:g,flowId:v}).catch((()=>{}))},{name:h.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>oe.XP({environment:g})}],s()(P.Z,{popupType:ue.kQ.Popup,renderOrigin:e=>r.createElement(de.Z,a()({ariaLabel:h.formatMessage({id:"asanaImportOption.asanaButton.ariaLabel",defaultMessage:"Import from Asana button",description:"Aria label text for import from Asana button."}),icon:c.Z.dots},e)),render:e=>{const t={key:"section",render:e=>r.createElement(j.Z,e),items:b.map((t=>{let{name:i,hoverText:n,action:o}=t;return{key:i,render:()=>n?s()(pe.Z,{placement:pe.Z.Placement.Right,textWrap:!0,render:e=>r.createElement(U.Z,a()({},e,{onClick:o,title:i,focused:!1})),renderTooltip:()=>n}):s()(U.Z,{onClick:o,title:i,focused:!1}),action:()=>{o(),e.close()}}}))};return s()(K.Z,{menuType:w.og.Popup,width:200},void 0,s()(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:[t]}))}})):me((0,M.UY)("guides.importAsana"),h),onClick:()=>{}};var b;return s()(P.Z,{onClick:()=>{var e;re.Z.resetImport(),n||l||o||(i?(m.ays(g,{import_source:"asana",from:"settings_modal",userId:g.currentUser.id,spaceId:null===(e=se.default.state.currentSpaceStore)||void 0===e?void 0:e.id,flowId:v}),oe.h7()):oe.w1({environment:g,flowId:v}).catch((()=>{})))},popupType:f.isMobile?P.Z.PopupType.SlideUp:P.Z.PopupType.Popup,buttonPopupStore:le,renderOrigin:e=>{let{onClick:t}=e;return r.createElement(D,a()({},y,{onClick:t}))},render:()=>{}})};var he=i(24405),fe=i(47307),ve=i(92625);var ye=i(22711),be=i(78900),Se=i(61519),we=i(1743),Me=i(74194),Ce=i(22346),ke=i(63296),Te=i(89728),_e=i(74523),Ie=i(29551);class xe extends l.Z{constructor(){super(...arguments),this.storeTypes={store:N},this.handleToggleItem=e=>{this.props.onComplete(e)}}willMount(e){const t=this.stores.store.state.selection,[i]=e.sections;if(i){const[e]=i.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return s()(K.Z,{menuType:w.og.Popup,header:this.renderMenuHeader(),width:280,maxHeight:350},void 0,this.renderMenuList())}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state;return s()(j.Z,{isInput:!0,desktopStyle:{paddingBottom:2}},void 0,s()(z.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e}))}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:i}=this.stores,{searchQuery:n}=i.state,o=e.map((e=>{const t=(0,R.ZP)(n,e.items,(t=>`${t.key} ${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===o.length)return s()(j.Z,{},void 0,s()(G.Z,{title:t}));const l=o.map((t=>{const i=t.items.map((e=>e.name)),n={};return i.forEach((e=>{n[e]=n[e]?n[e]+1:1})),{key:t.name,render:i=>r.createElement(j.Z,a()({},i,{title:e.length>1?t.name:void 0})),items:t.items.map((e=>({key:e.key,render:t=>r.createElement(U.Z,a()({},t,{title:s()(Ie.gq,{gap:2,alignItems:"center"},void 0,e.name,n[e.name]>1&&s()(pe.Z,{placement:pe.Z.Placement.Right,renderTooltip:()=>e.key,render:t=>r.createElement(de.Z,a()({ariaLabel:`Associated space key is ${e.key}`,disableBackground:!0,icon:c.Z.info},t))})),right:void 0!==e.count&&s()(Y.Z,{isSmall:!0},void 0,e.count)})),action:()=>{this.props.handleClickImportConfluenceWorkspace(e.key,e.name),this.handleToggleItem(e)}})))}}));return s()(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:l})}}xe.displayName="IntegrationConfluenceImportPopup";const Ze=xe;function Pe(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:i,options:n,currentOption:o}=e,l=null===(t=n.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,d=(0,he.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);return s()(P.Z,{popupType:P.Z.PopupType.Popup,placementToOrigin:P.Z.Placement.Left,renderOrigin:e=>r.createElement(Te.Z,a()({},e,{isLarge:!0,style:{opacity:1},disabled:!1}),l,c.Z.chevronDown(d.icon)),render:e=>{const t={menuType:w.og.Popup,width:250,left:50},o=[{key:"settings-item-section",render:e=>r.createElement(j.Z,e),items:n.map((t=>{let{key:n,label:o}=t;return{key:n,action:()=>{i(n),e.close()},render:e=>r.createElement(U.Z,a()({},e,{title:o,shouldWrapCaption:!0,right:l===o?s()("div",{style:{width:14}},void 0,c.Z.check()):void 0}))}}))}];return r.createElement(K.Z,t,s()(H.Z,{type:H.i.Vertical,sections:o,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}}))}})}async function Fe(e){await async function(e){const{environment:t,requestStore:i,userEmail:n,site:a,access_token:o,instance:s,spaceId:r,username:l,password:d,flowId:c}=e;if(!t.currentUser.id)return fe.showMessage({message:"Invalid details"}),void ve.x();const u=await v.authenticateConfluenceUser(t,{userEmail:n,site:a,access_token:o,instance:s,userId:t.currentUser.id,spaceId:r,username:l,password:d});await i.refresh(),"failed"===u.type?(m.a1y(t,{import_source:"confluence",data:{import_type:"api",status:"failure",error:u.error},flowId:c}),console.error(u.error),fe.showError(u)):(m.a1y(t,{import_source:"confluence",data:{import_type:"api",status:"success"},flowId:c}),fe.showMessage({message:"Successfully connected confluence instance."})),ve.x()}(e)}function Ae(e){let{environment:t,title:i,email:n,accountType:a,site:o,APIToken:l,personalAccessToken:d,confluenceVersion:c,username:u,password:m,hidePopup:g,spaceId:h,flowId:f,requestStore:v}=e;window.__c={n:"ModalContent"};const[y,b]=(0,r.useState)(""),[S,w]=(0,r.useState)("Cloud"),[M,C]=(0,r.useState)(""),[k,T]=(0,r.useState)(""),[_,I]=(0,r.useState)("OAuth2.0"),[x,Z]=(0,r.useState)(""),[P,F]=(0,r.useState)(""),B=(0,he.yK)((e=>({title:{fontWeight:A.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return s()(we.Z,{capture:!0},void 0,s()("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"}},void 0,s()("div",{style:{overflowY:"scroll"}},void 0,s()("div",{style:{marginBottom:24}},void 0,s()("div",{style:B.title},void 0,i),s()(_e.Z,{title:s()(p.FormattedMessage,{id:"confluenceAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Confluence",description:"Caption for help button in confluence authentication model."}),href:"https://www.notion.so/help/import-from-confluence",analyticsFrom:"import",style:{marginTop:8}})),s()("div",{},void 0,s()("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"}},void 0,s()("label",{htmlFor:"accountType",style:{...B.inputLabels}},void 0,a),s()(Pe,{onSelectOption:w,options:[{key:"Cloud",label:s()(p.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud",description:"Label for cloud option in account type dropdown."})},{key:"Server",label:s()(p.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownServerOption.label",defaultMessage:"Server/On-Premise",description:"Label for server option in account type dropdown."})}],currentOption:S})),s()(Se.Z,{size:12,isHidden:!0}),s()("div",{},void 0,"Server"===S?s()("div",{},void 0,s()("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row",alignItems:"center"}},void 0,s()("label",{htmlFor:"confluenceVersion",style:{...B.inputLabels}},void 0,c),s()(Pe,{onSelectOption:I,options:[{key:"OAuth2.0",label:s()(p.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownNewVersionOption.label",defaultMessage:"7.9 or later",description:"Label for OAuth2.0 option in confluence version dropdown."})},{key:"Basic",label:s()(p.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownOlderVersionOption.label",defaultMessage:"Prior to 7.9",description:"Label for Basic option in confluence version dropdown."})}],currentOption:_})),s()(Se.Z,{size:12,isHidden:!0})):void 0),s()("label",{htmlFor:"email",style:{...B.inputLabels}},void 0,n),s()(Me.Z,{id:"email",value:y,autoComplete:"off",autoCapitalize:"off",onChange:e=>{b(e.target.value)},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),s()(Se.Z,{size:12,isHidden:!0}),s()("div",{},void 0,s()("label",{htmlFor:"site",style:{...B.inputLabels}},void 0,o),s()(Me.Z,{id:"site",value:M,onChange:e=>C(e.target.value),showClearButton:!0,placeholder:"Cloud"===S?"https://confluence.atlassian.net":"https://domain.com",inputElementAttributes:{minLength:4}}),s()(Se.Z,{size:12,isHidden:!0}),"Cloud"===S?s()("div",{},void 0,s()("label",{htmlFor:"APIToken",style:{...B.inputLabels}},void 0,l),s()(Me.Z,{id:"AccessToken",type:"password",value:k,onChange:e=>{T(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})):s()("div",{},void 0,s()("div",{},void 0,"Basic"===_?s()("div",{},void 0,s()("label",{htmlFor:"username",style:{...B.inputLabels}},void 0,u),s()(Me.Z,{id:"username",value:x,onChange:e=>{Z(e.target.value)},showClearButton:!0,placeholder:"confluenceUser",inputElementAttributes:{minLength:1}}),s()(Se.Z,{size:12,isHidden:!0}),s()("label",{htmlFor:"password",style:{...B.inputLabels}},void 0,m),s()(Me.Z,{type:"password",id:"password",value:P,onChange:e=>{F(e.target.value)},showClearButton:!0,placeholder:"P@S$w0rd",inputElementAttributes:{minLength:1}})):s()("div",{},void 0,s()("label",{htmlFor:"AccessToken",style:{fontSize:"14px",fontWeight:"400"}},void 0,d),s()(Me.Z,{id:"AccessToken",type:"password",value:k,onChange:e=>{T(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABCi7h",inputElementAttributes:{minLength:4}}))))))),s()("div",{style:{flexGrow:0,flexShrink:0}},void 0,s()(Se.Z,{size:24}),s()(V.Z,{isLarge:!0,onClick:async()=>{await Fe({environment:t,userEmail:y,site:M,access_token:"Server"===S&&"Basic"===_?void 0:k,instance:S,username:"Basic"===_?x:void 0,password:"Basic"===_?P:void 0,spaceId:h,flowId:f,requestStore:v}),g()}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.authenticateButton.label",defaultMessage:"Authenticate",description:"Label for Authenticate button in confluence authentication model."})),s()(ke.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{g()}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.cancelButton.label",defaultMessage:"Cancel",description:"Label for Cancel button in confluence authentication model."})))))}const Be=(0,p.injectIntl)((function(e){const[t,i]=(0,r.useState)(!1),{spaceStore:n,flowId:o}=e,l=[{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi",defaultMessage:"Import via API",description:"Button to import confluence via API"}),hoverText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi.message",defaultMessage:"Recommended for the best import experience",description:"Message for import via Api"}),action:()=>{e.handleApiImportClick("confluence",o),i(!0)}},{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file",description:"Button to import confluence via file"}),hoverText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile.message",defaultMessage:"Best for importing partial workspace content",description:"Message for import via File"}),action:()=>e.handleFileUploadClick("confluence",o)}],h=(0,ne.O7)(),{device:f}=h,{confluenceResult:v,onComplete:y,intl:b,requestStore:S,spaceViewStore:M}=e,{account:C,spaces:k}=v;function T(e,t){m.qyQ(h,{import_source:"confluence",data:{spaceKey:e,spaceName:t},flowId:o})}const _={title:"Confluence",logo:d.Z.images.import.confluencePng,caption:C,actionButton:C&&e.renderItemActionsButton([{name:b.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file",description:"Button to import confluence via file"}),action:()=>e.handleFileUploadClick("confluence",o)},{name:b.formatMessage({id:"confluenceImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance",description:"Button to connect different instance of confluence"}),action:()=>{e.handleApiImportClick("confluence",o),i(!0)}},{name:b.formatMessage({id:"confluenceImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove",description:"Button to disconnect confluence account"}),action:()=>async function(e){const{environment:t,spaceId:i,requestStore:n}=e;await ye.DP(t,n,i)}({environment:h,spaceId:n.id,requestStore:S})}]),onClick:()=>{}},I={key:"default",name:b.formatMessage({id:"confluenceImportOption.spacesProperty.defaultName",defaultMessage:"Spaces",description:"List of confluence spaces to import"}),items:k.map((e=>({key:e.key,name:e.name})))},x={key:"section",render:e=>r.createElement(j.Z,e),items:l.map((e=>{let{name:t,hoverText:i,action:n}=e;return{key:t,render:()=>s()(pe.Z,{placement:pe.Z.Placement.Right,textWrap:!0,render:e=>r.createElement(U.Z,a()({},e,{onClick:n,title:t,focused:!1})),renderTooltip:()=>i}),action:n}}))};return r.createElement(r.Fragment,null,s()(P.Z,{popupType:f.isMobile?P.Z.PopupType.SlideUp:P.Z.PopupType.Popup,buttonPopupStore:be.Z,render:e=>C?s()("div",{},void 0,s()("label",{style:{fontSize:"12px",color:"rgba(55, 53, 47, 0.65)",paddingLeft:"12px"}},void 0,s()(p.FormattedMessage,{id:"confluenceImportOption.search.title",defaultMessage:"Select a space to import",description:"Title for the confluenc spaces menu."})),s()(Ze,{searchInputPlaceholder:b.formatMessage({id:"confluenceImportOption.search.placeholder",defaultMessage:"Search for a Space",description:"'Space' is a Confluence term."}),noSearchResultsPlaceholder:b.formatMessage({id:"confluenceImportOption.search.noResultsPlaceholder",defaultMessage:"No Spaces",description:"'Space' is a Confluence term."}),sections:[I],onComplete:async e=>{await async function(e){const{environment:t,onComplete:i,selectedSpace:n,spaceStore:a,spaceViewStore:o,flowId:s}=e,r=await g.A1({environment:t,spaceStore:a,spaceViewStore:o,space:n,flowId:s||(0,u.ZP)()});i(r)}({environment:h,onComplete:y,selectedSpace:e,spaceStore:n,spaceViewStore:M,flowId:o})},handleClickImportConfluenceWorkspace:T})):s()(K.Z,{menuType:w.og.Popup,width:200},void 0,s()(H.Z,{onAccept:e.close,type:H.i.Vertical,initialFocus:void 0,sections:[x]})),renderOrigin:e=>{let{onClick:t}=e;return r.createElement(D,a()({},_,{onClick:t}))}}),s()(Ce.Z,{open:t,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{i(!1)},render:()=>s()(Ae,{hidePopup:()=>{i(!1)},environment:h,title:s()(p.FormattedMessage,{id:"confluenceAuthentication.titleMessage",defaultMessage:"Authentication details",description:"Title for the popup that requests input for authentication details."}),email:s()(Ie.gq,{style:{alignItems:"center",gap:2}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.emailMessage",defaultMessage:"Email",description:"Label for email input."}),s()(pe.Z,{placement:pe.Z.Placement.Right,renderTooltip:()=>s()(p.FormattedMessage,{id:"confluenceAuthentication.emailHelpText",defaultMessage:"Email address of the Confluence user importing the data",description:"Help text for email input."}),render:e=>r.createElement(de.Z,a()({ariaLabel:"Email help text button",disableBackground:!0,icon:c.Z.info},e))})),accountType:s()(Ie.gq,{style:{alignItems:"center",gap:2}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.instanceMessage",defaultMessage:"Confluence instance",description:"Label for instance dropdown."}),s()(pe.Z,{style:{width:300,whiteSpace:"normal"},placement:pe.Z.Placement.Right,renderTooltip:()=>s()(p.FormattedMessage,{id:"confluenceAuthentication.instanceHelperText",defaultMessage:"On Confluence, click 'Help', the (?) next to your profile, then click on 'About Confluence' this will tell you if it is a Server, Cloud or Data Center",description:"Helper text for account input."}),render:e=>r.createElement(de.Z,a()({ariaLabel:"Confluence instance type help text button",disableBackground:!0,icon:c.Z.info},e))})),site:s()(Ie.gq,{style:{alignItems:"center",gap:2}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.siteMessage",defaultMessage:"Site",description:"Label for site input."}),s()(pe.Z,{style:{width:300,whiteSpace:"normal"},placement:pe.Z.Placement.Right,renderTooltip:()=>s()(p.FormattedMessage,{id:"confluenceAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Confluence. If you are running on a non-standard port, please provide the input in host:port format",description:"Helper text for site input."}),render:e=>r.createElement(de.Z,a()({ariaLabel:"Confluence site help text button",disableBackground:!0,icon:c.Z.info},e))})),APIToken:s()(Ie.gq,{style:{alignItems:"center",gap:2}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.apiTokenMessage",defaultMessage:"API token",description:"Label for API token input."}),s()(pe.Z,{placement:pe.Z.Placement.Right,renderTooltip:()=>s()(p.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceAccessToken.captions",defaultMessage:"Click to learn how to get access token from Confluence cloud",description:"Caption for steps to get Confluence access token button in Confluence authentication model."}),render:e=>r.createElement(de.Z,a()({ariaLabel:"Confluence access token help text button",onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account","_blank")},icon:c.Z.info},e))})),personalAccessToken:s()(Ie.gq,{style:{alignItems:"center",gap:2}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.personalAccessTokenMessage",defaultMessage:"Personal Access Token",description:"Label for personal access token input."}),s()(pe.Z,{placement:pe.Z.Placement.Right,style:{width:300,whiteSpace:"normal"},renderTooltip:()=>s()(p.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluencePAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Confluence server",description:"Caption for Steps to get confluence PAT button in confluence authentication model."}),render:e=>r.createElement(de.Z,a()({ariaLabel:"Confluence personal access token help text button",onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:c.Z.info},e))})),confluenceVersion:s()(Ie.gq,{style:{alignItems:"center",gap:2}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.confluenceVersion",defaultMessage:"Confluence version",description:"Label for Confluence version dropdown."}),s()(pe.Z,{style:{width:300,whiteSpace:"normal"},placement:pe.Z.Placement.Right,renderTooltip:()=>s()(p.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceVersion.captions",defaultMessage:"Click to learn how to know the version of Confluence you are running",description:"Caption for Steps to get confluence access token button in confluence authentication model."}),render:e=>r.createElement(de.Z,a()({ariaLabel:"Confluence version help text button",onClick:()=>{window.open("https://confluence.atlassian.com/confkb/how-do-i-know-what-version-of-confluence-is-running-179441565.html","_blank")},icon:c.Z.info},e))})),username:s()(Ie.gq,{style:{alignItems:"center",gap:2}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.username",defaultMessage:"Username",description:"Label for username input."}),s()(pe.Z,{placement:pe.Z.Placement.Right,renderTooltip:()=>s()(p.FormattedMessage,{id:"confluenceAuthentication.usernameHelpText",defaultMessage:"Username of the Confluence user importing the data",description:"Help text for username input."}),render:e=>r.createElement(de.Z,a()({ariaLabel:"Confluence user's username help text button",disableBackground:!0,icon:c.Z.info},e))})),password:s()(Ie.gq,{style:{alignItems:"center",gap:2}},void 0,s()(p.FormattedMessage,{id:"confluenceAuthentication.password",defaultMessage:"Password",description:"Label for password input."}),s()(pe.Z,{placement:pe.Z.Placement.Right,renderTooltip:()=>s()(p.FormattedMessage,{id:"confluenceAuthentication.passwordHelpText",defaultMessage:"Password of the Confluence user importing the data",description:"Help text for password input."}),render:e=>r.createElement(de.Z,a()({ariaLabel:"Confluence user's password help text button",disableBackground:!0,icon:c.Z.info},e))})),spaceId:n.id,flowId:o,requestStore:S})}))}));var Ee=i(68785),De=i(77137),Re=i(83805),Le=i(5978),Oe=i(90365),Ne=i(78291);class Ve extends l.Z{constructor(){super(...arguments),this.handleClickImportEvernote=()=>{m.ays(this.environment,{import_source:"evernote",from:this.props.analyticsFrom})},this.handleRemoveEvernote=async()=>{await v.disconnectEvernote(this.environment,{}),await this.props.requestStore.refresh(),m.qJZ(this.environment,{integration_name:"evernote"})},this.handleEvernoteAuth=async()=>{await Re.e({environment:this.environment,requestStore:this.props.requestStore})},this.handleImportEvernoteComplete=async(e,t)=>{const{notebooks:i}=e,n=i.filter((e=>Boolean(t.find((t=>t.key===e.guid)))));m.G7t(this.environment,{integration_name:"evernote",count:t.length});const a=await g.am({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore,notebooks:n});this.props.onComplete(a)},this.handleEvernoteHelpClick=()=>{Le.navigateToExternalURL({environment:this.environment,url:(0,M.UY)("guides.importEvernote")})}}renderComponent(){const{device:e}=this.environment,{evernoteResult:t,intl:i}=this.props,{userInfo:n,notebooks:o}=t,l=I().groupBy(o,(e=>e.stack||"")),c=Object.keys(l).map((e=>{const t=e||"Top-Level";return{key:t,name:t,items:(l[e]||[]).map((e=>({key:e.guid,name:e.title,count:e.noteCount})))}})),{data:u}=Ne.default.state,p=Boolean(u&&u.credits.find((e=>"import_evernote"===e.type&&e.activated))),m={title:"Evernote",logo:d.Z.images.import.evernotePng,shouldWrapCaption:!n&&!p,caption:n?n.name||n.username||n.email:p?void 0:i.formatMessage({id:"evernoteImportOption.caption.getCredit",defaultMessage:"Get $5 in credit on import"}),actionButton:n?this.props.renderItemActionsButton([{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:this.handleEvernoteHelpClick},{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>Oe.Z.setState({open:!0})},{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleEvernoteAuth},{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveEvernote}]):this.props.defaultActionButton,onClick:()=>{}};return s()(P.Z,{popupType:e.isMobile?P.Z.PopupType.SlideUp:P.Z.PopupType.Popup,buttonPopupStore:Oe.Z,onClick:this.handleClickImportEvernote,render:()=>s()(ee,{searchInputPlaceholder:i.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebook…",description:"'Notebook' is an Evernote term."}),noSearchResultsPlaceholder:i.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks",description:"'Notebook' is an Evernote term."}),analyticsName:"evernote",sections:c,onComplete:e=>this.handleImportEvernoteComplete(t,e)}),renderOrigin:e=>{let{onClick:t}=e;return r.createElement(D,a()({},m,{onClick:n?t:this.handleEvernoteAuth}))}})}}Ve.displayName="EvernoteImportOption";const Ue=(0,p.injectIntl)(Ve);var We=i(52192),ze=i(82066);class Ke extends l.Z{constructor(){super(...arguments),this.handleClickImportTrello=()=>{m.ays(this.environment,{import_source:"trello",from:this.props.analyticsFrom})},this.handleTrelloAuth=async()=>{await We.M({environment:this.environment,requestStore:this.props.requestStore})},this.handleRemoveTrello=async()=>{await v.disconnectTrello(this.environment,{}),await this.props.requestStore.refresh(),m.qJZ(this.environment,{integration_name:"trello"})},this.handleImportTrelloComplete=async(e,t)=>{const{boards:i}=e,n=i.filter((e=>Boolean(t.find((t=>t.key===e.id)))));m.G7t(this.environment,{integration_name:"trello",count:t.length});const a=await g.su({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,boards:n});this.props.onComplete(a)}}renderComponent(){const{device:e}=this.environment,{trelloResult:t,intl:i}=this.props,{account:n,boards:o}=t,l={key:"default",name:i.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:o.map((e=>({key:e.id,name:e.name})))},c={title:"Trello",logo:d.Z.images.import.trelloPng,actionButton:n&&this.props.renderItemActionsButton([{name:i.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>ze.Z.setState({open:!0})},{name:i.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleTrelloAuth},{name:i.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveTrello}]),onClick:()=>{}};return s()(P.Z,{popupType:e.isMobile?P.Z.PopupType.SlideUp:P.Z.PopupType.Popup,buttonPopupStore:ze.Z,onClick:this.handleClickImportTrello,render:()=>s()(ee,{searchInputPlaceholder:i.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a board…",description:"'Board' is a Trello term."}),noSearchResultsPlaceholder:i.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards",description:"'Board' is a Trello term."}),analyticsName:"trello",sections:[l],onComplete:e=>this.handleImportTrelloComplete(t,e)}),renderOrigin:e=>{let{onClick:t}=e;return r.createElement(D,a()({},c,{onClick:n?t:this.handleTrelloAuth}))}})}}Ke.displayName="TrelloImportOption";const qe=(0,p.injectIntl)(Ke);class He extends l.Z{constructor(){super(...arguments),this.storeTypes={trelloRequestStore:T.Z,asanaRequestStore:T.Z,evernoteRequestStore:T.Z,confluenceRequestStore:T.Z},this.handleFileUploadClick=async(e,t)=>{m.ays(this.environment,{import_source:e,from:this.props.analyticsFrom,import_type:"file",flowId:t});const i=await g.ro({environment:this.environment,pageStore:this.props.pageStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,uploadType:e,flowId:t});i&&this.props.onComplete(i)},this.handleApiImportClick=(e,t)=>{m.ays(this.environment,{import_source:e,from:this.props.analyticsFrom,import_type:"api",flowId:t})},this.getAnalyticsFlowId=()=>k.Z.state.flowId||(0,u.ZP)()}renderComponent(){if(!C.Z.state.online)return s()("div",{style:{...He.wrapStyle,fontSize:14,color:this.theme.mediumTextColor}},void 0,s()(p.FormattedMessage,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."}));const{analyticsFrom:e,isLoadingNewConnections:t}=this.props;return this.renderRequests((i=>!i||t?s()("div",{style:"onboarding"===e?{}:He.wrapStyle},void 0,s()(Ee.Z,{})):s()("div",{style:He.wrapStyle},void 0,this.renderOptions(i))))}renderOptions(e){const t=this.getAnalyticsFlowId();return s()("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"}},void 0,this.renderAsanaImportOption(e.asanaResult),this.renderEvernoteImportOption(e.evernoteResult),this.renderTrelloImportOption(e.trelloResult),(0,f.Tc)(this.environment)?this.renderConfluenceImportViaAPIOption(e.confluenceResult,t):this.renderConfluenceImportViaFileOption(t),s()(D,{title:s()(p.FormattedMessage,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown",description:"Button title for importing plain text and/or Markdown content into Notion"}),icon:c.Z.importText,onClick:()=>this.handleFileUploadClick("markdown")}),s()(D,{title:"CSV",icon:c.Z.importCSV,onClick:()=>this.handleFileUploadClick("csv")}),s()(D,{title:"HTML",icon:c.Z.importHTML,onClick:()=>this.handleFileUploadClick("html")}),s()(D,{title:"Word",logo:d.Z.images.import.wordPng,onClick:()=>this.handleFileUploadClick("docx")}),s()(D,{title:"Google Docs",logo:d.Z.images.import.googleDocsPng,actionButton:this.renderHelpButtonToURL((0,M.UY)("guides.importGoogleDocs")),onClick:()=>this.handleFileUploadClick("gdocs")}),s()(D,{title:"Dropbox Paper",logo:d.Z.images.import.dropboxPaperPng,actionButton:this.renderHelpButtonToURL((0,M.UY)("guides.importDropboxPaper")),onClick:()=>this.handleFileUploadClick("dropbox")}),s()(D,{title:"Quip",logo:d.Z.images.import.quipPng,actionButton:this.renderHelpButtonToURL((0,M.UY)("guides.importQuip")),onClick:()=>this.handleFileUploadClick("quip")}),s()(D,{title:"Workflowy",logo:d.Z.images.import.workflowyPng,actionButton:this.renderHelpButtonToURL((0,M.UY)("guides.importWorkflowy")),onClick:()=>this.handleFileUploadClick("workflowy")}))}renderRequests(e){return s()(De.Z,{request:this.environment,performRequest:y,requestStore:this.stores.trelloRequestStore,render:(t,i)=>s()(De.Z,{request:this.environment,performRequest:b,requestStore:this.stores.asanaRequestStore,render:(t,n)=>s()(De.Z,{request:this.environment,performRequest:S,requestStore:this.stores.evernoteRequestStore,render:(t,a)=>s()(De.Z,{request:this.environment,performRequest:()=>async function(e,t){const i=await v.getConfluenceSpaces(e,{spaceId:t});return"success"===i.type?i.data:(console.error(i.error),{spaces:[]})}(this.environment,this.props.spaceStore.id),requestStore:this.stores.confluenceRequestStore,render:(t,o)=>e(i&&n&&a&&o?{trelloResult:i,asanaResult:n,evernoteResult:a,confluenceResult:o}:void 0)})})})})}renderTrelloImportOption(e){return s()(qe,{trelloResult:e,analyticsFrom:this.props.analyticsFrom,renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.trelloRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderAsanaImportOption(e){return(0,h.c)()?s()(ge,{}):s()(ie,{asanaResult:e,analyticsFrom:"onboarding",renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.asanaRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderConfluenceImportViaAPIOption(e,t){const{analyticsFrom:i,onComplete:n,spaceStore:a,spaceViewStore:o,userSettingsStore:r}=this.props;return s()(Be,{confluenceResult:e,analyticsFrom:i,flowId:t,renderItemActionsButton:this.renderItemActionsButton,onComplete:n,spaceStore:a,requestStore:this.stores.confluenceRequestStore,spaceViewStore:o,userSettingsStore:r,handleFileUploadClick:this.handleFileUploadClick,handleApiImportClick:this.handleApiImportClick})}renderConfluenceImportViaFileOption(e){return s()(D,{title:"Confluence",logo:d.Z.images.import.confluencePng,onClick:()=>this.handleFileUploadClick("confluence",e),actionButton:this.renderHelpButtonToURL((0,M.UY)("guides.importConfluence"))})}renderEvernoteImportOption(e){return s()(Ue,{evernoteResult:e,analyticsFrom:"onboarding",renderItemActionsButton:this.renderItemActionsButton,defaultActionButton:this.renderHelpButtonToURL((0,M.UY)("guides.importEvernote")),onComplete:this.props.onComplete,requestStore:this.stores.evernoteRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderHelpButtonToURL(e){return s()(pe.Z,{renderTooltip:()=>s()(p.FormattedMessage,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),render:t=>r.createElement(ce.Z,a()({external:!0,href:e,style:{marginLeft:"auto"}},t),s()(de.Z,{icon:c.Z.help}))})}renderItemActionsButton(e){return s()(P.Z,{popupType:ue.kQ.Popup,renderOrigin:e=>r.createElement(de.Z,a()({icon:c.Z.dots},e)),render:t=>{const i={key:"section",render:e=>r.createElement(j.Z,e),items:e.map((e=>{let{name:i,action:n}=e;return{key:i,render:e=>r.createElement(U.Z,a()({},e,{title:i})),action:()=>{n(),t.close()}}}))};return s()(K.Z,{menuType:w.og.Popup,width:200},void 0,s()(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:[i]}))}})}}He.displayName="ImportOptions",He.wrapStyle={display:"flex",alignItems:"center",justifyContent:"center",width:752,minHeight:240},He.optionsColumnStyle={width:240};const Ge=He},15474:(e,t,i)=>{i.r(t),i.d(t,{IntegrationGalleryModal:()=>A});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(96486),l=i.n(r),d=i(67294),c=i(480),u=i(81954),p=i(24405),m=i(31942),g=i(3779),h=i(74181),f=i(5366),v=i(77719),y=i(761),b=i(27832),S=i(30874),w=i(49900),M=i(23999),C=i(42922),k=i(52275),T=i(73063),_=i(74194),I=i(3386),x=i(9342),Z=i(22346),P=i(74136),F=i(72495);function A(){window.__c={n:"IntegrationGalleryModal"};const e=(0,u.VK)((()=>w.d.state.open),[]),t=(0,c.Fy)(),i=(0,p.yK)((e=>({modal:{width:t.isMobile?"auto":"90vw",height:t.isMobile?"auto":"90vh",borderRadius:8}})),[t.isMobile]);return s()(Z.Z,{open:e,innerStyle:i.modal,onDismiss:()=>{w.d.setState({open:!1})},render:()=>s()("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"}},void 0,s()(D,{}),s()(B,{}))})}function B(){const e=(0,c.O7)(),t=(0,p.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor,padding:20},text:{color:e.darkTextColor}})),[]),i=(0,u.VK)((()=>{const{currentSpaceStore:e}=b.default.state;return null==e?void 0:e.id}),[]),n=(0,u.VK)((()=>{if(w.d.state.open)return w.d.state.selectedIntegration}),[]),a=(0,u.VK)((()=>n?S.Z.externalAuthentications.state.filter((e=>e.integration_id===n.id)):[]),[n]);if(!n||!i)return null;const o=n.info.icon,r=n.name,l=n.info.developer_name,m=n.info.description,g=[];(0,h.mo)(n)&&g.push("linkPreview"),(0,h.zc)(n)&&g.push("databaseSync");const k=n.info.screenshots,T=k?s()(E,{imageUrls:k},n.id):null;return d.createElement(d.Fragment,null,s()("div",{style:t.container},void 0,T,s()("div",{style:{display:"flex",justifyContent:"space-between",paddingBottom:20}},void 0,s()("div",{style:{display:"flex"}},void 0,s()("img",{src:o,style:{width:50,marginRight:10}}),s()("div",{style:{display:"flex",flexDirection:"column"}},void 0,s()("span",{},void 0,s()("b",{style:{fontSize:18}},void 0,r)),s()("span",{style:t.text},void 0,s()(f.FormattedMessage,{id:"integrationGalleryModalDetail.madeBy.name",description:"The name of the company who built the integration",defaultMessage:"By {name}",values:{name:l}})))),s()(C.Z,{style:{width:120},onClick:()=>(async t=>{await v.hM({environment:e,integration:t,spaceId:i,from:"integration_gallery"}),y.pJ({environment:e})})(n)},void 0,a.length>0?s()(f.FormattedMessage,{id:"integrationGalleryModalDetail.button.installAnother",description:"Button allowing users to add another account to an integration they've already connected.",defaultMessage:"Install another"}):s()(f.FormattedMessage,{id:"integrationGalleryModalDetail.button.install",description:"Button allowing users to connect integration for first time.",defaultMessage:"Install"}))),s()("span",{style:{...t.text,fontSize:14}},void 0,m),s()("div",{style:{display:"flex",marginTop:10}},void 0,g.map((e=>e&&s()(P.Z,{desktopStyle:{marginLeft:4},innerStyle:{fontSize:12}},void 0,M.a_[e]))))))}function E(e){window.__c={n:"ImageCarousel"};const{imageUrls:t}=e,[i,n]=(0,d.useState)(0),a=(0,p.yK)((e=>({heroImg:{width:"100%",objectFit:"contain",objectPosition:"top",paddingBottom:30},arrows:{fill:"#000"}})),[]),o=e=>{let a="right"===e?i+1:i-1;a<0&&(a=t.length-1),a>t.length-1&&(a=0),n(a)},r=t.length>0;return s()("div",{style:{width:"100%",position:"relative"}},void 0,r&&s()(T.Z,{style:{position:"absolute",top:"50%",left:10},iconStyle:a.arrows,icon:g.Z.chevronLeft,onClick:()=>o("left")}),s()("img",{style:a.heroImg,src:t[i]}),r&&s()(T.Z,{style:{position:"absolute",top:"50%",right:10},iconStyle:a.arrows,icon:g.Z.chevronRight,onClick:()=>o("right")}))}function D(){window.__c={n:"GalleryModalSidebar"};const e=(0,f.useIntl)(),t=(0,p.yK)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500}})),[]),[i,n]=(0,d.useState)(""),o=(0,u.VK)((()=>S.Z.integrations.state),[]),r=(0,u.VK)((()=>l().groupBy(S.Z.externalAuthentications.state,(e=>e.integration_id))),[]),c=(0,u.VK)((()=>{if(w.d.state.open)return w.d.state.selectedIntegration}),[]),h=(0,m.ZP)(i,o,(e=>e.name)),v=h.filter((e=>{var t;return null===(t=r[e.id])||void 0===t?void 0:t.length})),y=h.filter((e=>{var t;return!(null!==(t=r[e.id])&&void 0!==t&&t.length)})),b=[{key:"installed",render:e=>d.createElement(F.Z,a()({},e,{title:"Installed"})),items:v.map((e=>({key:e.id,action:()=>{w.d.state.open&&w.d.setState({...w.d.state,selectedIntegration:e})},render:i=>d.createElement(k.Z,a()({},i,{title:e.name,icon:s()("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==c?void 0:c.id)?t.selectedItem:void 0}}))})))},{key:"not_installed",render:e=>d.createElement(F.Z,a()({},e,{title:"Not Installed"})),items:y.map((e=>({key:e.id,action:()=>{w.d.state.open&&w.d.setState({...w.d.state,selectedIntegration:e})},render:i=>d.createElement(k.Z,a()({},i,{title:e.name,icon:s()("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==c?void 0:c.id)?t.selectedItem:void 0}}))})))}];return s()("div",{style:t.sidebar},void 0,s()("div",{style:t.header},void 0,s()(I.Z,{capture:!0,onBackspace:l().identity,onLeft:l().identity,onRight:l().identity,onSelectAll:l().identity,onRedo:l().identity,onUndo:l().identity,onCut:l().identity,onCopy:l().identity,onPaste:l().identity,onKeypress:l().identity,onDelete:l().identity,onTab:l().identity},void 0,s()(_.Z,{placeholder:e.formatMessage({id:"integrationGallery.sidebar.searchbar.placeholder",defaultMessage:"Search integrations",description:"Placeholder for integration search input"}),left:g.Z.searchThick(t.searchIcon),showClearButton:!0,format:_.Z.Format.Small,value:i,style:t.searchBar,onChange:e=>{n(e.target.value)}}))),s()(x.Z,{type:x.i.Vertical,initialFocus:0,sections:b}))}},79826:(e,t,i)=>{i.d(t,{Z:()=>A});var n=i(77094),a=i.n(n),o=i(97464),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(15070),u=i(8848),p=i(59054),m=i(77420),g=i(82990),h=i(5366),f=i(50906),v=i(76463),y=i(43132),b=i(60709),S=i(27832),w=i(61766),M=i(85057),C=i(24736),k=i(52275),T=i(31945),_=i(78140),I=i(9342),x=i(22346),Z=i(63296),P=i(72495),F=i(64369);function A(e){window.__c={n:"InternalIntegrationActionMenu"};const{botId:t}=e,[,,i]=(0,d.AF)(void 0,w.Z),n=(0,l.Fy)(),o=(0,l.O7)(),y=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),[A,E]=(0,r.useState)(!1),D=(0,d.VK)((()=>y?M.t1.createChildStore(y,{table:m.cZ,id:t,spaceId:y.id}):void 0),[t,y]),R=(0,d.VK)((()=>(0,c.Mh)(null==D?void 0:D.getModel())),[D]),[{value:L}]=(0,p.r5)((async()=>{if(D){return await v.VG({environment:o,botId:null==D?void 0:D.id})}}),[o,D]);if(!D)return null;let O;return O=n.isMobile?{menuType:b.og.ActionSheet}:{menuType:b.og.Popup},a()(T.Z,{popupType:n.isMobile?T.Z.PopupType.SlideUp:T.Z.PopupType.Popup,buttonPopupStore:i,renderOrigin:e=>r.createElement(C.Z,s()({isMobile:n.isMobile},e,{style:{marginLeft:8,marginRight:8}})),render:()=>r.createElement(r.Fragment,null,r.createElement(_.Z,O,a()(I.Z,{type:I.i.Vertical,sections:[{key:"integration options",render:e=>r.createElement(P.Z,e),items:[...B({environment:o,botToken:L}),{key:"delete",action:()=>E(!0),render:e=>r.createElement(k.Z,s()({title:a()(h.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectIntegrationButton.label",defaultMessage:"Disconnect {integrationName}",values:{integrationName:R}}),style:{color:u.ZP.red}},e))}]}],initialFocus:void 0})),a()(x.Z,{open:A,onDismiss:()=>{E(!1)},disableAnimation:!0,render:()=>a()("div",{style:{padding:20,width:333}},void 0,a()(F.Z,{isMultiline:!0,style:{marginBottom:8,fontWeight:g.Z.fontWeight.semibold}},void 0,a()(h.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegration.modal.label.title",defaultMessage:"Disconnect {integrationName} in workspace",values:{integrationName:R}})),a()(F.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginBottom:8}},void 0,a()(h.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegration.modal.label.caption",defaultMessage:"Revoke access for {integrationName} in workspace",values:{integrationName:R}})),a()("div",{style:{display:"flex",marginTop:12}},void 0,a()(Z.Z,{style:{width:140,marginRight:9},isLarge:!0,onClick:()=>E(!1)},void 0,a()(F.Z,{},void 0,a()(h.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.cancel",defaultMessage:"Cancel"}))),a()(Z.Z,{style:{width:140},isLarge:!0,onClick:async()=>{E(!1),await v.P0({environment:o,botId:D.id,onSuccess:()=>{f.IN8(o,{type:"internal"})}})},backgroundColor:u.ZP.red},void 0,a()(F.Z,{style:{color:u.ZP.white}},void 0,a()(h.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectIntegration..modal.button.disconnect",defaultMessage:"Disconnect"})))))}))})}function B(e){const{botToken:t,environment:i}=e;return t?[{key:"copy bot token",action:()=>{y.RD({environment:i,stringValue:t,copiedMessage:y.tq.copiedLinkToClipboard}),f.IVn(i,{from:"integration-settings",table:m.cZ})},render:e=>r.createElement(k.Z,s()({title:a()(h.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.copyInternalIntegrationTokenButton.label",defaultMessage:"Copy internal integration token"})},e))}]:[]}},74661:(e,t,i)=>{i.r(t),i.d(t,{default:()=>x});var n=i(77094),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(24405),d=i(66673),c=i(3779),u=i(80984),p=i(89101),m=i(82990),g=i(5366),h=i(50906),f=i(54642),v=i(5978),y=i(21969),b=i(25464),S=i(42389),w=i(42922),M=i(12508),C=i(73063),k=i(16354),T=i(44532),_=i(62385),I=i(64369);function x(){window.__c={n:"OpenInDesktopAppPopup"};const e=(0,s.O7)(),t=(0,g.useIntl)(),[i,n]=(0,o.useState)(!0),{isDesktopBrowser:x,os:Z}=(0,s.Fy)(),P=(0,r.VK)((()=>e.RouterStore.state.route.name in u.c$),[e]),F=e.currentUser.isLoggedIn(),A=(0,r.VK)((()=>S.Z.state),[]),[B,E]=(0,o.useState)(!1),D=!B&&F&&void 0===A&&x&&("mac"===Z||"windows"===Z)&&P&&S.Z.canPersistToLocalStorage(),[R,L]=(0,o.useState)(!1),O=D&&R,N=(0,o.useRef)(!1);(0,o.useEffect)((()=>{D&&!N.current&&(async function(e,t){const i=await f.getDesktopAppRegistration(e,{os:t});return"data"in i&&i.data.isRegistered}(e,Z).then((e=>{L(e)})),N.current=!0)}),[D,L,e,Z]);const V=(0,d.D9)(O);(0,o.useEffect)((()=>{O&&!V&&h.wWx(e)}),[O,V,e]);const U=(0,l.yK)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",width:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:m.Z.fontWeight.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34}})),[]);return a()(T.ZP,{popupType:T.kQ.Popup,placementToOrigin:b.u.Bottom,origin:a()("div",{style:U.origin}),disableMouseCapture:!0,open:O,style:U.container,render:()=>o.createElement(o.Fragment,null,a()("div",{style:U.header},void 0,a()(I.Z,{style:U.headerText},void 0,a()(g.FormattedMessage,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?",description:"The header of the popup shown to users to turn on the desktop deep-linking feature."})),a()(C.Z,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss",description:"Label for close button in popup shown to users to turn on the desktop deep-linking feature."}),icon:c.Z.closeSmall,onClick:()=>{S.Z.setState("never"),E(!0),h.ZyU(e)}})),a()(k.Z,{href:p.AR.desktop,external:!0,onClick:()=>{h.iDe(e)}},void 0,a()(_.Z,{style:U.appDownloadButton},void 0,c.Z.appDownload(U.appDownloadIcon),a()("span",{},void 0,a()(g.FormattedMessage,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download",description:"The download link in the popup shown to users to turn on the desktop deep-linking feature."})))),a()("div",{style:U.actions},void 0,a()("div",{style:U.alwaysOpenLinks},void 0,a()(M.Z,{checked:i,size:16,onClick:()=>{n(!i)}}),a()(I.Z,{isInline:!0,style:U.alwaysOpenLinksLabel},void 0,a()(g.FormattedMessage,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",description:"The label of the checkmark that enables desktop deep-linking going forward",values:{strongtext:e=>a()("strong",{},void 0,e)}}))),a()(w.Z,{style:U.alwaysOpenLinksButton,onClick:()=>{S.Z.setState(i?"always":"never"),E(!0),v.openInNativeApp({url:(0,y.W)(window.location.href),environment:e}),h.LC7(e,{always_open_in_app:i})}},void 0,a()(g.FormattedMessage,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",description:"Button that opens the current page in the desktop app",values:{strongtext:e=>a()("strong",{},void 0,e)}}))))})}},7811:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(83355),d=i(3779),c=i(89101),u=i(82990),p=i(5366),m=i(50906),g=i(54564),h=i(47307),f=i(88428),v=i(5978),y=i(30149),b=i(43250),S=i(34859),w=i(27832),M=i(88632),C=i(56638),k=i(88923),T=i(50795),_=i(42922),I=i(64921),x=i(57770),Z=i(68785),P=i(40721),F=i(22346),A=i(44532),B=i(18647),E=i(89302),D=i(31792),R=i(14694);class L extends l.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:D.Z,labelMouseStore:D.Z},this.handleToggleClick=()=>{const{section:e}=this.props;m.Z1A(this.environment,{section_name:e.sectionName,action:this.isOpen()?"close":"open"}),this.isOpen()?f.Jj(e.sectionName):f.GS(e.sectionName)},this.handleMouseMove=()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),this.handleMouseLeave=()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}),this.handleLabelMouseMove=()=>{const{labelMouseStore:e}=this.stores;e.setState({...e.state,mouseEntered:!0})},this.handleLabelMouseLeave=()=>{const{labelMouseStore:e}=this.stores;e.setState({...e.state,mouseEntered:!1})}}renderComponent(){const{renderSection:e}=this.props,t=!this.isOpen();return s()("div",{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,style:this.getButtonContainerStyle()},void 0,this.renderLabel(),!t&&e())}renderLabel(){const e=!this.isOpen();return s()(R.Z,{disableMobileBorder:e,shouldShowMobileMarginBottom:e,style:this.getSectionSidebarItemStyle(),childrenStyle:{overflow:"visible"}},void 0,s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()(I.Z,{onClick:this.handleToggleClick,onMouseMove:this.handleLabelMouseMove,onMouseLeave:this.handleLabelMouseLeave,style:this.getLabelButtonStyle()},void 0,!Boolean(this.props.forceOpen)&&d.Z.triangle(this.getArrowStyle()),s()("span",{style:this.getToggleButtonStyle()},void 0,this.props.icon&&s()("span",{style:{paddingRight:4,display:"inline-block"}},void 0,this.props.icon),this.props.section.name))))}isOpen(){const{section:e,expandedSections:t}=this.props;return!!t&&-1!==t.indexOf(e.sectionName)}getSectionSidebarItemStyle(){return{minHeight:24,padding:0}}getSectionLabelStyle(){return{lineHeight:1,marginBottom:1,color:this.theme.sidebarTextColor,fontWeight:u.Z.fontWeight.semibold,marginLeft:9}}getMobileSectionLabelStyle(){return{lineHeight:1,color:this.theme.sidebarTextColor,fontWeight:u.Z.fontWeight.semibold,marginLeft:9}}getLabelButtonStyle(){return{display:"flex",alignItems:"center",paddingBottom:12,paddingTop:12,paddingLeft:25,...this.props.isMobile&&{marginBottom:8},width:"100%"}}getToggleButtonStyle(){const{labelMouseStore:e}=this.stores,{mouseEntered:t}=e.state;return{...this.props.isMobile?this.getMobileSectionLabelStyle():this.getSectionLabelStyle(),color:t?this.theme.regularTextColor:this.theme.mediumTextColor,transition:"color 100ms ease-out"}}getButtonContainerStyle(){const e=!this.isOpen(),{first:t}=this.props;return{...t?{borderTop:`1px solid ${this.theme.regularDividerColor}`}:{},borderBottom:`1px solid ${this.theme.regularDividerColor}`,width:"100%",paddingBottom:e?0:10}}getArrowStyle(){return{width:"0.6875em",height:"0.6875em",transition:"transform 200ms ease-out",transform:`rotateZ(${this.isOpen()?180:90}deg)`,fill:this.theme.regularIconColor}}}L.displayName="PageTemplateToggleButton";const O=L;class N extends l.Z{constructor(){super(...arguments),this.storeTypes={templateRecordCacheStore:T.$},this.renderMobilePopup=()=>{const e=C.Z.state;if(e.open)return s()(P.default,{title:s()(p.FormattedMessage,{defaultMessage:"Try this template",id:"pageTemplateModal.mobileModal.title"}),left:s()(P.CancelMenuText,{}),onClickLeft:this.handleDismiss,right:e.isLoading?s()(Z.Z,{}):s()(p.FormattedMessage,{defaultMessage:"Use",id:"pageTemplateModal.mobileModal.useButton.label",description:"'Use' is utilized as a verb for a button label on the top right of a mobile menu, indicating to the user to click on the button to use the template they are previewing."}),onClickRight:this.handleUseTemplateClick,forceFullScreenSlideUp:!0},void 0,this.renderPreview(e))},this.renderModal=()=>{const e=C.Z.state;if(e.open)return s()("div",{style:N.modalStyle,className:b.fHd},void 0,this.renderPreview(e),this.renderSidebar(e))},this.handleDismiss=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.close()}else this.close()},this.handleUseTemplateClick=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.accept(!1)}else this.accept(!1)},this.handleItemClick=async e=>{const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state;if(t.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.setCurrentItem(e)}else this.setCurrentItem(e);m.n1D(this.environment,{template_name:e.name,page_prepopulated_template_id:e.rootId})}}willMountOrUpdate(){const e=C.Z.state,{currentSpaceViewStore:t}=w.default.state;e.open&&t&&y.createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:this.environment,perform:i=>{f.GF({item:e.item,spaceViewStore:t,transaction:i})}})}renderComponent(){const{device:e}=this.environment,t=C.Z.state;return e.isMobile?s()(A.GI,{open:t.open,render:this.renderMobilePopup,forceFullScreenSlideUp:!0,onDismiss:this.handleDismiss,popupType:e.isMobile?A.GI.PopupType.SlideUp:A.GI.PopupType.Popup}):s()(F.Z,{open:t.open,render:this.renderModal,onDismiss:this.handleDismiss})}renderSidebar(e){const{currentSpaceViewStore:t,currentSpaceStore:i}=w.default.state;if(!t||!i)return;const n=f.YH();return s()("div",{style:this.getSidebarStyle()},void 0,s()(_.Z,{isLarge:!0,onClick:this.handleUseTemplateClick,style:N.useTemplateButtonStyle,disabled:e.isLoading||!M.Z.state.online},void 0,e.isLoading&&s()(Z.Z,{isWhite:!0,style:{marginRight:6}}),s()(p.FormattedMessage,{defaultMessage:"Use this template",id:"pageTemplateModal.useTemplateButton.label"})),s()(B.Z,{style:N.scrollerStyle,type:S.Z.Y},void 0,e.sections.map(((o,l)=>s()(O,{isMobile:!1,section:o,expandedSections:n,spaceStore:i,spaceViewStore:t,showAddPageButton:!1,first:0===l,renderSection:()=>s()(r.Fragment,{},void 0,o.items.map(((t,i)=>{const n=e.item.rootId===t.rootId,o=n?this.hoveredButtonStyle():{};return r.createElement(I.Z,a()({hovered:n,style:o,key:i},this.props,{onClick:()=>this.handleItemClick(t)}),this.renderSidebarItem(t))})))},o.sectionName))),s()(I.Z,{onClick:()=>{m.T2x(this.environment),v.navigateToExternalURL({environment:this.environment,url:c._j.templates})},style:this.fixedLinkStyle(),hoveredStyle:{background:this.theme.sidebarHideButtonHoveredBackground},pressedStyle:{background:this.theme.sidebarHideButtonPressedBackground}},void 0,d.Z.typesRelation(this.fixedLinkIconStyle()),s()(p.FormattedMessage,{defaultMessage:"Browse more templates",id:"pageTemplateModal.goToFullTemplateGalleryButton.label"}))))}renderSidebarItem(e){return s()(R.Z,{style:{paddingLeft:30,fontWeight:u.Z.fontWeight.semibold},icon:s()("div",{style:this.getIconWrapStyle()},void 0,s()(x.Z,{size:20,emoji:e.emoji}))},void 0,e.name)}renderPreview(e){const{device:t}=this.environment;return s()(E.Z,{previewRootId:e.item.previewRootId,isFrontPage:!1,style:t.isMobile?N.previewMobileStyle:N.previewStyle,templateRecordCacheStore:this.stores.templateRecordCacheStore,disabled:!1},e.item.previewRootId)}accept(e){const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state,i=C.Z.state,{currentSpaceViewStore:n,currentSpaceStore:a,mainEditorCurrentBlockStore:o}=w.default.state;if(i.open&&n&&a){const s=o&&o.isEmptyPage()?o:void 0,r=k.default.state.open&&k.default.state.target&&k.default.state.target.isEmptyPage()?k.default.state.target:void 0;f.RL({environment:this.environment,item:i.item,spaceStore:a,spaceViewStore:n,useRecordCache:e?t:void 0,initializeStore:i.createNewPage?void 0:s||r,isPrivate:i.isPrivate,from:i.createNewPage?"sidebar":"newPage"})}}close(){f.xv(this.environment),g.LZ()}setCurrentItem(e){C.Z.state.open&&f.zO({templateItem:e,currentUserId:this.environment.currentUser.id})}showEditConfirmDialog(){return new Promise(((e,t)=>{h.showDialog({message:s()(p.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:s()(p.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:s()(p.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}getSidebarStyle(){return{width:N.sidebarWidth,color:this.theme.mediumTextColor,background:"dark"===this.theme.mode?this.theme.popoverBackground:this.theme.sidebarBackground,display:"flex",flexDirection:"column",borderTopRightRadius:N.borderRadius,borderBottomRightRadius:N.borderRadius}}getIconWrapStyle(){return{color:this.theme.regularTextColor,position:"relative"}}hoveredButtonStyle(){return{color:this.theme.regularTextColor,fontWeight:u.Z.fontWeight.medium}}fixedLinkStyle(){return{padding:12,color:this.theme.mediumTextColor,background:"dark"===this.theme.mode?this.theme.popoverBackground:this.theme.sidebarBackground,fontSize:13,fontWeight:u.Z.fontWeight.medium,display:"flex",alignItems:"center",position:"absolute",bottom:0,right:0,height:45,width:N.sidebarWidth,borderTop:`1px solid ${this.theme.regularDividerColor}`}}fixedLinkIconStyle(){return{width:12,height:12,marginLeft:8,marginRight:10,marginBottom:0,fill:this.theme.regularIconColor,fontWeight:u.Z.fontWeight.medium}}}N.displayName="PageTemplateModal",N.sidebarWidth=240,N.borderRadius=3,N.modalStyle={display:"flex",width:"85vw",height:"85vh",borderRadius:N.borderRadius},N.useTemplateButtonStyle={position:"relative",marginTop:16,marginLeft:20,marginRight:20,marginBottom:16,whiteSpace:"nowrap"},N.previewStyle={width:`calc(100% - ${N.sidebarWidth}px)`,flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"},N.previewMobileStyle={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"},N.scrollerStyle={flexGrow:1,flexShrink:1,paddingBottom:44};const V=(0,p.injectIntl)(N)},57806:(e,t,i)=>{i.r(t),i.d(t,{PermissionsInviteBase:()=>D,default:()=>R});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(96486),l=i.n(r),d=i(67294),c=i(83355),u=i(8848),p=i(94044),m=i(5366),g=i(50906),h=i(95209),f=i(21325),v=i(43250),y=i(60709),b=i(75472),S=i(65598),w=i(33665),M=i(23537),C=i(85834),k=i(1903),T=i(29677),_=i(85057),I=i(78140),x=i(40721),Z=i(72495),P=i(83182),F=i(7567),A=i(44385),B=i(24145),E=i(43579);class D extends c.Z{constructor(){super(...arguments),this.renderInShareMenu=this.createComputedStore((()=>Boolean(this.props.renderInShareMenu&&!this.environment.device.isMobile))),this.inviteOrigin=this.createComputedStore((()=>this.props.store instanceof _.G?this.renderInShareMenu.state?"page_share_modal":"page_permission_modal":"space_share_modal")),this.defaultRoleForSpaceBot=this.createComputedStore((()=>"editor")),this.defaultRoleForNonBot=this.createComputedStore((()=>{const{store:e,isSubscribed:t}=this.props;return b.xT({environment:this.environment,store:e,isSubscribed:t})})),this.inputDebounce=void 0,this.storeTypes={permissionsInviteStore:k.Z,contextualInviteStore:C.ZP},this.handleUpgradeClick=()=>{h.Vu({environment:this.environment,upgradeButtonName:this.props.upgradeButtonName,onUpgradeButtonClick:this.props.onUpgradeButtonClick})},this.handleModalDismiss=async()=>{await h.kL({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,from:"share_menu"})},this.handleInputChange=async e=>{var t;null===(t=this.inputDebounce)||void 0===t||t.cancel(),this.inputDebounce=l().debounce((()=>{g.UWw(this.environment,{...b.a_(this.environment,this.stores.permissionsInviteStore.state)})}),1e3),this.inputDebounce(),await h.jC({environment:this.environment,event:e,permissionsInviteStore:this.stores.permissionsInviteStore})},this.handleClickRemoveToken=e=>{h.PV({targetToRemove:e,permissionsInviteStore:this.stores.permissionsInviteStore,defaultRoleForNonBot:this.defaultRoleForNonBot.state})}}async willMount(){await f.bi(this.environment)}willUnmount(){var e;null===(e=this.inputDebounce)||void 0===e||e.flush()}renderComponent(){if(this.renderInShareMenu.state)return this.renderComponentInShareMenu();const e=this.renderHeader(),t=this.renderSearchRequest();return this.renderComponentOriginal(e,t)}renderHeader(){const{permissionsInviteStore:e}=this.stores,{device:t}=this.environment;return s()(B.Z,{permissionsInviteStore:e,store:this.props.store,handleClickRemoveToken:e=>{this.handleClickRemoveToken(e)},handleInputChange:async e=>{await this.handleInputChange(e)},handleInputSubmit:async()=>{await this.handleInviteInputSubmit()},origin:Boolean(this.renderInShareMenu.state)?"share_menu":"share_modal",defaultRoleForNonBot:this.defaultRoleForNonBot.state,isTeamsEnabled:(0,M.bq)(),right:!t.isMobile&&this.renderDesktopInputRightInner(),focus:"invitee"===e.state.inputFocus||"invitee-popup-closed"===e.state.inputFocus,handleFocus:()=>{t.isMobile||e.setState({...e.state,inputFocus:"invitee"})}})}renderSearchRequest(){const{permissionsInviteStore:e}=this.stores,t=(0,S.NZ)(this.props.store),i=(0,S.NZ)(this.props.store);return s()(E.Z,{permissionsInviteStore:e,store:this.props.store,defaultRoleForSpaceBot:this.defaultRoleForSpaceBot.state,shouldShowBots:t,shouldShowGroups:i,sectionRenderLimit:this.renderInShareMenu.state?5:10,membersOnly:this.props.membersOnly})}renderComponentOriginal(e,t){const{device:i}=this.environment;let n;return n=i.isMobile?{menuType:y.og.Modal,title:(0,S.Mm)(this.props.store)?s()(m.FormattedMessage,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):s()(m.FormattedMessage,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:s()("div",{style:{color:u.ZP.blue}},void 0,s()(m.FormattedMessage,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})),left:s()(x.CancelMenuText,{}),onClickLeft:this.handleModalDismiss,onClickRight:async()=>{await this.handleInviteClick()},header:e}:{menuType:y.og.Popup,width:480,height:"60vh",header:e,tokenInputHeader:!0,footer:this.renderHelpButton(),disableScroller:!1},d.createElement(I.Z,a()({},n,{className:v.FJA}),i.isMobile&&s()(Z.Z,{title:s()(m.FormattedMessage,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"})},void 0,this.renderDesktopInputRightInnerSelect()),s()("div",{},void 0,t),i.isMobile&&this.renderHelpButton())}renderHelpButton(){return this.renderInShareMenu.state?null:s()(Z.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,s()(P.Z,{title:s()(m.FormattedMessage,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,w.UY)("guides.invitePerson"),analyticsFrom:"invite_person"}))}renderDesktopInputRightInner(){return s()("div",{style:{marginLeft:p.p_,display:"flex",alignItems:"center"}},void 0,this.renderDesktopInputRightInnerSelect(),!this.renderInShareMenu.state&&this.renderDesktopInputRightInnerButton({isLarge:!0}))}renderDesktopInputRightInnerButton(e){const{isLarge:t}=e;return s()(A.Z,{store:this.props.store,permissionsInviteStore:this.stores.permissionsInviteStore,handleUpgradeClick:()=>this.handleUpgradeClick(),handleInviteClick:()=>this.handleInviteClick(),disabled:this.props.disabled,isLarge:t})}renderDesktopInputRightInnerSelect(){const{device:e}=this.environment,{store:t}=this.props,{permissionsInviteStore:i}=this.stores;if(i.state.isInviteTargetsEmpty||!(0,T.ow)(i.state))return s()(F.Z,{disabled:(0,S.Mm)(t)&&!t.canAdmin(),role:i.state.inviteRole,table:i.state.table,type:"user_permission",blockType:(0,S.NZ)(t)?t.getType():void 0,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",height:26,color:u.ZP.uiGray,...this.renderInShareMenu.state&&{marginTop:e.isMobile?4:i.state.isInviteTargetsEmpty?1:6,marginBottom:e.isMobile?4:i.state.isInviteTargetsEmpty?1:6,marginRight:0}},isMenuItem:e.isMobile,onChange:e=>{h.XC({environment:this.environment,newRole:e,permissionsInviteStore:this.stores.permissionsInviteStore})}})}renderComponentInShareMenu(){const e={menuType:y.og.Popup,header:s()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"top",marginLeft:12,marginRight:12,gap:10}},void 0,this.renderHeader(),this.renderDesktopInputRightInnerButton({isLarge:!0})),footer:this.renderHelpButton(),disableScroller:!1};return s()("div",{style:{paddingTop:14,paddingBottom:14,paddingLeft:2,paddingRight:2}},void 0,d.createElement(I.Z,e,this.renderSearchRequest()))}async handleInviteInputSubmit(){await this.handleInviteClick()}async handleInviteClick(){await h.qg({environment:this.environment,store:this.props.store,sudoModeStore:this.props.sudoModeStore,permissionsInviteStore:this.stores.permissionsInviteStore,contextualInviteStore:this.stores.contextualInviteStore,onInviteClick:this.props.onInviteClick,onInviteComplete:this.props.onInviteComplete,inviteOrigin:this.inviteOrigin.state,intl:this.props.intl})}}D.displayName="PermissionsInviteBase";const R=(0,m.injectIntl)(D)},44385:(e,t,i)=>{i.d(t,{e:()=>S,Z:()=>w});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(5366),u=i(94044),p=i(47425),m=i(67669),g=i(75472),h=i(8323),f=i(26781),v=i(25464),y=i(42922),b=i(58032);function S(){const e=(0,d.VK)((()=>(0,p.tP)((0,h.zt)())),[]);return r.createElement(r.Fragment,null,s()("div",{},void 0,s()(c.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your plan allows up to {guestLimit} unique guests.",description:"Guest limit shown when users attempts to invite a guest from the invite user button.",values:{guestLimit:e}})),s()("div",{},void 0,s()(c.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine2",defaultMessage:"Upgrade to go unlimited.",description:"Upgrade message shown when users attempts to invite a guest from the invite user button."})))}const w=function(e){window.__c={n:"PermissionsInviteButton"};const{store:t,permissionsInviteStore:i,handleUpgradeClick:n,handleInviteClick:o,isLarge:p}=e,h=(0,l.O7)(),[w]=(0,d.AF)(i),M=(0,d.VK)((()=>w.inviteTargets.some((e=>g.OA(e)))),[w]),C=(0,f.i)(t),k=(0,d.VK)((()=>{const e=w.inviteTargets,t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),i=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return m.dA(h,[...t,...i])}),[h,w]),T=M?C:void 0;return s()(b.Z,{alignment:v.v.Center,disableTooltip:!(k||T),renderTooltip:()=>k?s()(S,{}):T,render:e=>r.createElement(y.Z,a()({isLarge:p,style:{minWidth:u.UF},disabled:Boolean(T),onClick:k?n:o},e),s()(c.FormattedMessage,k?{id:"inviteUserModal.inviteButton.upgradeLabel",defaultMessage:"Upgrade"}:{id:"inviteUserModal.inviteButton.label",defaultMessage:"Invite"}))})}},7378:(e,t,i)=>{i.r(t),i.d(t,{default:()=>T});var n=i(77094),a=i.n(n),o=i(97464),s=i.n(o),r=i(67294),l=i(83355),d=i(41892),c=i(47425),u=i(5366),p=i(21325),m=i(93678),g=i(75472),h=i(65598),f=i(8323),v=i(1903),y=i(78291),b=i(42922),S=i(9019),w=i(58032),M=i(57806),C=i(60442);class k extends l.Z{constructor(){super(...arguments),this.storeTypes={permissionsInviteStore:v.Z},this.renderOverlay=()=>r.createElement(M.default,s()({},this.props,{permissionsInviteStore:this.stores.permissionsInviteStore})),this.handleUpgradeClick=()=>{m.y(this.environment,{from:this.props.upgradeButtonName,for:c.$M}),this.props.onUpgradeButtonClick&&this.props.onUpgradeButtonClick()},this.handleButtonClick=()=>{(0,g.z5)({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,store:this.props.store,renderInShareModal:!1,isSubscribed:this.props.isSubscribed})},this.handleModalDismiss=async()=>{const{permissionsInviteStore:e}=this.stores;await(0,g.Aw)({environment:this.environment,permissionsInviteStoreState:e.state,from:(0,h.Mm)(this.props.store)?"space_share_modal":"page_share_modal"})||e.reset()}}async willMount(){await p.bi(this.environment)}renderComponent(){const{store:e}=this.props,{modalOpen:t}=this.stores.permissionsInviteStore.state;let i,n,o=!1;return e.canEditMembership()?e.canEditMembership()&&(0,h.Mm)(e)&&y.default.state.data&&!f.Mk()?(i=!1,o=!0,n=a()(C.Z,{imageURL:d.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:a()(u.FormattedMessage,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:a()(u.FormattedMessage,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})})):i=!0:(i=!1,n=(0,h.Mm)(e)?a()(u.FormattedMessage,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."}):a()(u.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."})),a()("div",{},void 0,(0,h.Mm)(e)?a()(S.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:a()(w.Z,{renderTooltip:()=>n,disableTooltip:i,render:e=>r.createElement(b.Z,s()({isLarge:!0,onClick:o?this.handleUpgradeClick:this.handleButtonClick,disabled:!i&&!o,style:{flex:this.props.shouldGrow?1:0,...this.props.buttonStyle}},e),a()(u.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"}))})}):a()(S.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:null}))}}k.displayName="PermissionsInviteWithModal";const T=(0,u.injectIntl)(k)},79627:(e,t,i)=>{i.r(t),i.d(t,{default:()=>K});var n=i(77094),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(83355),d=i(480),c=i(81954),u=i(24405),p=i(41892),m=i(8848),g=i(3779),h=i(89101),f=i(60949),v=i(82990),y=i(5366),b=i(50906),S=i(29974),w=i(97627),M=i(30149),C=i(37181),k=i(36867),T=i(27832),_=i(4926),I=i(10161),x=i(5188),Z=i(49085);class P extends Z.Z{getInitialState(){return{open:!1,step:"prompt"}}}const F=new P;var A=i(12768),B=i(23063),E=i(42922),D=i(64921),R=i(28451),L=i(3386),O=i(89728),N=i(44532),V=i(42402),U=i(29551),W=i(38294);class z extends l.Z{constructor(){super(...arguments),this.hasSeenInitial=!1,this.renderMenu=()=>a()(R.P,{calloutId:"persona_collection"},void 0,a()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),a()(U.gq,{style:this.getInnerContainerStyle(),alignItems:"center",alignContent:"center"},void 0,this.renderStep()))),this.renderInitial=()=>{const e=this.environment.currentUser.id;if(!F.state.open||!e)return;this.hasSeenInitial||(b.q5U(this.environment,{user_id:e,event:"initial"}),this.hasSeenInitial=!0);const{invalidField:t}=F.state;return a()("div",{style:{...this.getSlideUpStyle(),padding:8}},void 0,a()("img",{style:{width:40,height:32},src:p.Z.images.chatButtonSmallPng}),a()("div",{style:{fontSize:14,fontWeight:v.Z.fontWeight.semibold,paddingTop:0,paddingBottom:8}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.header",defaultMessage:"Tell us more about yourself",description:"Header for the initial modal"})),a()("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:270,margin:"0 auto"}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you",description:"Caption for the initial modal"})),a()("div",{style:{...this.getLabelStyle(),marginTop:10}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.roleLabel",defaultMessage:"What is your role?",description:"Question for the role form selection"})),a()(W.ZP,{questionType:"role",title:a()(y.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.roleLabel",defaultMessage:"Role",description:"Label for role form"}),question:F.state.role,invalid:"role"===t,onSelect:e=>{F.state.open&&F.setState({...F.state,role:e,step:"initial"})}}),a()("div",{style:this.getLabelStyle()},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.workLabel",defaultMessage:"What kind of work do you do?",description:"Title for work form"})),a()(W.ZP,{questionType:"work",title:a()(y.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.workLabel",defaultMessage:"Work",description:"Label for work form"}),question:F.state.work,invalid:"work"===t,onSelect:e=>{F.state.open&&F.setState({...F.state,work:e,step:"initial"})}}),a()("div",{style:this.getLabelStyle()},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.questionLabel",defaultMessage:"What are you planning to use Notion for?",description:"Title for use form"})),a()(W.ZP,{questionType:"use",title:a()(y.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.useLabel",defaultMessage:"Use",description:"Label for use form"}),question:F.state.use,invalid:"use"===t,onSelect:e=>{F.state.open&&F.setState({...F.state,use:e,step:"initial"})}}),a()("div",{style:this.getLabelStyle()},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.companySizeLabel",defaultMessage:"Company size",description:"Label for asking company size"})),a()(U.gq,{},void 0,this.getCompanySizeButtonData().map((e=>{let{type:t,message:i,style:n}=e;return a()(O.Z,{isLightGray:!0,isLarge:!0,style:{...this.getBaseButtonStyle(),...F.state.open&&F.state.companySize===t&&this.getSelectedButtonStyle(),...n},onClick:()=>{F.state.open&&F.setState({...F.state,companySize:t,step:"initial"})}},void 0,i)}))))},this.renderCancel=()=>a()(D.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,g.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})),this.renderThanks=()=>{const e=this.environment.currentUser.id;if(e)return a()(H,{userId:e})},this.renderPrompt=()=>{const e=this.environment.currentUser.id;if(e)return a()(q,{userId:e})},this.handleCancel=()=>{const{currentUserSettingsStore:e}=T.default.state,t=this.environment.currentUser.id;e&&t&&(b.jPN(this.environment,{user_id:t,event:"cancel"}),M.createAndCommit({userAction:"PersonaCollectionModal.handleCancel",environment:this.environment,perform:t=>{C.d2({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}}),F.reset())}}willMountOrUpdate(){var e;if(F.state.open)return;const t=this.environment,i=t.currentUser.id,n=(0,k.g)(i),{currentUserSettingsStore:a,inAppCalloutStore:o}=T.default.state;if(!a||t.device.isMobile)return;if(n<3)return;const s=a.getSettings();if(!s)return;if(Boolean(s.seen_persona_collection||(null===(e=s.persona_version)||void 0===e?void 0:e.version)))return;const r="on"===I.default.getEligibleGroup({experimentId:"persona_collection",defaultGroup:"unassigned"});!A.default.state.isOnboarding&&"closed"!==F.state.step&&!1===x.Z.state.open&&o.canShow("persona_collection")&&r&&F.setState({...F.state,open:!0})}renderComponent(){return a()(N.GI,{keepFocus:!1,open:F.state.open,render:this.renderMenu,onDismiss:this.handleCancel,popupType:N.kQ.Popup,disableDarkOverlayBackground:!0,disableMouseCapture:!0})}renderStep(){if(!1===F.state.open)return;const{step:e}=F.state;return r.createElement(r.Fragment,null,a()(B.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>a()(L.Z,{capture:!0,onBackspace:s().identity,onLeft:s().identity,onRight:s().identity,onSelectAll:s().identity,onRedo:s().identity,onUndo:s().identity,onCut:s().identity,onCopy:s().identity,onPaste:s().identity,onKeypress:s().identity,onDelete:s().identity,onTab:s().identity},void 0,this.renderInitial())}),a()(B.Z,{isVisible:"prompt"===e,animationStyle:this.getAnimationStyle("prompt"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderPrompt}),a()(B.Z,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}),a()(B.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>a()(E.Z,{isLarge:!0,style:{marginTop:17,width:270,position:"absolute",bottom:20},onClick:()=>this.handleSubmitClick()},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.sendLabel",defaultMessage:"Submit",description:"Button to submit survey results"}))}))}getInvalidField(){if(!F.state.open)return"closed";const{use:e,role:t,work:i,companySize:n}=F.state;return n?e?t?i?void 0:"work":"role":"use":"company_size"}getCompanySizeButtonData(){return[{type:"1_100",message:a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.1_100Label",defaultMessage:"1-100",description:"Button to select 1-100 employees"})},{type:"101_1000",message:a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.101_1000Label",defaultMessage:"101-1,000",description:"Button to select 101-1000 employees"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.1000PlusLabel",defaultMessage:"1,001+",description:"Button to select 1,001+ employees"})}]}handleSubmitClick(){const e=this.environment.currentUser.id;if(!F.state.open||!e)return;const t=this.getInvalidField();if(t)return void F.setState({...F.state,step:"initial",invalidField:t});b.jPN(this.environment,{user_id:e,event:"submit"});const{currentUserSettingsStore:i}=T.default.state;if(i&&F.state.open){const e=F.state;if(M.createAndCommit({userAction:"PersonaCollectionModal.handleSubmitClick",environment:this.environment,perform:t=>{C.d2({userSettingsStore:i,data:{seen_persona_collection:!0,persona:e.work,team_role:e.role,use_case:e.use,source:"persona_collection",persona_version:{version:"V3",timestamp:(new Date).getTime()}},transaction:t})}}),I.default.checkGate("survey_data_writes")){const t=(new Date).getTime(),i=f.Dh({maybeFunction:e.work,guessedFunctionVersion:4,maybeRole:e.role,guessedRoleVersion:2,collectedFrom:"inapp_modal",collectedAt:t});void 0!==i&&w.Q1(this.environment,i);const n=f.K0({maybeCompanySize:e.companySize,guessedCompanySizeVersion:1,maybeUseCases:[e.use],guessedUseCasesVersion:3,collectedFrom:"inapp_modal",collectedAt:t});void 0!==n&&S.wg(this.environment,n)}}F.setState({...F.state,invalidField:void 0,step:"thanks"}),s().delay((()=>{F.reset()}),6e3)}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"fixed",bottom:65+_.Z.state,right:16+_.Z.state}}getBackgroundStyle(){return{backgroundColor:"transparent",pointerEvents:"none"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getInnerContainerStyle(){return{width:320,height:"prompt"===F.state.step||"thanks"===F.state.step?200:450,overflow:"hidden",position:"relative",right:"auto",padding:30,paddingTop:0,cursor:"default",textAlign:"center",justifyContent:"center"}}getLabelStyle(){return{marginTop:10,fontSize:12,color:this.theme.mediumTextColor,fontWeight:v.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getBaseButtonStyle(){return{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center"}}getSelectedButtonStyle(){return{color:m.ZP.blue,border:`1px solid ${m.ZP.blue}`}}getSlideUpStyle(){if(!F.state.open)return{};const{step:e}=F.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(0px)":"translateY(-180px)"}}}z.displayName="PersonaCollectionModal";const K=z;function q(e){window.__c={n:"PersonaCollectionPrompt"};const[t,i]=(0,c.AF)(F),n=(0,u.yK)((e=>({promptHeaderStyle:{color:e.regularTextColor,fontWeight:v.Z.fontWeight.semibold,fontSize:14},promptTextStyle:{fontSize:12,color:e.mediumTextColor,width:270,margin:"0 auto"}})),[]),o=(0,d.O7)();return(0,r.useEffect)((()=>{b.q5U(o,{user_id:e.userId,event:"prompt"})}),[o,e.userId]),a()("div",{style:{paddingTop:24}},void 0,a()("img",{style:{width:40,height:56,paddingTop:24},src:p.Z.images.chatButtonSmallPng}),a()("div",{style:n.promptHeaderStyle},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.prompt.header",defaultMessage:"Tell us more about yourself",description:"Title on survey modal"})),a()("div",{style:n.promptTextStyle},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.prompt.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you",description:"Explains rationale for survey modal"})),a()(E.Z,{isLarge:!0,style:{marginTop:6,width:260,bottom:20},onClick:()=>{!0===t.open&&i({...t,step:"initial"});const{currentUserSettingsStore:e}=T.default.state;e&&M.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:o,perform:t=>{C.d2({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}})}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.prompt.survey",defaultMessage:"Take the 20 second survey",description:"Button to prompt users to take a short survey"})),a()(O.Z,{isLightGray:!0,isLarge:!0,onClick:()=>{const{currentUserSettingsStore:t}=T.default.state;t&&e.userId&&(M.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:o,perform:e=>{C.d2({userSettingsStore:t,data:{seen_persona_collection:!0},transaction:e})}}),b.jPN(o,{user_id:e.userId,event:"skip"}),F.setState({open:!1,step:"closed"}))}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.prompt.skipLabel",defaultMessage:"Skip",description:"Button to allow users to skip taking the survey and close out of the modal"})))}function H(e){window.__c={n:"PersonaCollectionThanks"};const t=(0,u.yK)((e=>({thanksHeaderStyle:{color:e.regularTextColor,fontWeight:v.Z.fontWeight.semibold,fontSize:14}})),[]),i=(0,d.O7)();return(0,r.useEffect)((()=>{b.q5U(i,{user_id:e.userId,event:"thanks"})}),[i,e.userId]),a()("div",{},void 0,a()("img",{style:{width:208,height:89,paddingTop:30},src:p.Z.images.heroIllustrationPng}),a()("div",{style:t.thanksHeaderStyle},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.thanks.caption",defaultMessage:"Thank you! Discover new ways to use Notion in the <textlink>Template Gallery</textlink>",description:"Text on thanks modal",values:{textlink:t=>a()(V.Z,{disableUnderline:!0,disableHover:!0,href:h._j.templates,external:!0,style:{color:m.ZP.blue,fontSize:v.Z.fontSize.UIRegular.desktop,fontWeight:500},onClick:()=>{e.userId&&b.jPN(i,{user_id:e.userId,event:"template_gallery"})}},void 0,t)}})))}},26200:(e,t,i)=>{i.r(t),i.d(t,{default:()=>L});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(83355),d=i(8848),c=i(3779),u=i(5366);const p=(0,u.defineMessages)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"}});var m=i(7250),g=i(82990),h=i(54642),f=i(47307),v=i(360),y=i(28020),b=i(33929),S=i(60709),w=i(33665),M=i(88632),C=i(25399),k=i(36488),T=i(74194),_=i(78140),I=i(28992),x=i(9342),Z=i(17293),P=i(63296),F=i(72495),A=i(92660),B=i(74523),E=i(6202);const D=(0,u.defineMessages)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Add additional information (optional)"}});class R extends l.Z{constructor(e){super(e),this.handleCancel=()=>{v.q()},this.renderContent=()=>{const{device:e}=this.environment;if(!M.Z.state.online)return this.renderOffline();const t=C.Z.state;return t.open?e.isMobile?this.renderMobileModal(t):this.renderDesktopModal(t):void 0},this.onSubmit=async()=>{const e=this.environment,t=C.Z.getState();if(!t.open)return;const{additionalInformation:i,reason:n}=t,a=(0,y.Fv)();if(!n||null==a||!a.id)return void f.showErrorMessage(s()(u.FormattedMessage,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const o=await(l=(0,m.OP)(),h.reportPage(e,{reason:n,page:a,intercomVisitorId:l,additionalInformation:i}));var l;"failed"===o.type?f.showError(o):(C.Z.setState({open:!1}),f.showMessage({message:r.createElement(r.Fragment,null,s()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},void 0,c.Z.thanksShield({width:40}),s()("div",{style:{paddingTop:12,paddingBottom:8,fontSize:"large",textAlign:"center"}},void 0,s()(u.FormattedMessage,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."}))))}))},this.modalTitleStyle={fontSize:16,marginBottom:12,fontWeight:g.Z.fontWeight.medium}}renderComponent(){return s()(A.Z,{onDismiss:this.handleCancel,render:this.renderContent,requireOnline:!0,modalStore:C.Z})}renderOptionButtons(e){const{reason:t}=e;return r.createElement(r.Fragment,null,s()(Z.Z,{title:s()(u.FormattedMessage,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===t,onClick:()=>C.Z.setState({...e,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),s()(Z.Z,{title:b.default.formatMessage(p.inappropriate_content),isSelected:"inappropriate_content"===t,onClick:()=>C.Z.setState({...e,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),s()(Z.Z,{title:s()(u.FormattedMessage,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===t,onClick:()=>C.Z.setState({...e,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation"))}renderMobileModal(e){if(!e.open)return;const{reason:t}=e,i={menuType:S.og.Modal,title:s()(u.FormattedMessage,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:s()(u.FormattedMessage,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return r.createElement(_.Z,i,s()(x.Z,{type:x.i.Vertical,initialFocus:void 0,sections:[{key:"help",render:e=>{let{children:t,...i}=e;return r.createElement(F.Z,i,t)},items:[{key:"help",render:()=>s()(I.Z,{title:s()(B.Z,{title:s()(u.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,w.UY)("contentPolicy"),analyticsFrom:"report_page"}),right:r.createElement(r.Fragment,null),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...i}=e;return r.createElement(F.Z,i,t)},items:[{key:"options",render:()=>this.renderOptionButtons(e),action:()=>{}},{key:"additionalInfo",render:()=>t&&s()(T.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:b.default.formatMessage(D.additionalInformationPlaceholder),onChange:t=>{C.Z.setState({...e,additionalInformation:t.target.value})}}),action:()=>{}}]},{key:"actions",render:e=>{let{children:t,...i}=e;return r.createElement(F.Z,a()({isSubmitButton:!0},i),t)},items:[{key:"submit",render:e=>{const{onClick:t,...i}=e;return r.createElement(E.Z,a()({},i,{disabled:!this.canSubmit(),title:s()("div",{style:{color:d.ZP.red}},void 0,s()(u.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})),onClick:t||this.onSubmit}))},action:this.onSubmit}]}]},"main list"))}canSubmit(){const{state:e}=C.Z;if(e.open){const{reason:t}=e;return void 0!==t}return!1}renderDesktopModal(e){if(!e.open)return;const{reason:t}=e;return s()(k.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>s()("div",{style:this.getModalWrapStyle()},void 0,s()("div",{style:this.modalTitleStyle},void 0,s()(u.FormattedMessage,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})),s()("div",{style:{paddingBottom:12}},void 0,s()(B.Z,{title:s()(u.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,w.UY)("contentPolicy"),analyticsFrom:"report_page"})),s()("div",{},void 0,this.renderOptionButtons(e)),t&&s()(T.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:b.default.formatMessage(D.additionalInformationPlaceholder),onChange:t=>{C.Z.setState({...e,additionalInformation:t.target.value})}}),s()("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18}},void 0,s()(P.Z,{isLarge:!0,onClick:this.handleCancel,style:{marginRight:12}},void 0,s()(u.FormattedMessage,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})),s()(P.Z,{isRed:!0,isLarge:!0,onClick:this.onSubmit,disabled:!this.canSubmit(),disabledFeedback:!0},void 0,s()(u.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"}))))})}renderOffline(){return s()("div",{style:this.getOfflineStyle()},void 0,s()(u.FormattedMessage,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"}))}getModalWrapStyle(){return{width:360,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}getTextAreaStyle(){const{device:e}=this.environment;return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:e.isMobile?16:"10px 12px",height:e.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:e.isMobile?16:14}}}R.displayName="ReportPageModal";const L=R},30761:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var n=i(77094),a=i.n(n),o=(i(67294),i(480)),s=i(24405),r=i(22346),l=i(92222);function d(e){window.__c={n:"SidebarConnectionsModal"};const t=(0,o.Fy)(),i=(0,s.yK)((e=>({modal:{width:t.isMobile?"auto":890,height:t.isMobile?"auto":606,borderRadius:8}})),[t.isMobile]);return a()(r.Z,{open:e.modalOpened,innerStyle:i.modal,onDismiss:e.onModalClose,render:()=>a()("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"}},void 0,a()(l.Z,{location:"sidebar-modal"}))})}},29652:(e,t,i)=>{i.r(t),i.d(t,{MembersTabTitle:()=>yt,PeopleRow:()=>ft,SettingToggle:()=>bt,SidebarTeamModal:()=>vt});var n=i(77094),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(97880),p=i(82990),m=i(5366),g=i(50906),h=i(93678),f=i(43250),v=i(23537),y=i(92350),b=i(27832),S=i(85057),w=i(48690),M=i(3386),C=i(22346),k=i(76798),T=i(18647),_=i(24006),I=i(58032),x=i(64369),Z=i(29302),P=i(13490),F=i(66957),A=i(30040),B=i(58260),E=i(97464),D=i.n(E),R=i(8848),L=i(3779),O=i(64964),N=i(57688),V=i(30149),U=i(33929),W=i(78122),z=i(63409),K=i(35901),q=i(25464),H=i(42922),G=i(36488),j=i(74194),$=i(56664),Y=i(51923),Q=i(93686),X=i(37708),J=i(38755),ee=i(65426);const te=(0,m.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access",description:"All teamspace members have full permission access by default."},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit",description:"All teamspace members have edit-level access to teamspace pages by default."},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment",description:"All teamspace members have comment-level access to teamspace pages by default."},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view",description:"All teamspace members have view-level access to teamspace pages by default."}}),ie=(0,m.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access",description:"Everyone in the workspace has full access. Sometimes shown after message describing access level for team members."},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit",description:"Everyone in the workspace has edit-level access. Sometimes shown after message describing access level for team members."},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment",description:"Everyone in the workspace has comment-level access. Sometimes shown after message describing access level for team members."},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view",description:"Everyone in the workspace has view-level access. Sometimes shown after message describing access level for team members."},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access",description:"Everyone in the workspace does not have access. Sometimes shown after message describing access level for team members."}});function ne(e){let{teamStore:t}=e;const i=(0,c.yK)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),[n,o]=(0,d.AF)(w.Z),s=w.a.Members,l=(0,d.VK)((()=>t.getTeamAccessLevel()),[t]);return r.createElement(r.Fragment,null,a()("div",{style:i.spacer}),a()(X.Ph,{title:a()(m.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions",description:"Overview of teamspace permissions."}),rows:[a()(ee._,{currentAccessLevel:l,teamStore:t,disabledWithRightChevron:!0,style:i.accessLevelButton},"visibility"),a()(ae,{teamStore:t},"permissions")],onClick:()=>{n.open&&o({...n,tab:s})},itemStyle:i.listItem}))}function ae(e){let{teamStore:t}=e;window.__c={n:"PermissionsRow"};const i=(0,d.VK)((()=>b.default.state.currentSpaceStore),[]),n=(0,l.O7)(),o=(0,c.yK)((e=>({label:{color:e.regularTextColor,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),s=(0,d.VK)((()=>t.getTeamPermission()||{type:"team_permission",role:"none"}),[t]),u=(0,d.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:p,spaceName:m}=(0,d.VK)((()=>{if(!i)return{spaceIcon:void 0,spaceName:void 0};const e=(0,J.rn)(n,i);return{spaceIcon:a()(Q.p,{disabled:!0,store:i,size:20,style:o.icon}),spaceName:e}}),[i,n,o.icon]),g=(0,d.VK)((()=>a()(Q.p,{disabled:!0,store:t,size:20,style:o.icon})),[t,o.icon]),h=!(s.role===u.role),f=h?g:p,v=U.default.formatMessage(ie[u.role],{showTeam:h,spaceName:m}),y=U.default.formatMessage(te[s.role]);return a()("div",{style:o.row},void 0,f,a()(x.Z,{isSmall:!0,style:o.label},void 0,h&&r.createElement(r.Fragment,null,y,a()("span",{style:{marginLeft:5,marginRight:5}},void 0,"•")),v))}var oe=i(45660),se=i(89728),re=i(91718),le=i(27006),de=(i(59730),i(26825));const ce=["none","reader","comment_only","read_and_write","editor"],ue=["reader","comment_only","read_and_write"],pe=["reader","comment_only","read_and_write","editor"],me=["editor"];function ge(e){const t=function(e){var t,i;let{teamId:n,permissions:a}=e;const o=(null===(t=a.find((e=>(0,le.ix)(e))))||void 0===t?void 0:t.role)??"none",s=(null===(i=a.find((e=>(0,le.zU)(e)&&e.team_id===n)))||void 0===i?void 0:i.role)??o,r=a.find((e=>(0,le.bm)(e)));return{spacePermission:{type:"space_permission",role:o},teamMemberPermission:{type:"explicit_team_permission",team_id:n,role:s},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:n,role:"editor"},...r&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:n,role:r.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:i,teamMemberPermission:n}=t,a={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},o={spacePermission:fe({roles:ce,currentRole:n.role}),teamGuestPermission:ue,teamMemberPermission:he({roles:pe,currentRole:i.role}),teamOwnerPermission:me},{visibility:s,space_member_join_access:r}=e.settings;return"team_members"===s&&(a.space_member_join_access=["invite_only"],o.spacePermission=["none"]),"self_join"===r&&(a.visibility=["space_members"],a.invite_access=["team_members"],o.spacePermission=o.spacePermission.filter((e=>"none"!==e))),e.is_default&&(o.teamMemberPermission=[n.role],o.spacePermission=[n.role]),{settingsOptions:a,permissionItemRoleOptions:o,currentTeamPermissionItems:t}}function he(e){let{roles:t,currentRole:i}=e;return t.filter((e=>(0,de.IF)(e,i)))}function fe(e){let{roles:t,currentRole:i}=e;return t.filter((e=>(0,de.SL)(e,i)))}var ve=i(4708),ye=i(60709),be=i(98742),Se=i(52275),we=i(31945),Me=i(78140),Ce=i(9342),ke=i(72495);function Te(e){let{teamStore:t}=e;window.__c={n:"TeamSecuritySection"};const{teamSettings:i,isInviteToggleVisible:n}=(0,d.VK)((()=>({teamSettings:t.getSettingsStore().getValue(),isInviteToggleVisible:(0,ve.s$)()})),[t]),o=(0,d.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return ge({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!i||!o)return null;const s=[a()(Ie,{teamStore:t,hasMultiInviteAccessOptions:1===o.settingsOptions.invite_access.length,inviteAccess:i.invite_access},"invite"),a()(_e,{teamStore:t,disablePageEdits:i.disable_team_page_edits},"editSidebar")];return n&&s.push(a()(xe,{teamStore:t},"toggleInviteLink")),a()(X.Ph,{title:a()(m.FormattedMessage,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security",description:"Security settings for the whole teamspace."}),rows:s,hideDividers:!0})}function _e(e){window.__c={n:"EditSidebarPermissionRow"};const{teamStore:t,disablePageEdits:i}=e,n=(0,l.O7)(),o=(0,y.TE)(t),s=(0,d.VK)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),c=(0,r.useCallback)((e=>{V.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:n,perform:i=>{N.$x({environment:n,store:t,update:{disable_team_page_edits:e},transaction:i})}})}),[n,t]),u=(0,le.J5)(s),p=[{option:!0,label:a()(m.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners",description:"Only team owners can edit teamspace sidebar pages."}),action:()=>c(!0)}];return u&&p.push({option:!1,label:a()(m.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member",description:"Any teamspace member can edit teamspace sidebar pages."}),action:()=>c(!1)}),a()(Ze,{title:a()(m.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar",description:"Decide who in the team can edit the teamspace sidebar section"}),caption:a()(m.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages",description:"Actions possible when the teamspace edit pages setting is enabled"}),disabled:o||!u,currentOption:!u||Boolean(i),allOptions:p,optionTooltip:u?void 0:a()(m.FormattedMessage,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar",description:"Tooltip telling user why they can't change this option."})})}function Ie(e){window.__c={n:"InvitePermissionRow"};const{teamStore:t,hasMultiInviteAccessOptions:i,inviteAccess:n}=e,o=(0,y.ql)(t),s=(0,l.O7)(),d=(0,r.useCallback)((e=>{V.createAndCommit({userAction:"team.setInviteAccess",environment:s,perform:i=>{N.$x({environment:s,store:t,update:{invite_access:e},transaction:i})}})}),[s,t]),c=!o||i;return a()(Ze,{title:a()(m.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite teamspace members",description:"Decide who in the teamspace can invite other members"}),disabled:c,optionTooltip:c&&o&&a()(m.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members",description:"Tells the user that they need to change teamspace permissions to Closed or Private to change this setting of who can invite teamspace members."}),currentOption:n,allOptions:[{option:"team_members",label:a()(m.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member",description:"Any teamspace member can invite others."}),action:()=>d("team_members")},{option:"team_owners",label:a()(m.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners",description:"Only teamspace owners can invite others."}),action:()=>d("team_owners")}]})}function xe(e){window.__c={n:"ToggleInviteLinkRow"};const{teamStore:t}=e,i=(0,l.O7)(),n=(0,d.VK)((()=>v.U2(t)),[t]),o=(0,y.TE)(t),s=(0,c.yK)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return a()("div",{style:s.container},void 0,a()("div",{},void 0,a()(x.Z,{},void 0,a()(m.FormattedMessage,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link",description:"Title for teams invite link setting"})),a()(x.Z,{isSmall:!0,style:s.subtitle},void 0,a()(m.FormattedMessage,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link",description:"Description for the invite link setting"}))),a()("div",{style:s.switcher},void 0,a()(_.Z,{disabled:o,on:!n,onClick:()=>{V.createAndCommit({userAction:"team.setInviteAccess",environment:i,perform:e=>{N.$x({environment:i,store:t,update:{disable_invite_link:!n},transaction:e})}})}})))}function Ze(e){window.__c={n:"SettingSelect"};const{title:t,caption:i,currentOption:n,allOptions:o,disabled:s,optionTooltip:d}=e,u=(0,l.Fy)(),p=(0,c.yK)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),m=o.find((e=>e.option===n));return m?a()("div",{style:p.root},void 0,a()("div",{style:p.title},void 0,t,i&&a()(x.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5}},void 0,i)),a()(I.Z,{style:p.tooltipWidth,placement:q.u.Top,alignment:I.Z.Alignment.Start,textWrap:!0,disableTooltip:!d,renderTooltip:()=>d,render:e=>r.createElement(we.Z,D()({},e,{disablePopup:s,popupType:u.isMobile?we.Z.PopupType.SlideUp:we.Z.PopupType.Popup,alignmentToOrigin:we.Z.Alignment.End,renderOrigin:t=>r.createElement(se.Z,D()({style:p.buttonStyle,disabled:s},(0,be.Z)(e,t)),m.label,!s&&L.Z.chevronDown(p.chevron)),render:e=>{let t;t=u.isMobile?{menuType:ye.og.ActionSheet}:{menuType:ye.og.Popup,minWidth:150};const i=[{key:"options",render:e=>r.createElement(ke.Z,e),items:o.map((t=>({key:t.option.toString(),render:e=>r.createElement(Se.Z,D()({},e,{title:t.label,caption:t.caption,checkState:n===t.option})),action:()=>{t.action(),e.close()}})))}];return r.createElement(Me.Z,t,a()(Ce.Z,{type:Ce.i.Vertical,initialFocus:void 0,sections:i}))}}))})):null}function Pe(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsSecurity"};const{currentSpaceStore:i}=(0,d.Kw)(b.default),n=(0,l.O7)(),o=(0,oe.D)(),s="business",c=n.currentUser.id,u=(0,d.VK)((()=>({disable_public_access:{spaceIsDisabled:(null==i?void 0:i.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess()},disable_export:{spaceIsDisabled:(null==i?void 0:i.getDisableExport())??!1,teamIsDisabled:t.getDisableExport()},disable_guests:{spaceIsDisabled:(null==i?void 0:i.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests()},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits()}})),[i,t]),p=(0,y.ql)(t),g=(0,d.VK)((()=>(null==i?void 0:i.canAdmin())??!1),[i]);if(!i)return null;if(!c)return null;const h=e=>o&&!u[e].teamIsDisabled,f=e=>{if(h(e))return!1;if(!p)return!1;return!(e=>u[e].spaceIsDisabled&&u[e].teamIsDisabled)(e)||g},v=e=>h(e)&&g,S=e=>{const{teamIsDisabled:i,spaceIsDisabled:a}=u[e],o=!i;N.d({environment:n,store:t,settingName:e,newTeamSettingValue:Ee(o),spaceSettingValue:void 0===a?void 0:Ee(a)})},w=e=>{if((e=>u[e].spaceIsDisabled)(e))return(e=>u[e].teamIsDisabled)(e)?a()(m.FormattedMessage,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",description:"Text explaining that a setting is inherited from the workspace settings.",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>a()("span",{style:{textDecoration:"underline"}},void 0,e)}}):a()(m.FormattedMessage,{id:"teamSettingsSecurity.overridesWorkspaceSettings",description:"Text explaining that a setting overrides the workspace settings.",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>a()("span",{style:{textDecoration:"underline"}},void 0,e)}})},M=a()(re.Z,{subscriptionTier:s,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),C=a()(m.FormattedMessage,{id:"teamSettingsSecurity.setting.businessGateToggleTooltip",defaultMessage:"Upgrade to Business Plan to change security settings",description:"Shown when a user requires upgrade to change security setting."}),k=[a()(bt,{on:u.disable_public_access.teamIsDisabled,disabled:!f("disable_public_access"),onChange:()=>S("disable_public_access"),shouldTriggerUpsell:v("disable_public_access"),secondCaption:w("disable_public_access"),title:r.createElement(r.Fragment,null,a()(m.FormattedMessage,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable public page sharing",description:"Disable public page sharing for the teamspace"}),h("disable_public_access")&&M),tooltip:h("disable_public_access")&&C}),a()(bt,{on:u.disable_guests.teamIsDisabled,disabled:!f("disable_guests"),onChange:()=>S("disable_guests"),shouldTriggerUpsell:v("disable_guests"),secondCaption:w("disable_guests"),title:r.createElement(r.Fragment,null,a()(m.FormattedMessage,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests",description:"Disable guests for this teamspace"}),h("disable_guests")&&M),tooltip:h("disable_guests")&&C}),a()(bt,{on:u.disable_export.teamIsDisabled,disabled:!f("disable_export"),onChange:()=>S("disable_export"),shouldTriggerUpsell:v("disable_export"),secondCaption:w("disable_export"),title:r.createElement(r.Fragment,null,a()(m.FormattedMessage,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export",description:"Disable export for this team"}),h("disable_export")&&M),tooltip:h("disable_export")&&C})];return a()(Fe,{teamStore:t,toggles:k})}function Fe(e){let{teamStore:t,toggles:i}=e;const n=(0,c.yK)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]),o=a()(m.FormattedMessage,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security",description:"Security settings for the pages in the teamspace."});return r.createElement(r.Fragment,null,a()(Te,{teamStore:t}),a()("div",{style:n.spacer}),a()(X.Ph,{title:o,rows:i,hideDividers:!0}),a()(Y.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:n.learnMoreLinkContainer,message:a()(m.FormattedMessage,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security",description:"Link text that shows in the security tab of the teamspaces settings modal. When the user clicks the link, they are taken to a reference with more information about teamspaces security and permissions."})}))}function Ae(e){const t=(0,l.O7)();return r.createElement(r.Fragment,null,a()(se.Z,{style:e.style,icon:e=>L.Z.archive({...e,margin:"2px 17px 2px 2px",width:16,height:16}),onClick:()=>(e=>{let{teamStore:i,teamName:n}=e;return N.YH({environment:t,teamStore:i,teamName:n,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStoreInstance})},void 0,a()("div",{},void 0,a()(x.Z,{},void 0,a()(m.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})),a()(x.Z,{isSmall:!0,style:{whiteSpace:"normal"}},void 0,a()(m.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})))))}function Be(e){window.__c={n:"ArchiveTeamButton"};const t=(0,l.O7)(),i=(0,c.yK)((()=>({archiveLabel:{color:R.ZP.red}})),[]);return r.createElement(se.Z,D()({style:e.style,isRed:!0,icon:e=>L.Z.archive({...e,margin:"2px 17px 2px 2px",width:16,height:16}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:()=>e.disabled?void 0:async function(e){let{teamStore:t,environment:i}=e;await N.aQ({environment:i,teamStore:t,from:"sidebar_team_modal"})}({environment:t,teamStore:e.teamStoreInstance})},e.tooltipEvents),a()("div",{},void 0,a()(x.Z,{style:i.archiveLabel},void 0,a()(m.FormattedMessage,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace",description:"Archive teamspace"})),a()(x.Z,{isSmall:!0,style:{whiteSpace:"normal"}},void 0,a()(m.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members",description:"Explains that archiving the team will result in the teamspace being removed from sidebar."}))))}function Ee(e){return e?"disable":"allow"}const De=(0,m.defineMessages)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description",description:"Shown in teamspace settings for teamspace members when there is no teamspace description."}});function Re(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsGeneral"};const i=(0,l.O7)(),n=(0,d.VK)((()=>b.default.state.currentSpaceStore),[]),o=(0,y.TE)(t),[s,u]=(0,r.useState)(void 0),[p,g]=(0,r.useState)(void 0),h=(0,c.yK)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[f,v]=(0,d.VK)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===f)return null;const S=f||"",w=v??"",M=w.length>0,C=null==s?void 0:s.trim(),k=null==p?void 0:p.trim(),T=""===C||(void 0===p||k===w.trim())&&(void 0===s||C===S.trim()),_=a()(m.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name",description:"Icon and name for teamspace."}),I=a()("div",{style:h.nameAndIconWrap},void 0,a()(Q.p,{disabled:o,store:t,style:h.icon,size:20,onChange:e=>{V.createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:i,perform:i=>{N.fs({store:t,update:{icon:e},transaction:i})}})}}),o?a()(x.Z,{},void 0,S):a()(Le,{value:s??S,style:h.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:o,placeholder:"Acme Labs"})),Z=a()(m.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description",description:"Description for teamspace."}),P=U.default.formatMessage(De.noDescription),F=o?a()(x.Z,{isMultiline:!0,isSecondaryColor:!M},void 0,M?w:P):a()(Le,{value:void 0===p?w:p,onBlur:e=>{g(e)},onChange:e=>{g(e)},disabled:o,textarea:!0,autosize:!0,placeholder:P,style:h.description}),A=[r.createElement(r.Fragment,null,a()(x.Z,{isSmall:!0},void 0,_),I),r.createElement(r.Fragment,null,a()(x.Z,{isSmall:!0},void 0,Z),F)];return a()("div",{style:h.container},void 0,a()(X.Ph,{title:a()(m.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details",description:"Basic details for teamspace."}),rows:A}),!o&&a()(H.Z,{style:h.updateButton,disabled:T,isLarge:!0,onClick:async()=>{if(T)return;if(C&&C!==S.trim()){if(!(await(0,W.Xg)({environment:i,spaceStore:n,teamName:C})))return}const{performResult:e,serverCommitResult:o}=V.createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:i,perform:e=>{N.fs({store:t,update:{name:C??S,description:k??w},transaction:e})}});try{await Promise.all([e,o])}catch(s){return}O.oV({label:a()(m.FormattedMessage,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details",description:"Tells the user that the changes they made to the team settings were successfully made."})})}},void 0,a()(m.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})),a()("br",{}),a()(ne,{teamStore:t}),a()(Oe,{teamStore:t}),a()(Y.Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:h.learnMoreLinkContainer}))}function Le(e){window.__c={n:"EditableInput"};const{value:t,style:i,onBlur:n,onChange:o,placeholder:s,disabled:l}=e,[d,c]=(0,r.useState)(!1),u=(0,r.useRef)(null);return a()(G.Z,{capture:d,render:a=>r.createElement(j.Z,D()({textarea:e.textarea,autosize:e.autosize,ref:u,onFocus:e=>{c(!0)},onBlur:e=>{c(!1),n(e.target.value)},onChange:e=>{c(!1),o&&o(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:s,disabled:l,value:t,style:i},a))})}function Oe(e){let{teamStore:t}=e;const i=(0,c.yK)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:X.MQ,paddingBottom:X.MQ,paddingLeft:X.oM,paddingRight:X.oM}})),[]),[n,o]=(0,d.VK)((()=>[t.getName(),t.isArchived()]),[t]),s=(0,d.VK)((()=>b.default.state.currentSpaceStore),[]),l=(0,y.ql)(t),u=(0,y.e4)(t),p=(0,K.y)(t.id),g=(0,z.n)(s),h=p&&!g;if(void 0===n||!u)return null;const f=[],v=a()($.Z,{buttonInternals:a()(Ne,{isTeamOwner:l}),teamStore:t,placement:q.u.Bottom,alignment:q.v.Start,from:"sidebar_team_modal",style:i.buttonStyle,icon:e=>L.Z.leaveArrow({...e,margin:"2px 17px 2px 2px",width:16,height:16}),isRed:!l});if(f.push(v),l)if(o)f.push(a()(Ae,{teamStoreInstance:t,teamName:n,style:i.buttonStyle}));else{const e=a()(I.Z,{disableTooltip:!h,placement:q.u.Bottom,alignment:q.v.Start,renderTooltip:()=>a()(m.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace.",description:"Tells the user that they're unable to archive this teamspace due to stated reason."}),render:e=>a()(Be,{disabled:h,teamStoreInstance:t,tooltipEvents:e,style:i.buttonStyle})});f.push(e)}return r.createElement(r.Fragment,null,a()("div",{style:{height:20,width:"100%"}}),a()(X.Ph,{title:a()(m.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:f,itemStyle:{padding:0,margin:0}}))}function Ne(e){let{isTeamOwner:t}=e;window.__c={n:"LeaveTeamButton"};const i=(0,c.yK)((()=>({label:{color:t?"inherit":R.ZP.red}})),[t]);return a()("div",{},void 0,a()(x.Z,{style:i.label},void 0,a()(m.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace",description:"Allows the user to leave the teamspace."})),a()(x.Z,{isSmall:!0,style:{whiteSpace:"normal"}},void 0,a()(m.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar",description:"Explains that leaving the team will result in the teamspace being removed from sidebar."})))}var Ve=i(77907),Ue=i(33052);function We(e){let{teamStore:t}=e;window.__c={n:"TeamFilterAndAddMemberRow"};const i=(0,c.yK)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),n=(0,m.useIntl)(),[o,s]=(0,d.AF)(w.Z),[l,u,p]=(0,d.AF)(void 0,Ue.Z),g=(0,y.ef)(t);return a()("div",{style:i.container},void 0,a()(Ve.LazyTeamPermissionsInviteWithModal,{store:t,permissionsInviteStore:p,origin:a()(I.Z,{placement:I.Z.Placement.Left,alignment:I.Z.Alignment.Start,textWrap:!0,renderTooltip:()=>g?a()("div",{style:{width:"max-content",maxWidth:150}},void 0,a()(m.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups",description:"Message that tells the user that they can add members and groups via this button."})):a()("div",{style:{width:220}},void 0,a()(m.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace",description:"Message that tells the user that they cannot add members to this team since they do not have permissions."})),render:e=>r.createElement(H.Z,D()({disabled:!g,isLarge:!0,onClick:()=>{u({...l,modalOpen:!0})}},e),a()(m.FormattedMessage,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"}))})}),a()(j.Z,{placeholder:n.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…",description:"Search input text shown in team settings for filtering groups and members in a team."}),style:i.input,value:o.memberFilterQuery,onChange:e=>{s({...o,memberFilterQuery:e.target.value,limitMembers:!0})},left:L.Z.searchThick(i.searchIcon),showClearButton:!0,format:j.Z.Format.Small}))}var ze=i(34437);function Ke(e){let{teamStore:t}=e;window.__c={n:"TeamMembersListSection"};const i=(0,c.yK)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return a()("div",{style:i.content},void 0,a()(We,{teamStore:t}),a()(ze.I,{store:t}))}var qe=i(64684),He=i(79362),Ge=i(29369),je=i(7567),$e=i(75584);function Ye(e){window.__c={n:"TeamGuestsPermissionRow"};const{teamStore:t}=e,i=(0,l.O7)(),n=(0,m.useIntl)(),{teamGuestPermissionItem:o,teamPermissions:s}=(0,d.VK)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),r=(0,y.TE)(t),u=(0,d.VK)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:n.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access.",description:"Tooltip explaining why team guests cannot have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[n]),p=(0,c.yK)((e=>({button:{fontSize:12.5,marginRight:0,color:e.mediumTextColor}})),[]),g=o&&a()(je.Z,{role:o.role,table:Ge.e0,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:r,buttonStyle:p.button,availableRoleItems:u,onChange:async e=>{if(s.filter((t=>((0,le.jg)(t)||(0,le.hV)(t))&&(0,de.xO)(e,t.role))).length>0){if(!(await(0,W.Bt)()))return}V.createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:i,perform:n=>{N.$J({environment:i,teamStore:t,newRole:e,transaction:n,permissionsToClear:[]})}})}}),h=(0,d.VK)((()=>t.getName()),[t]),f=(0,d.VK)((()=>t.getIcon()),[t]),v=f&&He.V2(f.icon)?He.mk(f.icon):"gray",b=f?{...f,icon:`/icons/user-circle_${v}.svg`}:void 0,S=a()(Q.p,{disabled:!0,store:t,size:X.Kt,icon:b});return g?a()($e.p,{permissionRoleSelectComponent:g,iconComponent:S,name:Qe(h)}):null}function Qe(e){return a()(m.FormattedMessage,e?{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",description:"Title for teamspace guest permission",values:{teamName:e}}:{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName",description:"Title for teamspace guest permission when teamspace name is not available."})}function Xe(e){window.__c={n:"TeamMembersPermissionRow"};const{teamStore:t}=e,i=(0,l.O7)(),n=(0,c.Fg)(),o=(0,m.useIntl)(),{teamPermissionItem:s,teamPermissions:r}=(0,d.VK)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=(0,y.TE)(t),p=(0,d.VK)((()=>{var e;const i=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),n=o.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members",description:"Tooltip explaining why you can't set a teamspace permission to something lower."});function a(e){return i&&e!==i.role&&(0,de.nl)(e,i.role)===i.role&&!t.isDefault()?{isDisabled:!0,disabledMessage:n}:void 0}return[{role:"editor",disabledInfo:a("editor")},{role:"read_and_write",disabledInfo:a("read_and_write")},{role:"comment_only",disabledInfo:a("comment_only")},{role:"reader",disabledInfo:a("reader")}]}),[o,t]),g=s&&a()(je.Z,{role:s.role,table:Ge.e0,type:(0,le.zU)(s)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:n.mediumTextColor},availableRoleItems:p,onChange:async e=>{const n=r.filter((t=>((0,le.jg)(t)||(0,le.hV)(t))&&(0,de.xO)(e,t.role)));if(n.length>0){if(!(await(0,W.Bt)()))return}V.createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:i,perform:a=>{N.xI({environment:i,teamStore:t,newRole:e,transaction:a,permissionsToClear:n})}})}}),{teamName:h}=(0,d.VK)((()=>({teamName:t.getName()})),[t]),f=a()(Q.p,{disabled:!0,store:t,size:X.Kt});return a()($e.p,{permissionRoleSelectComponent:g,iconComponent:f,name:Je(h)})}function Je(e){return a()(m.FormattedMessage,e?{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",description:"Title for teamspace member permission",values:{teamName:e}}:{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName",description:"Title for teamspace member permission when teamspace name is not available."})}var et=i(19889),tt=i(62512);function it(e){window.__c={n:"TeamOwnersPermissionRow"};const{teamStore:t,teamOwnerIds:i}=e,n=(0,c.Fg)(),o=(0,d.VK)((()=>t.getName()),[t]),s=(0,d.VK)((()=>t.getTeamOwnerPermission()),[t]),r=(0,d.VK)((()=>b.default.state.currentUserStore),[]),l=(0,d.VK)((()=>r?i.map((e=>S.U6.createChildStore(r,{table:et.KJ,id:e}))):[]),[r,i]);return a()($e.p,{tooltip:a()(m.FormattedMessage,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default",description:"Tooltip explaining why you can't modify teamspace owners' team role."}),permissionRoleSelectComponent:a()(je.Z,{role:"editor",table:Ge.e0,type:s&&(0,le.LW)(s)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:n.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:a()(tt.n,{teamStore:t,ownerStores:l,isSmall:!0}),name:nt(o)})}function nt(e){return a()(m.FormattedMessage,e?{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",description:"Title for teamspace owner permission",values:{teamName:e}}:{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName",description:"Title for teamspace owner permission when teamspace name is not available."})}var at=i(10279);function ot(e){window.__c={n:"TeamSpacePermissionRow"};const{teamStore:t}=e,i=(0,l.O7)(),n=(0,d.VK)((()=>b.default.state.currentSpaceStore),[]),{iconComponent:o,spaceName:s}=(0,d.VK)((()=>{if(!n)return{iconComponent:void 0,spaceName:void 0};const e=(0,J.rn)(i,n);return{iconComponent:a()(Q.p,{disabled:!0,store:n,size:X.Kt}),spaceName:e}}),[n,i]);return a()($e.p,{permissionRoleSelectComponent:a()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},void 0,a()(rt,{teamStore:t})),iconComponent:o,name:st(s)})}function st(e){return a()(m.FormattedMessage,e?{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}:{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function rt(e){const{teamStore:t}=e,i=(0,l.O7)(),n=(0,c.Fg)(),o=(0,d.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),u=(0,y.TE)(t),p=(0,d.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return ge({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!p)return null;const g=p.permissionItemRoleOptions.spacePermission;if(1===g.length&&"none"===g[0])return a()(I.Z,{renderTooltip:()=>a()(m.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",description:"Permission tooltip showing that when a team is private, pages cannot be shared with the workspace.",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>r.createElement("div",D()({style:{display:"flex",alignItems:"center",maxWidth:170}},e),L.Z.lockedFilled({width:14,height:14,fill:n.timelineRed,marginRight:4}),a()("div",{style:{fontSize:12.5,color:n.timelineRed,marginRight:8}},void 0,a()(m.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",description:"Permission label showing that for private teams, non-team members will have no access to the team.",defaultMessage:"No access • Invite only"})))});{const e=s().sortBy(g,(e=>-le.xm[e])).map((e=>({role:e})));return a()(je.Z,{role:o.role,table:Ge.e0,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:u||1===g.length,buttonStyle:{fontSize:12.5,marginRight:0,color:n.mediumTextColor},availableRoleItems:e,onChange:e=>{const n={...o,role:e};V.createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:i,perform:e=>{at.ep({environment:i,store:t,permissionItems:[n],transaction:e})}})}})}}function lt(e){let{teamStore:t}=e;window.__c={n:"TeamPermissionRowsSection"};const i=(0,d.VK)((()=>t.isDefault()),[t]),n=(0,d.VK)((()=>(0,qe.XO)({membership:t.getMembers()})),[t]),o=(0,d.VK)((()=>{const e=b.default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!i&&(0,ve.F$)())}),[i]),s=(0,c.yK)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return a()("div",{style:s.container},void 0,a()(it,{teamStore:t,teamOwnerIds:n},"0"),a()(Xe,{teamStore:t},"1"),o&&a()(Ye,{teamStore:t},"2"),!i&&a()(ot,{teamStore:t},"3"))}var dt=i(49469);function ct(e){let{teamStore:t}=e;const i=(0,c.yK)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return r.createElement(r.Fragment,null,a()(ut,{teamStore:t}),a()("div",{style:i.spacer}),a()(dt.z,{title:a()(m.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members",description:"Title for members section of teamspace settings."}),style:i.heading}),a()(Ke,{teamStore:t}))}function ut(e){let{teamStore:t}=e;const i=(0,l.O7)(),n=(0,d.VK)((()=>t.getName()),[t]),o=(0,c.yK)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),s=(0,r.useCallback)(((e,a)=>{N.Ju({environment:i,accessLevel:e,isDefault:a,store:t,teamName:n,from:"sidebar_team_modal"})}),[i,t,n]),u=(0,d.VK)((()=>t.getTeamAccessLevel()),[t]),p=[a()(ee._,{teamStore:t,currentAccessLevel:u,onChange:s,style:o.accessButton},"visibility"),a()(lt,{teamStore:t},"permissions")];return r.createElement(r.Fragment,null,a()(X.Ph,{title:a()(m.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions",description:"Title for permissions section of teamspace settings."}),rows:p,itemStyle:o.teamSettingsListItems}),a()(Y.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:a()(m.FormattedMessage,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions",description:"Link text that shows in the permissions tab of the teamspaces settings modal. When the user clicks the link, they are taken to a reference with more information about teamspaces security and permissions."}),containerStyle:o.learnMoreLinkContainer}))}var pt=i(74136);function mt(e){return window.__c={n:"UnownedTeamPill"},r.createElement(pt.Z,e,a()(m.FormattedMessage,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned",description:"Unowned badge to indicate that this team is an unowned team, i.e. a team with no owners."}))}function gt(e){const{teamStore:t}=e,i=(0,d.VK)((()=>w.Z.state.tab),[]);if(void 0===i)return null;switch(i){case w.a.General:return a()(Re,{teamStore:t});case w.a.Members:return a()(ct,{teamStore:t});case w.a.Security:return a()(Pe,{teamStore:t});default:(0,u.t1)(i)}}function ht(e){window.__c={n:"UserWithAvatar"};const{userId:t,currentSpaceStore:i}=e,{userStore:n,isDefined:o}=(0,d.VK)((()=>{const e=S.U6.createChildStore(i,{table:"notion_user",id:t,spaceId:i.id});return{userStore:e,isDefined:e.isDefined()}}),[i,t]);return o?a()(Z.Z,{avatarShouldShowShadow:!0,userStore:n,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function ft(e){const{userIds:t,label:i,hasMarginTop:n}=e,o=(0,d.VK)((()=>b.default.state.currentSpaceStore),[]);return o?r.createElement(r.Fragment,null,a()(P.Z,{hasMarginTop:n},void 0,i),t.map((e=>a()(ht,{userId:e,currentSpaceStore:o},e)))):null}function vt(){window.__c={n:"SidebarTeamModal"};const e=(0,l.O7)(),t=(0,d.VK)((()=>b.default.state.currentSpaceStore),[]),i=(0,d.VK)((()=>b.default.state.currentSpaceViewStore),[]),n=(0,l.Fy)(),o=(0,c.yK)((e=>({modal:{width:n.isMobile?"auto":630,height:n.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:p.Z.fontWeight.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:p.Z.fontWeight.regular,textTransform:"unset",fontSize:11}})),[n.isMobile]),{open:r,tab:h,teamStore:S}=(0,d.VK)((()=>{const{open:e,tab:t}=w.Z.state;return{open:e,tab:t,teamStore:w.Z.getTeamStore()}}),[]),_=(0,d.VK)((()=>null==S?void 0:S.getSettings()),[S]),I=(0,y.ql)(S);if(!t||!i||!S)return null;const x=[w.a.General,w.a.Members,w.a.Security];return a()(C.Z,{open:r,innerStyle:o.modal,onDismiss:()=>{w.Z.reset()},render:()=>r?a()("div",{className:f.rIj,style:{height:"100%"}},void 0,a()("div",{style:o.modalWrap},void 0,a()(M.Z,{capture:!0,onBackspace:s().identity,onLeft:s().identity,onRight:s().identity,onSelectAll:s().identity,onRedo:s().identity,onUndo:s().identity,onCut:s().identity,onCopy:s().identity,onPaste:s().identity,onKeypress:s().identity,onDelete:s().identity,onTab:s().identity},void 0,a()("div",{style:o.innerWrap},void 0,a()("div",{style:o.header},void 0,a()(Q.p,{disabled:!0,store:S,size:24,style:o.icon}),a()(k.ZP,{store:S,style:{fontSize:16,fontWeight:p.Z.fontWeight.semibold}}),(0,v.C2)(_)&&a()(B.Z,{iconStyle:o.lockIcon}),(0,v.Hu)({membership:S.getRawMembership()})&&a()("div",{style:{gap:5,display:"flex"}},void 0,a()(mt,{desktopStyle:o.unownedPill,mobileStyle:o.unownedPill,innerStyle:o.unownedPillInner})),a()("div",{style:{flexGrow:1}}),a()(A.M,{teamStore:S,onLeavingTeam:()=>w.Z.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})),a()(F.Z,{tabs:x.map((e=>function(e,t){switch(e){case w.a.General:return a()(m.FormattedMessage,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General",description:"General settings for a team"});case w.a.Members:return a()(yt,{teamStore:t});case w.a.Security:return a()(m.FormattedMessage,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security",description:"Security settings for a team"});default:(0,u.t1)(e)}}(e,S))),selectedIndex:(0,u.$K)(h)?x.indexOf(h):1,onChange:t=>{r&&(g.rFP(e,{store:S,tab_old_value:h??w.a.General,tab_new_value:x[t]}),w.Z.update((e=>e.open?{...e,tab:x[t]}:e)))},tabStyle:{marginLeft:-8},style:o.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),a()(T.Z,{type:T.Z.OverflowType.Y,style:o.scroller},void 0,a()("div",{style:o.contentWrap},void 0,a()(gt,{currentSpaceStore:t,teamStore:S,userIsTeamOwner:I}))))))):null})}function yt(e){let{teamStore:t}=e;const i=(0,y.KR)(t),n=(0,c.Fg)();return r.createElement(r.Fragment,null,a()(m.FormattedMessage,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members",description:"Members list for a team with a member count next to it."}),a()("span",{},void 0," "),a()("div",{style:{color:n.lightTextColor}},void 0,i))}function bt(e){let{title:t,caption:i,secondCaption:n,on:o,disabled:s,tooltip:d,style:u,onChange:p,shouldTriggerUpsell:m}=e;const g=(0,l.O7)(),f=(0,c.yK)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:m?"pointer":void 0,...u},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18}})),[u,m]);return r.createElement(r.Fragment,null,a()("div",{style:f.root,onClick:()=>{if(m)return h.y(g,{from:"team_security_settings",for:"business",dontOpenPlansOnCancel:!0})}},void 0,a()("div",{style:f.title},void 0,t,i&&a()(x.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"}},void 0,i),n&&a()(x.Z,{isSmall:!0},void 0,n)),a()("div",{style:f.switcherWrap},void 0,a()(I.Z,{disableTooltip:!d,renderTooltip:()=>d,render:e=>r.createElement("div",e,a()(_.Z,{on:o,disabled:s,onClick:p}))}))))}},63199:(e,t,i)=>{i.r(t),i.d(t,{default:()=>F});var n=i(77094),a=i.n(n),o=i(67294),s=i(83355),r=i(5366),l=i(21325),d=i(27832),c=i(49085);class u extends c.Z{getInitialState(){return{open:!1}}}const p=new u;var m=i(42922),g=i(22346),h=i(63296),f=i(97464),v=i.n(f),y=i(8848),b=i(3779),S=i(24684),w=i(47425),M=i(82990),C=i(95477),k=i(21115),T=i(92083),_=i(27242),I=i(58032);class x extends s.Z{renderComponent(){return o.createElement(o.Fragment,null,b.Z.notionLogoStroked({width:34,height:34,marginBottom:18}),a()("div",{style:{...this.getPrimaryTextStyle(),marginBottom:6}},void 0,this.getPlanTitle()),a()("div",{style:this.getSecondaryTextStyle()},void 0,this.getOneLiner()),this.renderPriceAndTerms(),this.renderBlockLimit(),this.renderPlanFeatures(),this.renderLearnMore())}renderBlockLimit(){const{planInfo:e}=this.props;if("team_free"===e.subscriptionTier)return o.createElement(o.Fragment,null,a()("div",{style:{fontWeight:M.Z.fontWeight.semibold,fontSize:24}},void 0,a()(r.FormattedMessage,{id:"spaceSubscriptionUpgradePlanFeatures.blockLimit.title",defaultMessage:"Free"})),a()("div",{style:this.getSecondaryTextStyle()},void 0,a()(r.FormattedMessage,{id:"spaceSubscriptionUpgradePlanFeatures.blockLimit.description",defaultMessage:"For the first 1,000 blocks"}),a()(I.Z,{renderTooltip:()=>a()(r.FormattedMessage,{id:"spaceSubscriptionUpgradePlanFeatures.blockLimit.tooltip",defaultMessage:"Blocks are pieces of content you add to a page, like a paragraph or to-do item.{br}Some features on the Team Plan are not available on the Team Trial.",values:{br:a()("br",{})}}),placement:I.Z.Placement.Top,render:e=>o.createElement("span",e,b.Z.help({marginLeft:6,width:14,fill:y.ZP.mediumIconColor,verticalAlign:"middle",display:"inline-block"}))})))}renderPriceAndTerms(){const{planInfo:e,intl:t}=this.props;if("team_free"!==e.subscriptionTier)return o.createElement(o.Fragment,null,a()("div",{style:this.getPrimaryTextStyle()},void 0,a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.price",defaultMessage:"{price}",description:"Price is already formatted, e.g. $10",values:{price:(0,k._B)({subscriptionTier:e.subscriptionTier,intl:t})[e.billingInterval]}})),a()("div",{style:this.getSecondaryTextStyle()},void 0,this.getFormattedTerm()))}getFormattedTerm(){const{planInfo:e,intl:t}=this.props,i=(0,S.MZ)(C.Z,t),n={personal:i.terms.pro,team:i.terms.team,plus:i.terms.plus,business:i.terms.business,enterprise:i.terms.enterprise}[e.subscriptionTier];return{per_month:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.perMonthPricing.label",defaultMessage:"per month",description:"Appears after the price per month for a given plan, e.g. $10 per month"}),per_member_per_month:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.perUserPerMonthPricing.label",defaultMessage:"per member, per month",description:"Appears after the price per member, per month for a given plan, e.g. $10 per member, per month"})}[n]}renderPlanFeatures(){const{planInfo:e}=this.props;return o.createElement(o.Fragment,null,a()(I.Z,{delayThreshold:0,placement:I.Z.Placement.Left,renderTooltip:()=>this.renderPreviousPlanTierFeatures(),render:e=>o.createElement("span",v()({},e,{style:{cursor:"help",fontSize:14,borderBottom:`1px dotted ${this.theme.lightTextColor}`}}),a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.features",defaultMessage:"<span>Everything in {planName},</span> plus:",description:"Shown when comparing plan tier features in upgrade modal; 'planName' will be Personal, Team Trial, or Team",values:{span:e=>a()("span",{style:{paddingBottom:1}},void 0,e),planName:this.getPreviousPlanName()}}))}),this.getFeaturesByPlanKey(e.subscriptionTier).map(((t,i)=>a()("div",{style:{display:"flex",alignItems:"center",padding:"4px 0px",fontSize:14}},`${e.subscriptionTier}-feature-${i}`,b.Z.thinCheck({width:14,height:14,marginRight:5,color:this.theme.lightTextColor}),t.label,t.isComingSoon&&a()("div",{style:{background:this.theme.buttonHoveredBackground,fontSize:10,fontWeight:500,letterSpacing:"0.015em",color:this.theme.mediumTextColor,display:"inline",textTransform:"uppercase",padding:"2px 4px",marginLeft:6,borderRadius:3,whiteSpace:"nowrap"}},void 0,S.Mn)))))}renderPreviousPlanTierFeatures(){const e=this.getTierBelowKey();return this.getFeaturesByPlanKey(e).map(((t,i)=>a()("div",{style:{display:"flex",alignItems:"center",padding:"4px 0px",fontSize:14}},`${e}-feature-${i}`,b.Z.thinCheck({width:14,height:14,marginRight:5,color:this.theme.regularInvertedTextColor}),t.label)))}renderLearnMore(){return a()("div",{style:{fontWeight:M.Z.fontWeight.regular,fontSize:14,marginBottom:16,color:this.theme.mediumTextColor,textDecoration:"underline",marginTop:8,cursor:"pointer"},onClick:()=>{_.Z.reset(),p.reset(),T.Z.setState({open:!0,currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0})}},void 0,a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.learnMore",defaultMessage:"Learn more"}))}getPlanTitle(){const{planInfo:e}=this.props;return{personal:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.title.personal",defaultMessage:"Upgrade to Personal Pro"}),plus:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.title.plus",defaultMessage:"Upgrade to Plus",description:"Title of modal when upgrading to a Plus plan"}),team:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.title.team",defaultMessage:"Upgrade to Team"}),enterprise:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.title.enterprise",defaultMessage:"Upgrade to Enterprise"}),team_free:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.title.teamFree",defaultMessage:"Upgrade to Team Trial"})}[e.subscriptionTier]}getOneLiner(){const{planInfo:e}=this.props;switch(e.subscriptionTier){case"personal":return a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.oneLiner.personal",defaultMessage:"For power users who want to do even more."});case"plus":case"team":case"team_free":return a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.oneLiner.team",defaultMessage:"For teams to write, plan, and work together in one spot."});case"enterprise":return a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.oneLiner.enterprise",defaultMessage:"Controls and support to run your company."})}}getPreviousPlanName(){return{personal:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.personal",defaultMessage:"Pro"}),personal_free:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.free",defaultMessage:"Personal"}),team_free:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.teamTrial",defaultMessage:"Team Trial"}),team:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.team",defaultMessage:"Team"}),plus:a()(r.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.plus",defaultMessage:"Plus",description:"Name of Plus plan when displaying plan comparison"})}[this.getTierBelowKey()]}getTierBelowKey(){const{planInfo:e}=this.props;return{personal:"personal_free",team:"team_free",plus:"team_free",team_free:"personal",enterprise:w.$M}[e.subscriptionTier]}getFeaturesByPlanKey(e){const t=(0,S.Cq)();return{personal_free:[t.unlimitedBlocks,t.shareWithLimitedGuests,t.syncAcrossDevices],personal:[t.unlimitedFileUploads,t.unlimitedGuests,t.versionHistory,t.contentApi],team_free:[t.unlimitedTeamMembers,t.collaborativeWorkspace,t.adminTools],team:[t.unlimitedBlocks,t.unlimitedFileUploads,t.versionHistory,t.advancedPermissions],plus:[t.unlimitedBlocks,t.unlimitedFileUploads,t.versionHistory,t.advancedPermissions],enterprise:[t.sso,t.scimApi,t.advancedSecurity,t.dedicatedManager,t.customContract]}[e]}getPrimaryTextStyle(){return{fontWeight:M.Z.fontWeight.bold,fontSize:22,lineHeight:1.1,marginBottom:2}}getSecondaryTextStyle(){return{fontWeight:M.Z.fontWeight.regular,fontSize:14,lineHeight:1.4,marginBottom:22,color:this.theme.mediumTextColor}}}x.displayName="SpaceSubscriptionUpgradePlanFeatures";const Z=(0,r.injectIntl)(x);class P extends s.Z{constructor(){super(...arguments),this.storeTypes={},this.renderModal=()=>a()("div",{style:this.getModalStyle()},void 0,a()(Z,{planInfo:{subscriptionTier:"team_free"}}),a()("div",{style:this.getButtonContainerStyle()},void 0,a()(h.Z,{isLarge:!0,style:{marginLeft:"auto",marginRight:12},onClick:this.handleModalClose},void 0,a()(r.FormattedMessage,{id:"spacePermissionSettingsTrialModal.cancel.label",defaultMessage:"Cancel"})),a()(m.Z,{onClick:this.handleTrialAccept,isLarge:!0},void 0,a()(r.FormattedMessage,{id:"spacePermissionSettingsTrialModal.tryItFree.label",defaultMessage:"Try it free"})))),this.handleTrialAccept=async()=>{const{currentSpaceStore:e}=d.default.state;e&&(await l.EO({environment:this.environment,spaceStore:e,planType:"team",from:"space_permission_settings_trial_modal"}),this.handleModalClose())},this.handleModalClose=()=>{p.setState({...p.state,open:!1})}}renderComponent(){return a()(g.Z,{open:p.state.open,render:this.renderModal,onDismiss:this.handleModalClose})}getButtonContainerStyle(){return{display:"flex",marginTop:40}}getModalStyle(){return{background:this.theme.popoverBackground,borderRadius:3,width:349,padding:24}}}P.displayName="SpacePermissionSettingsTrialModal";const F=P},53641:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Wf});var n=i(77094),a=i.n(n),o=i(97464),s=i.n(o),r=i(96486),l=i.n(r),d=i(67294),c=i(83355),u=i(5220),p=i(4615),m=i(90965),g=i(3791),h=i(82990),f=i(5366),v=i(48298),y=i(7512),b=i(50906),S=i(47307),w=i(5978),M=i(29974),C=i(97627),k=i(21325),T=i(97880),_=i(23537),I=i(27832),x=i(74716),Z=i(49085);class P extends Z.Z{getInitialState(){return{loadingState:"uninitialized"}}}const F=new P;async function A(e){let{environment:t,messageStoreEmitValue:i}=e;if(!function(e){const t=F.state;if("loading"===t.loadingState)return!1;if(("uninitialized"===t.loadingState?void 0:t.messageStoreEmitValue)===e)return!1;return!0}(i))return!1;const{currentSpaceStore:n,currentUserStore:a}=I.default.state;if(!n||!a)return!1;"uninitialized"===F.state.loadingState&&F.setState({loadingState:"loading"});const o=await async function(e){let{environment:t,currentSpaceStore:i,currentUserStore:n}=e;const a=i.getModel();if(!a)return;if((0,u.H)({userId:n.id,spaceModel:a})){return await(0,_.sj)({environment:t,spaceStore:i,includeArchived:!0,currentUserId:n.id,minRoleOnTeamStores:"reader"})}return await(0,_.qX)({environment:t,spaceStore:i,includeArchived:!0,currentUserId:n.id})}({environment:t,currentSpaceStore:n,currentUserStore:a});if(!(0,T.$K)(o))return F.setState({loadingState:"uninitialized"}),!1;const{archivedTeams:s,unarchivedTeams:r}=(0,_.tV)(o);return F.setState({loadingState:"loaded",archivedTeamIds:s.map((e=>e.id)),unarchivedTeamIds:r.map((e=>e.id)),messageStoreEmitValue:i}),!0}var B=i(30149),E=i(37181),D=i(28020),R=i(68821),L=i(43250),O=i(4708),N=i(10161);var V=i(33929),U=i(67669),W=i(33665),z=i(62216),K=i(21115),q=i(8323),H=i(89837);const G=["page_edited","page_viewed","page_created","page_deleted","page_restored","page_exported","page_moved","page_permission_updated","page_shared_to_web","file_uploaded","file_downloaded","private_content_transferred","automation_created","automation_edited","member_invited","member_joined","member_role_updated","member_removed","guest_removed","invite_link_toggled","workspace_name_changed","invite_link_reset","page_access_requests_toggled","public_page_sharing_toggled","workspace_sidebar_editing_toggled","disable_team_guests_toggled","disable_guests_toggled","pages_to_other_workspaces_toggled","export_toggled","workspace_exported","workspace_icon_changed","workspace_domain_changed","workspace_integration_restriction_changed","allowed_email_domain_added","allowed_email_domain_removed","public_page_cleared","public_page_set","scim_token_generated","scim_token_revoked","idp_metadata_url_updated","idp_metadata_xml_updated","idp_metadata_xml_removed","saml_toggled","saml_enforce_toggled","automatic_account_creation_toggled","workspace_creation_set_for_email_domain","member_added_to_group","member_removed_from_group","space_transfer_status_changed","space_claim_and_upgrade_status_changed","space_claim_deletion_status_changed","membership_requests_toggled","membership_request_resolved","guest_membership_requests_toggled","audit_log_exported","user_analytics_exported","content_analytics_exported","admin_content_search_queried","workspace_analytics_toggled","login","logout","mfa_sms_toggled","mfa_totp_toggled","mfa_backup_code_toggled","password_set","password_cleared","password_changed","email_changed","preferred_name_changed","picture_changed","user_deleted","allowed_support_access","revoked_support_access","team_created","team_archived","team_restored","team_privacy_type_changed","team_default_toggled","team_public_page_sharing_toggled","team_export_toggled","team_sidebar_editing_toggled","team_name_changed","team_description_changed","team_icon_changed","team_creation_admins_setting_toggled","team_guests_toggled","member_added_to_team","group_added_to_team","member_removed_from_team","group_removed_from_team","member_left_team","member_joined_team","member_team_role_updated","team_user_permission_updated","team_group_permission_updated","team_member_default_permission_updated","team_guest_default_permission_updated","team_workspace_default_permission_updated","team_invite_access_changed","teams_enabled_for_space","ai_admin_legal_acceptance_toggled","space_consolidation_started","space_consolidation_completed","space_consolidation_failed"],j={page:["page_edited","page_viewed","page_created","page_deleted","page_restored","page_exported","page_moved","page_permission_updated","page_shared_to_web","file_uploaded","file_downloaded","private_content_transferred","automation_created","automation_edited"],space:["member_invited","member_joined","member_role_updated","member_removed","guest_removed","invite_link_toggled","workspace_name_changed","invite_link_reset","page_access_requests_toggled","public_page_sharing_toggled","workspace_sidebar_editing_toggled","disable_team_guests_toggled","disable_guests_toggled","pages_to_other_workspaces_toggled","export_toggled","workspace_icon_changed","allowed_email_domain_added","allowed_email_domain_removed","workspace_domain_changed","workspace_exported","audit_log_exported","user_analytics_exported","content_analytics_exported","workspace_integration_restriction_changed","public_page_cleared","public_page_set","scim_token_generated","scim_token_revoked","idp_metadata_url_updated","idp_metadata_xml_updated","idp_metadata_xml_removed","saml_toggled","saml_enforce_toggled","automatic_account_creation_toggled","workspace_creation_set_for_email_domain","member_added_to_group","member_removed_from_group","space_transfer_status_changed","space_claim_and_upgrade_status_changed","space_claim_deletion_status_changed","membership_requests_toggled","guest_membership_requests_toggled","membership_request_resolved","admin_content_search_queried","ai_admin_legal_acceptance_toggled","workspace_analytics_toggled","space_consolidation_started","space_consolidation_completed","space_consolidation_failed"],account:["login","logout","mfa_sms_toggled","mfa_totp_toggled","mfa_backup_code_toggled","password_set","password_cleared","password_changed","email_changed","preferred_name_changed","picture_changed","user_deleted","allowed_support_access","revoked_support_access"],team:["team_created","team_archived","team_restored","team_privacy_type_changed","team_default_toggled","team_public_page_sharing_toggled","team_export_toggled","team_sidebar_editing_toggled","team_guests_toggled","team_invite_access_changed","team_name_changed","team_description_changed","team_icon_changed","team_creation_admins_setting_toggled","member_added_to_team","group_added_to_team","member_removed_from_team","group_removed_from_team","member_joined_team","member_left_team","member_team_role_updated","team_user_permission_updated","team_group_permission_updated","team_member_default_permission_updated","team_guest_default_permission_updated","team_workspace_default_permission_updated"]};function $(e){switch(e.actionName){case"page_edited":case"page_viewed":case"page_created":case"page_deleted":case"page_restored":case"page_exported":case"page_moved":case"page_permission_updated":case"page_shared_to_web":case"file_uploaded":case"file_downloaded":case"private_content_transferred":case"automation_created":case"automation_edited":return e.target.page;case"member_invited":case"member_joined":case"member_role_updated":case"member_removed":case"guest_removed":case"workspace_name_changed":case"workspace_icon_changed":case"workspace_domain_changed":case"allowed_email_domain_added":case"allowed_email_domain_removed":case"workspace_exported":case"audit_log_exported":case"user_analytics_exported":case"content_analytics_exported":case"workspace_integration_restriction_changed":case"public_page_cleared":case"public_page_set":case"scim_token_generated":case"scim_token_revoked":case"saml_toggled":case"saml_enforce_toggled":case"automatic_account_creation_toggled":case"workspace_creation_set_for_email_domain":case"login":case"logout":case"mfa_sms_toggled":case"mfa_totp_toggled":case"mfa_backup_code_toggled":case"password_set":case"password_cleared":case"password_changed":case"email_changed":case"preferred_name_changed":case"picture_changed":case"user_deleted":case"allowed_support_access":case"revoked_support_access":case"invite_link_toggled":case"invite_link_reset":case"page_access_requests_toggled":case"public_page_sharing_toggled":case"workspace_sidebar_editing_toggled":case"disable_team_guests_toggled":case"disable_guests_toggled":case"pages_to_other_workspaces_toggled":case"workspace_analytics_toggled":case"export_toggled":case"idp_metadata_url_updated":case"idp_metadata_xml_updated":case"idp_metadata_xml_removed":case"member_added_to_group":case"member_removed_from_group":case"space_transfer_status_changed":case"space_claim_and_upgrade_status_changed":case"space_claim_deletion_status_changed":case"membership_requests_toggled":case"membership_request_resolved":case"guest_membership_requests_toggled":case"team_created":case"team_archived":case"team_restored":case"team_default_toggled":case"team_public_page_sharing_toggled":case"team_export_toggled":case"team_sidebar_editing_toggled":case"team_name_changed":case"team_description_changed":case"team_icon_changed":case"team_creation_admins_setting_toggled":case"team_guests_toggled":case"member_added_to_team":case"group_added_to_team":case"member_removed_from_team":case"group_removed_from_team":case"member_joined_team":case"member_left_team":case"member_team_role_updated":case"team_user_permission_updated":case"team_group_permission_updated":case"team_member_default_permission_updated":case"team_guest_default_permission_updated":case"team_workspace_default_permission_updated":case"team_privacy_type_changed":case"team_invite_access_changed":case"teams_enabled_for_space":case"admin_content_search_queried":case"ai_admin_legal_acceptance_toggled":case"space_consolidation_started":case"space_consolidation_completed":case"space_consolidation_failed":return;default:(0,T.t1)(e)}}let Y;!function(e){e.CreatedNewest="CreatedNewest",e.CreatedOldest="CreatedOldest"}(Y||(Y={}));var Q=i(30546);class X extends Z.Z{getInitialState(){return{pageNum:1,pageSize:10,timeRange:{},actors:[],actions:[],sortOrder:Y.CreatedNewest}}}const J=new X,ee=e=>{const{timeRange:t,actors:i,actions:n,sortOrder:a}=e,o=new URLSearchParams;return t.starting&&o.append("starting",`${H.OQ.toUnixMs(t.starting)}`),t.ending&&o.append("ending",`${H.OQ.toUnixMs(t.ending)}`),(null==i?void 0:i.length)>0&&o.append("actors",i.map(Q.eW).join(",")),(null==n?void 0:n.length)>0&&o.append("actions",n.join(",")),o.append("sort",`${a||Y.CreatedNewest}`),o.toString()};class te extends Z.Z{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,i){if(i<=1||this.state.spaceId!==e)return;const n=ee(t);if(this.state.filterStr!==n)return;const a=this.state.cachedResponses[i-1];return"success"===a.status?null==a?void 0:a.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,i){this.updateResultHelper(e,t,{...i,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,i){const n=ee(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===n?this.setState({spaceId:e,filterStr:n,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...i}}}):this.setState({spaceId:e,filterStr:n,cachedResponses:{[t.pageNum||1]:{...i}}})}}const ie=new te;var ne=i(67940);class ae extends Z.Z{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaceIds:[],createAccount:!1,useMetadataUrl:!0}}}const oe=ae;var se=i(53680);class re extends Z.Z{getInitialState(){return{displaySummary:!0,openDropdown:!1,query:""}}}const le=new re;let de;!function(e){e.Overview="overview",e.Users="users",e.Content="content",e.Search="search"}(de||(de={}));class ce extends Z.Z{getInitialState(){return{}}shouldRefreshState(e){const t=this.getState();return e!==t.currentSpaceId||!(t.currentTab!==de.Users||t.usersTabData&&t.usersTabData.usersAndStats)}}const ue=new ce;class pe extends Z.Z{getInitialState(){return{name:"",domain:"",domainState:"current-space",emailDomains:[],publicHomePage:void 0}}getValueForSpace(e){const t=e.getPublicContentDomain(),i=e.getPublicHomePage();if(e.isDefined())return{name:e.getName()||"",domain:t||"",emailDomains:e.getEmailDomains(),domainState:"current-space",publicHomePage:i}}}const me=pe;var ge=i(54642);class he extends Z.Z{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only",settings:{}}}async updateValueForSpace(e){const{environment:t,spaceId:i,store:n}=e,a=await ge.getEmailDomainsForSpace(t,{spaceId:i});if("failed"===a.type)return void S.showError(a);const{data:o}=a,s=Object.keys(o);return 0!==s.length?n.setState({emailDomains:s,spaceCreation:o[s[0]].spaceCreationEnum,settings:o[s[0]].settings}):n.setState(this.getInitialState()),n.state}}const fe=he;class ve extends Z.Z{getInitialState(){return{uploadingProfilePhoto:!1,givenName:"",familyName:"",name:"",startDayOfWeek:(0,H.aN)()}}getValueForUser(e,t,i){if(e.isDefined()){const n=e.getFullName(i),a=e.getProfilePhoto(),o=t.getSettings();return{uploadingProfilePhoto:!1,profilePhoto:a,name:n||"",startDayOfWeek:void 0===(null==o?void 0:o.start_day_of_week)?(0,H.aN)():null==o?void 0:o.start_day_of_week}}}}const ye=ve;var be=i(92083),Se=i(78291),we=i(98905),Me=i(85703),Ce=i(63314),ke=i(480),Te=i(81954),_e=i(24405),Ie=i(88632),xe=i(64369),Ze=i(27386),Pe=i(23189),Fe=i(70630),Ae=i(63296);function Be(e){let{spaceId:t,filters:i,disabled:n}=e;window.__c={n:"AdminContentSearchExportButton"};const[o,s]=(0,d.useState)(!1),r=(0,ke.O7)(),l=n||o,c=(0,_e.yK)((e=>({button:{opacity:l?.5:1}})),[l]);return a()(Ae.Z,{style:c.button,disabled:l,onClick:async function(){s(!0),b.j_p(r,{filters:i}),await Fe.gJ(r,{spaceId:t,filters:i}),s(!1)}},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.export",defaultMessage:"Export results",description:"Button for exporting content search results as a CSV."}))}var Ee=i(98165),De=i(40394),Re=i(68785),Le=i(16402),Oe=i(58032),Ne=i(69219);function Ve(e){let{dateTs:t,includeTime:i}=e;return window.__c={n:"DateCell"},a()(Oe.Z,{render:e=>d.createElement("div",e,a()(Ne.i,{useThinTitle:!0,title:i?(0,Le.uy)(t,!0):(0,Le.gs)(t)})),renderTooltip:()=>(0,Le.uy)(t)})}function Ue(){window.__c={n:"LoadingDateCell"};const e=(0,_e.yK)((()=>({title:{width:"50%"}})),[]);return a()(Ne.H,{titleStyles:e.title})}var We=i(42875),ze=i(85057),Ke=i(31278);const qe=(0,f.defineMessages)({privateTeamspace:{id:"baseTable.pageCell.privateTeamspace",defaultMessage:"Private teamspace",description:"Title given to a teamspace that is private and its name is unknown."},untitledPath:{id:"baseTable.pageCell.untitledPath",defaultMessage:"Untitled",description:"Title given to a path that has no title."}});function He(e){let{blockStore:t,rightIcon:i}=e;window.__c={n:"PageCell"};const n=(0,f.useIntl)(),o=(0,Te.VK)((()=>{var e;return null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),s=(0,Te.VK)((()=>{const e=null==t?void 0:t.getModel();if(e&&t)return e.getRenderIcon({getRecordModel:t.getRecordModel})}),[t]),r=(0,Te.VK)((()=>{const e=null==t?void 0:t.getModel();if(e&&t)return e.getRenderTitle({getRecordModel:t.getRecordModel,userTimeZone:(0,We.r)(),intl:V.default.getIntl()})}),[t]),l=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%",position:"relative"},summaryContainer:{flex:1,overflow:"hidden"},iconContainer:{height:20,width:20,flexGrow:0,flexShrink:0,flexBasis:20,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:6},name:{fontSize:14,fontWeight:500},nameUntitled:{fontSize:14,fontWeight:500,opacity:.25},byline:{lineHeight:1.3,fontSize:12,opacity:.5}})),[]),d=(0,Te.VK)((()=>{if(!t)return[];return(0,Ee.uJ)(t).filter((e=>e.id!==t.id)).map((e=>{if(e instanceof ze.zX)return e.getName()||n.formatMessage(qe.privateTeamspace);const t=e.getModel();return(null==t?void 0:t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,We.r)(),intl:V.default.getIntl()}))||n.formatMessage(qe.untitledPath)})).reverse()}),[t,n]);return a()("div",{style:l.container},void 0,a()("div",{style:l.iconContainer},void 0,a()(Ke.Z,{icon:s,size:20,isEmptyPage:!1,disabled:!0})),a()("div",{style:l.summaryContainer},void 0,a()(xe.Z,{showTooltipWhenTruncated:!0,style:r?l.name:l.nameUntitled},void 0,r||a()(f.FormattedMessage,{id:"baseTable.pageCell.untitledPage",defaultMessage:"Untitled",description:"Title given to a page that is untitled."})),a()(xe.Z,{showTooltipWhenTruncated:!0,style:l.byline},void 0,d.length>0?d.join("/"):o)),i)}var Ge=i(3779),je=i(42922),$e=i(89728);function Ye(e){window.__c={n:"AdminContentSearchAcknowledgement"};const t=(0,ke.O7)(),i=(0,_e.yK)((e=>({container:{marginTop:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},headerIcon:{width:36,height:36,color:e.lightTextColor,fill:"currentColor"},disclaimerTitle:{margin:"12px auto",fontWeight:h.Z.fontWeight.medium,fontSize:16},disclaimer:{fontWeight:h.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:432,margin:"0 auto 16px"},acknowledgeButton:{width:195,margin:"8px auto 0"},learnMoreButton:{width:195,margin:"8px auto 0",justifyContent:"center",color:e.lightTextColor},learnMoreButtonIcon:{width:12,height:12,marginRight:4}})),[]),n=(0,d.useCallback)((()=>{b.vN5(t),C.NY(t)}),[t]);return a()("div",{style:i.container},void 0,Ge.Z.lockedFilled(i.headerIcon),a()("h1",{style:i.disclaimerTitle},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimerTitle",description:"Title of the disclaimer that warns the user about the implications of using the admin content search feature.",defaultMessage:"Before using this feature"})),a()("p",{style:i.disclaimer},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimer",description:"Disclaimer that warns the user about the implications of using the admin content search feature.",defaultMessage:"As a workspace owner, you can use content search to find pages that you don't have access to, including the private pages of other workspace members. Consult with your organization's legal department on how to use this feature. Actions taken here will be recorded in the audit log."})),a()(je.Z,{style:i.acknowledgeButton,onClick:n},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.confirm",description:"Label for the button that confirms the user's acknowledgement into using the admin content search feature.",defaultMessage:"Acknowledge"})),a()($e.Z,{style:i.learnMoreButton,onClick:()=>{const e=(0,W.UY)("adminContentSearch");w.navigateToExternalURL({environment:t,url:e})}},void 0,Ge.Z.info(i.learnMoreButtonIcon),a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.learnMore",description:"Label for the button that links the user to learn more about the admin content search feature.",defaultMessage:"Learn more"})))}var Qe=i(95477);function Xe(e){let{runNewSearch:t,error:i}=e;window.__c={n:"AdminContentSearchError"};const n=(0,_e.yK)((e=>({container:{marginTop:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},headerIcon:{width:28,height:28,color:e.redBadgeBackground,fill:"currentColor"},title:{margin:"8px auto",fontWeight:h.Z.fontWeight.medium,fontSize:16},description:{fontWeight:h.Z.fontWeight.regular,fontSize:14,lineHeight:1.3,color:e.lightTextColor,textAlign:"center",width:328,margin:"0 auto 16px"},errorMessage:{borderRadius:4,background:e.cardBackground,fontFamily:h.Z.baseFontFamily.mono,fontSize:12,color:e.lightTextColor,padding:"18px 24px",margin:"0 auto 12px"},errorButton:{width:195,margin:"8px auto 0",textAlign:"center"}})),[]),o="production"===Qe.Z.env;return a()("div",{style:n.container},void 0,Ge.Z.genericError(n.headerIcon),a()("h1",{style:n.title},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.title",description:"Title explaining that an error has occurred.",defaultMessage:"Something went wrong"})),a()("p",{style:n.description},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.description",description:"Message explaining that something went wrong when running their search query.",defaultMessage:"Something went wrong when we were loading the results. Try to run your search again."})),o?null:a()("p",{style:n.errorMessage},void 0,i.message),a()(Ae.Z,{style:n.errorButton,onClick:()=>t(!0)},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.confirm",description:"Label for the button that will retry the search query.",defaultMessage:"Retry"})))}var Je=i(60709),et=i(29798),tt=i(55811),it=i(52275),nt=i(12508),at=i(78140),ot=i(9342),st=i(44532),rt=i(72495),lt=i(91642);function dt(e){let{selectedAudience:t,setSelectedAudience:i,onMenuClose:n,setPillTitleToActiveSelection:o}=e;const r=(0,Te.qz)(void 0,et.Z),l=(0,_e.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:4},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},teamIcon:{marginRight:8}})),[]),[c,u]=(0,d.useState)(!1),p=["private","shared_internally","shared_externally","shared_to_web"];function m(){u(!1),n&&n()}function g(){i&&i([])}function h(e){const n=t.includes(e)?[...t.filter((t=>t!==e))]:[...t,e];i&&i(n)}const v=a()(tt.u,{on:t.length>0,icon:Ge.Z.typesPerson(l.icon),title:o&&t[0]?ct(t[0]):a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.title",description:"Title of the audience filter for the admin content search table.",defaultMessage:"Audience"}),onClick:()=>u(!0),disabled:!i,hideChevron:!i});return i?a()(lt.Z,{},void 0,a()(st.ZP,{popupType:st.ZP.PopupType.Popup,placementToOrigin:st.ZP.Placement.Bottom,alignmentToOrigin:st.ZP.Alignment.Start,open:c,render:function(){const e={key:"teamOptions",items:p.map((e=>({key:e,action:()=>h(e),render:i=>d.createElement(it.Z,s()({},i,{icon:a()(nt.Z,{checked:t.includes(e),onClick:()=>h(e),size:16}),focused:!1,title:ct(e),caption:ut(e),shouldWrapCaption:!0}))}))),render:e=>d.createElement(rt.Z,s()({},e,{title:null,loading:!1}))};return a()("div",{style:l.container},void 0,a()(at.Z,{menuType:Je.og.Popup,header:null,maxHeight:250,width:300},void 0,a()(ot.Z,{type:ot.i.Vertical,store:r,initialFocus:0,sections:[e]})),a()(rt.Z,{topBorder:!0,style:l.footer},void 0,a()($e.Z,{onClick:g},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.clearButton",description:"Label for the button that resets the selected audiences back to empty.",defaultMessage:"Clear"})),a()(je.Z,{onClick:m},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.doneButton",description:"Label for the button that closes the menu.",defaultMessage:"Done"}))))},onDismiss:m,keepFocus:!0,origin:v,preventScaleTransition:!0})):v}function ct(e){switch(e){case"private":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.private",description:"Label that explains the audience is shared privately.",defaultMessage:"Private"});case"shared_externally":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.external",description:"Label that explains the audience is shared externally.",defaultMessage:"Shared externally"});case"shared_internally":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.internal",description:"Label that explains the audience is shared internally.",defaultMessage:"Shared internally"});case"shared_to_web":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.publishedToWeb",description:"Label that explains the audience is published to web.",defaultMessage:"Shared to web"});default:(0,T.t1)(e)}}function ut(e){switch(e){case"private":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.private",description:"Caption that explains the audience is shared privately.",defaultMessage:"Pages that only a single workspace member has access to."});case"shared_externally":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.external",description:"Caption that explains the audience is shared externally.",defaultMessage:"Pages that are shared with guests or connections."});case"shared_internally":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.internal",description:"Caption that explains the audience is shared internally.",defaultMessage:"Pages that are shared with other workspace members."});case"shared_to_web":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.publishedToWeb",description:"Caption that explains the audience is published to web.",defaultMessage:"Pages that are available for anyone to see on the web."});default:(0,T.t1)(e)}}function pt(e){let{filters:t,setFilters:i}=e;window.__c={n:"AdminContentSearchSuggestions"};const n=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},title:{margin:"12px auto",fontWeight:h.Z.fontWeight.medium,fontSize:16},description:{fontWeight:h.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:386,margin:"0 auto 16px"},suggestion:{position:"relative",height:38,width:440,margin:"12px auto 0",justifyContent:"center",color:e.darkTextColor,boxShadow:e.borderBoxShadow},filterContainer:{margin:"0 8px",display:"flex",alignItems:"center",justifyContent:"center"},arrowIconContainer:{position:"absolute",right:12,transform:"rotate(180deg)"},arrowIcon:{width:18,height:18,opacity:.5,color:e.lightTextColor,fill:"currentColor"}})),[]);return a()("div",{style:n.container},void 0,a()("h1",{style:n.title},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.title",description:"Title of the message that explains the admin content search feature.",defaultMessage:"Search pages in your workspace"})),a()("p",{style:n.description},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.description",description:"Explanation of the admin content search feature.",defaultMessage:"Use filters to find pages with specific sharing and permissions settings, such as:"})),a()($e.Z,{style:n.suggestion,onClick:function(){i({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_externally"],teamIds:[]},{runSearchAfter:!0})}},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",description:"Label for the button that queries the admin content search for pages shared to web.",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>a()("div",{style:n.filterContainer},void 0,a()(dt,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_externally"]}))}}),a()("div",{style:n.arrowIconContainer},void 0,Ge.Z.arrowLeftThick(n.arrowIcon))),a()($e.Z,{style:n.suggestion,onClick:function(){i({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_to_web"],teamIds:[]},{runSearchAfter:!0})}},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",description:"Label for the button that queries the admin content search for pages shared to web.",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>a()("div",{style:n.filterContainer},void 0,a()(dt,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_to_web"]}))}}),a()("div",{style:n.arrowIconContainer},void 0,Ge.Z.arrowLeftThick(n.arrowIcon))))}var mt=i(26825),gt=i(27006),ht=i(29369);function ft(e){let{blockStore:t}=e;window.__c={n:"AudienceCell"};const[i,n]=(0,d.useState)();(0,d.useEffect)((()=>{!async function(){const{currentSpaceStore:e}=I.default.state,i=Ee.fJ(t),a=mt.Wo(i),o=null==e?void 0:e.getPermissionItems().filter(gt.jg),s=await mt.uq({permissionItems:a,hasTeamLevelGuests:function(t){return!!e&&ze.zX.createChildStore(e,{table:ht.e0,id:t}).getMembers().some((e=>"team_level_guest"===e.type))},spaceUserPermissions:o});n(s)}()}),[t]);const o=(0,d.useMemo)((()=>{if(i)return vt(i)}),[i]);return a()(Ne.i,{useThinTitle:!0,title:o})}function vt(e){switch(e){case"private":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.private",defaultMessage:"Private",description:"Message indicating that this page is currently shared privately."});case"shared_internally":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.sharedInternally",defaultMessage:"Shared internally",description:"Message indicating that this page is currently shared internally."});case"shared_externally":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.sharedExternally",defaultMessage:"Shared externally",description:"Message indicating that this page is currently shared externally."});case"shared_to_web":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.publishedToWeb",defaultMessage:"Published to web",description:"Message indicating that this page is currently published to web."});default:(0,T.t1)(e)}}var yt,bt=i(93686);function St(e){let{teamStore:t,useThinTitle:i}=e;const n=(0,_e.yK)((e=>({icon:{height:20,width:20,color:e.lightIconColor,fill:"currentColor"},hiddenTeamName:{color:e.lightTextColor}})),[]),o=(0,Te.VK)((()=>null==t?void 0:t.getName()),[t]);return a()(Ne.i,o?{useThinTitle:i,icon:t?a()(bt.p,{disabled:!0,store:t,size:24}):void 0,title:o}:{useThinTitle:i,icon:Ge.Z.eyeHide(n.icon),title:a()("span",{style:n.hiddenTeamName},void 0,a()(f.FormattedMessage,{id:"baseTable.teamCell.hiddenTeam",defaultMessage:"Hidden",description:"Title given to a team that we cannot see the title of."}))})}function wt(e){let{blockStore:t,teamStore:i}=e;const n=(0,_e.yK)((e=>({icon:{height:18,width:18,color:e.lightIconColor,fill:"currentColor"}})),[]),o=(0,Te.VK)((()=>{const e=(0,Ee.fJ)(t),i=(0,mt.Wo)(e),n=i.filter((e=>!(0,gt.Le)(e)));return 1===n.length&&(0,gt.jg)(n[0])?yt.Private:i.length>0?yt.Shared:yt.Hidden}),[t]);return i?a()(St,{useThinTitle:!0,teamStore:i}):function(){switch(o){case yt.Shared:return a()(Ne.i,{useThinTitle:!0,icon:Ge.Z.typesPerson(n.icon),title:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.locationCell.shared",defaultMessage:"Shared",description:"Message indicating that this page is currently shared with others."})});case yt.Hidden:case yt.Private:return a()(Ne.i,{useThinTitle:!0,icon:Ge.Z.lockedFilled(n.icon),title:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.locationCell.private",defaultMessage:"Private",description:"Message indicating that this page is currently shared privately."})})}}()}!function(e){e.Shared="shared",e.Private="private",e.Hidden="hidden"}(yt||(yt={}));var Mt=i(43132),Ct=i(84210),kt=i(77907),Tt=i(61766),_t=i(97238),It=i(8675),xt=i(31945),Zt=i(73063);function Pt(e){let{blockStore:t}=e;window.__c={n:"PageCellActions"};const i=(0,ke.O7)(),n=(0,Te.qz)(void 0,Tt.Z),o=(0,Te.qz)(void 0,It.Z),r=(0,_e.yK)((e=>({changePermissionsIcon:{height:18,width:18,color:e.regularIconColor,fill:"currentColor"},copyLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor"}})),[]),[l,c]=(0,d.useState)(!1);(0,d.useEffect)((()=>{o.setState({...o.state,privatePageStore:t,changePermissionsEnabled:!0,loading:!1,error:void 0})}),[t,o]);const u={key:"actions",render:e=>d.createElement(rt.Z,e),items:[{key:"change-permissions",render:e=>d.createElement(it.Z,s()({},e,{icon:Ge.Z.settingsSecurity(r.changePermissionsIcon),title:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.changePermissions",defaultMessage:"Change permissions",description:"Title of the action that will change the permissions of this page."})})),action:function(){c(!0)}},{key:"copy-link",render:e=>d.createElement(it.Z,s()({},e,{icon:Ge.Z.link(r.copyLinkIcon),title:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page",description:"Title of the action that will copy a link to this page."})})),action:async function(){const e=(0,Ct.ZP)({store:t});await Mt.RD({environment:i,stringValue:e,copiedMessage:Mt.tq.copiedLinkToClipboard}),n.setState({open:!1})}}]};return a()(xt.Z,{popupType:st.kQ.Popup,alignmentToOrigin:st.ZP.Alignment.Center,placementToOrigin:st.ZP.Placement.Right,style:{width:l?450:248},render:()=>l?a()(kt.LazyShareMenuContainer,{store:t,sudoModeStore:o,location:"admin_content_search"}):a()(at.Z,{menuType:Je.og.Popup,width:248},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:[u]})),onClose:()=>{c(!1),_t.ZP.reset()},buttonPopupStore:n,renderOrigin:e=>d.createElement(Zt.Z,s()({icon:Ge.Z.dots},e))})}var Ft=i(53695),At=i(77420),Bt=i(36596),Et=i(28992),Dt=i(70301);function Rt(e){let{botId:t}=e;const i=(0,f.useIntl)(),n=(0,ke.O7)(),o=(0,Te.VK)((()=>ze.t1.createUniqueRootStore(n,{table:At.cZ,id:t})),[t,n]),s=(0,Te.VK)((()=>o.getDisplayName(i)),[o,i]),r=(0,Te.VK)((()=>o.getParentStore()),[o]),l=(0,Te.VK)((()=>{if(r){if(r instanceof ze.U6)return r.getDisplayName(i);if(r instanceof ze.H2)return r.getName()}}),[r,i]),d=(0,_e.yK)((()=>({desktopIconStyle:{alignSelf:"center",width:24,fontSize:18}})),[]);return s?a()(Et.Z,{desktopIconStyle:d.desktopIconStyle,icon:a()(Dt.Z,{botStore:o,size:24}),title:s,caption:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.botMenuItem.createdBy",defaultMessage:"Created by {creatorName}",description:"This page can be seen by an integration. Text refers to the caption of the cell indicating the creator of that integration.",values:{creatorName:l}})}):a()(Lt,{})}function Lt(){window.__c={n:"ShimmerLoader"};const e=(0,_e.yK)((e=>({container:{userSelect:"none",minHeight:45,fontSize:14,padding:"4px 8px",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},textContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",gap:6},icon:{flexGrow:0,flexShrink:0,width:24,height:24,borderRadius:"0.25em",marginRight:4,marginTop:1},title:{flexGrow:0,flexShrink:0,width:80,height:14,borderRadius:"0.25em",marginLeft:4},byline:{flexGrow:0,flexShrink:0,width:150,height:10,borderRadius:"0.25em",marginLeft:4}})),[]);return a()("div",{style:e.container},void 0,a()(Bt.Z,{style:e.icon}),a()("div",{style:e.textContainer},void 0,a()(Bt.Z,{emphasized:!1,style:e.title}),a()(Bt.Z,{emphasized:!1,style:e.byline})))}const Ot=(0,f.defineMessages)({editor:{id:"adminContentSearchTab.sharedWith.permissions.editor",defaultMessage:"Full access",description:"Full access permission for a page."},readAndWrite:{id:"adminContentSearchTab.sharedWith.permissions.readAndWrite",defaultMessage:"Can edit",description:"Read and write permission for a page."},commentOnly:{id:"adminContentSearchTab.sharedWith.permissions.commentOnly",defaultMessage:"Can comment",description:"Comment only permission for a page."},reader:{id:"adminContentSearchTab.sharedWith.permissions.reader",defaultMessage:"Can view",description:"Reader permission for a page."},none:{id:"adminContentSearchTab.sharedWith.permissions.none",defaultMessage:"None",description:"No permission for a page."}});function Nt(e,t){switch(t){case"editor":return e.formatMessage(Ot.editor);case"read_and_write":return e.formatMessage(Ot.readAndWrite);case"comment_only":return e.formatMessage(Ot.commentOnly);case"reader":return e.formatMessage(Ot.reader);case"none":return e.formatMessage(Ot.none)}}function Vt(e){let{name:t,icon:i,role:n}=e;window.__c={n:"GroupMenuItem"};const o=(0,f.useIntl)(),s=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),r=Nt(o,n),l=(0,_e.yK)((e=>({defaultIcon:{height:18,width:18,color:e.lightTextColor,fill:"currentColor"},defaultGroupIcon:{height:20,width:20,color:e.lightTextColor,fill:"currentColor"}})),[]);return a()(Et.Z,{desktopIconStyle:{alignSelf:"center",width:24,fontSize:18},icon:a()(Ke.Z,{disabled:!0,icon:i&&s?{pointer:s.pointer,icon:i}:void 0,size:20,isEmptyPage:!1,title:t,defaultIcon:Ge.Z.typesPerson(l.defaultGroupIcon)}),title:t||a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.untitledPage",defaultMessage:"Untitled{maybeRoleString}",description:"Title given to a page that is untitled.",values:{maybeRoleString:r?` · ${r}`:""}}),caption:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.group",defaultMessage:"Group{maybeRoleString}",description:"Caption of the user indicating that this is a group",values:{maybeRoleString:r?` · ${r}`:""}})})}function Ut(e){let{permissionItem:t}=e;window.__c={n:"SpaceMenuItem"};const i=(0,f.useIntl)(),n=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),o=(0,Te.VK)((()=>{var e;return null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),s=null==t?void 0:t.role,r=(0,gt.iC)(s)?Nt(i,s):void 0;return a()(Et.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:n?a()(bt.p,{disabled:!0,store:n,size:24}):void 0,title:o,caption:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.spaceMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:r?` · ${r}`:""},description:"Caption of the user indicating that this applies to space members"})})}function Wt(e){let{teamId:t,role:i,onlyOwners:n}=e;window.__c={n:"TeamMenuItem"};const o=(0,ke.O7)(),s=(0,f.useIntl)(),r=(0,Te.VK)((()=>new ze.zX(o,{table:ht.e0,id:t})),[o,t]),l=Nt(s,i),d=(0,Te.VK)((()=>r.getName()),[r]),c=d||a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.unknownTeamName",defaultMessage:"Private teamspace",description:"Identifier give to a team that we don't know the name of."});return a()(Et.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:d?a()(bt.p,{disabled:!0,store:r,size:24}):Ge.Z.privateTeam(),title:c,caption:a()(f.FormattedMessage,n?{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamOwners",defaultMessage:"Owners{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""},description:"Caption of the user indicating that this applies to team owners"}:{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""},description:"Caption of the user indicating that this applies to team members"})})}var zt=i(64684);var Kt=i(19889),qt=i(7928),Ht=i(45653);function Gt(e){let{userId:t,role:i,isGuest:n}=e;window.__c={n:"UserMenuItem"};const o=(0,f.useIntl)(),s=(0,ke.O7)(),{userStore:r,userName:l}=(0,Te.VK)((()=>{const e=new ze.U6(s,{table:Kt.KJ,id:t}),i=(0,qt.Nz)(o,e.getModel());return{userStore:e,userName:i}}),[s,t,o]),d=Nt(o,i);return a()(Et.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:a()(Ht.Z,{userStore:r,size:24}),title:l,caption:a()(f.FormattedMessage,n?{id:"adminContentSearchTab.pagesTable.sharedWithCell.guest",defaultMessage:"Guest{maybeRoleString}",description:"Caption of the user indicating that they are a guest",values:{maybeRoleString:d?` · ${d}`:""}}:{id:"adminContentSearchTab.pagesTable.sharedWithCell.member",defaultMessage:"Member{maybeRoleString}",description:"Caption of the user indicating that they are a member",values:{maybeRoleString:d?` · ${d}`:""}})})}const jt=(0,f.defineMessages)({sharedWithWorkspaceMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWorkspaceMembers",defaultMessage:"Workspace members",description:"Caption explaining that the members of the workspace have access to this page."},sharedWithTeamOwners:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamOwners",defaultMessage:"Teamspace owners",description:"Caption explaining that owners of the teamspace have access to this page."},sharedWithTeamMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamMembers",defaultMessage:"Teamspace members",description:"Caption explaining that members of the teamspace have access to this page."},sharedWithMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithMembers",defaultMessage:"{numMembers, plural, one {# member} other {# members}}",description:"Caption explaining that members of the workspace have access to this page."},sharedWithGroups:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGroups",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}",description:"Caption explaining that groups in the workspace have access to this page."},sharedWithGuests:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGuests",defaultMessage:"{numGuests, plural, one {# guest} other {# guests}}",description:"Caption explaining that guests have access to this page."},sharedWithBots:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithBots",defaultMessage:"{numBots, plural, one {# connection} other {# connections}}",description:"Caption explaining that connections have access to this page."},separator:{defaultMessage:", ",id:"adminContentSearchTab.pagesTable.sharedWithCell.separator",description:"The string used to separate items in the shared with tab summary. For instance, an entry could be 'workspace members, 1 guest'. Another one would be '2 members, 3 connections. The split string in English is ', '."}});function $t(e){let{blockStore:t}=e;window.__c={n:"SharedWithCellImpl"};const i=function(e){return(0,Te.VK)((()=>{const{data:t}=Se.default.state,i=t?(0,K.CM)(t):[],n=I.default.state.currentSpaceStore,a=(0,U.YO)(e),o=(null==n?void 0:n.getPermissionGroups())||[],s=(0,Ee.VP)(e),r=a.find((e=>{let{permissionItem:t}=e;return gt.$D(t)})),l=a.find((e=>{let{permissionItem:t}=e;return gt.ix(t)})),d=s?a.find((e=>{let{permissionItem:t}=e;return(0,zt.J2)(t,s.id)})):void 0,c=a.map((e=>{let{permissionItem:t}=e;return t})).filter(gt.zU),u=a.map((e=>{let{permissionItem:t}=e;return t})).filter(gt.LW),p=a.map((e=>{let{permissionItem:t}=e;return t})).filter(gt.hV).reduce(((e,t)=>{const i=t.group_id,n=t.role,a=o.find((e=>e.id===i));if(a){const t={...a,role:n};e.push(t)}return e}),[]),[m,g]=a.map((e=>{let{permissionItem:t}=e;return t})).filter(gt.jg).reduce(((e,t)=>{const n=i.find((e=>e.userId===t.user_id));return Boolean(n&&!gt.zz(n.role)&&!gt.J5(n.role))?[e[0].concat(t),e[1]]:[e[0],e[1].concat(t)]}),[[],[]]);return{groupPermissions:p,mostPermissivePublicItem:r,spacePermission:l,teamPermission:d,teamSharePermissions:c,teamOwnerSharePermissions:u,guestUserPermissions:m,memberUserPermissions:g,botPermissions:a.map((e=>{let{permissionItem:t}=e;return t})).filter((e=>(0,gt.FB)(e)))}}),[e])}(t),n=(0,f.useIntl)(),o=function(e,t){const{mostPermissivePublicItem:i,spacePermission:n,groupPermissions:o,guestUserPermissions:s,memberUserPermissions:r,teamSharePermissions:l,teamOwnerSharePermissions:c,botPermissions:u}=e,p=n&&"none"!==n.permissionItem.role;if(i&&"none"!==i.permissionItem.role)return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWeb",defaultMessage:"Shared to web",description:"Caption explaining that the world has access to this page since it was published to web."});if(!p&&0===o.length&&0===s.length&&0===r.length&&0===l.length&&0===c.length&&0===u.length)return a()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"}},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage",defaultMessage:"Nobody",description:"Caption explaining that nobody has access to this page."}),a()(Oe.Z,{render:e=>d.createElement("div",e,Ge.Z.info({marginLeft:4,height:14,width:14,opacity:.5})),renderTooltip:()=>a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage.tooltip",defaultMessage:"No person, group, or teamspace has any access to this page.",description:"Tooltip explaining what nobody having access to a page means."})}));const m=[];p?m.push(t.formatMessage(jt.sharedWithWorkspaceMembers)):(c.length>0&&0===l.length?m.push(t.formatMessage(jt.sharedWithTeamOwners)):l.length>0&&m.push(t.formatMessage(jt.sharedWithTeamMembers)),r.length>0&&m.push(t.formatMessage(jt.sharedWithMembers,{numMembers:r.length})),o.length>0&&m.push(t.formatMessage(jt.sharedWithGroups,{numGroups:o.length})));s.length>0&&m.push(t.formatMessage(jt.sharedWithGuests,{numGuests:s.length}));u.length>0&&m.push(t.formatMessage(jt.sharedWithBots,{numBots:u.length}));return m.join(t.formatMessage(jt.separator))}(i,n),r=[...i.spacePermission?[{key:"space-permission",render:e=>{var t;return d.createElement(Ut,s()({},e,{permissionItem:null===(t=i.spacePermission)||void 0===t?void 0:t.permissionItem}))},action:()=>{}}]:[],...i.teamOwnerSharePermissions.map((e=>({key:`${e.team_id}-owners`,render:t=>d.createElement(Wt,s()({},t,{onlyOwners:!0,teamId:e.team_id,role:e.role})),action:()=>{}}))),...i.teamSharePermissions.map((e=>({key:`${e.team_id}-members`,render:t=>d.createElement(Wt,s()({},t,{teamId:e.team_id,role:e.role})),action:()=>{}}))),...i.groupPermissions.map((e=>({key:e.id,render:t=>d.createElement(Vt,s()({},t,{name:e.name,icon:e.icon,role:e.role})),action:()=>{}}))),...i.memberUserPermissions.map((e=>({key:e.user_id,render:t=>d.createElement(Gt,s()({},t,{userId:e.user_id,role:e.role})),action:()=>{}}))),...i.guestUserPermissions.map((e=>({key:e.user_id,render:t=>d.createElement(Gt,s()({},t,{isGuest:!0,userId:e.user_id,role:e.role})),action:()=>{}}))),...i.botPermissions.map((e=>({key:e.bot_id,render:t=>d.createElement(Rt,s()({},t,{botId:e.bot_id})),action:()=>{}})))];return a()(Ft.N,{title:o,items:r,disabled:0===r.length})}const Yt=d.memo($t);function Qt(e){let{userStores:t,isClickable:i}=e;window.__c={n:"UsersCell"};const n=(0,f.useIntl)(),o=(0,ke.O7)(),r=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8},avatar:{marginRight:4},plusMore:{opacity:.5,marginLeft:4,display:"inline-block"},tooltip:{color:e.regularInvertedTextColor,fontSize:12}})),[]),l=t[0],c=(0,Te.VK)((()=>{if(l)return l.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(l)}))}),[l]),u=a()("div",{style:r.container},void 0,a()(Ht.Z,{style:r.avatar,userValue:c,size:20}),a()(f.FormattedMessage,{id:"baseTable.usersCell.userName",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser}<gray>+{remainingCount}</gray>} other {{firstUser}<gray>+{remainingCount}</gray>}}",description:"Shows the name of the first user in the list, followed by the number of additional users left that are not shown.",values:{firstUser:(0,qt.Nz)(n,c),remainingCount:t.length-1,gray:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return a()(xe.Z,{style:r.plusMore},void 0,t)}}}));if(!i)return a()(Oe.Z,{disableTooltip:t.length<=1,render:e=>d.createElement("div",e,u),renderTooltip:()=>d.createElement(d.Fragment,null,t.map(((e,t)=>a()(xe.Z,{style:r.tooltip},e?e.id:t,a()(Jt,{userStore:e})))))});const p=t.map(((e,t)=>({key:null!=e&&e.id?null==e?void 0:e.id:t,render:t=>d.createElement(Xt,s()({userStore:e},t)),action:()=>null!=e&&e.getEmail?w.navigateToExternalURL({environment:o,url:`mailto:${null==e?void 0:e.getEmail()}`}):void 0})));return a()(Ft.N,{hideDropdownIcon:!0,title:u,items:p})}function Xt(e){let{userStore:t,...i}=e;window.__c={n:"EmailableUserSummary"};const n=(0,Te.VK)((()=>null==t?void 0:t.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:i}=e;return i(t)}))),[t]),o=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return d.createElement($e.Z,s()({style:o.container},i),a()("div",{style:o.avatarContainer},void 0,a()(Ht.Z,{userValue:n,size:24})),a()("div",{style:o.nameContainer},void 0,a()(xe.Z,{style:o.name},void 0,a()(Jt,{userStore:t})),n?a()(xe.Z,{style:o.email},void 0,n.email):null),a()("div",{style:o.copyContainer},void 0,Ge.Z.mail({height:18,width:18})))}function Jt(e){const t=(0,f.useIntl)(),{userStore:i}=e,n=(0,Te.VK)((()=>null==i?void 0:i.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(i)}))),[i]);return d.createElement(d.Fragment,null,(0,qt.Nz)(t,n))}function ei(e){let{blockStore:t,userIds:i,isClickable:n}=e;window.__c={n:"UsersFromIdsCell"};const o=(0,Te.VK)((()=>i.map((e=>ze.U6.createChildStore(t,{table:Kt.KJ,id:e})))),[t,i]);return a()(Qt,{userStores:o,isClickable:n})}const ti={id:"page",headerTitle:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.name",defaultMessage:"Page",description:"Header for the page column in the admin content search table."}),renderCell:e=>a()(He,{blockStore:e.pageStore,rightIcon:a()(Pt,{blockStore:e.pageStore})}),widthData:{width:320,maxWidth:320},sortable:!1},ii={id:"location",headerTitle:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.location.name",defaultMessage:"Location",description:"Header for the team column in the admin content search table."}),renderCell:e=>a()(wt,{blockStore:e.pageStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},ni={id:"createdTime",headerTitle:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdTime.name",defaultMessage:"Created on",description:"Header for the created on column in the admin content search table."}),renderCell:e=>a()(Ve,{dateTs:e.createdTime}),widthData:{width:140},sortable:!1},ai={id:"lastEditedTime",headerTitle:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedTime.name",defaultMessage:"Last edited on",description:"Header for the last edited on column in the admin content search table."}),renderCell:e=>a()(Ve,{dateTs:e.lastEditedTime}),widthData:{width:140},sortable:!1},oi={id:"createdBy",headerTitle:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdBy.name",defaultMessage:"Created by",description:"Header for the created by column in the admin content search table."}),renderCell:e=>e.createdById?a()(ei,{blockStore:e.pageStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},si={id:"lastEditedBy",headerTitle:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedBy.name",defaultMessage:"Last edited by",description:"Header for the last edited by column in the admin content search table."}),renderCell:e=>e.lastEditedById?a()(ei,{blockStore:e.pageStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},ri=[ti,ii,{id:"audience",headerTitle:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audience.name",defaultMessage:"Audience",description:"Header for the audience column in the admin content search table."}),renderCell:e=>a()(ft,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},{id:"sharedWith",headerTitle:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWith.name",defaultMessage:"Shared with",description:"Header for the shared with column in the admin content search table."}),renderCell:e=>a()(Yt,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},si,ai,oi,ni];function li(e){let{loading:t,error:i,loadNextPage:n,filters:o,setFilters:s,pageStores:r,showSuggestions:l,runNewSearch:c}=e;const u=(0,Te.VK)((()=>{const e=I.default.state.currentSpaceViewStore,t=null==e?void 0:e.getSettings();return null==t?void 0:t.admin_content_search_acknowledgement}),[]),p=u&&!t&&!l,m=u&&!l,g=(0,Te.VK)((()=>r.map((e=>({id:e.id,isClickable:!1,pageStore:e,teamStore:(0,Ee.VP)(e),createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById()})))),[r]),h=(0,_e.yK)((e=>(0,De.b)({columnRenderInfo:ri,theme:e,containerMarginTop:0})),[]);return i?a()(Xe,{runNewSearch:c,error:i}):u?l&&0===g.length?a()(pt,{filters:o,setFilters:s}):d.createElement(d.Fragment,null,a()(De.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:400,columnRenderInfo:ri,rows:g,onScrollBottom:m?n:void 0,renderNoRowsComponent:()=>a()(xe.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,p&&a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.empty",defaultMessage:"No pages found with your query.",description:"Message displayed on the table that shows workspace pages if there are no pages to show."})),styles:h}),t?a()(Re.Z,{style:{margin:"24px auto 24px"}}):null):a()(Ye,{})}var di=i(2438);function ci(e){let{spaceStore:t}=e;return(0,Te.VK)((()=>{const{data:e}=Se.default.state;if(!e)return{loading:!0};const i=K.CM(e);if(!i.every((e=>ze.U6.createChildStore(t,{table:Kt.KJ,id:e.userId}).isReady())))return{loading:!0};const n=i.filter(di.CF),a=i.filter(di.du);return{loading:!1,members:n.map((e=>{let{userId:i}=e;return ze.U6.createChildStore(t,{table:Kt.KJ,id:i})})),guests:a.map((e=>{let{userId:i}=e;return ze.U6.createChildStore(t,{table:Kt.KJ,id:i})}))}}),[t])}var ui=i(84619),pi=i(16639),mi=i(43145),gi=i(46978),hi=i(85567),fi=i(719);const vi=(0,f.defineMessages)({usersPlaceholder:{id:"adminContentSearchTab.pagesTable.filters.users.usersPlaceholder",defaultMessage:"Search for users...",description:"Placeholder text for searching for users textbox."},usersAndGroupsPlaceholder:{id:"adminContentSearchTab.pagesTable.filters.users.usersAndGroupsPlaceholder",defaultMessage:"Search for users and groups...",description:"Placeholder text for searching for users and groups textbox."}});function yi(e){let{userStores:t,title:i,selectedIds:n,setSelectedItems:o,onMenuClose:r,isMultiSelect:l,includePermissionGroups:c,guestUserIdSet:u}=e;window.__c={n:"UsersFilter"};const p=(0,f.useIntl)(),m=(0,Te.qz)(void 0,et.Z),g=(0,_e.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:8},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%",maxHeight:200,overflowY:"auto"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},defaultGroupIcon:{height:22,width:22,color:e.mediumTextColor,fill:"currentColor"},defaultGroupIconPill:{height:14,width:14,color:e.mediumTextColor,fill:"currentColor"},groupIconSpacing:{marginRight:8},pillContainer:{margin:"0px 6px 6px 0px",background:e.legacyDefaultSelectColor,height:20},guestPillContainer:{margin:"0px 6px 6px 0px",background:e.guestTokenBackground,height:20},guestIcon:{height:16,width:16,color:e.guestIconColor},pillContents:{display:"inline-flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},pillText:{marginLeft:4},noResultsMessage:{width:"100%",margin:"8px 12px"},optionTitle:{display:"block"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"}})),[]),[h,v]=(0,d.useState)(10),[y,b]=(0,d.useState)(!1),[S,w]=(0,d.useState)(""),M=t.length,C=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),k=(0,Te.VK)((()=>{const e=I.default.state.currentSpaceStore;return c&&e?e.getPermissionGroups():[]}),[c]),_=(0,Te.VK)((()=>n.map((e=>t.find((t=>t.id===e)))).filter(T.$K)),[n,t]),x=(0,Te.VK)((()=>n.map((e=>k.find((t=>t.id===e)))).filter(T.$K)),[n,k]);function Z(){v(10),b(!1),w(""),r()}function P(){w(""),o([])}function F(e){e<5&&h<M&&v(h+10)}function A(e){if(l){return n.includes(e)?[...n.filter((t=>t!==e))]:[...n,e]}return n.includes(e)?[]:[e]}function B(e){const t=A(e).map((e=>({id:e,type:"user"})));o(t),w("")}function E(e){const t=A(e).map((e=>({id:e,type:"permission_group"})));o(t),w("")}const D=(0,d.useCallback)((e=>{w(e.target.value)}),[]),R=(0,Te.VK)((()=>_.map((e=>{const t=(0,qt.Nz)(p,e.getModel()),i=!!u&&u.has(e.id);return a()(hi.Z,{isSingle:!0,format:ui.l.Inline,showRemoveButton:!0,onClickRemove:()=>{const t=n.filter((t=>t!==e.id)).map((e=>({id:e,type:"user"})));o(t)},style:i?g.guestPillContainer:g.pillContainer,value:a()("div",{style:g.pillContents},void 0,i?Ge.Z.globe2(g.guestIcon):a()(Ht.Z,{userStore:e,size:16}),a()(xe.Z,{style:g.pillText},void 0,t))},e.id)}))),[n,_,o,u,g,p]),L=(0,Te.VK)((()=>x.map((e=>{const t=pi.kF({intl:p,group:e});return a()(hi.Z,{isSingle:!0,format:ui.l.Inline,showRemoveButton:!0,onClickRemove:()=>{const t=n.filter((t=>t!==e.id)).map((e=>({id:e,type:"permission_group"})));o(t)},style:g.pillContainer,value:a()("div",{style:g.pillContents},void 0,a()(Ke.Z,{disabled:!0,icon:e.icon&&C?{pointer:C.pointer,icon:e.icon}:void 0,size:14,isEmptyPage:!1,title:t,defaultIcon:Ge.Z.typesPerson(g.defaultGroupIconPill),style:g.groupIconSpacing}),a()(xe.Z,{style:g.pillText},void 0,t))},e.id)}))),[n,x,o,g,C,p]);const O=a()(tt.u,{on:n.length>0,icon:Ge.Z.person(g.icon),title:i,onClick:()=>b(!0)});return a()(lt.Z,{},void 0,a()(st.ZP,{popupType:st.ZP.PopupType.Popup,placementToOrigin:st.ZP.Placement.Bottom,alignmentToOrigin:st.ZP.Alignment.Start,open:y,render:function(){const e=[];for(const c of t){var i;const t=(0,qt.Nz)(p,c.getModel()),o=!!u&&u.has(c.id);(t.toLocaleLowerCase().includes(S)||null!==(i=c.getEmail())&&void 0!==i&&i.toLocaleLowerCase().includes(S))&&e.push({key:c.id,action:()=>B(c.id),render:e=>d.createElement(it.Z,s()({},e,{icon:l?a()(nt.Z,{checked:n.includes(c.id),onClick:()=>B(c.id),size:16}):a()(gi.Z,{isSelected:n.includes(c.id)}),focused:!1,title:a()("div",{style:g.optionContainer},void 0,a()(Ht.Z,{userStore:c,size:24,style:g.optionAvatar}),a()("div",{style:{paddingTop:4,paddingBottom:4}},void 0,a()(xe.Z,{style:g.optionTitle},void 0,t),a()(xe.Z,{style:g.optionCaption},void 0,a()(f.FormattedMessage,o?{id:"adminContentSearchTab.pagesTable.filters.users.guestCaption",description:"Caption indicating that this user option is a guest of the workspace.",defaultMessage:"Guest"}:{id:"adminContentSearchTab.pagesTable.filters.users.memberCaption",description:"Caption indicating that this user option is a member of the workspace.",defaultMessage:"Member"}))))}))})}const o=[];for(const t of k){const e=pi.kF({intl:p,group:t});e.toLocaleLowerCase().includes(S)&&o.push({key:t.id,action:()=>E(t.id),render:i=>d.createElement(it.Z,s()({},i,{icon:l?a()(nt.Z,{checked:n.includes(t.id),onClick:()=>E(t.id),size:16}):a()(gi.Z,{isSelected:n.includes(t.id)}),focused:!1,title:a()("div",{style:g.optionContainer},void 0,a()(Ke.Z,{disabled:!0,icon:t.icon&&C?{pointer:C.pointer,icon:t.icon}:void 0,size:22,isEmptyPage:!1,title:e,defaultIcon:Ge.Z.typesPerson(g.defaultGroupIcon),style:g.groupIconSpacing}),a()("div",{style:{paddingTop:4,paddingBottom:4}},void 0,a()(xe.Z,{style:g.optionTitle},void 0,e),a()(xe.Z,{style:g.optionCaption},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.groupCaption",description:"Caption indicating that this user option is a group in the workspace.",defaultMessage:"Group"}))))}))})}const r={key:"no-results",action:()=>{},render:e=>d.createElement(xe.Z,s()({isSecondaryColor:!0,style:g.noResultsMessage},e),a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.noResultsMessage",description:"Message in the users dropdown to indicate that no results were found.",defaultMessage:"No results found."}))},v=[...e,...o],y={key:"userOptions",items:v.length>0?v.slice(0,h):[r],render:e=>d.createElement(rt.Z,s()({},e,{title:null,loading:!1}))};return a()("div",{style:g.container},void 0,a()(fi.Z,{focus:!0,value:S,style:g.input,placeholder:V.default.formatMessage(c?vi.usersAndGroupsPlaceholder:vi.usersPlaceholder),onChange:D,onRemoveLastToken:()=>{},tokens:[...R,...L]}),a()(at.Z,{menuType:Je.og.Popup,header:null,maxHeight:250,width:300},void 0,a()(ot.Z,{type:ot.i.Vertical,store:m,initialFocus:0,sections:[y]}),a()(mi.Z,{onChange:F})),a()(rt.Z,{topBorder:!0,style:g.footer},void 0,a()($e.Z,{onClick:P},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.clearButton",description:"Label for the button that resets the selected users back to empty.",defaultMessage:"Clear"})),a()(je.Z,{onClick:Z},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.doneButton",description:"Label for the button that closes the menu.",defaultMessage:"Done"}))))},onDismiss:Z,keepFocus:!0,origin:O,preventScaleTransition:!0}))}function bi(e){let{spaceStore:t,createdByFilterIds:i,setCreatedByFilter:n,runNewSearch:o,includeGuests:s}=e;window.__c={n:"CreatedByFilter"};const r=ci({spaceStore:t}),l=(0,d.useMemo)((()=>r.loading?[]:s?[...r.members,...r.guests]:r.members),[r,s]),c=(0,d.useMemo)((()=>r.loading?new Set:new Set(r.guests.map((e=>e.id)))),[r]);return a()(yi,{userStores:l,title:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdBy.title",defaultMessage:"Created by",description:"Title of the filter that lets the user filter page results by the created by field."}),selectedIds:i,setSelectedItems:function(e){const t=e.map((e=>{let{id:t}=e;return t}));n(t)},onMenuClose:o,guestUserIdSet:c})}var Si=i(32918),wi=i(80084),Mi=i(64921),Ci=i(14871),ki=i(76150),Ti=i(13854),_i=i(41558),Ii=i(3386),xi=i(67950),Zi=i(40721),Pi=i(86825),Fi=i(46945),Ai=i(16953);const Bi="Invalid date",Ei="Invalid range";class Di extends Z.Z{getInitialState(){return{dateEdited:!1,timeEdited:!1,temporaryValue:{date:void 0,time:void 0},error:void 0}}}const Ri=Di;var Li=i(74194);class Oi extends c.Z{constructor(){super(...arguments),this.storeTypes={store:Ri},this.renderInput=()=>{const{device:e}=this.environment,{store:t,hideClearButton:i,focus:n,showTime:o,placeholder:r,...l}=this.props,c=e.isMobile?"date":"text",u=e.isMobile?"time":"text",p=Li.Z.Format.Transparent,m=e.isMobile?void 0:n;return a()("div",{style:{display:"flex",alignItems:"center",borderRadius:3,lineHeight:2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%",...this.getInputStyles().inputOuterStyle}},void 0,d.createElement(Li.Z,s()({},l,{type:c,format:p,placeholder:r,focus:"date"===m,onFocus:this.handleDateFocus,onChange:this.handleDateChange,onSubmit:e=>this.handleSubmit(e,"date"),onBlur:this.handleBlur,value:this.getDateInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:!o&&this.showClearButton(),onClearButtonClick:this.handleClear})),o&&d.createElement(d.Fragment,null,a()("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}}),d.createElement(Li.Z,s()({},l,{placeholder:V.default.formatMessage(Vi.timePlaceholder),type:u,format:p,focus:"time"===m,onFocus:this.handleTimeFocus,onChange:this.handleTimeChange,onSubmit:e=>this.handleSubmit(e,"time"),onBlur:this.handleBlur,value:this.getTimeInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:this.showClearButton(),onClearButtonClick:this.handleClear}))))},this.handleDateFocus=e=>{const{onDateFocus:t}=this.props,{store:i}=this.stores;i.setState({...i.state,dateEdited:!1}),t&&t(e)},this.handleTimeFocus=e=>{const{onTimeFocus:t}=this.props,{store:i}=this.stores;i.setState({...i.state,timeEdited:!1}),t&&t(e)},this.handleClear=()=>{const{onClear:e,onUpdate:t}=this.props,{store:i}=this.stores;i.setState({...i.state,dateEdited:!0,timeEdited:!0,temporaryValue:{date:void 0,time:void 0},error:void 0});const n=this.validateCurrent();n&&t(n),i.setState({...i.state,dateEdited:!1,timeEdited:!1}),e&&e()},this.handleDateChange=e=>{const{device:t}=this.environment,{store:i}=this.stores;i.setState({...i.state,dateEdited:!0,temporaryValue:{...i.state.temporaryValue,date:e.target.value||""}}),t.isAndroid&&this.handleBlur()},this.handleTimeChange=e=>{const{device:t}=this.environment,{store:i}=this.stores;i.setState({...i.state,timeEdited:!0,temporaryValue:{...i.state.temporaryValue,time:e.target.value||""}}),t.isAndroid&&this.handleBlur()},this.handleSubmit=(e,t)=>{var i,n;const{onUpdate:a,onSubmit:o,showTime:s}=this.props,{store:r}=this.stores;let l;(!s||"date"===t&&null!==(i=this.props.value)&&void 0!==i&&i.start_time||"time"===t&&null!==(n=this.props.value)&&void 0!==n&&n.start_date)&&(l=this.validateCurrent(),l&&(a(l),l.error?r.setState({...r.state,dateEdited:!1,error:l.error}):r.reset())),o&&o(e,l)},this.handleBlur=e=>{const{onUpdate:t,onBlur:i}=this.props,{store:n}=this.stores,a=this.validateCurrent();a?(t(a),a.error?n.setState({...n.state,dateEdited:!1,timeEdited:!1,error:a.error}):n.reset()):n.setState({...n.state,dateEdited:!1,timeEdited:!1}),e&&i&&i(e)},this.styles={menuItem:{marginBottom:this.environment.device.isMobile?1:12},inputWrapper:{borderRadius:3,height:28,paddingRight:this.showClearButton()?6:0,position:"relative"},inputEditRegion:{width:this.showClearButton()?"calc(100% - 14px)":"100%"},inputEditRegionMobile:{padding:"2px 6px",position:"relative"},tooltipOriginGap:-8}}didUpdate(e){const{store:t}=this.stores;l().isEqual(e.value,this.props.value)||t.reset()}renderComponent(){const e=this.styles,t=this.getError();return t?a()(Oe.Z,{renderTooltip:()=>t,forceVisibleState:!0,placement:Oe.Z.Placement.Left,render:this.renderInput,originGap:e.tooltipOriginGap}):this.renderInput()}getDateInputValue(){const{device:e}=this.environment,{value:t,intl:i}=this.props,{store:n}=this.stores;return e.isMobile?t?Q.dd(t,i):"":n.state.temporaryValue.date?n.state.temporaryValue.date:n.state.dateEdited?n.state.temporaryValue.date||"":t?Q.dd(t,i):""}getTimeInputValue(){const{device:e}=this.environment,{value:t,intl:i}=this.props,{store:n}=this.stores;return e.isMobile?t?Q.KN(t,i):"":n.state.temporaryValue.time?n.state.temporaryValue.time:n.state.timeEdited?n.state.temporaryValue.time||"":t?Q.KN(t,i):""}getError(){const{store:e}=this.stores,{intl:t}=this.props;if(e.state.error)switch(e.state.error){case Bi:return t.formatMessage({id:"dateInputError.invalidDateError.tooltip",defaultMessage:"Invalid date"});case Ei:return t.formatMessage({id:"dateInputError.invalidDateRangeError.tooltip",defaultMessage:"Invalid range"});default:(0,T.t1)(e.state.error)}}validateCurrent(){const{validate:e}=this.props,t=this.parseCurrentDateTimeValue();if(t)return e?e(t):t}parseCurrentDateTimeValue(){const{store:e}=this.stores,{value:t,showTime:i,isEndingDate:n}=this.props;if(!e.state.dateEdited&&!e.state.timeEdited)return;if(!e.state.temporaryValue.date&&!e.state.temporaryValue.time)return{value:void 0};const a=(0,Ai.parseDateValue)(e.state.temporaryValue.date||"",this.props.intl);if(a){let e="";return e=i?(null==t?void 0:t.start_time)||"00:00":n?"23:59":"00:00",{value:{type:"datetime",start_date:a,time_zone:(null==t?void 0:t.time_zone)||(0,We.r)(),start_time:e}}}const o=(0,Ai.parseTimeValue)(e.state.temporaryValue.time||"",this.props.intl);return(null!=t&&t.start_date||a)&&o?{value:{type:"datetime",start_date:(null==t?void 0:t.start_date)||a,start_time:o,time_zone:(null==t?void 0:t.time_zone)||(0,We.r)()}}:{error:Bi}}showClearButton(){const{device:e}=this.environment,{hideClearButton:t}=this.props;return!!e.isMobile||!t}getInputStyles(){const{device:e}=this.environment,{inputStyle:t,inputOuterStyle:i,style:n}=this.props,a=this.styles;return{style:{...a.menuItem,...n},inputOuterStyle:{...a.inputWrapper,...i,...this.getInputBorders()},inputStyle:{...a.inputEditRegion,...e.isMobile&&a.inputEditRegionMobile,...t}}}getInputBorders(){const{disabled:e,focus:t}=this.props,i=this.getThemeColors(),n=this.getError();if(!e)return n?i.inputError:t?i.inputFocused:i.inputDefault}getThemeColors(){return{inputDefault:{background:this.theme.inputBackground,boxShadow:this.theme.inputBoxShadow},inputFocused:{boxShadow:this.theme.outlineBlueInputBoxShadow},inputError:{boxShadow:this.theme.outlineRedInputBoxShadow},placeholder:{color:this.theme.lightTextColor}}}}Oi.displayName="DateTimeInputMenuItem";const Ni=(0,f.injectIntl)(Oi),Vi=(0,f.defineMessages)({startingDateMessage:{defaultMessage:"Starting",id:"auditLog.dateTimeRangeMenu.startingDatePlaceholder",description:"Placeholder for the starting date in audit log date filter."},endingDateMessage:{defaultMessage:"Ending",id:"auditLog.dateTimeRangeMenu.endingDatePlaceholder",description:"Placeholder for the ending date in audit log date filter."},timePlaceholder:{defaultMessage:"12:00 AM",id:"auditLog.dateTimeRangeMenu.timePlaceholderInNumber",description:"Placeholder for the time input in audit log. 12 is the hour, 00 is the minutes, and AM/PM is morning vs afternoon."}});class Ui extends c.Z{constructor(){super(...arguments),this.storeTypes={store:Ti.ZP,dayRangeStore:_i.Z},this.renderInputs=()=>{const{device:e,WindowSizeStore:t}=this.environment,{value:i,disabled:n}=this.props,{store:o}=this.stores,s=o.getFocus();let r="date";s!==ki.Hv.StartTime&&s!==ki.Hv.EndTime||(r="time");const l=this.getRangeBounds();return a()("div",{style:{paddingTop:e.isMobile?16:12,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:o.state.showTime?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0}},void 0,a()(Ni,{disabled:n,placeholder:V.default.formatMessage(Vi.startingDateMessage),focus:s===ki.Hv.StartDate||s===ki.Hv.StartTime?r:void 0,value:i.starting,validate:this.validateStart,onUpdate:this.handleUpdateStart,onDateFocus:()=>this.handleDateFocus(ki.Hv.StartDate),onTimeFocus:()=>this.handleTimeFocus(ki.Hv.StartTime),onSubmit:(e,t)=>this.handleStartSubmit(e,t,s),inputElementAttributes:{max:l.latestValidStarting},showTime:o.state.showTime}),a()("div",{style:{width:12,height:8}}),a()(Ni,{disabled:n,placeholder:V.default.formatMessage(Vi.endingDateMessage),focus:s===ki.Hv.EndDate||s===ki.Hv.EndTime?r:void 0,value:i.ending,validate:this.validateEnd,onUpdate:this.handleUpdateEnd,onDateFocus:()=>this.handleDateFocus(ki.Hv.EndDate),onTimeFocus:()=>this.handleTimeFocus(ki.Hv.EndTime),onSubmit:(e,t)=>this.handleEndSubmit(e,t,s),inputElementAttributes:{min:l.earliestValidEnding},showTime:o.state.showTime}))},this.renderCalendar=()=>{const{device:e}=this.environment,{value:t,onUpdate:i}=this.props,{store:n,dayRangeStore:o}=this.stores,s=this.styles,r=this.getThemeColors(),l={...s.pickerSection,...e.isMobile&&s.pickerSectionMobile,...e.isMobile&&r.pickerSectionMobile};return a()(rt.Z,{},void 0,a()("div",{style:l},void 0,a()(Fi.Z,{value:Q.Zy(t),dateTimeStore:n,store:o,onUpdate:e=>{if(e.error)return;const n=Q.PM(t,e.value);return i({error:e.error,value:n})},validate:this.validateDateRangeField})))},this.handleDateFocus=e=>{const{store:t,dayRangeStore:i}=this.stores;t.setState({...t.state,focus:e});const n=Ti.QJ[e];i.setState({...i.state,focus:n})},this.handleTimeFocus=e=>{const{store:t}=this.stores;t.setState({...t.state,focus:e})},this.handleUpdateStart=e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,starting:e.value}})},this.handleUpdateEnd=e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,ending:e.value}})},this.handleStartSubmit=(e,t,i)=>{const{store:n,dayRangeStore:a}=this.stores;t&&t.error||(i===ki.Hv.StartDate&&n.state.showTime?n.setState({...n.state,focus:ki.Hv.StartTime}):(n.setState({...n.state,focus:ki.Hv.EndDate}),a.setState({...a.state,focus:"ending"})))},this.handleEndSubmit=(e,t,i)=>{const{store:n}=this.stores;t&&t.error||i===ki.Hv.EndDate&&n.state.showTime&&n.setState({...n.state,focus:ki.Hv.EndTime})},this.validateStart=e=>{const t=this.validateField("starting",e);return t.error?t:{value:t.value.starting}},this.validateEnd=e=>{const t=this.validateField("ending",e);return t.error?t:{value:t.value.ending}},this.validateField=(e,t)=>{const{value:i}=this.props;return t.error?t:this.validateRange({...i,[e]:t.value})},this.validateRange=e=>{if(e.starting&&e.ending){const t=H.OQ.notionDateTimeToLuxon(e.starting);return H.OQ.notionDateTimeToLuxon(e.ending)>=t?{value:e}:{error:xi.B.INVALID_RANGE}}return{value:e}},this.getMenuProps=()=>{const{device:e}=this.environment,{onDismiss:t,title:i}=this.props;if(e.isMobile){return{menuType:Je.og.Modal,title:i,right:a()(Zi.DoneMenuText,{}),onClickRight:t,header:this.renderInputs()}}return{menuType:Je.og.Popup,onClickOutside:t,footer:this.props.footer}},this.validateDateRangeField=(e,t)=>{const{value:i}=this.props;if(t.error)return t;const n=Q.Zy(i);return this.validateDateRange({...n,[e]:t.value})},this.validateDateRange=e=>{if(e.starting&&e.ending){const t=H.OQ.notionDateToLuxon(e.starting);return H.OQ.notionDateToLuxon(e.ending)>=t?{value:e}:{error:xi.B.INVALID_RANGE}}return{value:e}},this.styles={pickerSection:{paddingLeft:16,paddingRight:16},pickerSectionMobile:{paddingTop:16,paddingBottom:8},sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 220px",backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:`1px solid ${this.theme.regularDividerColor}`,maxWidth:"fit-content"},menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4,color:this.theme.mediumTextColor}}}didMount(){const{store:e}=this.stores;void 0!==this.props.showTime&&e.setState({...e.state,showTime:this.props.showTime})}renderComponent(){const{device:e}=this.environment;return d.createElement(at.Z,this.getMenuProps(),a()("div",{style:{display:"flex",flexDirection:"row"}},void 0,a()("div",{},void 0,this.props.header,!e.isMobile&&this.renderInputs(),this.renderCalendar()),this.renderSidebar()))}renderSidebar(){const{store:e}=this.stores,{onUpdate:t,value:i,hideTime:n}=this.props;return a()("aside",{style:this.styles.sidebar},void 0,n?null:a()(Pi.Z,{title:a()(f.FormattedMessage,{id:"auditlogDateFilter.timeToggle",defaultMessage:"Use time",description:"Toggle to show or not show time in audit log date filter."}),on:e.state.showTime,onClick:()=>{if(e.toggleShowTime(),e.state.showTime){const e=i;e.starting&&(e.starting.start_time="00:00"),e.ending&&(e.ending.start_time="23:59"),t({value:e})}},focused:!1}),a()(it.Z,{focused:!1,title:a()(f.FormattedMessage,{id:"auditlogDateFilter.quickFilters.today",defaultMessage:"Today"}),onClick:()=>{const e=Date.now(),t=H.CQ(e,(0,We.r)());this.setStoresTemporaryValue({starting:{...t,start_time:"00:00"},ending:t})},style:this.styles.menuItem}),a()(it.Z,{focused:!1,title:a()(f.FormattedMessage,{id:"auditlogDateFilter.quickFilters.yesterday",defaultMessage:"Yesterday"}),onClick:()=>{const e=H.Cv((0,We.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,We.r)()},ending:{type:"datetime",start_date:e.start_date,start_time:"23:59",time_zone:(0,We.r)()}})},style:this.styles.menuItem}),a()(it.Z,{focused:!1,title:a()(f.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastWeek",defaultMessage:"Last 7 days"}),onClick:()=>{const e=H.Oo((0,We.r)()),t=H.CQ(Date.now(),(0,We.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,We.r)()},ending:t})},style:this.styles.menuItem}),a()(it.Z,{focused:!1,title:a()(f.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastMonth",defaultMessage:"Last 30 days"}),onClick:()=>{const e=H.dj((0,We.r)()),t=H.CQ(Date.now(),(0,We.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,We.r)()},ending:t})},style:this.styles.menuItem}))}setStoresTemporaryValue(e){const{store:t,dayRangeStore:i}=this.stores;e.ending&&this.handleDateFocus(ki.Hv.EndDate),t.setState({...t.state,temporaryDateRange:e}),i.setState({...i.state,displayMonth:e.starting||e.ending?H.Sy(e.starting||e.ending):void 0,temporaryDateRange:{starting:Q.Qb(e.starting),ending:Q.Qb(e.ending)}})}getRangeBounds(){const{value:e,intl:t}=this.props;return{earliestValidEnding:e.starting&&Q.o0(e.starting,t),latestValidStarting:e.ending&&Q.o0(e.ending,t)}}getThemeColors(){return{pickerSectionMobile:{background:this.theme.popoverBackground,boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1}}}}Ui.displayName="DateTimeRangeMenu";const Wi=(0,f.injectIntl)(Ui);var zi=i(255),Ki=i(98707),qi=i(75689);class Hi extends c.Z{constructor(){super(...arguments),this.storeTypes={store:Ti.ZP,dayRangeStore:_i.Z},this.renderActiveButtonOrigin=()=>{const{value:e,disabled:t,focused:i,intl:n}=this.props,o=this.styles,s=this.getThemeColors(),r={...o.menuItem,...s.activeMenuItem},l=wi._Q(e,n),d=a()(zi.Z,{onClick:this.handleClear,disabled:t});return a()(it.Z,{focused:i,disabled:t,icon:Ge.Z.calendar(o.iconActiveDesktop),title:l,right:d,isTokenTitle:!0,alignIconTop:!0,onClick:this.handleOriginActivate,desktopTitleStyle:o.menuItemTitleDesktop,desktopIconStyle:o.iconActiveDesktopWrapper,style:r})},this.renderInactiveButtonOrigin=()=>{const{title:e,icon:t,disabled:i,focused:n,mode:o}=this.props,s=this.styles,r=this.getThemeColors(),l={...s.menuItem,...r.buttonMenuItem,...o===Ki.Z.Mode.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return a()(it.Z,{focused:n,disabled:i,icon:t(s.icon),title:e,onClick:this.handleOriginActivate,style:l})},this.renderPillButtonOrigin=()=>{const{value:e,pillTitle:t}=this.props,i=a()(f.FormattedMessage,{id:"searchDateFilter.shortTitle",defaultMessage:"Date"});return a()(tt.u,{on:Boolean(e.starting||e.ending),icon:Ge.Z.calendar({width:16,marginRight:6,fill:"currentColor"}),title:a()("span",{},void 0,t||i),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e,header:t,showButtons:i,sidebar:n,hideTime:o}=this.props,{store:s,dayRangeStore:r}=this.stores;return d.createElement(d.Fragment,null,a()(Wi,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:s,dayRangeStore:r,onDismiss:this.handleMenuClose,footer:"footer"===i&&this.renderFooter(),sidebar:n,hideTime:o,header:t}),"side"===i&&a()("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"}},void 0,a()($e.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleMenuClose},void 0,a()(f.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})),a()(je.Z,{onClick:()=>this.props.onChange(this.stores.store.state.temporaryDateRange)},void 0,a()(f.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"}))))},this.renderFooter=()=>{const{store:e,dayRangeStore:t}=this.stores;return a()(rt.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"}},void 0,a()($e.Z,{onClick:()=>{e.clearTemporaryDateRange(),t.clearTemporaryDateRange(),this.props.onChange({starting:void 0,ending:void 0})}},void 0,a()(f.FormattedMessage,{id:"searchDateFilter.clearButton",defaultMessage:"Clear"})),a()(je.Z,{onClick:e=>{this.props.onChange(this.stores.store.state.temporaryDateRange),this.handleMenuClose(e)}},void 0,a()(f.FormattedMessage,{id:"searchDateFilter.applyButton",defaultMessage:"Apply"})))},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t,dayRangeStore:i}=this.stores;e||(t.setState({...t.state,isOpen:!0,focus:ki.Hv.StartDate}),i.setState({...i.state,isOpen:!0,focus:"starting"}))},this.handleMenuClose=e=>{const{onChange:t,onMenuDismiss:i,showButtons:n}=this.props,{store:a,dayRangeStore:o}=this.stores,{temporaryDateRange:s}=a.state;wi.zD(e)||(n||t(s),a.setState({...a.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),o.setState({...o.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),i&&i())},this.handleClear=()=>{const{onChange:e}=this.props;e({starting:void 0,ending:void 0})},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t,dayRangeStore:i}=this.stores;if(e.error)return;const n={starting:(0,Q.Qb)(e.value.starting),ending:(0,Q.Qb)(e.value.ending)};return i.setState({...i.state,temporaryDateRange:{...i.state.temporaryDateRange,...n}}),t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:16,width:16,marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:0,paddingBottom:8},popupWithSidebar:{display:"flex"},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t,sidebar:i}=this.props,{store:n}=this.stores,o=this.styles,s=e===Ki.z.Section,r=s?t:void 0,l=(()=>e===Ki.Z.Mode.Section?this.renderActiveButtonOrigin():e===Ki.Z.Mode.Button?this.renderInactiveButtonOrigin():e===Ki.Z.Mode.Pill?this.renderPillButtonOrigin():void(0,T.t1)(e))();return a()(lt.Z,{title:r,marginAfter:s},void 0,a()(Ii.Z,{capture:n.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey},void 0,a()(st.ZP,{popupType:this.getPopupType(),open:n.state.isOpen,origin:l,render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:st.ZP.Placement.Bottom,alignmentToOrigin:st.ZP.Alignment.Start,style:i?o.popupWithSidebar:o.popup})))}renderMobile(e){const{store:t}=this.stores,i=e===Ki.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return a()(st.ZP,{popupType:st.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:i,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:i}=this.props,n=this.styles;return a()(it.Z,{disabled:i,focused:!1,icon:e(n.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,disabled:i,intl:n}=this.props,o=this.styles,s=a()("div",{style:o.summary},void 0,Ge.Z.calendar(o.iconActiveMobile),wi._Q(t,n));return a()(qi.Z,{disabled:i,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:s})}getCurrentValue(){const{value:e}=this.props,{store:t}=this.stores,{temporaryDateRange:i}=t.state;return{...e,...i}}getPopupType(){const{device:e}=this.environment;return e.isMobile?xt.Z.PopupType.SlideUp:xt.Z.PopupType.Popup}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},activeMenuItem:{color:this.theme.regularTextColor}}}}Hi.displayName="DateTimeFilter";const Gi=(0,f.injectIntl)(Hi);function ji(e){let{lastEditedTime:t,createdTime:i,setLastEditedTime:n,setCreatedOnTime:o}=e;window.__c={n:"DateFilter"};const s=(0,f.useIntl)(),[r,l]=(0,d.useState)("createdTime"),c=(0,d.useMemo)((()=>{switch(r){case"createdTime":return i;case"lastEditedTime":return t;default:(0,T.t1)(r)}}),[t,i,r]),u=(0,d.useMemo)((()=>{switch(r){case"createdTime":return o;case"lastEditedTime":return n;default:(0,T.t1)(r)}}),[n,o,r]);const p=(0,Te.VK)((()=>{if((0,Q.mK)(c))switch(r){case"createdTime":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.title",description:"Label for the filter that can set the created on time window on the admin content search table.",defaultMessage:"Created on"});case"lastEditedTime":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.title",description:"Label for the filter that can set the last edited time window on the admin content search table.",defaultMessage:"Last edited on"});default:(0,T.t1)(r)}const e=(0,Q.Hq)(c),t=wi._Q(e,s,Si.sF);switch(r){case"createdTime":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.titleWithDateRange",description:"Label for the filter that can set the created on time window on the admin content search table with an existing date range enabled.",defaultMessage:"Created on: {dateRangeString}",values:{dateRangeString:t}});case"lastEditedTime":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.titleWithDateRange",description:"Label for the filter that can set the last edited time window on the admin content search table with an existing date range enabled.",defaultMessage:"Last edited on: {dateRangeString}",values:{dateRangeString:t}});default:(0,T.t1)(r)}}),[c,r,s]);return a()(Gi,{header:a()($i,{selectedItem:r,setSelectedItem:function(e){l(e)}}),mode:Ki.z.Pill,focused:!1,hideTime:!0,pillTitle:p,title:p,icon:Ge.Z.calendar,value:c,showButtons:"footer",onChange:e=>{u(e)}})}function $i(e){let{selectedItem:t,setSelectedItem:i}=e;window.__c={n:"DateTimeFilterSelector"};const n=(0,_e.yK)((e=>({button:{margin:"14px 12px 4px",padding:"2px 8px",width:"fit-content",borderRadius:3},text:{display:"flex",alignItems:"center",color:e.mediumTextColor,fill:e.lightIconColor,fontWeight:500,fontSize:13},icon:{height:10,width:10,marginLeft:4}})),[]),o={width:190,items:["createdTime","lastEditedTime"],selectedItem:t,getKey:e=>e,onSelect:e=>i(e),renderItem:e=>d.createElement(it.Z,s()({title:Yi(e.value)},e)),renderOrigin:e=>d.createElement(Mi.Z,s()({},e,{style:n.button}),a()("div",{style:n.text},void 0,Yi(t),Ge.Z.chevronDown(n.icon)))};return d.createElement(Ci.Z,s()({},o,{mobileActionSheet:!0}))}function Yi(e){return{lastEditedTime:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.option",defaultMessage:"Last edited on",description:"Label for the filter option that can set the last edited time window on the admin content search table."}),createdTime:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.option",defaultMessage:"Created on",description:"Label for the filter option that can set the last edited time window on the admin content search table."})}[e]}let Qi;!function(e){e.OnChange="on-change",e.Button="button"}(Qi||(Qi={}));const Xi=(0,f.defineMessages)({placeholder:{id:"adminContentSearchTab.pagesTable.filters.query.placeholder",defaultMessage:"Search by page ID, title or content",description:"Placeholder text for writing a new query textbox."}});function Ji(e){let{mode:t,query:i,setQueryFilter:n,placeholderText:o}=e;window.__c={n:"QuerySearchInput"};const[s,l]=(0,d.useState)(i??""),c=(0,_e.yK)((e=>({searchIcon:{color:e.lightIconColor,width:14},input:{padding:"4px 4px 4px 10px",margin:"0 auto 8px",width:"100%",background:e.modalBackground}})),[]),u=(0,d.useMemo)((()=>(0,r.debounce)(n,500)),[n]),p=(0,d.useCallback)((e=>{l(e.target.value),t===Qi.OnChange&&u(e.target.value)}),[u,t]);return a()(Li.Z,{value:s,style:c.input,left:Ge.Z.collectionSearch(c.searchIcon),placeholder:o||V.default.formatMessage(Xi.placeholder),onChange:p,onSubmit:()=>n(s),right:t===Qi.Button?a()(je.Z,{onClick:()=>n(s)},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.query.searchButton",description:"Label for the button that triggers a search.",defaultMessage:"Search"})):null})}function en(e){let{spaceStore:t,sharedWithFilterIds:i,setSharedWithFilter:n,runNewSearch:o,includeGroups:s,includeGuests:r}=e;window.__c={n:"SharedWithFilter"};const l=ci({spaceStore:t}),c=i?i.map((e=>e.id)):[],u=(0,d.useMemo)((()=>l.loading?[]:r?[...l.members,...l.guests]:l.members),[l,r]),p=(0,d.useMemo)((()=>l.loading?new Set:new Set(l.guests.map((e=>e.id)))),[l]);return a()(yi,{isMultiSelect:!0,includePermissionGroups:s,userStores:u,title:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.sharedWith.title",defaultMessage:"Shared with",description:"Title of the filter that lets the user filter page results by the shared with field."}),selectedIds:c,setSelectedItems:function(e){const t=e.map((e=>{let{id:t,type:i}=e;return{type:i,id:t}}));n(t.length>0?t:void 0)},onMenuClose:o,guestUserIdSet:p})}const tn=(0,f.defineMessages)({placeholder:{id:"adminContentSearchTab.pagesTable.filters.teams.placeholder",defaultMessage:"Search for teamspaces...",description:"Placeholder text for searching for teamspaces textbox."}});function nn(e){let{selectedTeamIds:t,setSelectedTeamIds:i,onMenuClose:n,teamStores:o}=e;window.__c={n:"TeamsFilter"};const r=(0,Te.qz)(void 0,et.Z),l=(0,_e.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:4},pillContainer:{margin:"0px 6px 6px 0px",background:e.legacyDefaultSelectColor,height:20},pillContents:{display:"inline-flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:4},pillText:{marginLeft:4},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},teamIcon:{marginRight:8},optionTitle:{display:"block"},noResultsMessage:{width:"100%",margin:"8px 12px"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"}})),[]),[c,u]=(0,d.useState)(!1),[p,m]=(0,d.useState)(""),g=(0,Te.VK)((()=>[...o].sort(_.KP)),[o]),h=(0,Te.VK)((()=>t.map((e=>o.find((t=>t.id===e)))).filter(T.$K)),[o,t]);function v(){u(!1),m(""),n()}function y(){m(""),i([])}function b(e){const n=t.includes(e)?[]:[e];i(n),m("")}const S=(0,d.useCallback)((e=>{m(e.target.value)}),[]),w=(0,Te.VK)((()=>h.map((e=>{const n=e.getName();return a()(hi.Z,{isSingle:!0,format:ui.l.Inline,showRemoveButton:!0,onClickRemove:()=>{const n=t.filter((t=>t!==e.id));i(n)},style:l.pillContainer,value:a()("div",{style:l.pillContents},void 0,a()(bt.p,{disabled:!0,store:e,size:16}),a()(xe.Z,{style:l.pillText},void 0,n))},e.id)}))),[h,t,i,l]);const M=a()(tt.u,{on:t.length>0,icon:Ge.Z.typesPerson(l.icon),title:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.title",description:"Title of the teams filter for the admin content search table.",defaultMessage:"Teamspace"}),onClick:()=>u(!0)});return a()(lt.Z,{},void 0,a()(st.ZP,{popupType:st.ZP.PopupType.Popup,placementToOrigin:st.ZP.Placement.Bottom,alignmentToOrigin:st.ZP.Alignment.Start,open:c,render:function(){const e=[];for(const o of g){const i=o.getName(),n=o.getTeamAccessLevel(),r=o.isDefault();i&&i.toLocaleLowerCase().includes(p)&&e.push({key:o.id,action:()=>b(o.id),render:e=>d.createElement(it.Z,s()({},e,{icon:a()(gi.Z,{isSelected:t.includes(o.id)}),focused:!1,title:a()("div",{style:l.optionContainer},void 0,a()(bt.p,{disabled:!0,store:o,size:24,style:l.teamIcon}),a()("div",{style:{paddingTop:4,paddingBottom:4}},void 0,a()(xe.Z,{style:l.optionTitle},void 0,i),a()(xe.Z,{style:l.optionCaption},void 0,an(n,r))))}))})}const i={key:"no-results",action:()=>{},render:e=>d.createElement(xe.Z,s()({isSecondaryColor:!0,style:l.noResultsMessage},e),a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.noResultsMessage",description:"Message in the teams dropdown to indicate that no results were found.",defaultMessage:"No results found."}))},n={key:"teamOptions",items:e.length>0?e:[i],render:e=>d.createElement(rt.Z,s()({},e,{title:null,loading:!1}))};return a()("div",{style:l.container},void 0,a()(fi.Z,{focus:!0,value:p,style:l.input,placeholder:V.default.formatMessage(tn.placeholder),onChange:S,onRemoveLastToken:()=>{},tokens:w}),a()(at.Z,{menuType:Je.og.Popup,header:null,maxHeight:250,width:300},void 0,a()(ot.Z,{type:ot.i.Vertical,store:r,initialFocus:0,sections:[n]})),a()(rt.Z,{topBorder:!0,style:l.footer},void 0,a()($e.Z,{onClick:y},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.clearButton",description:"Label for the button that resets the selected teams back to empty.",defaultMessage:"Clear"})),a()(je.Z,{onClick:v},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.doneButton",description:"Label for the button that closes the menu.",defaultMessage:"Done"}))))},onDismiss:v,keepFocus:!0,origin:M,preventScaleTransition:!0}))}function an(e,t){if(t)return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.default",description:"Caption for a team that has the default access level.",defaultMessage:"Default"});switch(e){case"private":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.private",description:"Caption for a team that has the private access level.",defaultMessage:"Private"});case"closed":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.closed",description:"Caption for a team that has the closed access level.",defaultMessage:"Closed"});case"open":return a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.open",description:"Caption for a team that has the open access level.",defaultMessage:"Open"});default:(0,T.t1)(e)}}function on(e){let{spaceStore:t,filters:i,runNewSearch:n,setFilters:o}=e;window.__c={n:"FiltersSection"};const s=function(){const[e,t]=(0,d.useState)([]),i=(0,ke.O7)(),n=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),a=(0,Te.VK)((()=>{var e;return null===(e=I.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]);return(0,d.useEffect)((()=>{!async function(){const e=await(0,_.sj)({spaceStore:n,currentUserId:a,includeArchived:!1,minRoleOnTeamStores:"editor",environment:i});t(e)}()}),[n,a,i]),e}(),r=(0,_e.yK)((e=>({container:{margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItemsCenter:"center"}})),[]);return a()("div",{style:r.container},void 0,a()(Ji,{mode:Qi.Button,query:i.query,setQueryFilter:function(e){o({query:e},{runSearchAfter:!0})}}),a()("div",{style:r.filterPillsContainer},void 0,a()(ji,{lastEditedTime:i.lastEditedTime,createdTime:i.createdTime,setLastEditedTime:function(e){o({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){o({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}}),a()(nn,{selectedTeamIds:i.teamIds,setSelectedTeamIds:function(e){o({teamIds:e})},onMenuClose:n,teamStores:s}),a()(en,{spaceStore:t,sharedWithFilterIds:i.sharedWith,setSharedWithFilter:function(e){o({sharedWith:e})},runNewSearch:n,includeGroups:!0,includeGuests:!0}),a()(dt,{selectedAudience:i.audience,setSelectedAudience:function(e){o({audience:e})},onMenuClose:n}),a()(bi,{spaceStore:t,createdByFilterIds:i.createdBy,setCreatedByFilter:function(e){o({createdBy:e})},runNewSearch:n,includeGuests:!0})))}var sn=i(26263),rn=i(7406),ln=i(45953),dn=i(21202),cn=i(66504);const un={query:"",createdBy:[],sharedWith:void 0,audience:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},pn={...un,audience:["shared_externally","shared_internally","shared_to_web"]},mn={filters:un,pageStores:[],numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0,shouldReRunSearch:!1,showSuggestions:!0},gn={...mn,filters:pn};function hn(e){let{spaceStore:t,userStore:i}=e;const n=(0,Te.VK)((()=>N.default.checkGate("enabled_bev_default_audience_filter")),[])?gn:mn,a=(0,ke.O7)(),[o,s]=(0,d.useState)(n),r=(0,d.useRef)(n.filters),c=(0,d.useCallback)((async e=>{let{restartSearch:n,ignoreFilterComparison:d}=e;if(!d&&l().isEqual(o.filters,r.current))return;r.current=o.filters;let c=o.loading,u=o.error,p=o.hasNextPage,m=o.numPagesLoaded,g=o.paginationToken;if(n&&(s((e=>({...mn,showSuggestions:e.showSuggestions,filters:e.filters}))),c=mn.loading,u=mn.error,p=mn.hasNextPage,m=mn.numPagesLoaded,g=mn.paginationToken),p&&!c&&!u){s((e=>({...e,showSuggestions:!1,loading:!0})));try{const e=await ge.adminContentSearch(a,{spaceId:t.id,sort:{field:"relevance",direction:"desc"},limit:20,paginationToken:g,query:o.filters.query,audience:o.filters.audience,lastEditedTime:(0,Q.Hq)(o.filters.lastEditedTime),createdTime:(0,Q.Hq)(o.filters.createdTime),createdBy:o.filters.createdBy,sharedWith:o.filters.sharedWith,teamspaceIds:o.filters.teamIds});if("failed"===e.type)throw e.error;b.jdc(a,{filters:o.filters,pageNumber:m});const n=e.data.paginationToken,r=e.data.recordIds,d=function(e){const{recordMapWithRoleJson:t}=e,i=ln.PF.create(t),n=ln.PF.create();for(const{pointer:a,value:o}of i)if(o){const e=l().cloneDeep(o);n.setValueAndRole(a,e,"editor")}return n}({recordMapWithRoleJson:e.data.recordMap}),c=new sn.Z(new cn.o({[i.id]:d}));c.addCacheFallback(a.defaultRecordCache.inMemoryRecordCache),s((e=>{const t=[],i=new Set(e.pageStores.map((e=>e.id)));for(const n of r)if(!i.has(n)){const e=new ze.G(a,{table:dn.iU,id:n},{inMemoryRecordCache:c});t.push(e)}const o=[...e.pageStores,...t];return{...e,pageStores:o,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:n,hasNextPage:Boolean(n)}}))}catch(h){const e=(0,rn.tg)(h);s((t=>({...t,loading:!1,error:e})))}}}),[a,t,i,o.filters,o.loading,o.error,o.hasNextPage,o.numPagesLoaded,o.paginationToken]);(0,d.useEffect)((()=>{o.shouldReRunSearch&&(s((e=>({...e,shouldReRunSearch:!1}))),c({restartSearch:!0,ignoreFilterComparison:!1}))}),[o.shouldReRunSearch,c]);const u=(0,d.useCallback)((async()=>{o.shouldReRunSearch||await c({restartSearch:!1,ignoreFilterComparison:!0})}),[o.shouldReRunSearch,c]),p=(0,d.useCallback)((async e=>{await c({restartSearch:!0,ignoreFilterComparison:e||!1})}),[c]),m=(0,d.useCallback)(((e,t)=>{b.gL0(a,{newFilters:e}),s((i=>({...i,filters:{...i.filters,...e},...null!=t&&t.runSearchAfter?{shouldReRunSearch:null==t?void 0:t.runSearchAfter}:void 0})))}),[a]);return{showSuggestions:o.showSuggestions,filters:o.filters,pageStores:o.pageStores,loading:o.loading,error:o.error,hasNextPage:o.hasNextPage,loadNextPage:u,runNewSearch:p,setFilters:m}}const fn=function(e){let{spaceStore:t,userStore:i}=e;window.__c={n:"AdminContentSearchTab"};const n=(0,ke.O7)(),o=(0,Te.VK)((()=>Ie.Z.state.online),[]),s=(0,_e.yK)((e=>({description:{display:"flex",flexDirection:"row",gap:24}})),[]),{showSuggestions:r,loadNextPage:l,pageStores:d,loading:c,error:u,runNewSearch:p,filters:m,setFilters:g}=hn({spaceStore:t,userStore:i});return o?a()(Ze.Z,{},void 0,a()(Pe.Z,{large:!n.device.isMobile||void 0,divider:n.device.isMobile?void 0:"full"},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.title",defaultMessage:"Content Search",description:"Content search settings tab title."})),a()("div",{style:s.description},void 0,a()(xe.Z,{isMultiline:!0,style:{marginBottom:20}},void 0,a()(f.FormattedMessage,{id:"adminContentSearchTab.description",defaultMessage:"Search and filter for any page in the workspace, including private pages. Only workspace owners can use content search.",description:"Content search settings tab description."})),a()(Be,{spaceId:t.id,disabled:0===d.length,filters:m})),a()(on,{spaceStore:t,runNewSearch:p,setFilters:g,filters:m}),a()(li,{loading:c,error:u,pageStores:d,loadNextPage:l,filters:m,setFilters:g,showSuggestions:r,runNewSearch:p})):a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,a()(f.FormattedMessage,{defaultMessage:"Please go online to access content search.",id:"adminContentSearchTab.offline.message",description:"Offline message for the content search settings menu."})))};var vn=i(59730),yn=i(49044);class bn extends Z.Z{getInitialState(){return{spaceId:void 0,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set}}isUserOrBotRemoved(e){return Boolean(e&&(this.state.removedUserIds.has(e)||this.state.removedBotIds.has(e)))}}const Sn=new bn,wn=(0,f.defineMessages)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs",description:"The error message when audit log cannot be loaded from the server"}}),Mn=async e=>{const{environment:t,spaceId:i}=e,n=await ge.getHistoricalAuditLogUsers(t,{spaceId:i});return"success"!==n.type?[]:n.data.results},Cn=async e=>{const{environment:t,spaceId:i}=e;if(Sn.getState().spaceId!==i&&Sn.reset(),!i)return;const[n,a]=await Promise.all([yn.Te({environment:t,membersOnly:!1}),Mn({environment:t,spaceId:i})]),o={spaceId:i,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};n.userIds.forEach((e=>{o.allUserIds.add(e)})),n.botIds.forEach((e=>{o.allBotIds.add(e)})),a.forEach((e=>{var t;(t=e.actorId)!==At._H.id&&t!==Kt.s$.id&&t!==Kt.el.id||o.allUserIds.has(e.actorId)?e.actorType!==Kt.KJ||o.allUserIds.has(e.actorId)?e.actorType!==At.cZ||o.allBotIds.has(e.actorId)||(o.allBotIds.add(e.actorId),o.removedBotIds.add(e.actorId)):(o.allUserIds.add(e.actorId),o.removedUserIds.add(e.actorId)):o.allUserIds.add(e.actorId)})),Sn.setState(o)};class kn extends Z.Z{getInitialState(){return{open:!1}}}const Tn=new kn,_n=(0,f.defineMessages)({30:{id:"auditLogCSV.menu.30days",defaultMessage:"Last 30 days",description:"An audit log menu item giving the user an option to download the last 30 days worth of audit logs in CSV format"},60:{id:"auditLogCSV.menu.60days",defaultMessage:"Last 60 days",description:"An audit log menu item giving the user an option to download the last 60 days worth of audit logs in CSV format"},90:{id:"auditLogCSV.menu.90days",defaultMessage:"Last 90 days",description:"An audit log menu item giving the user an option to download the last 90 days worth of audit logs in CSV format"},365:{id:"auditLogCSV.menu.365days",defaultMessage:"Last 1 year",description:"An audit log menu item giving the user an option to download the last 1 year worth of audit logs in CSV format"},Export:{id:"auditLogCSV.menu.export",defaultMessage:"Export",description:"An audit log button giving the user an option to export and download audit logs in CSV format"}});class In extends c.Z{constructor(){super(...arguments),this.renderCSVMenu=()=>{const e=[this.getCSVMenuItem(30),this.getCSVMenuItem(60),this.getCSVMenuItem(90),this.getCSVMenuItemWithConfirmation(365)];return a()(at.Z,{menuType:Je.og.Popup},void 0,a()(ot.Z,{type:ot.i.Vertical,sections:[{key:"results",render:e=>d.createElement(rt.Z,e),items:e}],initialFocus:0}))},this.getCSVMenuItem=e=>({key:e,render:()=>a()(it.Z,{focused:!1,title:V.default.formatMessage(_n[e]),onClick:()=>{this.handleDismiss(),xn(this.environment,e)}}),action:()=>{}}),this.getCSVMenuItemWithConfirmation=e=>({key:e,render:()=>a()(it.Z,{focused:!1,title:V.default.formatMessage(_n[e]),onClick:()=>{S.showDialog({message:a()(f.FormattedMessage,{id:"auditLogCSV.menu.365days.prompt",defaultMessage:"Are you sure you want to export a one year CSV? You can't repeat this action while this is processing in the background.",description:"An audit log menu confirmation dialog that confirms if the user wants to download the last 1 years worth of audit logs in CSV format and that they cannot repeat the action while processing is happening in the background."}),showCancel:!0,keepFocus:!0,items:[{label:a()(f.FormattedMessage,{id:"AuditLogCSV.exportConfirmationDialog.label",defaultMessage:"Export",description:"Label for button that when clicked will export a CSV for the current workspace."}),color:"blue",onAccept:()=>{this.handleDismiss(),xn(this.environment,e)}}]})}}),action:()=>{}}),this.handleDismiss=()=>{Tn.setState({open:!1})},this.popOpenOptions=e=>{Tn.setState({open:e})}}renderComponent(){const e=Tn.state;return a()(st.ZP,{popupType:st.ZP.PopupType.Popup,open:e.open,placementToOrigin:st.ZP.Placement.Bottom,alignmentToOrigin:st.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,keepFocus:!1,render:this.renderCSVMenu,onDismiss:this.handleDismiss,enableOutsideClickDismiss:!0,origin:a()(Oe.Z,{renderTooltip:()=>a()(f.FormattedMessage,{id:"auditLogCSV.popup.tooltip",defaultMessage:"Click for options to export the Audit Log in CSV form",description:"Message that shows options for the user to export audit log to CSV."}),render:t=>d.createElement(je.Z,s()({isLarge:!0,onClick:()=>this.popOpenOptions(!e.open)},t),V.default.formatMessage(_n.Export))})})}}In.displayName="AuditLogCSV";const xn=(e,t)=>{const{currentSpaceStore:i}=I.default.state;i&&Fe.PN(e,{spaceId:i.id,exportOptions:{duration:t}})},Zn=(0,f.injectIntl)(In);var Pn=i(66897),Fn=i(74136),An=i(97680);class Bn extends Z.Z{getInitialState(){return{tempSelections:new Set([])}}setTempSelections(e){this.setState({tempSelections:new Set(e)})}}class En extends c.Z{constructor(){super(...arguments),this.storeTypes={localStore:Bn},this.renderResultMenuItem=(e,t)=>{var i;const{intl:n,auditLogHistoricalUserStore:o}=this.props,{localStore:r}=this.stores,l=this.getActor(e);return d.createElement(An.Z,s()({},t,{key:e,actor:l,useEmailAsTooltip:!0,checkState:r.state.tempSelections.has(e),userTitle:a()("div",{style:{display:"flex",gap:4}},void 0,(0,Pn.$4)(n,l),o.isUserOrBotRemoved(null===(i=l.value)||void 0===i?void 0:i.id)&&a()(Fn.Z,{},void 0,a()(f.FormattedMessage,{id:"auditlogActorFilter.removed_user",defaultMessage:"Removed",description:"Describes a user who had access to the workspace, but no longer has it now"})))}))},this.performRequest=async e=>{let{query:t,current:i}=e;const{allUserIds:n,allBotIds:a}=this.props.auditLogHistoricalUserStore.getState(),o=await yn.ri({environment:this.environment,query:t,userIds:[...n],botIds:[...a]}),s=[...o.users.map((e=>`notion_user:${e.id}`)),...o.bots.map((e=>`bot:${e.id}`))];if(t.length>0)return s.slice(0,100);const r=this.props.selectedActors.map(Q.eW),l=new Set(r),d=s.filter((e=>!l.has(e)));return[...r,...d].slice(0,Math.max(r.length,100))},this.createUserValue=e=>ze.U6.createChildStore(this.props.parentStore,{table:Kt.KJ,id:e}).getValue(),this.createBotValue=e=>(0,ze.Kv)(this.props.parentStore,{table:At.cZ,id:e}).getValue()}didMount(){this.updateTempSelectionFromProps()}renderComponent(){const{selectedActors:e,intl:t}=this.props,{localStore:i}=this.stores,n=a()(f.FormattedMessage,{id:"auditlogActorFilter.title",defaultMessage:"User",description:"The title of the actor filter in the pill mode"});return a()(Ki.Z,{mode:Ki.z.Pill,title:n,icon:Ge.Z.person,iconStyles:{marginRight:2},items:Array.from(i.state.tempSelections),hasItemsSelected:(null==e?void 0:e.length)>0,onChange:e=>{i.setTempSelections(e)},renderFooter:!0,allowApplyBatchSelection:!0,keepInputOnItemConfirm:!0,onMenuDismiss:e=>{"applyButton"!==e?this.updateTempSelectionFromProps():this.updateOnChangeToParent()},labelText:{title:n,tokenInputPlaceholder:t.formatMessage({defaultMessage:"Search user...",id:"auditlogActorFilter.searchActor.placeholder",description:"The placeholder in the input for search an actor in audit log filter"}),resultSectionTitle:t.formatMessage({defaultMessage:"Select users",id:"auditlogActorFilter.searchActor.resultsTitle",description:"The text shown above the list of all selectable actors in audit log filter"}),componentDebugName:"SearchActorFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}updateOnChangeToParent(){const{onChange:e}=this.props,{localStore:t}=this.stores;e(Array.from(t.state.tempSelections).map(Q.Ij).filter((e=>Boolean(e))))}updateTempSelectionFromProps(){const{selectedActors:e}=this.props,{localStore:t}=this.stores,i=e.map(Q.eW);t.setTempSelections(i)}getActor(e){const t=(0,Q.Ij)(e);return t?"notion_user"===t.actorType?(0,Pn.m3)(this.createUserValue(t.actorId)):(0,Pn.ON)(this.createBotValue(t.actorId)):(0,Pn.m3)(void 0)}}En.displayName="AuditLogActorFilter";const Dn=(0,f.injectIntl)(En),Rn=["page_edited"];(0,T.AO)((e=>{for(const t of G)if(t===e)return{true:e};return{false:e}}));const Ln=(0,f.defineMessages)({adminLabel:{id:"auditLogSpaceRoleMessages.admin",defaultMessage:"admin",description:"A user in an audit log entry who has admin access"},workspaceOwnerLabel:{id:"auditLogSpaceRoleMessages.workspaceOwner",defaultMessage:"workspace owner",description:"A user in an audit log entry who has workspace owner access"},membershipAdminLabel:{id:"auditLogSpaceRoleMessages.membershipAdmin",defaultMessage:"membership admin",description:"A user in an audit log entry who is a membership admin (controls membership for space & groups)."},memberLabel:{id:"auditLogSpaceRoleMessages.member",defaultMessage:"member",description:"A user in an audit log entry who has member access"},guestLabel:{id:"auditLogSpaceRoleMessages.guest",defaultMessage:"guest",description:"A user in an audit log entry who has guest access"},noAccessLabel:{id:"auditLogSpaceRoleMessages.noAccess",defaultMessage:"no access",description:"A user in an audit log entry who has no access"},pageGuestLabel:{id:"auditLogSpaceRoleMessages.pageGuest",defaultMessage:"page guest",description:"A user in an audit log entry who has guest access to only pages in the workspace"},teamGuestLabel:{id:"auditLogSpaceRoleMessages.teamGuest",defaultMessage:"teamspace guest",description:"A user in an audit log entry who has guest access to only teamspaces in the workspace"}}),On=(0,f.defineMessages)({missing:{defaultMessage:"MISSING",id:"csvExport.copiedText.missingField",description:"Shown in the copied text/CSV for audit log in the case of a missing/unavailable field"},notApplicable:{defaultMessage:"N/A",id:"csvExport.copiedText.notApplicable",description:"Means 'not applicable', shown in audit log CSV for values that shouldn't be populated for an audit log."},untitled:{defaultMessage:"Untitled",id:"csvExport.copiedText.untitled",description:"Filler text when a page is untitled"}});function Nn(e){return`"${e.replace(/"/g,'""')}"`}var Vn=i(61784);(0,T.AO)((e=>30===e||60===e||90===e||365===e?{true:e}:{false:e}));const Un=(0,f.defineMessages)({page_edited:{id:"auditlogEventFilter.actionName.page_edited",defaultMessage:"Page edited",description:"An audit log that describe a user edited a page"},page_viewed:{id:"auditlogEventFilter.actionName.page_viewed",defaultMessage:"Page viewed",description:"An audit log that describe a user viewed a page"},page_created:{id:"auditlogEventFilter.actionName.page_created",defaultMessage:"Page created",description:"An audit log that describe a user created a page"},page_deleted:{id:"auditlogEventFilter.actionName.page_deleted",defaultMessage:"Page deleted",description:"An audit log that describe a user deleted a page"},page_restored:{id:"auditlogEventFilter.actionName.page_restored",defaultMessage:"Page restored",description:"An audit log that describe a user restored a deleted page"},page_exported:{id:"auditlogEventFilter.actionName.page_exported",defaultMessage:"Page exported",description:"An audit log that describe a user exported a page"},page_moved:{id:"auditlogEventFilter.actionName.page_moved",defaultMessage:"Page moved",description:"An audit log that describe a user moved a page"},page_permission_updated:{id:"auditlogEventFilter.actionName.page_permission_updated",defaultMessage:"Page permission updated",description:"An audit log that describe a page's permission has been changed. It means members, guests, bots, teams can be added, removed, or changed role for this page"},page_shared_to_web:{id:"auditlogEventFilter.actionName.page_shared_to_web",defaultMessage:"Page shared to web",description:"An audit log that describe a page is now shared with public. It means everyone on the internet have access this page."},password_set:{id:"auditlogEventFilter.actionName.password_set",defaultMessage:"Password set",description:"An audit log that describe a user set their password"},password_cleared:{id:"auditlogEventFilter.actionName.password_cleared",defaultMessage:"Password cleared",description:"An audit log that describe a user cleared their password"},password_changed:{id:"auditlogEventFilter.actionName.password_changed",defaultMessage:"Password changed",description:"An audit log that describe a user changed their password"},login:{id:"auditlogEventFilter.actionName.login",defaultMessage:"Login",description:"An audit log that describe a user logs in"},logout:{id:"auditlogEventFilter.actionName.logout",defaultMessage:"Logout",description:"An audit log that describe a user logs out"},mfa_sms_toggled:{id:"auditlogEventFilter.actionName.mfa_sms_toggled",defaultMessage:"MFA SMS toggled",description:"An audit log that describe a user toggled an SMS multi-factor authentication"},mfa_totp_toggled:{id:"auditlogEventFilter.actionName.mfa_totp_toggled",defaultMessage:"MFA TOTP toggled",description:"An audit log that describe a user toggled a TOTP multi-factor authentication"},mfa_backup_code_toggled:{id:"auditlogEventFilter.actionName.mfa_backup_code_toggled",defaultMessage:"MFA backup code toggled",description:"An audit log that describe a user toggled backup code for multi-factor authentication"},member_invited:{id:"auditlogEventFilter.actionName.member_invited",defaultMessage:"Member invited",description:"An audit log that describe a user is invited to the workspace"},member_joined:{id:"auditlogEventFilter.actionName.member_joined",defaultMessage:"Member joined",description:"An audit log that describe a member has joined the workspace"},member_role_updated:{id:"auditlogEventFilter.actionName.member_role_updated",defaultMessage:"Member role updated",description:"An audit log that describe a member is updated with a role"},member_removed:{id:"auditlogEventFilter.actionName.member_removed",defaultMessage:"Member removed",description:"An audit log that describe a member is removed access from the space"},guest_removed:{id:"auditlogEventFilter.actionName.guest_removed",defaultMessage:"Guest removed",description:"An audit log that describe a guest is removed access from the space"},user_deleted:{id:"auditlogEventFilter.actionName.user_deleted",defaultMessage:"User deleted",description:"An audit log that describe a user is deleted"},email_changed:{id:"auditlogEventFilter.actionName.email_changed",defaultMessage:"Email changed",description:"An audit log that describe a user changed their email"},preferred_name_changed:{id:"auditlogEventFilter.actionName.preferred_name_changed",defaultMessage:"Name changed",description:"An audit log that describe a user changed their preferred name"},picture_changed:{id:"auditlogEventFilter.actionName.picture_changed",defaultMessage:"Picture changed",description:"An audit log that describe a user changed their picture"},file_uploaded:{id:"auditlogEventFilter.actionName.file_uploaded",defaultMessage:"File uploaded",description:"An audit log that describe a file is uploaded by a user"},file_downloaded:{id:"auditlogEventFilter.actionName.file_downloaded",defaultMessage:"File downloaded",description:"An audit log that describe a file is downloaded by a user"},invite_link_toggled:{id:"auditlogEventFilter.actionName.invite_link_toggled",defaultMessage:"Invite link toggled",description:"An audit log that shows that the workspace's invite link feature was enabled"},workspace_name_changed:{id:"auditlogEventFilter.actionNames.workspace_name_changed",defaultMessage:"Name changed",description:"An audit log that describes a change of the workspace name"},workspace_integration_restriction_changed:{id:"auditlogEventFilter.actionNames.workspace_integration_restriction_changed",defaultMessage:"Integration installation toggled",description:"An audit log that describes a change of the workspace integration restriction"},invite_link_reset:{id:"auditlogEventFilter.actionNames.invite_link_reset",defaultMessage:"Invite link reset",description:"An audit log filter that describes the invite link getting reset"},public_page_sharing_toggled:{id:"auditlogEventFilter.actionNames.public_page_sharing_toggled",defaultMessage:"Public page sharing toggled",description:"An audit log filter describing public page sharing toggled"},workspace_sidebar_editing_toggled:{id:"auditlogEventFilter.actionNames.workspace_sidebar_editing_toggled",defaultMessage:"Workspace sidebar editing toggled",description:"An audit log filter describing workspace sidebar editing toggled"},disable_team_guests_toggled:{id:"auditlogEventFilter.actionNames.disable_team_guests_toggled",defaultMessage:"Disable teamspace guests toggled",description:"An audit log filter describing disable teamspace guests toggled"},disable_guests_toggled:{id:"auditlogEventFilter.actionNames.disable_guests_toggled",defaultMessage:"Disable guests toggled",description:"An audit log filter describing disable guests toggled"},pages_to_other_workspaces_toggled:{id:"auditlogEventFilter.actionNames.pages_to_other_workspaces_toggled",defaultMessage:"Pages to other workspaces toggled",description:"An audit log filter describing pages to other workspaces toggled"},export_toggled:{id:"auditlogEventFilter.actionNames.export_toggled",defaultMessage:"Export toggled",description:"An audit log filter describing workspace export toggled"},page_access_requests_toggled:{id:"auditlogEventFilter.actionNames.page_access_requests_toggled",defaultMessage:"Page access requests toggled",description:"An audit log filter describing page access requests in workspace toggled"},workspace_exported:{id:"auditlogEventFilter.actionNames.workspace_exported",defaultMessage:"Content exported",description:"An audit log that describes an export of all the workspace contents, e.g. in PDF form"},audit_log_exported:{id:"auditlogEventFilter.actionNames.audit_log_exported",defaultMessage:"Audit Log exported",description:"An audit log that describes an export of the audit log in CSV format."},user_analytics_exported:{id:"auditlogEventFilter.actionNames.user_analytics_exported",defaultMessage:"User Analytics exported",description:"An audit log that describes an export of the user analytics tab in CSV format."},content_analytics_exported:{id:"auditlogEventFilter.actionNames.content_analytics_exported",defaultMessage:"Content Analytics exported",description:"An audit log that describes an export of the content analytics tab in CSV format."},workspace_icon_changed:{id:"auditlogEventFilter.actionNames.workspace_icon_changed",defaultMessage:"Icon changed",description:"An audit log that describes a change of the workspace icon"},allowed_email_domain_added:{id:"auditlogEventFilter.actionNames.allowed_email_domain_added",defaultMessage:"Added allowed email domain",description:"An audit log that describes the adding of an allowed_email_domain to a workspace"},allowed_email_domain_removed:{id:"auditlogEventFilter.actionNames.allowed_email_domain_removed",defaultMessage:"Removed allowed email domain",description:"An audit log that describes the removing of an allowed_email_domain to a workspace"},workspace_domain_changed:{id:"auditlogEventFilter.actionNames.workspace_domain_changed",defaultMessage:"Domain changed",description:"An audit log that describes a change of the workspace domain"},public_page_cleared:{id:"auditlogEventFilter.actionNames.public_page_cleared",defaultMessage:"Public home page link cleared",description:"An audit log that describes the clearing of a public home page for a workspace"},public_page_set:{id:"auditlogEventFilter.actionNames.public_page_set",defaultMessage:"Public home page set",description:"An audit log that describes the setting of a public home page for a workspace"},scim_token_generated:{id:"auditlogEventFilter.actionNames.scim_token_generated",defaultMessage:"SCIM token generated",description:"An audit log that describes the generating of a SCIM token for a workspace"},scim_token_revoked:{id:"auditlogEventFilter.actionNames.scim_token_revoked",defaultMessage:"SCIM token revoked",description:"An audit log that describes the revoking of the SCIM token for a workspace"},idp_metadata_url_updated:{id:"auditlogEventFilter.actionNames.idp_metadata_url_updated",defaultMessage:"IDP metadata URL updated",description:"An audit log filter that describes IDP metadata URL update"},idp_metadata_xml_updated:{id:"auditlogEventFilter.actionNames.idp_metadata_xml_updated",defaultMessage:"IDP metadata XML updated",description:"An audit log filter that describes IDP metadata XML update"},idp_metadata_xml_removed:{id:"auditlogEventFilter.actionNames.idp_metadata_xml_removed",defaultMessage:"IDP metadata XML removed",description:"An audit log filter that describes IDP metadata XML removed"},saml_toggled:{id:"auditlogEventFilter.actionNames.saml_toggled",defaultMessage:"SAML enabling toggled",description:"An audit log filter that describes the toggling of SAML enabling for a workspace"},saml_enforce_toggled:{id:"auditlogEventFilter.actionNames.saml_enforce_toggled",defaultMessage:"SAML enforcing toggled",description:"An audit log that describes the toggling of enforcing of SAML for a workspace"},automatic_account_creation_toggled:{id:"auditlogEventFilter.actionNames.automatic_account_creation_toggled",defaultMessage:"Auto-create accounts on sign-in toggled",description:"An audit log that describes the toggling of enabling of automatic creation of accounts on sign-in"},workspace_creation_set_for_email_domain:{id:"auditlogEventFilter.actionNames.workspace_creation_set_for_email_domain",defaultMessage:"Workspace creation setting updated",description:"An audit log that describes the setting of whether users under the domain can create a workspace."},member_added_to_group:{id:"auditlogEventFilter.actionNames.member_added_to_group",defaultMessage:"Member added to group",description:"An audit log that describes when a member is added to a group"},member_removed_from_group:{id:"auditlogEventFilter.actionNames.member_removed_from_group",defaultMessage:"Member removed from group",description:"An audit log that describes when a member is removed from a group"},space_transfer_status_changed:{id:"auditlogEventFilter.actionNames.space_transfer_status_changed",defaultMessage:"Workspace transfer status change",description:"An audit log event describing a space transfer status change."},space_claim_and_upgrade_status_changed:{id:"auditlogEventFilter.actionNames.space_claim_and_upgrade_status_changed",defaultMessage:"Workspace claim status change",description:"An audit log event describing a workspace claim and upgrade status change."},space_claim_deletion_status_changed:{id:"auditlogEventFilter.actionNames.space_claim_deletion_status_changed",defaultMessage:"Claimable workspace deletion status change",description:"An audit log event describing a status change for deletion initiated for a claimable workspace."},allowed_support_access:{id:"auditlogEventFilter.actionNames.allowed_support_access",defaultMessage:"Granted support access",description:"An audit log that describes the enabling of support access"},revoked_support_access:{id:"auditlogEventFilter.actionNames.revoked_support_access",defaultMessage:"Revoked support access",description:"An audit log that describes the disabling of support access"},membership_requests_toggled:{id:"auditlogEventFilter.actionNames.membership_requests_toggled",defaultMessage:"Membership requests toggled",description:"An audit log that describes the disabling of membership requests"},membership_request_resolved:{id:"auditlogEventFilter.actionNames.membership_request_resolved",defaultMessage:"Membership request resolved",description:"An audit log that describes the resolution of a membership request"},guest_membership_requests_toggled:{id:"auditlogEventFilter.actionNames.guest_membership_requests_toggled",defaultMessage:"Guest membership requests toggled",description:"An audit log that describes the disabling of guest membership requests"},team_created:{id:"auditlogEventFilter.actionNames.team_created",defaultMessage:"Teamspace created",description:"An audit log that describes that a teamspace was created."},team_archived:{id:"auditlogEventFilter.actionNames.team_archived",defaultMessage:"Teamspace archived",description:"An audit log that describes that a teamspace was archived."},team_restored:{id:"auditlogEventFilter.actionNames.team_restored",defaultMessage:"Teamspace restored",description:"An audit log that describes that a teamspace was restored."},team_default_toggled:{id:"auditlogEventFilter.actionNames.team_default_toggled",defaultMessage:"Teamspace default toggled",description:"An audit log that describes that a teamspace's default status was toggled."},team_privacy_type_changed:{id:"auditlogEventFilter.actionNames.team_privacy_type_changed",defaultMessage:"Teamspace privacy type changed",description:"An audit log event that describes that the privacy type for a teamspace was updated."},team_invite_access_changed:{id:"auditlogEventFilter.actionNames.team_invite_access_changed",defaultMessage:"Teamspace invite access changed",description:"An audit log event that describes that who can invite teamspace members for a teamspace was updated."},team_public_page_sharing_toggled:{id:"auditlogEventFilter.actionNames.team_public_page_sharing_toggled",defaultMessage:"Teamspace public page sharing toggled",description:"An audit log that describes that public page sharing was toggled for a teamspace."},team_export_toggled:{id:"auditlogEventFilter.actionNames.team_export_toggled",defaultMessage:"Teamspace export toggled",description:"An audit log that describes that the ability to export a teamspace was toggled."},team_sidebar_editing_toggled:{id:"auditlogEventFilter.actionNames.team_sidebar_editing_toggled",defaultMessage:"Teamspace sidebar editing toggled",description:"An audit log that describes that the ability to edit a teamspace's sidebar was toggled."},team_guests_toggled:{id:"auditlogEventFilter.actionNames.team_guests_toggled",defaultMessage:"Teamspace disable guests toggled",description:"An audit log that describes that the ability to edit a teamspace's sidebar was toggled."},team_name_changed:{id:"auditlogEventFilter.actionNames.team_name_changed",defaultMessage:"Teamspace name changed",description:"An audit log that describes that a teamspace's name was changed."},team_description_changed:{id:"auditlogEventFilter.actionNames.team_description_changed",defaultMessage:"Teamspace description changed",description:"An audit log that describes that a teamspace's description was changed."},team_icon_changed:{id:"auditlogEventFilter.actionNames.team_icon_changed",defaultMessage:"Teamspace icon changed",description:"An audit log that describes that a teamspace's icon was changed."},team_creation_admins_setting_toggled:{id:"auditlogEventFilter.actionNames.team_creation_admins_setting_toggled",defaultMessage:"Teamspace creation limiting to admins changed",description:"An audit log that describes that the setting to limit teamspace creation to admins was changed."},member_added_to_team:{id:"auditlogEventFilter.actionNames.member_added_to_team",defaultMessage:"Member added to teamspace",description:"An audit log that describes that a user was added to a teamspace."},member_removed_from_team:{id:"auditlogEventFilter.actionNames.member_removed_from_team",defaultMessage:"Member removed from teamspace",description:"An audit log that describes that a user was removed from the teamspace."},group_added_to_team:{id:"auditlogEventFilter.actionNames.group_added_to_team",defaultMessage:"Group added to teamspace",description:"An audit log that describes that a group was added to a teamspace."},group_removed_from_team:{id:"auditlogEventFilter.actionNames.group_removed_from_team",defaultMessage:"Group removed from teamspace",description:"An audit log that describes that a group was removed from the teamspace."},member_left_team:{id:"auditlogEventFilter.actionNames.member_left_team",defaultMessage:"Member left teamspace",description:"An audit log that describes that a user left a teamspace."},member_joined_team:{id:"auditlogEventFilter.actionNames.member_joined_team",defaultMessage:"Member joined teamspace",description:"An audit log that describes that a user joined a teamspace."},member_team_role_updated:{id:"auditlogEventFilter.actionNames.member_team_role_updated",defaultMessage:"Member role updated for teamspace",description:"An audit log that describes a user's role in a teamspace was updated."},team_user_permission_updated:{id:"auditlogEventFilter.actionNames.team_user_permission_updated",defaultMessage:"Custom permissions updated for a member in the teamspace",description:"An audit log that describes the permission for a user in the teamspace was updated."},team_group_permission_updated:{id:"auditlogEventFilter.actionNames.team_group_permission_updated",defaultMessage:"Custom permissions updated for a group in the teamspace",description:"An audit log that describes the permission for a group in the teamspace was updated."},team_member_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_member_default_permission_updated",defaultMessage:"Teamspace Members default permission updated",description:"An audit log that describes that the default permissions of members of a teamspace were updated."},team_guest_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_guest_default_permission_updated",defaultMessage:"Teamspace Guests default permission updated",description:"An audit log that describes that the default permissions of teamspace guests of a teamspace were updated."},team_workspace_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_workspace_default_permission_updated",defaultMessage:"Workspace default permission updated for teamspace",description:"An audit log that describes that the default permissions for everyone else in the workspace for a teamspace were updated."},teams_enabled_for_space:{id:"auditlogEventFilter.actionNames.teams_enabled_for_space",defaultMessage:"Workspace updated to enable teamspaces",description:"An audit log that describes that the workspace was updated to enable teamspaces."},private_content_transferred:{id:"auditLogEventFilter.actionNames.private_content_transferred",defaultMessage:"Private content transferred",description:"Event name for private content transferred audit log event"},admin_content_search_queried:{id:"auditLogEventFilter.actionNames.admin_content_search_queried",defaultMessage:"Admin content search queried",description:"Event name for 'admin content search queried' audit log event"},automation_created:{id:"auditLogEventFilter.actionNames.automation_created",defaultMessage:"Automation created",description:"Event name for automation created audit log event"},automation_edited:{id:"auditLogEventFilter.actionNames.automation_edited",defaultMessage:"Automation edited",description:"Event name for automation edited audit log event"},ai_admin_legal_acceptance_toggled:{id:"auditLogEventFilter.actionNames.ai_admin_legal_acceptance_toggled",defaultMessage:"Notion AI toggled for workspace.",description:"Event name for AI admin legal acceptance toggled audit log event"},workspace_analytics_toggled:{id:"auditLogEventFilter.actionNames.workspace_analytics_toggled",defaultMessage:"Workspace analytics tracking toggled",description:"Event name disabling workspace analytics setting audit log event"},space_consolidation_started:{id:"auditLogEventFilter.actionNames.space_consolidation_started",defaultMessage:"Workspace consolidation started",description:"Event name for workspace consolidation started audit log event"},space_consolidation_completed:{id:"auditLogEventFilter.actionNames.space_consolidation_completed",defaultMessage:"Workspace consolidation completed",description:"Event name for workspace consolidation completed audit log event"},space_consolidation_failed:{id:"auditLogEventFilter.actionNames.space_consolidation_failed",defaultMessage:"Workspace consolidation failed",description:"Event name for workspace consolidation failed audit log event"}}),Wn=(0,f.defineMessages)({private:{id:"auditLogColumnEvent.tooltip.pageAudience.private",defaultMessage:"private",description:"Audience descriptor for private pages"},shared_internally:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedInternally",defaultMessage:"shared internally",description:"Audience descriptor for pages that are shared within a workspace"},shared_externally:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedExternally",defaultMessage:"shared externally",description:"Audience descriptor for pages that are shared outside a workspace"},shared_to_web:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedToWeb",defaultMessage:"shared to web",description:"Audience descriptor for pages that are shared to web"}}),zn=["name","email","status","activityType","activity","audience","dateAndTime","platform","ipAddress","city","state","country","pageId"];(0,f.defineMessages)({name:{id:"exportAuditLog.header.name",defaultMessage:"Name",description:"The column header denoting that this column's contents show the name of an audit log event."},email:{id:"exportAuditLog.header.email",defaultMessage:"Email",description:"The column header denoting that this column's contents show the email of an audit log event's actor."},status:{id:"exportAuditLog.header.status",defaultMessage:"Status",description:"The column header denoting that this column's contents show the guest/member/admin status of an audit log event's actor"},activityType:{id:"exportAuditLog.header.activityType",defaultMessage:"Activity Type",description:"The column header denoting that this column's contents show the type of activity of an audit log event"},activity:{id:"exportAuditLog.header.activity",defaultMessage:"Activity",description:"The column header denoting that this column's contents show the activity contents of an audit log event"},dateAndTime:{id:"exportAuditLog.header.dateAndTime",defaultMessage:"Date and Time (UTC)",description:"The column header denoting that this column's contents show the date and time in UTC time for an audit log event"},platform:{id:"exportAuditLog.header.platform",defaultMessage:"Platform",description:"The column header denoting that this column's contents show the date and time of an audit log event"},ipAddress:{id:"exportAuditLog.header.ipAddress",defaultMessage:"IP Address",description:"The column header denoting that this column's contents show the IP address an audit log event took place in"},city:{id:"exportAuditLog.header.city",defaultMessage:"City",description:"The column header denoting that this column's contents show the city an audit log event took place in"},state:{id:"exportAuditLog.header.state",defaultMessage:"State",description:"The column header denoting that this column's contents show the state an audit log event took place in"},country:{id:"exportAuditLog.header.country",defaultMessage:"Country",description:"The column header denoting that this column's contents show the country an audit log event took place in"},audience:{id:"exportAuditLog.header.audience",defaultMessage:"Audience",description:"Column header for audit log CSV labelling the audience of the event"},pageId:{id:"exportAuditLog.header.pageId",defaultMessage:"Page Id",description:"Column header for audit log CSV labelling the page ID."}});function Kn(e,t,i){var n;return e.actor.actorId===Kt.s$.id||e.actor.actorId===Kt.el.id?t.formatMessage({defaultMessage:"notion_admin",id:"auditLogPaginatedTable.copiedText.notionAdmin",description:"Shown in the copied text for a Notion Admin user"}):"notion_user"===e.actor.actorType?t.formatMessage(function(e,t){if(!e)return Ln.noAccessLabel;if(t){if("guest"===e)return Ln.pageGuestLabel;if("team_level_guest"===e)return Ln.teamGuestLabel}switch(e){case"admin":return Ln.workspaceOwnerLabel;case"membership_admin":return Ln.membershipAdminLabel;case"member":return Ln.memberLabel;case"guest":case"team_level_guest":return Ln.guestLabel;case"no_access":return Ln.noAccessLabel;default:(0,T.t1)(e)}}(null===(n=e.actor.meta)||void 0===n?void 0:n.spaceRole,i)):t.formatMessage({defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.noRole",description:"Shown in the copied text for a bot, who has no role. Means not applicable"})}function qn(e,t){var i,n,a,o,s,r,l,d,c,u,p,m,g,h,f,v,y,b;return null!==(i=e.actor.meta)&&void 0!==i&&i.countryCode?null!==(n=e.actor)&&void 0!==n&&null!==(a=n.meta)&&void 0!==a&&a.city?"US"===(null===(o=e.actor.meta)||void 0===o?void 0:o.countryCode)&&null!==(s=e.actor)&&void 0!==s&&null!==(r=s.meta)&&void 0!==r&&r.state?t.formatMessage({description:"city, state and country metadata for audit log",defaultMessage:"{city}, {state}, {countryCode}",id:"auditLogSettings.metadata.cityStateAndCountry"},{city:null===(g=e.actor)||void 0===g||null===(h=g.meta)||void 0===h?void 0:h.city,state:null===(f=e.actor)||void 0===f||null===(v=f.meta)||void 0===v?void 0:v.state,countryCode:null===(y=e.actor)||void 0===y||null===(b=y.meta)||void 0===b?void 0:b.countryCode}):t.formatMessage({description:"city and country metadata for audit log",defaultMessage:"{city}, {countryCode}",id:"auditLogSettings.metadata.cityAndCountry"},{city:null===(l=e.actor)||void 0===l||null===(d=l.meta)||void 0===d?void 0:d.city,countryCode:null===(c=e.actor)||void 0===c||null===(u=c.meta)||void 0===u?void 0:u.countryCode}):null===(p=e.actor)||void 0===p||null===(m=p.meta)||void 0===m?void 0:m.countryCode:""}function Hn(e){const{auditLogEntry:t,intl:i,getAuditLogEventText:n,isTeamGuestsEnabled:a}=e,o=[],s=i.formatMessage(On.missing);return zn.forEach((e=>{var r,l,d,c,u;switch(e){case"name":o.push(t.actor.name||s);break;case"email":o.push(function(e,t){return"notion_user"===e.actor.actorType?e.actor.email:t.formatMessage({defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.noEmail",description:"Shown in the copied text for a bot, who has no email address. Means not applicable"})}(t,i)||s);break;case"status":o.push(Kn(t,i,a)||s);break;case"activityType":o.push(Un[t.actionName]?i.formatMessage(Un[t.actionName]):s);break;case"activity":o.push(n(t)||s);break;case"dateAndTime":o.push((0,Vn.$I)(t.serverTimestamp));break;case"platform":o.push((null===(r=t.actor.meta)||void 0===r?void 0:r.platform)||s);break;case"ipAddress":o.push((null===(l=t.actor.meta)||void 0===l?void 0:l.ipAddress)||s);break;case"city":o.push((null===(d=t.actor.meta)||void 0===d?void 0:d.city)||s);break;case"state":o.push((null===(c=t.actor.meta)||void 0===c?void 0:c.state)||s);break;case"country":o.push((null===(u=t.actor.meta)||void 0===u?void 0:u.countryCode)||s);break;case"audience":const p=function(e){return Gn(e)??e.intl.formatMessage(On.notApplicable)}({auditLogEntry:t,intl:i});o.push(p||s);break;case"pageId":const m=$(t);m?o.push(m.id):o.push(i.formatMessage(On.notApplicable));break;default:(0,T.t1)(e)}})),o.map(Nn).join(",")}function Gn(e){var t;const{auditLogEntry:i,intl:n}=e,a=$(i);return null!=a&&null!==(t=a.meta)&&void 0!==t&&t.pageAudience?n.formatMessage(Wn[a.meta.pageAudience]):null}let jn;!function(e){e.All="All",e.Partial="Partial",e.None="None"}(jn||(jn={}));class $n extends Z.Z{getInitialState(){return{categorySelections:{page:jn.All,space:jn.All,team:jn.All,account:jn.All},actionSelections:{page_edited:!0,page_viewed:!0,page_created:!0,page_deleted:!0,page_restored:!0,page_exported:!0,page_moved:!0,page_permission_updated:!0,page_shared_to_web:!0,private_content_transferred:!0,automation_created:!0,automation_edited:!0,password_set:!0,password_cleared:!0,password_changed:!0,login:!0,logout:!0,member_invited:!0,member_role_updated:!0,member_removed:!0,guest_removed:!0,email_changed:!0,user_deleted:!0,member_joined:!0,preferred_name_changed:!0,picture_changed:!0,workspace_name_changed:!0,workspace_icon_changed:!0,allowed_email_domain_added:!0,allowed_email_domain_removed:!0,workspace_domain_changed:!0,workspace_exported:!0,audit_log_exported:!0,user_analytics_exported:!0,content_analytics_exported:!0,public_page_cleared:!0,public_page_set:!0,scim_token_generated:!0,scim_token_revoked:!0,saml_toggled:!0,saml_enforce_toggled:!0,mfa_sms_toggled:!0,mfa_totp_toggled:!0,mfa_backup_code_toggled:!0,automatic_account_creation_toggled:!0,workspace_creation_set_for_email_domain:!0,member_added_to_group:!0,member_removed_from_group:!0,space_transfer_status_changed:!0,space_claim_and_upgrade_status_changed:!0,space_claim_deletion_status_changed:!0,file_uploaded:!0,file_downloaded:!0,invite_link_toggled:!0,invite_link_reset:!0,page_access_requests_toggled:!0,public_page_sharing_toggled:!0,workspace_sidebar_editing_toggled:!0,disable_team_guests_toggled:!0,disable_guests_toggled:!0,pages_to_other_workspaces_toggled:!0,export_toggled:!0,workspace_integration_restriction_changed:!0,idp_metadata_url_updated:!0,idp_metadata_xml_updated:!0,idp_metadata_xml_removed:!0,allowed_support_access:!0,revoked_support_access:!0,membership_requests_toggled:!0,guest_membership_requests_toggled:!0,membership_request_resolved:!0,team_created:!0,team_archived:!0,team_restored:!0,team_default_toggled:!0,team_public_page_sharing_toggled:!0,team_guests_toggled:!0,team_export_toggled:!0,team_sidebar_editing_toggled:!0,team_name_changed:!0,team_description_changed:!0,team_icon_changed:!0,team_creation_admins_setting_toggled:!0,member_added_to_team:!0,group_added_to_team:!0,member_removed_from_team:!0,group_removed_from_team:!0,member_left_team:!0,member_joined_team:!0,member_team_role_updated:!0,team_user_permission_updated:!0,team_group_permission_updated:!0,team_guest_default_permission_updated:!0,team_member_default_permission_updated:!0,team_workspace_default_permission_updated:!0,team_privacy_type_changed:!0,team_invite_access_changed:!0,teams_enabled_for_space:!0,admin_content_search_queried:!0,ai_admin_legal_acceptance_toggled:!0,workspace_analytics_toggled:!0,space_consolidation_started:!0,space_consolidation_completed:!0,space_consolidation_failed:!0},isMenuOpen:!1,renderOrder:[{category:"page",orderedActions:j.page},{category:"space",orderedActions:j.space},{category:"account",orderedActions:j.account},{category:"team",orderedActions:j.team}]}}getAllActionNames(){return(0,T.Yd)(this.state.actionSelections)}getSelectedActionNames(){return this.getAllActionNames().filter((e=>this.state.actionSelections[e]))}hasActionNameSelected(){const e=this.getAllActionNames(),t=this.getSelectedActionNames();return t.length>0&&t.length!==e.length}toggleCategorySelection(e){const t=e.category,i=this.state.categorySelections[t],n=i===jn.None||i===jn.Partial?jn.All:jn.None,a=n===jn.All,o={...this.state.actionSelections},s=this.state.renderOrder.find((e=>e.category===t));s&&(s.orderedActions.forEach((e=>{o[e]=a})),this.setState({...this.state,actionSelections:o,categorySelections:{...this.state.categorySelections,[s.category]:n}}))}toggleActionNameSelection(e,t){const i=this.state.actionSelections[e],n={...this.state.actionSelections,[e]:!i},a=t.orderedActions.filter((e=>n[e])).length,o=0===a?jn.None:a===t.orderedActions.length?jn.All:jn.Partial;this.setState({...this.state,actionSelections:n,categorySelections:{...this.state.categorySelections,[t.category]:o}})}clearAllSelections(){const e=this.getBulkUpdateNextActionSelectionState((0,T.Yd)(this.state.actionSelections),!1),t=this.getBulkUpdateNextCategorySelectionState((0,T.Yd)(this.state.categorySelections),jn.None);this.setState({...this.state,actionSelections:e,categorySelections:t})}getBulkUpdateNextCategorySelectionState(e,t){const i={...this.state.categorySelections};return e.forEach((e=>{i[e]=t})),i}getBulkUpdateNextActionSelectionState(e,t){const i={...this.state.actionSelections};return e.forEach((e=>{i[e]=t})),i}}class Yn extends c.Z{constructor(){super(...arguments),this.storeTypes={componentStore:$n,lastSelectionStore:$n,menuListStore:et.Z},this.renderMenu=()=>{const{componentStore:e,menuListStore:t}=this.stores,i=[];e.state.renderOrder.forEach((e=>{("team"!==e.category||(0,_.bq)())&&(i.push(this.renderCategoryMenu(e)),e.orderedActions.forEach((t=>{this.eventsToFilterOut.includes(t)||i.push(this.renderActionNameMenu(t,e))})))}));const n={key:"results",items:i,render:e=>d.createElement(rt.Z,s()({},e,{title:null,loading:!1}))};return d.createElement(d.Fragment,null,a()(at.Z,{menuType:Je.og.Popup,header:null,maxHeight:356},void 0,a()(ot.Z,{type:ot.i.Vertical,store:t,initialFocus:0,sections:[n]})),a()(rt.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"}},void 0,a()($e.Z,{onClick:()=>{this.handleClear()}},void 0,a()(f.FormattedMessage,{id:"auditlogEventFilter.clearButton",defaultMessage:"Clear"})),a()(je.Z,{onClick:()=>{this.handleApply()}},void 0,a()(f.FormattedMessage,{id:"auditlogEventFilter.applyButton",defaultMessage:"Apply"}))))},this.renderPillButtonOrigin=e=>{const{componentStore:t}=this.stores,i=t.hasActionNameSelected();return a()(tt.u,{on:i,icon:Ge.Z.bot({width:16,marginRight:6,fill:"currentColor"}),title:a()("span",{},void 0,e),onClick:()=>{this.setMenuOpen(!0)}})},this.consolidationEventsToFilterOut=N.default.checkGate("space_consolidation_read_only")?[]:["space_consolidation_started","space_consolidation_completed","space_consolidation_failed"],this.aesEventsToFilterOut=N.default.checkGate("audit_log_aes_event_read")?[]:Rn,this.eventsToFilterOut=[...this.aesEventsToFilterOut,...this.consolidationEventsToFilterOut],this.setMenuOpen=e=>{const{componentStore:t}=this.stores;t.setState({...t.state,isMenuOpen:e})},this.styles={menu:{width:250,maxHeight:"40vh"},menuItem:{width:"fit-content",border:"solid 1px",borderColor:this.theme.outlineButtonBorder,paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12},icon:{height:14,width:14,fill:"currentColor"},popup:{paddingTop:8,paddingBottom:8}}}renderComponent(){const{componentStore:e}=this.stores,t=this.styles,i=a()(f.FormattedMessage,{id:"auditlogEventFilter.title",defaultMessage:"Event",description:"The title of the event filter in the pill mode"}),n=this.renderPillButtonOrigin(i);return a()(lt.Z,{marginAfter:!1},void 0,a()(st.ZP,{popupType:st.ZP.PopupType.Popup,placementToOrigin:st.ZP.Placement.Bottom,alignmentToOrigin:st.ZP.Alignment.Start,open:e.state.isMenuOpen,render:this.renderMenu,onDismiss:()=>{this.handleMenuCloseFromOutside()},keepFocus:!0,origin:n,preventScaleTransition:!0,style:t.popup}))}renderCategoryMenu(e){const{intl:t}=this.props,{componentStore:i}=this.stores,n=e.category,o=()=>{i.toggleCategorySelection(e)};return{key:n,action:o,render:e=>d.createElement(it.Z,s()({},e,{icon:a()(nt.Z,{checked:i.state.categorySelections[n]===jn.All,size:16,onClick:o}),focused:!1,title:t.formatMessage(Qn[n]),className:"notranslate"}))}}renderActionNameMenu(e,t){const{intl:i}=this.props,{componentStore:n}=this.stores,o=()=>{n.toggleActionNameSelection(e,t)};return{key:e,action:o,render:t=>d.createElement(it.Z,s()({},t,{icon:a()(nt.Z,{checked:n.state.actionSelections[e],size:16,onClick:o}),focused:!1,title:i.formatMessage(Un[e]),className:"notranslate",style:{paddingLeft:20}}))}}handleMenuCloseFromOutside(){const{componentStore:e,lastSelectionStore:t}=this.stores;e.setState({...e.state,actionSelections:{...t.state.actionSelections},categorySelections:{...t.state.categorySelections}}),this.setMenuOpen(!1)}handleClear(){const{componentStore:e}=this.stores;e.clearAllSelections()}handleApply(){const{onChange:e}=this.props,{componentStore:t,lastSelectionStore:i}=this.stores,n=t.getAllActionNames(),a=t.getSelectedActionNames();e(n.length===a.length?[]:a),0===a.length&&t.reset(),i.setState({...i.state,actionSelections:{...t.state.actionSelections},categorySelections:{...t.state.categorySelections}}),this.setMenuOpen(!1)}}Yn.displayName="AuditLogEventFilter";const Qn=(0,f.defineMessages)({page:{id:"auditlogEventFilter.categoryName.page",defaultMessage:"Page",description:"audit log action category - page"},space:{id:"auditlogEventFilter.categoryName.workspace",defaultMessage:"Workspace",description:"audit log action category - workspace"},team:{id:"auditlogEventFilter.categoryName.team",defaultMessage:"Teamspace",description:"audit log action category - Teamspace"},account:{id:"auditlogEventFilter.categoryName.account",defaultMessage:"Account",description:"audit log action category - account"}}),Xn=(0,f.injectIntl)(Yn);const Jn=(0,f.injectIntl)((function(e){window.__c={n:"AuditLogFilterContainer"};const{spaceStore:t}=e,[i,n]=(0,Te.AF)(J),[o,s,r]=(0,Te.AF)(Sn);return a()("div",{style:{display:"flex",flexDirection:"row",gap:4}},void 0,a()(Gi,{mode:Ki.z.Pill,focused:!1,title:a()(f.FormattedMessage,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:Ge.Z.calendar,value:i.timeRange,showButtons:"footer",onChange:e=>{n({...i,timeRange:e,pageNum:1})}}),a()(Dn,{parentStore:t,auditLogHistoricalUserStore:r,selectedActors:i.actors,onChange:e=>{n({...i,actors:e,pageNum:1})}}),a()(Xn,{parentStore:t,selectedEvents:i.actions,onChange:e=>{n({...i,actions:e,pageNum:1})}}))}));function ea(){return window.__c={n:"AuditLogHeading"},a()(Pe.Z,{large:!0,style:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:h.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"}},void 0,a()("div",{style:{gap:8,display:"flex"}},void 0,a()(f.FormattedMessage,{id:"auditlog.title",defaultMessage:"Audit log"})),a()(ta,{}))}function ta(){window.__c={n:"AuditLogFeedbackButton"};const e=(0,ke.O7)();return Qe.Z.isLocalhost||"development"===Qe.Z.env?a()(Ae.Z,{style:{marginLeft:10},isSmall:!0,onClick:()=>{w.navigateToExternalURL({environment:e,url:"https://dev.notion.so/notion/Audit-Log-Dev-feedback-e9048c4e7d544369b0b8413ec20f02cf",targetSelf:!0})}},void 0,"🎁 Feedback is a gift!"):null}var ia=i(43568);const na=function(){return window.__c={n:"AuditLogLoadingShimmer"},a()("div",{style:{}},void 0,a()(ia.Z,{paragraphs:[{lineHeight:45,lineMargin:20,sectionWidths:[100],repeat:1,sectionMargin:15},{lineHeight:40,lineMargin:5,sectionWidths:[100],repeat:8,sectionMargin:10}]}))};var aa=i(21752);function oa(e){window.__c={n:"AuditLogColumnActor"};const{auditLogEntry:t,spaceStore:i,id:n}=e,o=(0,f.useIntl)(),r=(0,Te.VK)((()=>{if(t.actor.actorType===Kt.KJ){const e=ze.U6.createChildStore(i,{id:t.actor.actorId,table:Kt.KJ});if(e.isDefined())return{actorStore:e};if(t.actor.email)return{avatar:{name:t.actor.name,email:t.actor.email}}}else if(t.actor.actorType===At.cZ){const e=ze.Qx.createChildStore(i,{id:t.actor.actorId,table:At.cZ});return e.isDefined()?{actorStore:e}:{avatar:{name:t.actor.name,email:t.actor.actorId}}}return{actorStore:void 0}}),[i,t]),l=(0,Te.VK)((()=>{var e,t;if(r)return(null===(e=r.actorStore)||void 0===e?void 0:e.getDisplayName(o))??(null===(t=r.avatar)||void 0===t?void 0:t.name)}),[r,o]),c=(0,Te.VK)((()=>{var e,t;if(r)return(null===(e=r.actorStore)||void 0===e?void 0:e.getDetail())??(null===(t=r.avatar)||void 0===t?void 0:t.email)}),[r]),u=(0,d.useMemo)((()=>{var e;if(t.actor.actorType===Kt.KJ)return(0,aa.K)(null===(e=t.actor.meta)||void 0===e?void 0:e.spaceRole)}),[t]),p=(0,_e.yK)((()=>({container:{display:"block",width:"100%",paddingBlock:6}})),[]),m=(0,d.createRef)();return a()(Oe.Z,{disableTooltip:sa(m.current),renderTooltip:()=>d.createElement(d.Fragment,null,a()("div",{},void 0,l),a()("div",{},void 0,c)),placement:Oe.Z.Placement.Bottom,render:e=>d.createElement("div",s()({},e,{style:p.container}),d.createElement(aa.Z,s()({id:n},r,{spaceRole:u})))})}function sa(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var ra=i(13991),la=i(25464);function da(e){window.__c={n:"AuditLogColumnDateTime"};const{auditLogEntry:t,id:i}=e,n=(0,_e.yK)((()=>({container:{display:"block",width:"100%"}})),[]);return a()(Oe.Z,{renderTooltip:()=>a()("div",{style:{display:"flex",flexDirection:"column",fontVariantNumeric:"tabular-nums"}},void 0,a()("div",{},void 0,a()(f.FormattedMessage,{id:"auditLogSettings.timeTooltip.utcTime",defaultMessage:"UTC: {time}",description:"Tooltip for UTC time on hover in the audit log.",values:{time:(0,Vn.$I)(t.serverTimestamp)}}))),render:e=>a()("div",{id:i,style:n.container},void 0,d.createElement(xe.Z,s()({isSecondaryColor:!0},e),(0,Vn.Yx)(t.serverTimestamp,"medium_with_time",ra.SP))),placement:la.u.Bottom})}var ca=i(65917),ua=i(19639),pa=i(90468),ma=i(73123);function ga(e){return"workspace"!==e}const ha=(0,f.defineMessages)({password_cleared:{id:"auditlog.actionNames.eventColumn.password_cleared",defaultMessage:"Cleared login password",description:"Password cleared event for audit log"},password_set:{id:"auditlog.actionNames.eventColumn.password_set",defaultMessage:"Created a login password",description:"Password set event for audit log"},password_changed:{id:"auditlog.actionNames.eventColumn.password_changed",defaultMessage:"Changed login password",description:"Password change event for audit log"},logout:{id:"auditlog.actionNames.eventColumn.logout",defaultMessage:"Logged out",description:"Logout picture event for audit log"},user_deleted:{id:"auditlog.actionNames.eventColumn.user_deleted",defaultMessage:"User was deleted",description:"User deleted event for audit log"},member_joined:{id:"auditlog.actionNames.eventColumn.member_joined",defaultMessage:"Joined the workspace",description:"Member joined event for audit log"},file_uploaded:{id:"auditlog.actionNames.eventColumn.file_uploaded",defaultMessage:"Uploaded a file",description:"File uploaded event for audit log"},invite_link_reset:{id:"auditlog.actionNames.eventColumn.invite_link_reset",defaultMessage:"Reset invite link",description:"Reset invite link for workspace"},workspace_exported:{id:"auditlog.actionNames.eventColumn.workspace_exported",defaultMessage:"Exported all workspace content",description:"An audit log that describes an export of all the workspace contents, e.g. in PDF form"},audit_log_exported:{id:"auditlogEventFilter.eventColumn.audit_log_exported",defaultMessage:"Exported audit log for last {duration} days",description:"Describes audit log event of exporting the audit log for a specific number of days in CSV format."},user_analytics_exported:{id:"auditlogEventFilter.eventColumn.user_analytics_exported",defaultMessage:"Exported user analytics for {daysFilterString}",description:"Describes audit log event of exporting the user analytics tab for a specific days filter in CSV format."},content_analytics_exported:{id:"auditlogEventFilter.eventColumn.content_analytics_exported",defaultMessage:"Exported content analytics for {daysFilterString}",description:"Describes audit log event of exporting the user analytics tab for a specific days filter in CSV format."},workspace_icon_changed:{id:"auditlog.actionNames.eventColumn.workspace_icon_changed",defaultMessage:"Changed workspace icon",description:"An audit log that describes a change of the workspace icon"},public_page_cleared:{id:"auditlogEventFilter.actionNames.public_page_cleared",defaultMessage:"Public home page link cleared",description:"An audit log that describes the clearing of a public home page for a workspace"},scim_token_generated:{id:"auditlog.actionNames.scim_token_generated",defaultMessage:"Generated API SCIM token",description:"An audit log that describes the generating of a SCIM token for a workspace"},scim_token_revoked:{id:"auditlog.actionNames.scim_token_revoked",defaultMessage:"Revoked API SCIM token",description:"An audit log that describes the revoking of the SCIM token for a workspace"},page_access_requests_toggled:{id:"auditlog.actionNames.eventColumn.page_access_requests_toggled",defaultMessage:"page access requests from non-members",description:"Used to track page access requests toggle from settings in audit log, will either have the word 'Enabled' or 'Disabled' in front"},public_page_sharing_toggled:{id:"auditlog.actionNames.eventColumn.public_page_sharing_toggled",defaultMessage:"members sharing pages publicly",description:"Used to track page sharing toggle from settings in audit log, will either have the word 'Enabled' or 'Disabled' in front"},workspace_sidebar_editing_toggled:{id:"auditlog.actionNames.eventColumn.workspace_sidebar_editing_toggled",defaultMessage:"members changing the Workspace section",description:"Used to track members changing Workspace settings toggle in audit log, will either have the word 'Enabled' or 'Disabled' in front"},disable_team_guests_toggled:{id:"auditlog.actionNames.eventColumn.disable_team_guests_toggled",defaultMessage:"teamspace guests",description:"Used to track toggling teamspace guests in a workspace in audit log, will either have the word 'Enabled' or 'Disabled' in front"},disable_guests_toggled:{id:"auditlog.actionNames.eventColumn.disable_guests_toggled",defaultMessage:"guests",description:"Used to track toggling guests in a workspace in audit log, will either have the word 'Enabled' or 'Disabled' in front"},pages_to_other_workspaces_toggled:{id:"auditlog.actionNames.eventColumn.pages_to_other_workspaces_toggled",defaultMessage:"moving or duplicating pages to other workspaces",description:"Used to track toggling moving pages to other workspaces in audit log, will either have the word 'Enabled' or 'Disabled' in front"},export_toggled:{id:"auditlog.actionNames.eventColumn.export_toggled",defaultMessage:"export",description:"Used to track toggling export for a workspace in audit log, will either have the word 'Enabled' or 'Disabled' in front"},idp_metadata_xml_updated:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_updated",defaultMessage:"Updated IDP metadata XML",description:"An audit log that describes IDP metadata XML getting updated"},idp_metadata_xml_removed:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_removed",defaultMessage:"Removed IDP metadata XML",description:"An audit log that describes IDP metadata XML getting removed"},saml_enabled:{id:"auditlog.actionNames.saml_enabled",defaultMessage:"Enabled SAML",description:"An audit log that describes the enabling of SAML for a workspace"},saml_disabled:{id:"auditlog.actionNames.saml_disabled",defaultMessage:"Disabled SAML",description:"An audit log that describes the disabling of SAML for a workspace"},saml_enforced:{id:"auditlog.actionNames.saml_enforced",defaultMessage:"Enabled enforcing SAML",description:"An audit log that describes the enforcing of SAML for a workspace"},saml_unenforced:{id:"auditlog.actionNames.saml_unenforced",defaultMessage:"Disabled enforcing SAML",description:"An audit log that describes the disabling of SAML enforcing for a workspace"},automatic_account_creation_enabled:{id:"auditlog.actionNames.automatic_account_creation_enabled",defaultMessage:"Enabled automatically creating accounts on sign-in",description:"An audit log that describes the enabling of automatically creating accounts on sign-in"},automatic_account_creation_disabled:{id:"auditlog.actionNames.automatic_account_creation_disabled",defaultMessage:"Disabled automatically creating accounts on sign-in",description:"An audit log that describes the disabling of automatically creating accounts on sign-in"},workspace_analytics_enabled:{id:"auditlog.actionNames.workspace_analytics_enabled",defaultMessage:"Enabled page view tracking for workspace analytics",description:"An audit log that describes the enabling of workspace analytics"},workspace_analytics_disabled:{id:"auditlog.actionNames.workspace_analytics_disabled",defaultMessage:"Disabled page view tracking for workspace analytics",description:"An audit log that describes the disabling of workspace analytics"},a_private_page:{defaultMessage:"a private page",id:"auditlog.actionNames.eventColumn.private_page",description:"An audit log that describes a page action performed on a page that is private"},an_untitled_page:{defaultMessage:"an untitled page",id:"auditlog.actionNames.eventColumn.untitled_page",description:"An audit log that describes a page action performed on a page that is untitled"},thisWorkspace:{defaultMessage:"this workspace",id:"auditlog.actionNames.eventColumn.thisWorkspace",description:"The word is used in an audit log that describes a page action performed to the current workspace"},otherWorkspace:{defaultMessage:"another workspace",id:"auditlog.actionNames.eventColumn.otherWorkspace",description:"The word is used in an audit log that describes a page action performed to another workspace"},workspaceLevel:{defaultMessage:"the workspace level",id:"auditlog.actionNames.eventColumn.workspaceLevel",description:"The word is used in an audit log that describes a page action performed to a page at the workspace level"},private:{defaultMessage:"private",id:"auditlog.actionNames.eventColumn.private",description:"The word is used in an audit log that describes a page action performed to a private page"},a_file:{defaultMessage:"a file",id:"auditlog.actionNames.eventColumn.a_file",description:"The word is used in an audit log that describes a file users uploaded or downloaded"},a_file_with_extension:{defaultMessage:"a {extension} file",id:"auditlog.actionNames.eventColumn.a_file_with_extension",description:"The word is used in an audit log that describes a file with a particular extension users uploaded or downloaded"},team:{defaultMessage:"teamspace",id:"auditlog.actionNames.eventColumn.team",description:"The word to denote a teamspace in audit log."},for_a_private_team:{defaultMessage:"for a private teamspace",id:"auditlog.actionNames.eventColumn.for_private_team",description:"An audit log that describes a action performed for a teamspace that is private"},a_private_team:{defaultMessage:"a private teamspace",id:"auditlog.actionNames.eventColumn.private_team",description:"An audit log that describes a action performed on a teamspace that is private"},a_team_and_page:{defaultMessage:"a teamspace and page",id:"auditlog.actionNames.eventColumn.team_and_page",description:"A phrase to denote a teamspace and page in audit log (e.g. under which a child page resides)."},team_member:{defaultMessage:"teamspace member",id:"auditlog.actionNames.eventColumn.team_member",description:"A phrase to denote a teamspace member."},team_owner:{defaultMessage:"teamspace owner",id:"auditlog.actionNames.eventColumn.team_owner",description:"A phrase to denote a teamspace owner."},team_level_guest:{defaultMessage:"teamspace guest",id:"auditlog.actionNames.eventColumn.team_level_guest",description:"A phrase to denote a teamspace guest."},group:{defaultMessage:"group",id:"auditlog.actionNames.eventColumn.group",description:"The word to denote a group in audit log."},user:{defaultMessage:"user",id:"auditLogEntry.user.noName",description:"Placeholder used in audit log entry when a user neither has a name nor an email address."},adminContentSearchQuery:{defaultMessage:"query=“{query}“",id:"auditLogEntry.adminContentSearch.query",description:"The contents of the query in the content search audit log entry."},adminContentSearchAudience:{defaultMessage:"audience=“{audience}“",id:"auditLogEntry.adminContentSearch.audience",description:"The audience of the page in the admin content search audit log entry."},adminContentSearchCreatedBy:{defaultMessage:"created by=“{createdBy}“",id:"auditLogEntry.adminContentSearch.createdBy",description:"The creator of the page in the admin content search audit log entry."},adminContentSearchSharedWith:{defaultMessage:"shared with=“{sharedWith}“",id:"auditLogEntry.adminContentSearch.sharedWith",description:"The people the page is shared with in the admin content search audit log entry."},adminContentSearchTeamspaces:{defaultMessage:"{teamspaceCount, plural, one {teamspace=“{teamspaces}“} other {teamspaces=“{teamspaces}“}}",id:"auditLogEntry.adminContentSearch.teamspace",description:"The teamspaces the page might be in the admin content search audit log entry."},adminContentSearchCreatedTime:{defaultMessage:"created time=“{createdTime}“",id:"auditLogEntry.adminContentSearch.createdTime",description:"The created time of the page in the admin content search audit log entry."},adminContentSearchLastEditedTime:{defaultMessage:"last edited time=“{lastEditedTime}“",id:"auditLogEntry.adminContentSearch.lastEditedTime",description:"The last edited time of the page in the admin content search audit log entry."},adminContentSearchPredicateSplit:{defaultMessage:", ",id:"auditLogEntry.adminContentSearch.predicateSplit",description:"The string used to split the predicates in the admin content search audit log entry. For instance, an entry could be 'title=..., id=...'. The split string in this instance is ', '"},from:{defaultMessage:"from",id:"auditLogEntry.spaceContentDuplication.from",description:"The word used to indicate the direction that data was moved, so in this case the data was moved 'from' space"},into:{defaultMessage:"into",id:"auditLogEntry.spaceContentDuplication.into",description:"The word used to indicate the direction that data was moved, so in this case the data was moved 'into' space"}});function fa(e,t){if(t.target)return"user"in t.target&&t.target.user?va(e,t.target.user):"bot"in t.target&&t.target.bot?t.target.bot.name?`“${t.target.bot.name}“`:"bot":"group"in t.target&&t.target.group?t.target.group.name?`“${t.target.group.name}“`:"group":void 0}function va(e,t){return t?t.name&&t.email?`“${t.name}“ (${t.email})`:t.name?`“${t.name}“`:t.email?`“${t.email}“`:e.formatMessage(ha.user):e.formatMessage(ha.user)}const ya=(0,f.defineMessages)({started:{id:"space.spaceContentDuplicationStatus.started",defaultMessage:"Started",description:"Word to indicate the progress/status of a workspace consolidation"},completed:{id:"space.spaceContentDuplicationStatus.completed",defaultMessage:"Completed",description:"Word to indicate the progress/status of a workspace consolidation"},failed:{id:"space.spaceContentDuplicationStatus.failed",defaultMessage:"Failed",description:"Word to indicate the progress/status of a workspace consolidation"}}),ba=(0,f.defineMessages)({equallyRestrictive:{defaultMessage:". This is the same as the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_equal",description:"An audit log suffix that describes that a team's guest settings were the same as the workspace's"},moreRestrictive:{defaultMessage:". This is more restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_more_restrictive",description:"An audit log suffix that describes that a team's guest settings were more restrictive than the workspace's"},lessRestrictive:{defaultMessage:". This is less restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_less_restrictive",description:"An audit log suffix that describes that a team's guest settings were less restrictive than the workspace's"}});function Sa(e,t){if(void 0!==e&&void 0!==t)return e===t?d.createElement(f.FormattedMessage,ba.equallyRestrictive):!e&&t?d.createElement(f.FormattedMessage,ba.moreRestrictive):e&&!t?d.createElement(f.FormattedMessage,ba.lessRestrictive):void 0}function wa(e){return e.name?`“${e.name}“ group`:d.createElement(f.FormattedMessage,ha.group)}function Ma(e){return window.__c={n:"getTeamNameChangeFromAuditLogEntry"},e.changes.name.oldValue&&e.changes.name.newValue?a()(f.FormattedMessage,{defaultMessage:"from “{oldTeamName}“ to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_old_team_name_to_new_team_name",description:"An audit log that describes that a team's name change.",values:{oldTeamName:e.changes.name.oldValue,newTeamName:e.changes.name.newValue}}):!e.changes.name.oldValue&&e.changes.name.newValue?a()(f.FormattedMessage,{defaultMessage:"from some teamspace name to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_unknown_team_name_to_new_team_name",description:"An audit log that describes that a teamspace's name change from an unknown old name.",values:{newTeamName:e.changes.name.newValue}}):a()(f.FormattedMessage,{defaultMessage:"for {teamName}",id:"auditlog.actionNames.eventColumn.for_team_name",description:"An audit log that describes that a team's name.",values:{teamName:Ca(e)}})}function Ca(e){return window.__c={n:"getTeamNameFromAuditLogEntry"},"team"in e.target?ka(e.target.team):d.createElement(f.FormattedMessage,ha.team)}function ka(e){return e.name?`“${e.name}“ teamspace`:d.createElement(f.FormattedMessage,ha.team)}function Ta(e){if(window.__c={n:"getTeamRole"},e)switch(e){case"owner":return d.createElement(f.FormattedMessage,ha.team_owner);case"member":return d.createElement(f.FormattedMessage,ha.team_member);case"team_level_guest":return d.createElement(f.FormattedMessage,ha.team_level_guest)}return d.createElement(f.FormattedMessage,ha.team_member)}function _a(e){return window.__c={n:"getPagePermission"},d.createElement(f.FormattedMessage,function(e){if(!e)return mt.mq.noAccessLabel;switch(e){case"editor":return mt.mq.fullAccessLabel;case"membership_admin":case"read_and_write":return mt.mq.canEditLabel;case"content_only_editor":return mt.mq.canEditContentLabel;case"reader":return mt.mq.canReadLabel;case"comment_only":return mt.mq.canCommentLabel;case"none":return mt.mq.noAccessLabel;default:(0,T.t1)(e)}}(e))}function Ia(e){var t,i,n,a;return{oldRole:d.createElement(f.FormattedMessage,xa(null===(t=e.changes)||void 0===t||null===(i=t.permission)||void 0===i?void 0:i.oldValue)),newRole:d.createElement(f.FormattedMessage,xa(null===(n=e.changes)||void 0===n||null===(a=n.permission)||void 0===a?void 0:a.newValue))}}const xa=e=>{if(!e)return mt.mq.noAccessLabel;switch(e){case"editor":return mt.mq.adminLabel;case"membership_admin":return mt.mq.membershipAdminLabel;case"read_and_write":return mt.mq.memberLabel;default:return mt.mq.noAccessLabel}};function Za(e){return e.target.page.title?`“${e.target.page.title}“`:d.createElement(f.FormattedMessage,ha.an_untitled_page)}function Pa(e){var t,i,n,a,o,s;return window.__c={n:"getParentPageTitle"},null!==(t=e.target)&&void 0!==t&&null!==(i=t.page)&&void 0!==i&&null!==(n=i.meta)&&void 0!==n&&n.parent&&"title"in(null===(a=e.target)||void 0===a||null===(o=a.page)||void 0===o||null===(s=o.meta)||void 0===s?void 0:s.parent)?`“${e.target.page.meta.parent.title}“`:d.createElement(f.FormattedMessage,ha.an_untitled_page)}function Fa(e){var t;return null!==(t=e.actor.meta)&&void 0!==t&&t.platform?a()(f.FormattedMessage,{defaultMessage:"on {platform}",id:"auditlog.actionNames.eventColumn.logged_in_platform",description:"An audit log phrase that describes what platform a user logged in on (e.g. desktop)",values:{platform:e.actor.meta.platform}}):""}function Aa(e){return e.changes.name.oldValue?a()(f.FormattedMessage,{defaultMessage:"from “{oldDomain}“",id:"auditlog.actionNames.eventColumn.old_domain",description:"An audit log phrase that describes what the old domain for a workspace was before it changed.",values:{oldDomain:e.changes.name.oldValue}}):""}function Ba(e,t){return"block"===e.table?a()(f.FormattedMessage,{defaultMessage:"{teamName} page {parentPage}",id:"auditlog.actionNames.eventColumn.team_parent_page",description:"An audit log phrase that describes what parent page and teamspace a page is under.",values:{teamName:ka(t),parentPage:Ea(e)}}):"team"===e.table?ka(t):void 0}function Ea(e){return window.__c={n:"getParentTargetTypePageTitle"},"title"in e?`“${e.title}“`:d.createElement(f.FormattedMessage,ha.an_untitled_page)}function Da(e,t){if(!t)return d.createElement(f.FormattedMessage,ha.an_untitled_page);const i=t.table;return"space"===i?t.id!==e?d.createElement(f.FormattedMessage,ha.otherWorkspace):ga(t.permissionLevel)?d.createElement(f.FormattedMessage,ha.private):d.createElement(f.FormattedMessage,ha.thisWorkspace):"team"===i?ka(t):"block"===i?t.title?`“${t.title}“`:d.createElement(f.FormattedMessage,ha.an_untitled_page):void 0}const Ra=(0,f.defineMessages)({open:{defaultMessage:"Open",id:"auditlog.actionNames.eventColumn.team_privacy_types.open",description:"An audit log phrase that describes an open team"},closed:{defaultMessage:"Closed",id:"auditlog.actionNames.eventColumn.team_privacy_types.closed",description:"An audit log phrase that describes a closed team"},private:{defaultMessage:"Private",id:"auditlog.actionNames.eventColumn.team_privacy_types.private",description:"An audit log phrase that describes a private team"},default:{defaultMessage:"Default",id:"auditlog.actionNames.eventColumn.team_privacy_types.default",description:"An audit log phrase that describes a default team"},unknown:{defaultMessage:"an unknown privacy state",id:"auditlog.actionNames.eventColumn.team_privacy_types.unknown",description:"An audit log phrase that describes a team with an unknown privacy state"}});function La(e){return e?d.createElement(f.FormattedMessage,Ra[e]):d.createElement(f.FormattedMessage,Ra.unknown)}function Oa(e){return e.changes.enabled.newValue?a()(f.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.membership_requests_toggled.disabled",description:"An audit log that describes that the membership requests setting was disabled."}):a()(f.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.membership_requests_toggled.enabled",description:"An audit log that describes that the membership requests setting was enabled."})}function Na(e){return"approved"===e.changes.requestStatus.newValue?a()(f.FormattedMessage,{defaultMessage:"Approved",id:"auditlog.actionNames.eventColumn.membership_request_resolved.approved",description:"An audit log that describes that a membership request was approved."}):a()(f.FormattedMessage,{defaultMessage:"Declined",id:"auditlog.actionNames.eventColumn.membership_request_resolved.declined",description:"An audit log that describes that a membership request was declined."})}function Va(e){return e.changes.enabled.newValue?a()(f.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.disabled",description:"An audit log that describes that the guest membership requests setting was disabled."}):a()(f.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.enabled",description:"An audit log that describes that the guest membership requests setting was enabled."})}function Ua(e){return e.changes.enabled.newValue?a()(f.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled.disabled",description:"An audit log that describes Notion AI being enabled"}):a()(f.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled.enabled",description:"An audit log that describes Notion AI being disabled"})}const Wa=(0,f.defineMessages)({team_members:{defaultMessage:"any teamspace member",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_members",description:"An audit log phrase that any teamspace members can invite teamspace members"},team_owners:{defaultMessage:"only teamspace owners",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_owners",description:"An audit log phrase that only teamspace owners can invite teamspace members"},unknown:{defaultMessage:"unknown",id:"auditlog.actionNames.eventColumn.team_access_level_types.unknown",description:"An audit log phrase that describes a team state where who can invite team members is unknown"}});function za(e){return window.__c={n:"getAutomationType"},a()(f.FormattedMessage,"recurrence"===e?{id:"auditlog.actionNames.eventColumn.automation_type.recurrence",defaultMessage:"a repeating automation",description:"A phrase that describes a repeating automation event in an audit log entry."}:{id:"auditlog.actionNames.eventColumn.automation_type.automation",defaultMessage:"an automation",description:"A phrase that describes a generic automation event in an audit log entry."})}function Ka(e,t,i){var n,o,s,r,c,u,p,m,g,h,v,y,b,S,w,M,C,k,_,I,x,Z,P,F,A,B,E,D,R,L,O;switch(e.actionName){case"page_edited":return a()(f.FormattedMessage,{defaultMessage:"Edited {pageName}",id:"auditlog.actionNames.eventColumn.page_edited",description:"An audit log that describes a user edited a page",values:{pageName:Za(e)}});case"page_viewed":return a()(f.FormattedMessage,{defaultMessage:"Viewed {pageName}",id:"auditlog.actionNames.eventColumn.page_viewed_under",description:"An audit log that describes a viewed page",values:{pageName:Za(e)}});case"page_deleted":return e.target.page.meta.permanentDeletion?a()(f.FormattedMessage,{defaultMessage:"Permanently deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_permanently_deleted",description:"Permanently deleted page event for audit log",values:{pageName:Za(e)}}):a()(f.FormattedMessage,{defaultMessage:"Deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_deleted",description:"Deleted page event for audit log",values:{pageName:Za(e)}});case"page_restored":return a()(f.FormattedMessage,{defaultMessage:"Restored {pageName}",id:"auditlog.actionNames.eventColumn.page_restored",description:"Restored page event for audit log",values:{pageName:Za(e)}});case"page_exported":return a()(f.FormattedMessage,{defaultMessage:"Exported {pageName}",id:"auditlog.actionNames.eventColumn.page_exported",description:"Exported page event for audit log",values:{pageName:Za(e)}});case"page_moved":{var N,V,U;const t=null===(N=e.changes)||void 0===N?void 0:N.team,n=e.changes.parent.oldValue,o=e.changes.parent.newValue;let s=Da(e.spaceId,e.changes.parent.oldValue),r=Da(e.spaceId,e.changes.parent.newValue);null!=t&&t.oldValue&&null!=t&&t.newValue&&n&&o&&("block"===n.table||"block"===o.table)?(s=Ba(n,null==t?void 0:t.oldValue),r=Ba(o,null==t?void 0:t.newValue)):"space"===(null===(V=e.changes.parent.oldValue)||void 0===V?void 0:V.table)&&"space"===(null===(U=e.changes.parent.newValue)||void 0===U?void 0:U.table)&&e.changes.parent.oldValue.id===e.changes.parent.newValue.id&&(ga(e.changes.parent.oldValue.permissionLevel)||ga(e.changes.parent.newValue.permissionLevel))&&(s=ga(e.changes.parent.oldValue.permissionLevel)?d.createElement(f.FormattedMessage,ha.private):d.createElement(f.FormattedMessage,ha.workspaceLevel),r=ga(e.changes.parent.newValue.permissionLevel)?d.createElement(f.FormattedMessage,ha.private):d.createElement(f.FormattedMessage,ha.workspaceLevel));const l=s?i.formatMessage({id:"auditLogEntry.changes.page_moved.old_parent",defaultMessage:" from {oldParentName}",description:"Description of the old parent page for the page that was moved."},{oldParentName:s}):"",c=r?i.formatMessage({id:"auditLogEntry.changes.page_moved.new_parent",defaultMessage:" to {newParentName}",description:"Description of the new parent page for the page that was moved."},{newParentName:r}):"";return a()(f.FormattedMessage,{defaultMessage:"Moved {pageName}{oldParentMessage}{newParentMessage}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_moved",description:"Moved page event for audit log",values:{pageName:Za(e),oldParentMessage:l,newParentMessage:c,inSudoMode:Ha(e)}})}case"page_permission_updated":return function(e,t){var i,n,o,s,r;window.__c={n:"renderPagePermissionUpdated"};const l="bot"in t.target,d="space"in t.target,c="team"in t.target,u="group"in t.target,p="user"in t.target&&"guest"===(null===(i=t.target.user.meta)||void 0===i?void 0:i.spaceRole);var m,g,h,v;if(l)return a()(f.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for bot {botName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_bot",description:"An audit log that describe a page's permission has been changed for bots. It means bots can be added, removed, or changed role for this page",values:{botName:fa(e,t),oldRole:_a(null===(m=t.changes)||void 0===m||null===(g=m.permission)||void 0===g?void 0:g.oldValue),newRole:_a(null===(h=t.changes)||void 0===h||null===(v=h.permission)||void 0===v?void 0:v.newValue),pageName:Za(t),inSudoMode:Ha(t)}});var y,b,S,w,M,C,k,T,_,I,x,Z;if(d)return a()(f.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for everyone in the workspace from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_space",description:"An audit log that describe a page's permission has been changed for everyone in the workspace. It means the permission can be added, removed, or changed role for this page",values:{oldRole:_a(null===(y=t.changes)||void 0===y||null===(b=y.permission)||void 0===b?void 0:b.oldValue),newRole:_a(null===(S=t.changes)||void 0===S||null===(w=S.permission)||void 0===w?void 0:w.newValue),pageName:Za(t),inSudoMode:Ha(t)}});if(c)return a()(f.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {teamName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_team",description:"An audit log that describe a page's permission has been changed for a team.",values:{oldRole:_a(null===(M=t.changes)||void 0===M||null===(C=M.permission)||void 0===C?void 0:C.oldValue),newRole:_a(null===(k=t.changes)||void 0===k||null===(T=k.permission)||void 0===T?void 0:T.newValue),pageName:Za(t),teamName:Ca(t),inSudoMode:Ha(t)}});if(p)return a()(f.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for guest {guestNameAndEmail} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_guest",description:"An audit log that describe a page's permission has been changed for guests. It means guests can be added, removed, or changed role for this page",values:{guestNameAndEmail:fa(e,t),oldRole:_a(null===(_=t.changes)||void 0===_||null===(I=_.permission)||void 0===I?void 0:I.oldValue),newRole:_a(null===(x=t.changes)||void 0===x||null===(Z=x.permission)||void 0===Z?void 0:Z.newValue),pageName:Za(t),inSudoMode:Ha(t)}});if(u){var P,F,A,B;return a()(f.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for group {groupName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_group",description:"An audit log that describe a page's permission has been changed for a group. It means a group has been added, removed, or changed permission roles for this page",values:{groupName:fa(e,t),oldRole:_a(null===(P=t.changes)||void 0===P||null===(F=P.permission)||void 0===F?void 0:F.oldValue),newRole:_a(null===(A=t.changes)||void 0===A||null===(B=A.permission)||void 0===B?void 0:B.newValue),pageName:Za(t),inSudoMode:Ha(t)}})}return a()(f.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {memberNameAndEmail} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_default",description:"An audit log that describe a page's permission has been changed for members. It means members can be added, removed, or changed role for this page",values:{memberNameAndEmail:fa(e,t),oldRole:_a(null===(n=t.changes)||void 0===n||null===(o=n.permission)||void 0===o?void 0:o.oldValue),newRole:_a(null===(s=t.changes)||void 0===s||null===(r=s.permission)||void 0===r?void 0:r.newValue),pageName:Za(t),inSudoMode:Ha(t)}})}(i,e);case"page_created":const H=$(e);if(null!=H&&null!==(n=H.meta)&&void 0!==n&&n.parent){var W,z,K,q;if(H.meta.parent.table===pa.bx)return"private"===(null===(K=H.meta)||void 0===K?void 0:K.permissionLevel)||"private"===(null===(q=H.meta)||void 0===q?void 0:q.pageAudience)?a()(f.FormattedMessage,{defaultMessage:"Created a private page",description:"Created private page event for audit log",id:"auditlog.actionNames.eventColumn.page_created_private"}):a()(f.FormattedMessage,{defaultMessage:"Created a page in the workspace",description:"Created page event for audit log",id:"auditlog.actionNames.eventColumn.page_created_workspace"});if((null===(W=H.meta)||void 0===W?void 0:W.parent.table)===ht.e0)return a()(f.FormattedMessage,{defaultMessage:"Created a page under {teamName}",description:"Created page under a team event for audit log",id:"auditlog.actionNames.eventColumn.page_created_team",values:{teamName:ka(H.meta.parent)}});if((null===(z=H.meta)||void 0===z?void 0:z.parent.table)===dn.iU)return a()(f.FormattedMessage,{defaultMessage:"Created a page under {parentPageName}",description:"Created page event for audit log",id:"auditlog.actionNames.eventColumn.page_created_under",values:{parentPageName:Pa(e)}})}return a()(f.FormattedMessage,{defaultMessage:"Created a page",description:"Created page (audit log)",id:"auditlog.actionNames.eventColumn.page_created_general"});case"page_shared_to_web":return function(e){if(window.__c={n:"renderPageSharedToWeb"},void 0===e.changes.permission.newValue||"none"===e.changes.permission.newValue)return a()(f.FormattedMessage,{defaultMessage:"Disabled sharing {pageName} to web{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_shared_to_web.disabled",description:"An audit log that describe a page has been disabled for sharing to web. It means everyone on the Internet will not have access to the page.",values:{pageName:Za(e),inSudoMode:Ha(e)}});return a()(f.FormattedMessage,{defaultMessage:"Enabled sharing {pageName} to web{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_shared_to_web.enabled",description:"An audit log that describe a page has been enabled for sharing to web. It means everyone on the Internet will have access to the page.",values:{pageName:Za(e),inSudoMode:Ha(e)}})}(e);case"login":return null!==(o=e.actor.meta)&&void 0!==o&&o.countryCode?a()(f.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithCityStateAndCountry",defaultMessage:"Logged in {platform} in {geolocation}",description:"Login event for audit log with additional metadata (platform is device i.e. web, mobile, city/country name)",values:{platform:Fa(e),geolocation:qn(e,i)}}):a()(f.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithPlatform",defaultMessage:"Logged in {platform}",description:"Login event for audit log with additional metadata (platform is device i.e. web, mobile, city/country name)",values:{platform:Fa(e)}});case"allowed_support_access":return a()(f.FormattedMessage,{defaultMessage:"Granted support access for {name} until {date}",id:"auditlog.actionNames.allowed_support_access",description:"An audit log that describes the enabling of support access",values:{date:i.formatDate(e.changes.expiresAt),name:e.target.user.name}});case"revoked_support_access":return a()(f.FormattedMessage,{defaultMessage:"Revoked support access for {name}",id:"auditlog.actionNames.revoked_support_access",description:"An audit log that describes the disabling of support access",values:{name:e.target.user.name}});case"preferred_name_changed":return function(e,t){var i;window.__c={n:"renderPreferredNameChanged"};const n=!!e.target&&e.actor.actorId!==(null===(i=e.target)||void 0===i?void 0:i.user.id),o=e.changes.name.oldValue,s=e.changes.name.newValue;if(n){if(o&&s)return a()(f.FormattedMessage,{defaultMessage:'Changed {memberNameAndEmail} name from "{oldValue}" to "{newValue}"',id:"auditlog.actionNames.eventColumn.external_preferred_name_changed",description:"An audit log that describes a change of a user's preferred name by another user between two values",values:{memberNameAndEmail:fa(t,e),oldValue:o,newValue:s}});if(!o&&s)return a()(f.FormattedMessage,{defaultMessage:'Set {memberNameAndEmail} name to "{newValue}"',id:"auditlog.actionNames.eventColumn.external_preferred_name_changed_to_value",description:"An audit log that describes a change of a user's preferred name by another user to a new value",values:{memberNameAndEmail:fa(t,e),newValue:s}});if(o&&!s)return a()(f.FormattedMessage,{defaultMessage:'Removed {memberNameAndEmail} name "{oldValue}"',id:"auditlog.actionNames.eventColumn.external_preferred_name_changed_from_value",description:"An audit log that describes a change of a user's preferred name by another user from the old value",values:{memberNameAndEmail:fa(t,e),oldValue:o}})}if(o&&s)return a()(f.FormattedMessage,{defaultMessage:'Changed name from "{oldValue}" to "{newValue}"',id:"auditlog.actionNames.eventColumn.preferred_name_changed",description:"An audit log that describes a change of a user's preferred name between two values",values:{oldValue:o,newValue:s}});if(!o&&s)return a()(f.FormattedMessage,{defaultMessage:'Set name to "{newValue}"',id:"auditlog.actionNames.eventColumn.preferred_name_changed_to_value",description:"An audit log that describes a change of a user's preferred name to a new value",values:{newValue:s}});if(o&&!s)return a()(f.FormattedMessage,{defaultMessage:'Removed name "{oldValue}"',id:"auditlog.actionNames.eventColumn.preferred_name_changed_from_value",description:"An audit log that describes a change of a user's preferred name from the old value",values:{oldValue:o}});return a()(f.FormattedMessage,{defaultMessage:"Name was changed",id:"auditlog.actionNames.eventColumn.preferred_name_changed_generic",description:"An audit log that describes a change of a user's preferred name"})}(e,i);case"email_changed":return function(e,t){var i;return e.target&&e.actor.actorId!==(null===(i=e.target)||void 0===i?void 0:i.user.id)?a()(f.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} email from {oldEmail} to {newEmail}",id:"auditlog.actionNames.eventColumn.external_email_changed",description:"Email changed by another user event for audit log",values:{memberNameAndEmail:fa(t,e),oldEmail:e.changes.email.oldValue,newEmail:e.changes.email.newValue}}):a()(f.FormattedMessage,{defaultMessage:"Changed email from {oldEmail} to {newEmail}",id:"auditlog.actionNames.eventColumn.email_changed",description:"Email changed event for audit log",values:{oldEmail:e.changes.email.oldValue,newEmail:e.changes.email.newValue}})}(e,i);case"picture_changed":return function(e,t){var i;return e.target&&e.actor.actorId!==(null===(i=e.target)||void 0===i?void 0:i.user.id)?a()(f.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} profile picture",id:"auditlog.actionNames.eventColumn.external_picture_changed",description:"Profile picture changed by another user event for audit log",values:{memberNameAndEmail:fa(t,e)}}):a()(f.FormattedMessage,{defaultMessage:"Changed profile picture",id:"auditlog.actionNames.eventColumn.picture_changed",description:"Profile picture changed event for audit log"})}(e,i);case"member_invited":{const t=Ia(e);return a()(f.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to the workspace as {newRole}",id:"auditlog.actionNames.eventColumn.member_invited",description:"An audit log that describe a user is invited to the workspace",values:{memberNameAndEmail:fa(i,e),newRole:t.newRole}})}case"member_role_updated":{const t=Ia(e);return a()(f.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.member_role_updated",description:"An audit log that describe a member is updated with a role",values:{memberNameAndEmail:fa(i,e),oldRole:t.oldRole,newRole:t.newRole}})}case"member_removed":return e.actor.actorId===e.target.user.id?a()(f.FormattedMessage,{defaultMessage:"Left the workspace",id:"auditlog.actionNames.eventColumn.member_left",description:"An audit log that describes when a member leaves the workspace"}):a()(f.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.member_removed",description:"An audit log that describe a member is removed access from the space",values:{memberNameAndEmail:fa(i,e)}});case"guest_removed":return a()(f.FormattedMessage,{defaultMessage:"Removed guest {guestNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.guest_removed",description:"An audit log that describe a guest is removed access from the space",values:{guestNameAndEmail:fa(i,e)}});case"file_uploaded":return a()(f.FormattedMessage,{defaultMessage:"Uploaded a file to {pageName}",id:"auditlog.actionNames.eventColumn.file_uploaded_public",description:"Uploaded a file to a non-private page event for audit log",values:{pageName:Za(e)}});case"file_downloaded":return function(e){return window.__c={n:"renderFileDownloaded"},a()(f.FormattedMessage,{defaultMessage:"Downloaded {fileName} from {pageName}",id:"auditlog.actionNames.eventColumn.file_downloaded",description:"An audit log that describes a user has downloaded a file from a page",values:{fileName:qa(e),pageName:Za(e)}})}(e);case"invite_link_toggled":return e.changes.enabled.newValue?a()(f.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.enabled",defaultMessage:"Enabled invite link",description:"Audit log for invite link enabled"}):a()(f.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.disabled",defaultMessage:"Disabled invite link",description:"Audit log for invite link disabled"});case"public_page_sharing_toggled":case"workspace_sidebar_editing_toggled":case"disable_team_guests_toggled":case"disable_guests_toggled":case"pages_to_other_workspaces_toggled":case"export_toggled":case"page_access_requests_toggled":return e.changes.enabled.newValue?a()(f.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.disabled",defaultMessage:"Disabled {workspaceSetting}",description:"Audit log event for disabling a workspace setting",values:{workspaceSetting:i.formatMessage(ha[e.actionName])}}):a()(f.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.enabled",defaultMessage:"Enabled {workspaceSetting}",description:"Audit log event for enabling a workspace setting",values:{workspaceSetting:i.formatMessage(ha[e.actionName])}});case"workspace_name_changed":return a()(f.FormattedMessage,{defaultMessage:"Changed workspace name from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_name_changed",description:"An audit log that describes a change of the workspace name",values:{oldValue:e.changes.name.oldValue,newValue:e.changes.name.newValue}});case"workspace_domain_changed":return a()(f.FormattedMessage,{defaultMessage:"Changed workspace domain {oldValue} to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_domain_changed",description:"An audit log that describes a change of the workspace domain",values:{oldValue:Aa(e),newValue:e.changes.name.newValue}});case"workspace_integration_restriction_changed":return function(e){window.__c={n:"renderIntegrationRestrictionChanged"};const t=void 0,{oldValue:i,newValue:n}=e.changes.integration_restrictions;if(n===t)return a()(f.FormattedMessage,{defaultMessage:"Enabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.no_restrictions",description:"An audit log that describes a user has removed the workspace integration restrictions, which means workspace members can install any integration."});if(i===t&&"approved_only"===n)return a()(f.FormattedMessage,{defaultMessage:"Disabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.approved_only",description:"An audit log that describes a user has turned on the workspace integration restrictions, which means workspace members can only install integrations pre-approved by an admin."});if("approved_or_built_by_notion"===i&&"approved_only"===n)return a()(f.FormattedMessage,{defaultMessage:"Disabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.disabled_built_by_notion.from_approved_or_built_by_notion",description:"An audit log that describes a user has turned off auto approval for built-by-Notion integrations."});if("approved_only"===i&&"approved_or_built_by_notion"===n)return a()(f.FormattedMessage,{defaultMessage:"Enabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.enabled_built_by_notion",description:"An audit log that describes a user has turned on auto approval for built-by-Notion integrations."});return a()(f.FormattedMessage,{defaultMessage:"Changed workspace integration restriction",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.fallback_message",description:"An audit log that describes workspace integration restrictions is changed."})}(e);case"allowed_email_domain_added":return a()(f.FormattedMessage,{defaultMessage:"Added “{addedValue}“ into allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_added",description:"An audit log that describes the adding of an allowed email domain to a workspace",values:{addedValue:e.changes.domain}});case"allowed_email_domain_removed":return a()(f.FormattedMessage,{defaultMessage:"Removed “{removedValue}“ from allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_removed",description:"An audit log that describes the removing of an allowed email domain to a workspace",values:{removedValue:e.changes.domain}});case"public_page_set":return e.changes.name.oldValue?a()(f.FormattedMessage,{defaultMessage:"Changed public home page from “{oldPage}“ to “{newPage}“",id:"auditlog.actionNames.eventColumn.public_page_changed",description:"An audit log that describes the changing of a public home page for a workspace",values:{oldPage:e.changes.name.oldValue,newPage:e.changes.name.newValue}}):a()(f.FormattedMessage,{defaultMessage:"Set “{newPage}“ as public home page",id:"auditlog.actionNames.eventColumn.public_page_set",description:"An audit log that describes the setting of a public home page for a workspace",values:{newPage:e.changes.name.newValue}});case"idp_metadata_url_updated":return e.changes.url.oldValue?a()(f.FormattedMessage,{defaultMessage:'Changed IDP metadata URL from "{oldValue}" to "{newValue}"',id:"auditlog.actionNames.eventColumn.idp_metadata_url_updated",description:"An audit log that describes when an IDP metadata URL is updated",values:{oldValue:e.changes.url.oldValue,newValue:e.changes.url.newValue}}):a()(f.FormattedMessage,{defaultMessage:'Set IDP metadata URL to "{newValue}"',id:"auditlog.actionNames.eventColumn.idp_metadata_url_set",description:"An audit log that describes when an IDP metadata URL is first set",values:{newValue:e.changes.url.newValue}});case"saml_toggled":return e.changes.enabled.newValue?d.createElement(f.FormattedMessage,ha.saml_enabled):d.createElement(f.FormattedMessage,ha.saml_disabled);case"saml_enforce_toggled":return e.changes.enabled.newValue?d.createElement(f.FormattedMessage,ha.saml_enforced):d.createElement(f.FormattedMessage,ha.saml_unenforced);case"automatic_account_creation_toggled":return e.changes.enabled.newValue?d.createElement(f.FormattedMessage,ha.automatic_account_creation_enabled):d.createElement(f.FormattedMessage,ha.automatic_account_creation_disabled);case"workspace_analytics_toggled":return e.changes.enabled.newValue?d.createElement(f.FormattedMessage,ha.workspace_analytics_enabled):d.createElement(f.FormattedMessage,ha.workspace_analytics_disabled);case"workspace_creation_set_for_email_domain":return function(e,t){window.__c={n:"renderWorkspaceCreationSetForEmailDomain"};const{oldValue:i,newValue:n}=e.changes.workspace_creation;if(!i&&!n)return a()(f.FormattedMessage,{defaultMessage:"Changed workspace creation setting",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain.fallback_message",description:"An audit log that describes changes for the workspace creation prevention setting without indicating the old or new values."});const o=e.changes.workspace_creation.oldValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.beforeSetting",defaultMessage:" from {prevWorkspaceCreationSetting}",description:"Description of previous workspace creation setting"},{prevWorkspaceCreationSetting:(0,ua.nJ)(e.changes.workspace_creation.oldValue,t)}):"",s=e.changes.workspace_creation.newValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.afterSetting",defaultMessage:" to {afterWorkspaceCreationSetting}",description:"Description of current workspace creation setting"},{afterWorkspaceCreationSetting:(0,ua.nJ)(e.changes.workspace_creation.newValue,t)}):"";return a()(f.FormattedMessage,{defaultMessage:"Changed workspace creation setting{before}{after}.",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain",description:"An audit log that describes changes for the workspace creation prevention setting providing the old and new values.",values:{before:o,after:s}})}(e,i);case"member_added_to_group":return a()(f.FormattedMessage,{defaultMessage:"Added {memberNameAndEmail} to {groupName}",id:"auditlog.actionNames.eventColumn.member_added_to_group",description:"An audit log that describes that a user was added to a group.",values:{memberNameAndEmail:fa(i,e),groupName:wa(e.target.group)}});case"member_removed_from_group":return a()(f.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {groupName}",id:"auditlog.actionNames.eventColumn.member_removed_from_group",description:"An audit log that describes that a user was removed from a group.",values:{memberNameAndEmail:fa(i,e),groupName:wa(e.target.group)}});case"space_transfer_status_changed":return function(e,t){window.__c={n:"renderSpaceTransferStatusChanged"};const{oldValue:i,newValue:n}=e.changes.spaceTransferStatus,o=e.target.space.name?t.formatMessage({id:"auditLogEntry.changes.space_transfer_status_changed.space_name",defaultMessage:" for {spaceName}",description:"Description of the workspace that had a space transfer status change"},{spaceName:e.target.space.name}):"";if(!i&&!n)return a()(f.FormattedMessage,{defaultMessage:"Workspace transfer status changed{spaceNameMessage}",id:"auditlog.actionNames.eventColumn.space_transfer_status_changed.fallback_message",description:"An audit log that describes changes for space transfer status without indicating the old or new values.",values:{spaceNameMessage:o}});if(!n)return a()(f.FormattedMessage,{defaultMessage:"Workspace transfer request cleared{spaceNameMessage} from prior status of {oldStatus}",id:"auditlog.actionNames.eventColumn.space_transfer_status_cleared",description:"An audit log that describes the space transfer requested being removed.",values:{spaceNameMessage:o,oldStatus:i}});return a()(f.FormattedMessage,{defaultMessage:"{newStatus, select, requested {Workspace transfer request initiated{spaceNameMessage}.} started {Workspace transfer started{spaceNameMessage}} completed {Workspace transfer completed{spaceNameMessage}} other {Workspace transfer status change to {newStatus}{spaceNameMessage}}}",id:"auditlog.actionNames.eventColumn.space_transfer_status_changed.newStatus",description:"An audit log that describes the space transfer requested being removed.",values:{spaceNameMessage:o,newStatus:n}})}(e,i);case"space_claim_and_upgrade_status_changed":return function(e){const{oldValue:t,newValue:i}=e.changes.claimAndUpgradeStatus,n=a()(f.FormattedMessage,{defaultMessage:"Status changed for workspace claim of {workspaceName}",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_changed.fallback_message",description:"An audit log that describes changes for space claim and upgrade status without indicating the old or new values.",values:{workspaceName:e.target.space.name}});if(!t&&!i)return n;if(!i&&"completed"!==t)return a()(f.FormattedMessage,{defaultMessage:"Pending workspace claim for {workspaceName} has been cleared from {oldStatus}",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_cleared",description:"An audit log that describes the space claim and upgrade request being removed.",values:{workspaceName:e.target.space.name,oldStatus:t}});if("completed"===i)return a()(f.FormattedMessage,{defaultMessage:"{workspaceName} has been claimed and upgraded to the Enterprise plan",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_completed",description:"An audit log that describes the space claim and upgrade request being completed.",values:{workspaceName:e.target.space.name}});if("requested"===i)return a()(f.FormattedMessage,{defaultMessage:"Request to claim and upgrade {workspaceName} has been sent.",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_requested",description:"An audit log that describes the space claim and upgrade request being initiated.",values:{workspaceName:e.target.space.name}});return n}(e);case"space_claim_deletion_status_changed":return function(e){window.__c={n:"renderSpaceClaimDeletionStatusChange"};const{oldValue:t,newValue:i}=e.changes.claimDeletionStatus,n=a()(f.FormattedMessage,{defaultMessage:"Claimable workspace deletion status change for {spaceName}",id:"auditlog.actionNames.eventColumn.space_claim_deletion_status_changed.fallback_message",description:"An audit log that describes changes for space claim deletion status without indicating the old or new values.",values:{spaceName:e.target.space.name}});if(!t&&!i)return n;if(!i||"canceled"===i)return a()(f.FormattedMessage,{defaultMessage:"Recovered workspace {spaceName} using Domain Management",id:"auditlog.actionNames.eventColumn.space_claim_deletion.status_cleared",description:"An audit log that describes the space claim deletion requested being removed.",values:{spaceName:e.target.space.name}});return a()(f.FormattedMessage,{defaultMessage:"Deleted workspace {spaceName} using Domain Management",id:"auditlog.actionNames.eventColumn.space_claim_deletion.deleted",description:"An audit log that describes that this workspace was deleted as part of domain claim.",values:{spaceName:e.target.space.name}})}(e);case"membership_requests_toggled":return a()(f.FormattedMessage,{defaultMessage:"{enabled} allowing members to request adding new members",id:"auditlog.actionNames.eventColumn.membership_requests_toggled",description:"An audit log that describes that the membership requests setting was toggled.",values:{enabled:Oa(e)}});case"membership_request_resolved":return a()(f.FormattedMessage,{defaultMessage:"{status} request to add {email} to the workspace as a member",id:"auditlog.actionNames.eventColumn.membership_request_resolved",description:"An audit log that describes that a membership request was resolved.",values:{status:Na(e),email:fa(i,e)}});case"guest_membership_requests_toggled":return a()(f.FormattedMessage,{defaultMessage:"{enabled} allowing page guests to request to be added to the workspace as members",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled",description:"An audit log that describes that the guest membership requests setting was toggled.",values:{enabled:Va(e)}});case"team_created":return a()(f.FormattedMessage,{defaultMessage:"Created {teamName}",id:"auditlog.actionNames.eventColumn.team_created",description:"An audit log that describes that a team was created.",values:{teamName:Ca(e)}});case"team_archived":return a()(f.FormattedMessage,{defaultMessage:"Archived {teamName}",id:"auditlog.actionNames.eventColumn.team_archived",description:"An audit log that describes that a team was archived.",values:{teamName:Ca(e)}});case"team_restored":return a()(f.FormattedMessage,{defaultMessage:"Restored {teamName}",id:"auditlog.actionNames.eventColumn.team_restored",description:"An audit log that describes that a team was restored.",values:{teamName:Ca(e)}});case"team_default_toggled":return e.changes.enabled.newValue?a()(f.FormattedMessage,{defaultMessage:"Added {teamName} to the default teamspace list. Workspace members will automatically be added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_enabled",description:"An audit log that describes that a teamspace was set to be default which enabled all workspace members to be automatically added to this teamspace.",values:{teamName:Ca(e)}}):a()(f.FormattedMessage,{defaultMessage:"Removed {teamName} from the default teamspace list. Workspace members will no longer be automatically added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_disabled",description:"An audit log that describes that a teamspace was removed from being default which disables all workspace members from being automatically added to this teamspace.",values:{teamName:Ca(e)}});case"team_public_page_sharing_toggled":return e.changes.enabled.newValue?d.createElement(d.Fragment,null,a()(f.FormattedMessage,{defaultMessage:"Disabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_disabled",description:"An audit log that describes that public page sharing was switched off for a team",values:{teamName:Ca(e)}}),Sa((null===(s=e.meta)||void 0===s?void 0:s.spacePublicPageSharingDisabled)??(null==e?void 0:e.spacePublicPageSharingDisabled),e.changes.enabled.newValue)):d.createElement(d.Fragment,null,a()(f.FormattedMessage,{defaultMessage:"Enabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_enabled",description:"An audit log that describes that public page sharing was switched on for a team",values:{teamName:Ca(e)}}),Sa((null===(r=e.meta)||void 0===r?void 0:r.spacePublicPageSharingDisabled)??(null==e?void 0:e.spacePublicPageSharingDisabled),e.changes.enabled.newValue));case"team_export_toggled":return e.changes.enabled.newValue?d.createElement(d.Fragment,null,a()(f.FormattedMessage,{defaultMessage:"Disabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_disabled",description:"An audit log that describes that exports were disabled for a team",values:{teamName:Ca(e)}}),Sa((null===(c=e.meta)||void 0===c?void 0:c.spaceExportDisabled)??(null==e?void 0:e.spaceExportDisabled),e.changes.enabled.newValue)):d.createElement(d.Fragment,null,a()(f.FormattedMessage,{defaultMessage:"Enabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_enabled",description:"An audit log that describes that exports were enabled for a team",values:{teamName:Ca(e)}}),Sa((null===(u=e.meta)||void 0===u?void 0:u.spaceExportDisabled)??(null==e?void 0:e.spaceExportDisabled),e.changes.enabled.newValue));case"team_sidebar_editing_toggled":return e.changes.enabled.newValue?a()(f.FormattedMessage,{defaultMessage:"Disabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_disabled",description:"An audit log that describes that changing the sidebar section was disabled for a team",values:{teamName:Ca(e)}}):a()(f.FormattedMessage,{defaultMessage:"Enabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_enabled",description:"An audit log that describes that changing the sidebar section was enabled for a team",values:{teamName:Ca(e)}});case"team_creation_admins_setting_toggled":return e.changes.enabled.newValue?a()(f.FormattedMessage,{defaultMessage:"Disabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_disabled",description:"An audit log that describes that the ability for everyone in the workspace to create a team was disabled",values:{teamName:Ca(e)}}):a()(f.FormattedMessage,{defaultMessage:"Enabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_enabled",description:"An audit log that describes that the ability for everyone in the workspace to create a team was enabled",values:{teamName:Ca(e)}});case"team_guests_toggled":return e.changes.enabled.newValue?d.createElement(d.Fragment,null,a()(f.FormattedMessage,{defaultMessage:"Disabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_disabled",description:"An audit log that describes that the ability for everyone in the workspace to create a team was disabled",values:{teamName:Ca(e)}}),Sa((null===(p=e.meta)||void 0===p?void 0:p.spaceDisableGuests)??e.spaceDisableGuests,e.changes.enabled.newValue)):d.createElement(d.Fragment,null,a()(f.FormattedMessage,{defaultMessage:"Enabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_enabled",description:"An audit log that describes that the ability for everyone in the workspace to create a team was enabled",values:{teamName:Ca(e)}}),Sa((null===(m=e.meta)||void 0===m?void 0:m.spaceDisableGuests)??e.spaceDisableGuests,e.changes.enabled.newValue));case"team_name_changed":return a()(f.FormattedMessage,{defaultMessage:"Changed teamspace name {oldTeamNameToNewTeamName}",id:"auditlog.actionNames.eventColumn.team_name_changed",description:"An audit log that describes that a team name was changed.",values:{oldTeamNameToNewTeamName:Ma(e)}});case"team_description_changed":return a()(f.FormattedMessage,{defaultMessage:"Changed description of {teamName}",id:"auditlog.actionNames.eventColumn.team_description_changed",description:"An audit log that describes that a team description was changed.",values:{teamName:Ca(e)}});case"team_icon_changed":return a()(f.FormattedMessage,{defaultMessage:"Changed icon of {teamName}",id:"auditlog.actionNames.eventColumn.team_icon_changed",description:"An audit log that describes that a team icon was changed.",values:{teamName:Ca(e)}});case"member_added_to_team":return a()(f.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_added_to_team",description:"An audit log that describes that a user was added to a team.",values:{memberNameAndEmail:fa(i,e),teamName:Ca(e),teamRole:Ta(e.changes.teamRole.newValue)}});case"group_added_to_team":return a()(f.FormattedMessage,{defaultMessage:"Invited {groupName} to {teamName} as teamspace member",id:"auditlog.actionNames.eventColumn.group_added_to_team",description:"An audit log that describes that a group was added to a teamspace.",values:{groupName:wa(e.target.group),teamName:Ca(e)}});case"member_removed_from_team":return a()(f.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {teamName}",id:"auditlog.actionNames.eventColumn.member_removed_from_team",description:"An audit log that describes that a user was removed from a team.",values:{memberNameAndEmail:fa(i,e),teamName:Ca(e)}});case"group_removed_from_team":return a()(f.FormattedMessage,{defaultMessage:"Removed {groupName} from {teamName}",id:"auditlog.actionNames.eventColumn.group_removed_from_team",description:"An audit log that describes that a group was removed from a team.",values:{groupName:wa(e.target.group),teamName:Ca(e)}});case"member_joined_team":const G=Ca(e),j=Ta(e.changes.teamRole.newValue);return Ha(e)?a()(f.FormattedMessage,{defaultMessage:"Joined {teamName} as {teamRole} using administrator privileges",id:"auditlog.actionNames.eventColumn.member_joined_team_privileged",description:"An audit log that describes that a user joined a team using administrator privileges. Examples of administrator privileges include joining any team as an owner, or joining a closed or private team without an invite.",values:{teamName:G,teamRole:j}}):a()(f.FormattedMessage,{defaultMessage:"Joined {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_joined_team",description:"An audit log that describes that a user joined a team.",values:{teamName:G,teamRole:j}});case"member_left_team":return a()(f.FormattedMessage,{defaultMessage:"Left {teamName}",id:"auditlog.actionNames.eventColumn.member_left_team",description:"An audit log that describes that a user left a team.",values:{teamName:Ca(e)}});case"member_team_role_updated":const Y=fa(i,e),Q=Ta(e.changes.teamRole.oldValue),X=Ta(e.changes.teamRole.newValue),J=Ca(e);return Ha(e)?a()(f.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldTeamRole} to {newTeamRole} in {teamName} using administrator privileges",id:"auditlog.actionNames.eventColumn.member_team_role_updated_privileged",description:"An audit log that describe a user's role in a team was updated.",values:{memberNameAndEmail:Y,oldTeamRole:Q,newTeamRole:X,teamName:J}}):a()(f.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldTeamRole} to {newTeamRole} in {teamName}",id:"auditlog.actionNames.eventColumn.member_team_role_updated",description:"An audit log that describe a user's role in a team was updated using administrator privileges. Examples of administrator privileges include an enterprise admin upgrading themselves to team owner.",values:{memberNameAndEmail:Y,oldTeamRole:Q,newTeamRole:X,teamName:J}});case"team_user_permission_updated":return a()(f.FormattedMessage,{defaultMessage:"Updated {userNameOrEmail}’s custom permissions in {teamName} from {oldPermission} to {newPermission}.",id:"auditlog.actionNames.eventColumn.team_user_permission_updated",description:"An audit log that describes the permission for a user in the teamspace was updated.",values:{userNameOrEmail:fa(i,e),oldPermission:_a(e.changes.permission.oldValue),newPermission:_a(e.changes.permission.newValue),teamName:Ca(e)}});case"team_group_permission_updated":return a()(f.FormattedMessage,{defaultMessage:"Updated {groupName}’s custom permissions in {teamName} from {oldPermission} to {newPermission}.",id:"auditlog.actionNames.eventColumn.team_group_permission_updated",description:"An audit log that describes the permission for a group in the teamspace was updated.",values:{groupName:wa(e.target.group),oldPermission:_a(e.changes.permission.oldValue),newPermission:_a(e.changes.permission.newValue),teamName:Ca(e)}});case"team_member_default_permission_updated":return a()(f.FormattedMessage,{defaultMessage:"Updated default page permissions for teamspace members in {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_member_default_permission_updated",description:"An audit log event that describes default page permissions for teamspace members in a teamspace were updated.",values:{teamName:Ca(e),oldRole:_a(null===(g=e.changes)||void 0===g||null===(h=g.permission)||void 0===h?void 0:h.oldValue),newRole:_a(null===(v=e.changes)||void 0===v||null===(y=v.permission)||void 0===y?void 0:y.newValue)}});case"team_guest_default_permission_updated":return a()(f.FormattedMessage,{defaultMessage:"Updated default page permissions for teamspace guests in {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_guest_default_permission_updated",description:"An audit log event that describes default page permissions for teamspace members in a teamspace were updated.",values:{teamName:Ca(e),oldRole:_a(null===(b=e.changes)||void 0===b||null===(S=b.permission)||void 0===S?void 0:S.oldValue),newRole:_a(null===(w=e.changes)||void 0===w||null===(M=w.permission)||void 0===M?void 0:M.newValue)}});case"team_workspace_default_permission_updated":return a()(f.FormattedMessage,{defaultMessage:"Updated default page permissions for everyone else in the workspace for {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_workspace_default_permission_updated",description:"An audit log event that describes that page permissions for a team were updated for the workspace.",values:{teamName:Ca(e),oldRole:_a(null===(C=e.changes)||void 0===C||null===(k=C.permission)||void 0===k?void 0:k.oldValue),newRole:_a(null===(_=e.changes)||void 0===_||null===(I=_.permission)||void 0===I?void 0:I.newValue)}});case"team_privacy_type_changed":return a()(f.FormattedMessage,{defaultMessage:"Changed the teamspace privacy type for {teamName} from {oldType} to {newType}",id:"auditlog.actionNames.eventColumn.team_privacy_type_changed",description:"An audit log event that describes that the privacy type for a teamspace was updated.",values:{teamName:Ca(e),oldType:La(null===(x=e.changes)||void 0===x?void 0:x.teamAccessLevel.oldValue),newType:La(null===(Z=e.changes)||void 0===Z?void 0:Z.teamAccessLevel.newValue)}});case"team_invite_access_changed":return a()(f.FormattedMessage,{defaultMessage:"Changed who can invite teamspace members to {newType} for {teamName}",id:"auditlog.actionNames.eventColumn.team_invite_access_changed",description:"An audit log event that describes that the privacy type for a teamspace was updated.",values:{teamName:Ca(e),newType:(O=null===(P=e.changes)||void 0===P||null===(F=P.teamInviteAccess)||void 0===F?void 0:F.newValue,O?d.createElement(f.FormattedMessage,Wa[O]):d.createElement(f.FormattedMessage,Wa.unknown))}});case"teams_enabled_for_space":return a()(f.FormattedMessage,{defaultMessage:"Enabled teamspaces for {workspaceName}",id:"auditlog.actionNames.eventColumn.teams_enabled_for_space",description:"An audit log that describes that teamspaces were enabled for the workspace.",values:{workspaceName:e.target.space.name}});case"private_content_transferred":return a()(f.FormattedMessage,{defaultMessage:"Transferred private content from {fromUserName} to {toUserName}",id:"auditLog.actionNames.eventColumn.private_content_transferred",description:"An audit log event describing when private page content is transferred from one user to another",values:{fromUserName:va(i,e.changes.userPermission.oldValue),toUserName:va(i,e.changes.userPermission.newValue)}});case"audit_log_exported":return a()(f.FormattedMessage,{id:"auditlogEventFilter.eventColumn.audit_log_exported",defaultMessage:"Exported audit log for last {duration} days",values:{duration:e.meta.duration},description:"Describes audit log event of exporting the audit log for a specific number of days in CSV format."});case"user_analytics_exported":return a()(f.FormattedMessage,{id:"auditlogEventFilter.eventColumn.user_analytics_exported",defaultMessage:"Exported user analytics for {daysFilterString}",values:{daysFilterString:i.formatMessage(ma.Rh[e.meta.daysFilter]).toLowerCase()},description:"Describes audit log event of exporting the user analytics tab for a specific days filter in CSV format."});case"content_analytics_exported":return a()(f.FormattedMessage,{id:"auditlogEventFilter.eventColumn.content_analytics_exported",defaultMessage:"Exported content analytics for {daysFilterString}",description:"Describes audit log event of exporting the user analytics tab for a specific days filter in CSV format.",values:{daysFilterString:i.formatMessage(ma.Rh[e.meta.daysFilter]).toLowerCase()}});case"admin_content_search_queried":function ee(e){return e.join(i.formatMessage(ha.adminContentSearchPredicateSplit))}function te(e){return"starting"in e&&"ending"in e?`${e.starting} - ${e.ending}`:"starting"in e?`${e.starting} - `:"ending"in e?` - ${e.ending}`:void 0}const ie=e.searchParameters.query&&i.formatMessage(ha.adminContentSearchQuery,{query:e.searchParameters.query}),ne=e.searchParameters.teamspaces&&e.searchParameters.teamspaces.length>0&&i.formatMessage(ha.adminContentSearchTeamspaces,{teamspaceCount:e.searchParameters.teamspaces.length,teamspaces:ee(e.searchParameters.teamspaces)}),ae=e.searchParameters.createdBy&&e.searchParameters.createdBy.length>0&&i.formatMessage(ha.adminContentSearchCreatedBy,{createdBy:ee(e.searchParameters.createdBy)}),oe=e.searchParameters.sharedWith&&e.searchParameters.sharedWith.length>0&&i.formatMessage(ha.adminContentSearchSharedWith,{sharedWith:ee(e.searchParameters.sharedWith)}),se=e.searchParameters.audience&&e.searchParameters.audience.length>0&&i.formatMessage(ha.adminContentSearchAudience,{audience:ee(e.searchParameters.audience)}),re=e.searchParameters.createdTime&&i.formatMessage(ha.adminContentSearchCreatedTime,{createdTime:te(e.searchParameters.createdTime)}),le=e.searchParameters.lastEditedTime&&i.formatMessage(ha.adminContentSearchLastEditedTime,{lastEditedTime:te(e.searchParameters.lastEditedTime)}),de=l().compact([ie,ne,ae,oe,se,re,le]);if(0===de.length)return a()(f.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_queried.no_filters",defaultMessage:"Ran a content search with no filters",description:"Describes an admin content search query with no filters being used."});{const e=ee(de);return a()(f.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_queried",defaultMessage:"Ran a content search with the following criteria: {searchCriteria}",values:{searchCriteria:e},description:"Describes an admin content search query with a specific set of filters."})}case"automation_created":return a()(f.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_created",defaultMessage:"Created {automationType} on {pageTitle}",values:{automationType:za(e.meta.automationType),pageTitle:Za(e)},description:"Created an automation (audit log)"});case"automation_edited":return a()(f.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_edited",defaultMessage:"Edited {automationType} on {pageTitle}",values:{automationType:za(e.meta.automationType),pageTitle:Za(e)},description:"Edited an automation (audit log)"});case"ai_admin_legal_acceptance_toggled":return a()(f.FormattedMessage,{defaultMessage:"{enabled} Notion AI for the workspace.",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled",description:"An audit log that describes that the membership requests setting was toggled.",values:{enabled:Ua(e)}});case"space_consolidation_started":case"space_consolidation_completed":case"space_consolidation_failed":const ce=e.spaceId===e.meta.spaceConsolidationMetadata.source_space_id,ue=e.meta.spaceConsolidationMetadata.source_space_name??e.meta.spaceConsolidationMetadata.source_space_id,pe=e.meta.spaceConsolidationMetadata.target_space_name??e.meta.spaceConsolidationMetadata.target_space_id,me=e.changes.spaceContentDuplicationStatus.newValue;return a()(f.FormattedMessage,{defaultMessage:"{status} workspace consolidation {direction} {spaceName}.",id:"auditlog.actionNames.eventColumn.space_consolidation_status_changed",description:"An audit log that describes that a workspace consolidation into or from this space started, completed or failed.",values:{status:me?d.createElement(f.FormattedMessage,ya[me]):"",spaceName:ce?pe:ue,direction:d.createElement(f.FormattedMessage,ce?ha.into:ha.from)}});case"mfa_sms_toggled":return a()(f.FormattedMessage,{defaultMessage:'{enabled} SMS MFA on "{value}"',id:"auditlog.actionNames.eventColumn.mfa_sms_toggled",description:"An audit log that describe a user toggled an SMS multi-factor authentication.",values:{value:null!==(A=e.changes)&&void 0!==A&&A.maskedPhoneNumber.oldValue?null===(B=e.changes)||void 0===B?void 0:B.maskedPhoneNumber.oldValue:null===(E=e.changes)||void 0===E?void 0:E.maskedPhoneNumber.newValue,enabled:null!==(D=e.changes)&&void 0!==D&&D.enabled.newValue?"Enabled":"Disabled"}});case"mfa_totp_toggled":return a()(f.FormattedMessage,{defaultMessage:"{enabled} TOTP MFA",id:"auditlog.actionNames.eventColumn.mfa_totp_toggled",description:"An audit log that describe a user toggled an TOTP multi-factor authentication",values:{enabled:null!==(R=e.changes)&&void 0!==R&&R.enabled.newValue?"Enabled":"Disabled"}});case"mfa_backup_code_toggled":return a()(f.FormattedMessage,{defaultMessage:"{enabled} backup codes for MFA",id:"auditlog.actionNames.eventColumn.mfa_backup_code_toggled",description:"An audit log that describe a user toggled backup code for multi-factor authentication",values:{enabled:null!==(L=e.changes)&&void 0!==L&&L.enabled.newValue?"Enabled":"Disabled"}});case"workspace_exported":case"workspace_icon_changed":case"public_page_cleared":case"logout":case"password_changed":case"password_cleared":case"password_set":case"revoked_support_access":case"user_deleted":case"member_joined":case"invite_link_toggled":case"scim_token_generated":case"scim_token_revoked":case"invite_link_reset":case"idp_metadata_xml_removed":case"idp_metadata_xml_updated":return d.createElement(f.FormattedMessage,ha[e.actionName]);default:if("local"!==t)return ca.log({level:"error",from:"auditLogEvent",type:"AuditLogEvent",data:{miscDataToConvertToString:{data:e}}}),d.createElement(d.Fragment,null);(0,T.t1)(e)}}function qa(e){window.__c={n:"getLocalizedFileName"};const{name:t,extension:i}=e.target.file;return t?`“${t}“`:i?d.createElement(f.FormattedMessage,s()({},ha.a_file_with_extension,{values:{extension:i}})):d.createElement(f.FormattedMessage,ha.a_file)}function Ha(e){return!!e.meta&&("inSudoMode"in e.meta&&e.meta.inSudoMode)}function Ga(e){window.__c={n:"AuditLogColumnEvent"};const{auditLogEntry:t,id:i}=e,[n,o]=(0,d.useState)(""),r=(0,f.useIntl)();return(0,d.useEffect)((()=>{const e=document.getElementById(i);o((null==e?void 0:e.textContent)||"")}),[i]),a()(Oe.Z,{style:{whiteSpace:"normal"},delayThreshold:80,renderTooltip:()=>a()($a,{text:n,auditLogEntry:t}),placement:Oe.Z.Placement.Bottom,render:e=>d.createElement("div",s()({},e,{style:{fontSize:14,...h.Z.textOverflowStyle},id:i}),a()(ja,{auditLogEntry:t,env:Qe.Z.env,intl:r}))})}function ja(e){const{auditLogEntry:t,env:i,intl:n}=e;return Ka(t,i,n)}function $a(e){var t,i;window.__c={n:"AuditLogEventTooltip"};const{auditLogEntry:n,text:o}=e,s=(0,f.useIntl)(),r=Gn({auditLogEntry:n,intl:s});return a()("div",{},void 0,o,(null===(t=n.actor.meta)||void 0===t?void 0:t.ipAddress)&&a()("div",{},void 0,a()(f.FormattedMessage,{description:"User's IP address in audit log",defaultMessage:"IP address: {ip}",values:{ip:null===(i=n.actor.meta)||void 0===i?void 0:i.ipAddress},id:"auditLogSettings.metadata.ipAddress"})),a()("div",{},void 0,qn(n,s)),r&&a()(f.FormattedMessage,{id:"auditLogColumnEvent.tooltip.audienceMessage",description:"Message in tooltip describing audience for permission change events",defaultMessage:"Page audience: {audience}",values:{audience:r}}))}function Ya(e){window.__c={n:"AuditLogPaginationButton"};const{children:t,disabled:i,onClick:n}=e;return a()($e.Z,{onClick:n,disabled:i,style:{justifyContent:"center",marginLeft:6},isBlue:!i,isLightGray:i},void 0,t)}const Qa={id:"actor",headerTitle:a()(f.FormattedMessage,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`;return a()(oa,{spaceStore:e.spaceStore,auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:30},sortable:!1},Xa={id:"event",headerTitle:a()(f.FormattedMessage,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),renderCell:e=>{const t=`event-${e.auditLogEntry.actionName}-${e.id}`;return a()(Ga,{auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:40},sortable:!1},Ja={id:"dateTimeAndMenu",headerTitle:a()(f.FormattedMessage,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`,i=`event-${e.auditLogEntry.actionName}-${e.id}`,n=`datetime-${e.auditLogEntry.actionName}-${e.id}`;return d.createElement(d.Fragment,null,a()(da,{auditLogEntry:e.auditLogEntry,id:n}),a()(io,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:t,eventColumnId:i,dateTimeColumnId:n}}))},widthData:{width:25},sortable:!0},eo=[Qa,Xa,Ja];function to(){return window.__c={n:"AuditLogEmptyTable"},a()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"}},void 0,a()("div",{},void 0,a()(xe.Z,{isSecondaryColor:!0,style:{fontWeight:500}},void 0,a()(f.FormattedMessage,{id:"auditlog.logTable.noResults",defaultMessage:"No results"}))),a()(xe.Z,{isSecondaryColor:!0},void 0,a()(f.FormattedMessage,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."})))}function io(e){window.__c={n:"AuditLogColumnMenu"};const{auditLogEntry:t,ids:i}=e,n=(0,Te.VK)((()=>(0,O.F$)()),[]),o=(0,f.useIntl)(),r=(0,ke.O7)(),l=(0,_e.Fg)(),c=(0,_e.yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:3}})),[]);return a()(Oe.Z,{delayThreshold:80,placement:Oe.Z.Placement.Bottom,render:e=>d.createElement("div",s()({style:c.container},e),a()(Mi.Z,{style:c.button,onClick:()=>{var e;Mt.RD({environment:r,stringValue:Hn({auditLogEntry:t,intl:o,getAuditLogEventText:(e=i.eventColumnId,t=>{var i;return null===(i=document.getElementById(e))||void 0===i?void 0:i.textContent}),isTeamGuestsEnabled:n}),copiedMessage:Mt.tq.copiedToClipboard})}},void 0,Ge.Z.copy({width:16,height:16,fill:l.mediumIconColor}))),renderTooltip:()=>a()(f.FormattedMessage,{id:"AuditLogSettings.copyAuditLogEvent",description:"Tooltip that shows up when you hover over the copy button for copying a row",defaultMessage:"Copy row"})})}const no=(0,f.injectIntl)((function(e){const{searchResponse:t,spaceStore:i}=e,[n,o]=(0,Te.AF)(J),s=t.results||[],r=t.hasMoreResults,l=Boolean(s.length),c=e=>{const t={...n,pageNum:e};o(t)},u=(0,_e.yK)((e=>(0,De.b)({columnRenderInfo:eo,theme:e,containerMarginTop:0})),[]),p=s.map(((e,t)=>({id:t.toString(),auditLogEntry:e,spaceStore:i,isClickable:!1}))),m=(0,d.useCallback)((()=>{const e=n.sortOrder===Y.CreatedOldest?Y.CreatedNewest:Y.CreatedOldest;o({...n,sortOrder:e,pageNum:1})}),[n,o]),g=(0,d.useMemo)((()=>({column:Ja,sortAscending:n.sortOrder===Y.CreatedOldest})),[n]);return d.createElement(d.Fragment,null,a()(De.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:eo,rows:p,sortState:g,onSortStateChanged:m,renderNoRowsComponent:to,styles:u}),l?a()("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10}},void 0,a()(Ya,{onClick:()=>{c(n.pageNum-1)},disabled:1===n.pageNum},void 0,a()(f.FormattedMessage,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})),a()(Ya,{disabled:!r,onClick:()=>{c(n.pageNum+1)}},void 0,a()(f.FormattedMessage,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"}))):null)}));const ao=(0,f.injectIntl)((function(e){const{spaceStore:t}=e,i=(0,ke.O7)(),n=null==t?void 0:t.id,[o]=(0,Te.AF)(ie),[s]=(0,Te.AF)(J),r=ee(s)!==o.filterStr?void 0:o.cachedResponses[s.pageNum];return(0,d.useEffect)((()=>{n&&(async e=>{var t,i;const{environment:n,spaceId:a}=e,o=J.getState();ie.startLoading(a,o);const{sortOrder:s,pageSize:r,pageNum:l}=o,d={spaceId:a,limit:r,cursor:ie.getCursor(a,o,l),filters:{timeRange:{starting:o.timeRange.starting?H.OQ.toUnixMs(o.timeRange.starting):void 0,ending:o.timeRange.ending?H.OQ.toUnixMs(o.timeRange.ending):void 0},...(null===(t=o.actors)||void 0===t?void 0:t.length)>0?{actors:o.actors}:void 0,...(null===(i=o.actions)||void 0===i?void 0:i.length)>0?{actions:o.actions}:void 0},sort:s||Y.CreatedNewest},c=await ge.searchAuditLog(n,d);"success"!==c.type?(ie.updateError(a,o),(0,vn.Jx)(c.body)?S.showErrorMessage(c.body.message):S.showErrorMessage(V.default.formatMessage(wn.loadCurrentAuditLogError))):ie.updateLoadedResult(a,o,c.data)})({environment:i,spaceId:n})}),[i,n,s]),(0,d.useEffect)((()=>{Cn({environment:i,spaceId:n})}),[i,n]),d.createElement(d.Fragment,null,a()(ea,{}),a()("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12}},void 0,a()(Jn,{spaceStore:t}),a()(Zn,{})),"loading"===(null==r?void 0:r.status)&&a()(na,{}),"success"===(null==r?void 0:r.status)&&a()(no,{searchResponse:r,spaceStore:t}))}));var oo=i(98692),so=i(76463),ro=i(761),lo=i(72087),co=i(74181),uo=i(9038),po=i(9953),mo=i(30874),go=i(38484),ho=i(8848),fo=i(9844),vo=i(5500),yo=i(77719),bo=i(74021),So=i(77137),wo=i(78948);function Mo(e){window.__c={n:"AdminIntegrationSettingsSearchResults"};const{query:t}=e,i=(0,ke.O7)(),n=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),o=(0,Te.VK)((()=>null==n?void 0:n.getBotSettingsStore().getValue()),[n]),r="approved_or_built_by_notion"===(null==o?void 0:o.integration_restrictions),l=(0,Te.VK)((()=>null!=o&&o.integration_approval_statuses?Object.keys(o.integration_approval_statuses):[]),[o]),c=(0,Te.VK)((()=>Object.values(vo.iK).map((e=>{let{id:t}=e;const i=null==n?void 0:n.getRecordValue({id:t,table:fo.K2});if("published"===(null==i?void 0:i.status))return t})).filter(T.$K)),[n]),u=(0,d.useMemo)((()=>c.some((e=>e===vo.iK.google_drive.id))),[c]),m=(0,Te.VK)((()=>c.filter((e=>!l.includes(e))).slice(0,5)),[l,c]);return a()(at.Z,{menuType:Je.og.Popup,width:255,header:To(t,m,r)},void 0,a()(So.Z,{request:t,performRequest:e=>async function(e){const{query:t,integrationType:i,environment:n,spaceId:a,approvedIntegrationIds:o,popularIntegrationIds:s,autoApproveBuiltByNotion:r}=e;if(!Ie.Z.state.online||!a)return[];if((0,p.e)(t)||(0,p.qn)(t))return[t];if(""===t&&!r)return s;const l=await ge.searchIntegrations(n,{query:t,type:i});if("success"===l.type){const e=l.data.integrationIds.filter((e=>!o.includes(e))),t=Qe.Z.env;if(!r){return e.sort(((e,i)=>(0,vo.BP)({integrationId:e,env:t})===(0,vo.BP)({integrationId:i,env:t})?0:(0,vo.BP)({integrationId:e,env:t})?-1:1)).slice(0,5)}return e.filter((e=>!(0,vo.BP)({integrationId:e,env:t}))).slice(0,5)}if("failed"===l.type)throw l.error;return(0,T.t1)(l)}({query:e,environment:i,spaceId:null==n?void 0:n.id,approvedIntegrationIds:l,popularIntegrationIds:m,autoApproveBuiltByNotion:r}),debounce:yn.vp,render:(r,c,p)=>{if(!c||!p)return a()(rt.Z,{},void 0,a()(wo.Z,{}));const m=co.ns.filter((e=>t&&e.name.toLowerCase().includes(t.toLowerCase())&&!l.includes(e.id)&&(e.id!==co._o||!u))),g=[];if(0===c.length&&0===m.length)g.push({key:"no_results",render:()=>a()(xe.Z,{isSmall:!0,style:{marginLeft:8}},void 0,a()(f.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})),action:()=>{}});else{const t=c.map((t=>{var r;const l={table:fo.K2,id:t};if(!n)return;const c=ze.y2.createChildStore(n,l),u=null===(r=c.getInfo())||void 0===r?void 0:r.icon;return{key:`${t}`,render:e=>{var t;return d.createElement(it.Z,s()({},e,{title:a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.semibold}},void 0,c.getName()),icon:u&&a()(Ke.Z,{disabled:!0,icon:{pointer:l,icon:u},isEmptyPage:!1,size:20}),style:u?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:a()(_o,{tagline:null===(t=c.getInfo())||void 0===t?void 0:t.tagline,isNotionIntegration:(0,vo.BP)({integrationId:c.id,env:Qe.Z.env})}),className:"notranslate"}))},action:()=>{e.closeDropdown(),ko({environment:i,currentSpaceStore:n,botSettings:o,integrationId:t})}}})).filter(T.$K),r=m.map((t=>({key:`${t.id}`,render:e=>d.createElement(it.Z,s()({},e,{title:a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.semibold}},void 0,t.name),icon:a()("img",{src:t.info.icon,style:{height:20}}),caption:t.info.tagline,style:{paddingBottom:12},shouldWrapCaption:!0,className:"notranslate"})),action:()=>{e.closeDropdown(),ko({environment:i,currentSpaceStore:n,botSettings:o,integrationId:t.id})}}))).filter(T.$K);g.push(...t,...r)}return a()(ot.Z,{type:ot.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>d.createElement(rt.Z,e),items:g}]})}}))}function Co(e){window.__c={n:"AdminComplianceIntegrationSettingsSearchResults"};const{query:t}=e,i=(0,ke.O7)(),n=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]);return n?a()(at.Z,{menuType:Je.og.Popup,width:255,header:To(t,[],!1)},void 0,a()(So.Z,{request:t,performRequest:e=>async function(e){const{query:t,environment:i,spaceId:n}=e;if(!Ie.Z.state.online||!n)return[];if((0,p.e)(t)||(0,p.qn)(t))return[t];const a=await ge.searchIntegrations(i,{query:t,type:"compliance"});if("success"===a.type)return a.data.integrationIds;if("failed"===a.type)throw a.error;return(0,T.t1)(a)}({query:e,environment:i,spaceId:null==n?void 0:n.id}),debounce:yn.vp,render:(t,o,r)=>{if(!o||!r)return a()(rt.Z,{},void 0,a()(wo.Z,{}));const l=[];if(0===o.length)l.push({key:"no_results",render:()=>a()(xe.Z,{isSmall:!0,style:{marginLeft:8}},void 0,a()(f.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})),action:()=>{}});else{const t=mo.Z.state.loaded?mo.Z.state.webhookSubscriptions.map((e=>{var t;return null===(t=mo.Z.getBotsAsRecordMap().getValue({table:At.cZ,id:e.bot_id}))||void 0===t?void 0:t.integration_id})):[],r=o.map((o=>{var r;const l=ze.y2.createChildStore(n,{id:o,table:fo.K2});if(t.includes(o))return;const c={table:fo.K2,id:o},u=ze.y2.createChildStore(n,c),p=(0,uo.RW)(u.id),m=null===(r=u.getInfo())||void 0===r?void 0:r.icon;return{key:`${o}`,render:e=>{var t;return d.createElement(it.Z,s()({},e,{title:a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.semibold}},void 0,u.getName()),icon:m&&a()(Ke.Z,{disabled:!0,icon:{pointer:c,icon:m},isEmptyPage:!1,size:20}),style:m?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:a()(_o,{tagline:(null===(t=u.getInfo())||void 0===t?void 0:t.tagline)||"A SIEM or DLP partner",isNotionIntegration:!1}),className:"notranslate"}))},action:async()=>{var t;e.closeDropdown();const a=l.getModel();a&&null!=p&&null!==(t=p.info.oauth)&&void 0!==t&&t.accountInfoPropertyNames?await yo.Bb({environment:i,integration:a,spaceId:n.id,from:"compliance_connected_apps_settings"}):bo.Z.setState({open:!0,integrationId:u.id})}}})).filter(T.$K);l.push(...r)}return a()(ot.Z,{type:ot.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>d.createElement(rt.Z,e),items:l}]})}})):null}function ko(e){const{environment:t,currentSpaceStore:i,botSettings:n,integrationId:a}=e;if(i&&!(0,uo.DB)(a)){const e={...null==n?void 0:n.integration_approval_statuses,[a]:{type:"integration",status:"approved"}};B.createAndCommit({userAction:"AdminIntegrationSettingsSearchResults.handleIntegrationSelection",environment:t,perform:t=>{po.sW({store:i,data:{bot_settings:{...n,integration_approval_statuses:e}},transaction:t})}})}}const To=(e,t,i)=>!e&&!i&&t.length>0&&a()(Et.Z,{title:a()(xe.Z,{isSmall:!0,style:{marginTop:4,fontWeight:h.Z.fontWeight.medium}},void 0,a()(f.FormattedMessage,{defaultMessage:"Popular integrations",id:"adminIntegrationSettings.search.title.popularIntegrations"}))}),_o=e=>{window.__c={n:"IntegrationCaption"};const{tagline:t,isNotionIntegration:i}=e,n=(0,_e.Fg)(),o=i?{}:{maxHeight:48,overflow:"scroll"};return t?a()("div",{style:o},void 0,t,i&&a()("div",{style:{display:"flex",alignItems:"center",marginTop:8}},void 0,a()(f.FormattedMessage,{defaultMessage:"Developed by Notion",id:"adminIntegrationSettings.search.subtitle.notionBuilt"}),Ge.Z.integrationSecurity({marginLeft:3,width:12,height:12,fill:n.invoiceGreen}))):null},Io=(0,f.defineMessages)({searchInputPlaceholder:{id:"adminConnectionsSettings.search.input.placeholder",defaultMessage:"Add by name or integration ID",description:"Placeholder text for 'Add approved connection' search bar"}});function xo(){const e=(0,ke.O7)(),t=(0,_e.Fg)(),[i,n]=(0,d.useState)(!0),[o,s]=(0,d.useState)(!1),[r,l]=(0,d.useState)(""),c=d.createRef();return i?a()(Mi.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:h.Z.fontWeight.medium,fontSize:h.Z.fontSize.UIRegular.desktop,color:ho.ZP.blue,padding:"0px 6px"},onClick:()=>{n(!1)}},void 0,a()(f.FormattedMessage,{id:"adminConnectionsSettings.search.button.label",defaultMessage:"{plusIcon} Add approved connection",description:"Text for button to open dropdown menu for selecting and adding a new connection to the approved list",values:{plusIcon:Ge.Z.plus({fill:ho.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})):a()(st.ZP,{alignmentToOrigin:st.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=c.current)||void 0===e||e.handleBlur(),n(!0),s(!1)},origin:d.createElement(Li.Z,{type:"text",style:{width:255},left:Ge.Z.plus({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),ref:c,value:r,onFocus:()=>{s(!0)},placeholder:V.default.formatMessage(Io.searchInputPlaceholder),onChange:e=>l(e.target.value)}),open:o,popupType:st.ZP.PopupType.Popup,style:{width:255},render:()=>a()(Mo,{query:r,closeDropdown:()=>s(!1)})})}function Zo(){const e=(0,ke.O7)(),t=(0,_e.Fg)(),[i,n]=(0,d.useState)(!0),[o,s]=(0,d.useState)(!1),[r,l]=(0,d.useState)(""),c=d.createRef();return i?a()(Mi.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:h.Z.fontWeight.medium,fontSize:h.Z.fontSize.UIRegular.desktop,color:ho.ZP.blue,padding:"0px 6px"},onClick:()=>{var e;n(!1),null===(e=c.current)||void 0===e||e.focusInput()}},void 0,a()(f.FormattedMessage,{id:"adminConnectionsSettingsAddComplianceMenu.search.button.label",defaultMessage:"{plusIcon} Add connection",description:"Text for button to open dropdown menu for selecting and adding a new compliance connection",values:{plusIcon:Ge.Z.plus({fill:ho.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})):a()(st.ZP,{alignmentToOrigin:st.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=c.current)||void 0===e||e.handleBlur(),n(!0),s(!1)},origin:d.createElement(Li.Z,{type:"text",style:{width:255},left:Ge.Z.plus({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),focus:!0,ref:c,value:r,onFocus:()=>{s(!0)},placeholder:V.default.formatMessage(Io.searchInputPlaceholder),onChange:e=>l(e.target.value)}),open:o,popupType:st.ZP.PopupType.Popup,style:{width:255},render:()=>a()(Co,{query:r,closeDropdown:()=>{n(!0),s(!1)}})})}var Po=i(23999),Fo=i(61519),Ao=i(42402),Bo=i(55422),Eo=i(66957);const Do=["member_connections","workspace_connections"];function Ro(e){const t=(0,ke.O7)(),{isMobile:i}=t.device,{externalBotIds:n,guestBotIds:o}=e,s=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),r=(0,Te.VK)((()=>mo.Z.webhookSubscriptions.state.reduce(((e,t)=>{const i=t.bot_id;return i&&(e[i]=t),e}),{})),[]),l=(0,Te.VK)((()=>(0,q.wP)()&&N.default.checkGate("webhook_registration")),[]),c=(0,Te.VK)((()=>s?[...o,...n].map((e=>{const t=ze.Qx.createChildStore(s,{table:At.cZ,id:e,spaceId:s.id});return t.getAlive()?t:void 0})).filter(T.$K):[]),[s,o,n]),u=(0,Te.VK)((()=>function(e){return e.reduce(((e,t)=>{const i=t.getIntegrationId();if(!i)return e;return(0,uo.oh)(i)?(i in e.compliance||(e.compliance[i]=[]),e.compliance[i].push(t.id)):(i in e.nonCompliance||(e.nonCompliance[i]=[]),e.nonCompliance[i].push(t.id)),e}),{compliance:{},nonCompliance:{}})}(c)),[c]),p=(0,Te.VK)((()=>function(e){return e.filter((e=>!e.getIntegrationId())).map((e=>e.id))}(c)),[c]),m=(0,Te.VK)((()=>function(e,t){if(!t)return{};return e.reduce(((e,i)=>{const n=go.U.createChildStore(t,{table:Kt.KJ,id:i.getCreatedById()}),a=i.getIntegrationId();return a?e[a]=a in e?[...e[a],n]:[n]:e[i.id]=[n],e}),{})}(c,s)),[c,s]),g=(0,Te.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]),v=Object.keys(u.nonCompliance).length+p.length,y=(0,Te.VK)((()=>null!=g&&g.integration_approval_statuses?Object.keys(g.integration_approval_statuses).length+p.length:p.length),[g,p]),b={member_connections:a()(f.FormattedMessage,{id:"admin.connections.tabs.member_connections",defaultMessage:"Member Connections",description:"Member Connections tab title"}),workspace_connections:a()(f.FormattedMessage,{id:"admin.connections.tabs.workspace_connections",defaultMessage:"Workspace Connections",description:"Workspace Connections tab title"})},S=Do.map((e=>b[e])),w=(0,Te.VK)((()=>"integrations"===be.Z.state.currentTab?be.Z.state.defaultSubtab:void 0),[]),[M,C]=(0,d.useState)(w||"member_connections"),k={member_connections:()=>d.createElement(d.Fragment,null,a()(Lo,{}),(null==g?void 0:g.integration_restrictions)&&a()("div",{style:{marginTop:"19px"}},void 0,a()(Oo,{})),a()(Fo.Z,{size:i?32:18,isHidden:!i}),Boolean(null==g?void 0:g.integration_restrictions)?a()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19}},void 0,a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28}},void 0,a()(f.FormattedMessage,{id:"adminConnectionsSettings.table.allowIntegrations.title",defaultMessage:"Approved connections{numberOfIntegrations}",description:"Title for table that displays admin-approved workspace connections",values:{numberOfIntegrations:0!==y&&a()(xe.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,y)}})),a()(xo,{})):a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.medium,display:"flex",height:28,alignItems:"center",marginBottom:"19px"}},void 0,a()(f.FormattedMessage,{id:"adminConnectionsSettings.table.default.title",defaultMessage:"All connections{numberOfIntegrations}",description:"Title for table that shows all connections installed on workspace",values:{numberOfIntegrations:0!==v&&a()(xe.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,v+co.T2.length)}})),a()(Po.ZP,{integrationIdToBotIds:u.nonCompliance,internalIntegrationIds:p,integrationIdToUsers:m})),workspace_connections:()=>d.createElement(d.Fragment,null,l?d.createElement(d.Fragment,null,a()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19,marginTop:20}},void 0,a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28}},void 0,a()(f.FormattedMessage,{id:"adminConnectionsSettings.table.securityAndCompliance.title",defaultMessage:"Security & compliance",description:"Title for table that displays security and compliance workspace connections",values:{numberOfIntegrations:0!==y&&a()(xe.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,y)}})),a()(Zo,{})),a()(Po.cP,{botIdToWebhookSubscription:r})):null)},_=e=>k[e];return l?d.createElement(d.Fragment,null,a()(Eo.Z,{tabs:S,selectedIndex:Do.findIndex((e=>e===M)),onChange:e=>(e=>{C(Do[e])})(e),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),_(M)()):_("member_connections")()}const Lo=()=>{window.__c={n:"RequireApprovalDropdown"};const e=(0,ke.O7)(),t=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),{isMobile:i}=e.device,n=(0,Te.VK)((()=>(0,q.wP)()),[]),o=(0,Te.VK)((()=>null==t?void 0:t.getBotSettingsStore().getValue()),[t]);return a()(Bo.Z,{isMobile:i,title:a()(f.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.title",defaultMessage:"Restrict members from adding connections",description:"Section header for restriction settings related to user-installed workspace connections"}),caption:(0,m.CJ)(o)?a()(f.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.allowList.workspaceOwner.caption",defaultMessage:"Workspace members can only install connections pre-approved by workspace owners.",description:"Caption for menu option that restricts member-installed connections to those on workspace owners put on allow list"}):a()(f.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.off.caption",defaultMessage:"Workspace members can install any new connection.",description:"Caption for restriction settings related to user-installed workspace connections"}),upsellOptions:{shouldUpsell:!n,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"dropdown",currentOption:(0,m.CJ)(o)?"allow_list":"any_integrations",options:[{key:"any_integrations",label:a()(f.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.title",defaultMessage:"No restrictions",description:"Title for menu option in workspace connections settings that removes member restrictions on installing connections"}),caption:a()(f.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.off.caption",defaultMessage:"Workspace members can install any connection.",description:"Caption for menu option in workspace connections settings that removes member restrictions on installing connections"})},{key:"allow_list",label:a()(f.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.allowList.title",defaultMessage:"Only from approved list",description:"Title for menu option in workspace connections settings for restricting which connections users may install"}),caption:a()(f.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.allowList.caption",defaultMessage:"Workspace members can only install connections pre-approved by an admin.",description:"Caption in workspace connections settings for restricting which connections users may install"})}],onSelectOption:i=>{!function(e){const{environment:t,currentSpaceStore:i,botSettings:n,setting:a}=e;if(i){if("allow_list"===a&&(0,m.CJ)(n))return;const e="allow_list"===a?"approved_only":void 0;B.createAndCommit({userAction:"AdminIntegrationSettings.handleIntegrationRestrictionSelect",environment:t,perform:t=>{po.sW({store:i,data:{bot_settings:{...n,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:t,botSettings:o,setting:i})},info:[{key:"learn_more",label:a()(f.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.info.title",defaultMessage:"Admins can always install and approve new connections.",description:"Information about admin permissions for workspace connections"})}]})};const Oo=()=>{window.__c={n:"AutoApproveBuiltByNotionToggle"};const e=(0,ke.O7)(),t=(0,_e.Fg)(),i=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),{isMobile:n}=e.device,o=(0,Te.VK)((()=>(0,q.wP)()),[]),s=(0,Te.VK)((()=>null==i?void 0:i.getBotSettingsStore().getValue()),[i]);return a()(Bo.Z,{isMobile:n,title:a()(f.FormattedMessage,{id:"adminConnectionsSettings.autoApproveBuiltByNotion.title",description:"This message is for the option to auto approve connections that are built by Notion.",defaultMessage:"Auto-approve <builtbynotion>Built by Notion</builtbynotion> connections",values:{builtbynotion:e=>a()("span",{style:{color:t.invoiceGreen}},void 0,Ge.Z.integrationSecurity({width:14,display:"inline",verticalAlign:"text-bottom",marginRight:2}),e)}}),caption:a()(f.FormattedMessage,{defaultMessage:"Toggle this on to approve all workspace members to install connections <helpcenterlink>built by Notion</helpcenterlink>.",id:"adminConnectionsSettings.autoApproveBuiltByNotion.caption",description:"Caption for toggle UI in workspace connections settings",values:{helpcenterlink:e=>a()(Ao.Z,{href:(0,W.UY)("guides.enterpriseIntegrationSettings")},void 0,e)}}),upsellOptions:{shouldUpsell:!o,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"toggle",isOn:"approved_or_built_by_notion"===(null==s?void 0:s.integration_restrictions),onToggle:()=>function(e){const{environment:t,currentSpaceStore:i,botSettings:n}=e;if(i){const e="approved_or_built_by_notion"===(null==n?void 0:n.integration_restrictions)?"approved_only":"approved_or_built_by_notion";B.createAndCommit({userAction:"AdminIntegrationSettings.handleAutoApproveBuiltByNotionToggle",environment:t,perform:t=>{po.sW({store:i,data:{bot_settings:{...n,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:i,botSettings:s})})};var No=i(70578),Vo=i(59649),Uo=i(39111),Wo=i(79826),zo=i(40235);function Ko(e){const{botIds:t}=e,i=(0,f.useIntl)(),n=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),o=(0,_e.Fg)(),s=(0,Te.VK)((()=>n?t.map((e=>function(e,t){const{currentSpaceStore:i}=I.default.state;if(!e.isDefined()||!e.getAlive()||!i||!e.canAdmin()&&!i.canAdmin())return;const n=null==i?void 0:i.getRecordValue({table:Kt.KJ,id:e.getCreatedById()}),o=(0,qt.Nz)(t,n),s=(0,Vn.Yx)(e.getCreatedAt(),"medium_with_time",ra.SP),r=!e.getIntegrationId();return{key:e.id,columns:[a()("div",{style:{maxWidth:300,display:"flex"}},void 0,a()(Uo.Z,{botStore:e,avatarSize:24,style:{marginRight:6}}),r&&a()(Fn.Z,{},void 0,a()(f.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.row.internalIntegrationLabel",defaultMessage:"Internal",description:"This label indicates that an integration is internal, as opposed to public."}))),a()(f.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.creationInfoColumn.contents",defaultMessage:"{installerName} on {installedTime}",values:{installerName:o,installedTime:s},description:"Text describing who added an integration to a workspace and when. For example: 'Johnny Appleseed on May 13, 2021'"}),a()(Wo.Z,{botId:e.id})]}}(ze.t1.createChildStore(n,{table:At.cZ,id:e,spaceId:n.id}),i))).filter(T.$K):[]),[n,t,i]);return d.createElement(d.Fragment,null,a()("div",{style:{marginBottom:"19px",display:"flex",alignItems:"center"}},void 0,a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.medium}},void 0,a()(f.FormattedMessage,{id:"memberIntegrationSettings.table.default.title",defaultMessage:"All integrations",description:"Title for the member view of the integrations table"})),a()(xe.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,s.length)),a()(zo.Z,{columns:[{key:"integration",header:a()(f.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.integrationColumn.title",defaultMessage:"Integration"}),style:{width:"40%"}},{key:"added_by",header:a()(f.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.creationInfoColumnMember.title",defaultMessage:"Added by",description:"Title for integrations table added by column for member view"})},{key:"more",header:void 0}],rows:s}),0===s.length?a()("div",{style:{height:120,width:"100%",fontSize:12,color:o.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:`1px solid ${o.lightDividerColor}`}},void 0,a()(f.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.emptyMessage",defaultMessage:"No integration installed"})):void 0)}class qo extends c.Z{constructor(){super(...arguments),this.storeTypes={requestStore:lo.Z},this.renderResult=(e,t,i)=>{const{currentSpaceStore:n}=I.default.state;if(n)return a()(Vo.Z,{loaded:i,spinnerSize:16,showSpinnerTimeout:600},void 0,e&&a()("div",{},void 0,a()(f.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})),t&&(n.canAdmin()?d.createElement(Ro,t):a()(Ko,{botIds:t.guestBotIds})),a()("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4}},void 0,a()(No.Z,{})))},this.fetchBotsInSpace=async e=>{let{spaceId:t}=e;const i=await Promise.all([so.Yw({environment:this.environment,table:pa.bx,id:t,type:"guest"}),so.Yw({environment:this.environment,table:pa.bx,id:t,type:"external"}),ro.pJ({environment:this.environment})]);return{guestBotIds:i[0].botIds,externalBotIds:i[1].botIds}}}renderComponent(){const{device:e}=this.environment;return a()(Ze.Z,{},void 0,a()(Pe.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",style:{paddingBottom:12}},void 0,a()(f.FormattedMessage,{id:"spaceConnectionsSettings.title",defaultMessage:"Connections",description:"Page title for workspace connections settings tab"})),this.renderRequest())}renderRequest(){const{spaceStore:e,userStore:t}=this.props;return a()(So.Z,{requestStore:this.stores.requestStore,request:{spaceId:e.id,userId:t.id},performRequest:this.fetchBotsInSpace,render:this.renderResult})}}qo.displayName="IntegrationSettings";const Ho=(0,f.injectIntl)(qo);var Go=i(36488),jo=i(56940),$o=i(22346),Yo=i(58047);function Qo(e){window.__c={n:"EnterpriseSettingsPrompt"};const t=(0,ke.O7)(),{onView:i}=e;return(0,d.useEffect)((()=>{const{currentSpaceStore:e}=I.default.state;"enterprise"===(null==e?void 0:e.getSubscriptionTier())&&i(t)}),[t,i]),a()("div",{},void 0,a()(Fo.Z,{size:0}),a()(Yo.N,{icon:Ge.Z.magnifyingGlass({width:20}),title:e.title,description:e.descriptionMessage,onDismiss:e.onDismiss,primaryAction:{text:e.buttonText,onClick:t=>(e.onDismiss(),e.onClick(t))},secondaryAction:{icon:e=>Ge.Z.help(e),text:a()(f.FormattedMessage,{id:"enterpriseSettingsPrompt.learnMore.button",defaultMessage:"Learn more",description:"Button shown in an enterprise setting prompt that links to the help center."}),onClick:e.onClickLearnMore}}))}var Xo=i(79603),Jo=i(53770);const es=[50,100,200,500,1e3];function ts(e){let{spaceStore:t,samlConfigStore:i,memberCountFilter:n,isPrimarySpace:a}=e;const o=(0,ke.O7)(),s=(0,Te.VK)((()=>i.state.emailDomains),[i]),[r,l]=(0,d.useState)({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),c=(0,Te.VK)((()=>(0,q.wP)()),[]),u=(0,d.useCallback)((async e=>{if(c&&0!==s.length&&a&&r.nextEarliestCreatedAt&&!r.loading&&!(e&&r.numPagesLoaded>0||r.error)){l((e=>({...e,loading:!0})));try{const{spaces:e,earliestCreatedAt:i,hasMoreSpaces:a}=await(0,Jo.XD)({fn:async()=>await async function(e,t,i,n,a){const o=await ge.getSpacesCreatedByUserWithDomains(e,{spaceId:t,emailDomains:i,spacesLimit:10,memberCountFilter:a,spaceCreatedTimeUpperBound:n});if("failed"===o.type)throw o.error;return{spaces:o.data.results.map((e=>({id:e.id,name:e.spaceName,icon:e.spaceIcon,createdAt:e.spaceCreatedTime,memberCount:e.memberCount,subscriptionTier:e.subscriptionTier,creatorEmailDomain:e.spaceCreatedByDomain,creator:e.spaceCreator,admins:e.admins,spaceRequest:e.spaceRequest,isDelinquent:e.isDelinquent,isPendingBilling:e.isPendingBilling,isActorInSpace:e.isActorInSpace}))),earliestCreatedAt:o.data.hasMoreSpaces?o.data.earliestCreatedAt:void 0,hasMoreSpaces:o.data.hasMoreSpaces}}(o,t.id,s,r.nextEarliestCreatedAt?r.nextEarliestCreatedAt-1:Date.now(),n),handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:es,retryAttemptRandomOffsetMS:50,initialInput:void 0});l((t=>{const n=[...t.spaces],o=new Set(t.spaces.map((e=>e.id)));for(const i of e)o.has(i.id)||n.push(i);return{spaces:n,nextEarliestCreatedAt:i,numPagesLoaded:t.numPagesLoaded+1,hasNextPage:a,loading:!1,error:void 0}}))}catch(i){const e=(0,rn.tg)(i);l((t=>({...t,loading:!1,error:e})))}}}),[o,c,n,a,t,s,r.nextEarliestCreatedAt,r.numPagesLoaded,r.loading,r.error]);const p=(0,d.useCallback)((async()=>{await u(!1)}),[u]),m=(0,d.useCallback)((async()=>{await u(!0)}),[u]),g=(0,d.useCallback)((async()=>{l({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),await u(!0)}),[u]);return{claimableSpaces:r.spaces,loading:r.loading,error:r.error,hasNextPage:r.hasNextPage,loadFirstPage:m,loadNextPage:p,resetFirstPage:g,setSpaceRequest:function(e,t){l((i=>{const n=i.spaces.map((i=>i.id===e?{...i,spaceRequest:t}:i));return{...i,spaces:n}}))},removeClaimableSpace:function(e){l((t=>{const i=t.spaces.filter((t=>t.id!==e));return{...t,spaces:i}}))}}}var is=i(59054);async function ns(e){const{environment:t,spaceId:i,store:n}=e;if(!(0,q.Rs)())return n.reset(),{};const a=await ge.getSamlConfigForSpace(t,{spaceId:i});if("failed"===a.type)S.showError(a);else if(a.data&&a.data.samlConfig){const e={...a.data.samlConfig,useMetadataUrl:!Boolean(a.data.samlConfig.idpMetadata)};return n.setState(e),a.data}return n.reset(),{}}const as="settings-page",os="workspaces-page",ss="managed-users-page";let rs;!function(e){e[e.Single=0]="Single",e[e.Multi=1]="Multi"}(rs||(rs={}));const ls=(0,d.createContext)(null),ds=e=>{let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n,children:o}=e;window.__c={n:"PageProvider"};const s=(0,ke.O7)(),[r,l]=(0,d.useState)(as),[c,u]=(0,d.useState)(rs.Single),p=(0,Te.VK)((()=>i.state.emailDomains),[i]),m=(0,Te.VK)((()=>Boolean(i.state.id)&&i.state.id===t.id),[i,t]),{loading:g,error:h,loaded:f}=function(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n}=e;const a=(0,ke.O7)(),[{status:o,error:s}]=(0,is.r5)((async()=>{var e;const o=await ns({environment:a,spaceId:t.id,store:i});if((0,vn.Zw)(o))return o;const s=null===(e=o.samlConfig)||void 0===e?void 0:e.id;return s?{samlResponse:o,domainResponse:await n.updateValueForSpace({environment:a,spaceId:s,store:n})}:{samlResponse:o,domainResponse:void 0}}),[a,i,t,n]);return{loading:"pending"===o,loaded:"resolved"===o,error:s}}({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),{loading:v,error:y,claimableSpaces:S,setSpaceRequest:w,removeClaimableSpace:M,hasNextPage:C,loadNextPage:k,loadFirstPage:T,resetFirstPage:_}=ts({spaceStore:t,samlConfigStore:i,isPrimarySpace:m,memberCountFilter:"single"}),{loading:I,error:x,claimableSpaces:Z,setSpaceRequest:P,removeClaimableSpace:F,hasNextPage:A,loadNextPage:B,loadFirstPage:E,resetFirstPage:D}=ts({spaceStore:t,samlConfigStore:i,isPrimarySpace:m,memberCountFilter:"multi"}),R=S.length+Z.length>0,[L,O,N,V,U,W,z,K]=c===rs.Single?[v,y,S,w,M,C,k,T,_]:[I,x,Z,P,F,A,B,E,D],{loading:q,error:H,domainVerifications:G}=function(e){let{spaceStore:t}=e;const i=(0,ke.O7)(),[n,a]=(0,d.useState)([]),[{status:o,error:s}]=(0,is.r5)((async()=>{const e=await ge.getDomainVerificationCodesForSpace(i,{spaceId:t.id,verifiedOnly:!0});"success"===e.type?a(e.data.domainVerifications):a([])}),[i,t]);return{loading:"pending"===o,domainVerifications:"resolved"===o?n:[],error:s}}({spaceStore:t,emailDomains:p});(0,d.useEffect)((()=>{T(),E()}),[N,T,E]);const j={page:r,navigateTo:function(e){l(e),0===S.length&&Z.length>0&&u(rs.Multi),"workspaces-page"===e&&b.Cez(s,{verifiedDomains:p,tab:c===rs.Single?"single":"multi"})},loadingSaml:g,loadingSpaces:L,loadingVerifications:q,errorSaml:h,errorClaimableSpaces:O,errorVerifications:H,loadedSaml:f,domainVerifications:G,hasBrowsableSpaces:R,claimableSpaces:N,setSpaceRequest:V,removeClaimableSpace:U,resetInitialClaimableSpaces:K,hasMoreClaimableSpaces:W,loadMoreClaimableSpaces:z,tab:c,setSelectedTab:function(e){u(e),"workspaces-page"===r&&b.Cez(s,{verifiedDomains:p,tab:e===rs.Single?"single":"multi"})},verifiedDomains:p};return a()(ls.Provider,{value:j},void 0,o)};var cs=i(81236);const us={managedUsers:[],filters:{query:"",multiFactorStatus:void 0,workspaceId:void 0},numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0};function ps(e){let{lastActiveAt:t}=e;window.__c={n:"LastActiveDate"};const i=(0,_e.yK)((e=>({container:{opacity:.5}})),[]);return a()("div",{style:i.container},void 0,t?a()(Ve,{dateTs:t}):a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.unknown",defaultMessage:"No activity",description:"Indicates that this user has no latest activity data to show the workspace owner."})))}const ms={defaultMessage:"External workspace",id:"managedUsers.externalWorkspaceName",description:"A generic name to replace the real name of an external workspace."};function gs(e){return e.formatMessage(ms)}function hs(e){let{workspace:t}=e;window.__c={n:"WorkspaceSummaryName"};const i=(0,f.useIntl)(),n=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"}})),[]);return a()("div",{style:n.container},void 0,t.name??gs(i),t.isExternal?a()(fs,{}):null)}function fs(){window.__c={n:"ExternalWorkspaceInfoIcon"};const e=(0,_e.yK)((e=>({icon:{marginLeft:4,height:14,width:14,opacity:.5}})),[]);return a()(Oe.Z,{render:t=>d.createElement("div",t,Ge.Z.info(e.icon)),renderTooltip:()=>a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.userAccess.externalSpaceNameTooltipText",defaultMessage:"This is an external workspace that does not belong to this user.",description:"A tooltip message explaining that this workspace does not belong to the user so we cannot show its full name."})})}function vs(e){let{workspaceSummaries:t}=e;window.__c={n:"UserAccess"};const i=(0,f.useIntl)(),n=(0,_e.yK)((e=>({title:{marginRight:8},noWorkspaces:{paddingInline:8,opacity:.5},plusMore:{opacity:.5,marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"}})),[]),o=t.map((e=>({key:e.id,render:t=>{const n=e.icon?{pointer:{table:pa.bx,id:e.id,spaceId:e.id},icon:e.icon}:void 0;return d.createElement(it.Z,s()({icon:a()(Ke.Z,{disabled:!0,icon:n,isEmptyPage:!1,size:28,title:e.name,isLarge:!0,emojiSize:24,isRaw:!1}),title:a()(xe.Z,{},void 0,a()(hs,{workspace:e})),caption:Array.isArray(e.membersCount)?1===e.membersCount.length?a()(f.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd}+ members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersLowerEndRange",description:"Provides a base range of the number of members in the workspace. Note that `lowerEnd` should always be plural since it's always greater than 1.",values:{plan:(0,K.t1)(e.plan,i),lowerEnd:e.membersCount[0]}}):a()(f.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd} - {higherEnd} members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersRange",description:"Provides a range of the number of members in the workspace. Note that `higherEnd` should always be plural since it's always greater than 1.",values:{plan:(0,K.t1)(e.plan,i),lowerEnd:e.membersCount[0],higherEnd:e.membersCount[1]}}):a()(f.FormattedMessage,{defaultMessage:"{plan} · {numMembers} {numMembers, plural, one {member} other {members}}",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembers",description:"Provides the exact number of members in the workspace.",values:{plan:(0,K.t1)(e.plan,i),numMembers:e.membersCount}})},t))},action:()=>{}})));if(t.length<=0)return a()(xe.Z,{style:n.noWorkspaces},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.noWorkspaces",defaultMessage:"No workspaces",description:"Shows that the user is not part of any workspaces."}));const r=t.find((e=>e.name)),l=r?r.name:gs(i);return a()(Ft.N,{title:a()("div",{style:n.titleContainer},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.cellTitle",defaultMessage:"{remainingCount, plural, =0 {{firstWorkspaceName}} one {{firstWorkspaceName}<gray>+{remainingCount}</gray>} other {{firstWorkspaceName}<gray>+{remainingCount}</gray>}}",description:"Shows the name of the first workspace in the list, followed by the number of additional workspaces remaining.",values:{firstWorkspaceName:l,remainingCount:o.length-1,gray:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return a()(xe.Z,{isInline:!0,style:n.plusMore},void 0,t)}}}),!r||r.isExternal?a()(fs,{}):null),items:o})}var ys=i(93405);const bs=(0,f.defineMessages)({menuAriaLabel:{defaultMessage:"Open action menu for this user.",id:"identityAndProvisioning.managedUsers.table.menu.ariaLabel",description:"Accessibility label on button that will open an action menu for this managed user."}});function Ss(e){let{managedUser:t,onEditDetails:i}=e;window.__c={n:"UserActionsMenu"};const n=(0,Te.qz)(void 0,Tt.Z),o=(0,f.useIntl)(),r=(0,_e.yK)((()=>({container:{minWidth:265}})),[]);return a()(xt.Z,{popupType:st.kQ.Popup,style:r.container,buttonPopupStore:n,renderOrigin:e=>d.createElement(Zt.Z,s()({ariaLabel:o.formatMessage(bs.menuAriaLabel),icon:Ge.Z.dots},e)),render:()=>a()(ws,{managedUser:t,popupStore:n,onEditDetails:i})})}function ws(e){let{managedUser:t,popupStore:i,onEditDetails:n}=e;window.__c={n:"ActionsMenu"};const o={key:"workspace-actions",render:e=>d.createElement(rt.Z,e),items:[{key:"user-details",render:e=>d.createElement(ys.Z,s()({},e,{shouldWrapCaption:!0,svg:e=>Ge.Z.pencil(e),title:a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.userDetails",defaultMessage:"Edit details",description:"Label for a button that will open a dialog to show the user this account's details."}),style:{paddingTop:8,paddingBottom:8}})),action:()=>n(t)}]};return a()(at.Z,{menuType:Je.og.Popup},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:[o],onAccept:()=>{i.setState({open:!1})}}))}function Ms(e){let{userId:t}=e;const i=(0,f.useIntl)(),n=(0,Te.VK)((()=>{const e=I.default.state.currentSpaceStore;if(!e)return;const n=ze.U6.createChildStore(e,{table:Kt.KJ,id:t});return{userStore:n,userName:n.getDisplayName(i),userEmail:n.getEmail()}}),[t,i]),o=(0,_e.yK)((e=>({iconStyle:{border:`1px solid ${e.tableDividerColor}`,color:e.lightTextColor,fontWeight:500}})),[]);return n?a()(Ne.i,{useThinTitle:!0,title:n.userName,byline:n.userEmail,icon:a()(Ht.Z,{size:28,userStore:n.userStore,iconStyle:o.iconStyle})}):null}var Cs;!function(e){e.ManagedUser="managed-user",e.Loading="loading"}(Cs||(Cs={}));const ks={borderRadius:"100%",height:28,width:28,marginLeft:-4},Ts=[{id:"user",headerTitle:a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.user",defaultMessage:"Users",description:"Header for the users column in the managed users table."}),renderCell:e=>e.type===Cs.ManagedUser?a()(Ms,{userId:e.managedUser.userId}):a()(Ne.H,{includeByline:!0,includeIcon:!0,iconStyles:ks}),widthData:{width:70},sortable:!1},{id:"access",headerTitle:a()("span",{style:{paddingInline:8}},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.access",defaultMessage:"Access",description:"Header for the access column in the managed users table."})),renderCell:e=>e.type===Cs.ManagedUser?a()(vs,{workspaceSummaries:e.managedUser.workspaces}):a()(Ft.z,{}),widthData:{width:60},sortable:!1,computeClickableContents:e=>e.type===Cs.ManagedUser&&e.managedUser.workspaces.length>0},{id:"lastActive",headerTitle:a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive",defaultMessage:"Last active",description:"Header for the last active column in the managed users table."}),renderCell:e=>e.type===Cs.ManagedUser?a()(ps,{lastActiveAt:e.managedUser.lastActiveAt}):a()(Ue,{}),widthData:{width:60},sortable:!1},{id:"menu",headerTitle:null,renderCell:e=>e.type===Cs.ManagedUser?a()(Ss,{managedUser:e.managedUser,onEditDetails:e.onEditDetails}):null,widthData:{width:15},sortable:!1,hasClickableContents:!0}],_s=[{id:"1",isClickable:!1,type:Cs.Loading},{id:"2",isClickable:!1,type:Cs.Loading},{id:"3",isClickable:!1,type:Cs.Loading}];function Is(e){let{managedUsers:t,loadMoreManagedUsers:i,onEditDetails:n,loading:o}=e;const s=t.map((e=>({id:e.userId,type:Cs.ManagedUser,managedUser:e,onEditDetails:n,isClickable:!0}))),r=(0,_e.yK)((e=>(0,De.b)({columnRenderInfo:Ts,theme:e,containerMarginTop:0})),[]);const l=o?[...s,..._s]:s;return d.createElement(d.Fragment,null,a()(De.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Ts,rows:l,onRowClick:function(e){e.type===Cs.ManagedUser&&n(e.managedUser)},renderNoRowsComponent:()=>a()(xs,{loading:o}),styles:r,onScrollBottom:i}))}function xs(e){window.__c={n:"EmptyState"};const t=(0,_e.yK)((()=>({text:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]);return a()(xe.Z,{isSmall:!0,style:t.text},void 0,!e.loading&&a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.empty",defaultMessage:"No users found.",description:"Message displayed on the table that shows workspaces if there are no workspaces to show."}))}function Zs(e){let{pillIcon:t,pillTitle:i,selectedItem:n,setSelectedItem:o,items:r}=e;window.__c={n:"BaseFilterPill"};const l=(0,Te.qz)(void 0,et.Z),c=(0,_e.yK)((e=>({container:{padding:"6px 0 6px"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:12,marginRight:6,fill:"currentColor"}})),[]),[u,p]=(0,d.useState)(!1),[m,g]=(0,d.useState)(n);function h(){o(void 0),g(void 0),p(!1)}function v(){o(m),p(!1)}const y=a()(tt.u,{on:void 0!==n,icon:t?t(c.icon):void 0,title:i,onClick:()=>p(!0)});return a()(lt.Z,{},void 0,a()(st.ZP,{popupType:st.ZP.PopupType.Popup,placementToOrigin:st.ZP.Placement.Bottom,alignmentToOrigin:st.ZP.Alignment.Start,open:u,render:function(){const e={key:"menuOptions",items:r.map((e=>({key:e.key,action:()=>function(e){g(m===e?void 0:e)}(e.value),render:t=>d.createElement(it.Z,s()({},t,{icon:a()(gi.Z,{isSelected:m===e.value}),focused:!1,title:e.title,caption:e.caption,shouldWrapCaption:e.wrapCaption}))}))),render:e=>d.createElement(rt.Z,s()({},e,{title:null,loading:!1}))};return a()("div",{style:c.container},void 0,a()(at.Z,{menuType:Je.og.Popup,header:null,maxHeight:250,width:300},void 0,a()(ot.Z,{type:ot.i.Vertical,store:l,initialFocus:0,sections:[e]})),a()(rt.Z,{topBorder:!0,style:c.footer},void 0,a()($e.Z,{onClick:h},void 0,a()(f.FormattedMessage,{id:"core.baseFilterPill.clearButton",description:"Label for the button that resets the selected filter back to empty.",defaultMessage:"Clear"})),a()(je.Z,{onClick:v},void 0,a()(f.FormattedMessage,{id:"core.baseFilterPill.doneButton",description:"Label for the button that closes the menu.",defaultMessage:"Apply"}))))},onDismiss:function(){p(!1),g(n)},keepFocus:!0,origin:y,preventScaleTransition:!0}))}function Ps(e){let{selectedMfaMethod:t,setSelectedMfaMethod:i}=e;return window.__c={n:"MfaMethodFilter"},a()(Zs,{pillTitle:a()(f.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.title",description:"Title of the MFA method filter for the managed users table.",defaultMessage:"MFA method"}),pillIcon:Ge.Z.lockShield,selectedItem:t,setSelectedItem:i,items:Fs})}const Fs=[{key:"totp",value:"totp",title:a()(f.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp",description:"Label for the option that selects the MFA method of a time-based one time password.",defaultMessage:"Authenticator"}),caption:a()(f.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp.caption",description:"Caption for the option that selects the MFA method of a time-based one time password.",defaultMessage:"Users who have enabled 2-step verification through an authenticator app"}),wrapCaption:!0},{key:"sms",value:"sms",title:a()(f.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms",description:"Label for the option that selects the MFA method of a phone number.",defaultMessage:"Phone number"}),caption:a()(f.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms.caption",description:"Caption for the option that selects the MFA method of a phone number.",defaultMessage:"Users who have enabled 2-step verification through their phone number"}),wrapCaption:!0},{key:"backup_code",value:"backup_code",title:a()(f.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backupCode",description:"Label for the option that selects the MFA method of a backup code.",defaultMessage:"Backup code"}),caption:a()(f.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backup_code.caption",description:"Caption for the option that selects the MFA method of a backup code.",defaultMessage:"Users who have enabled 2-step verification with active backup codes."}),wrapCaption:!0}];var As=i(24211),Bs=i(71119),Es=i(23063),Ds=i(15095),Rs=i(71669),Ls=i(81865);function Os(e){let{size:t,style:i,avatarType:n,isOffline:o,disabled:s,loading:r,disabledTooltipMessage:l,onUploadProfilePhoto:c,onRemoveProfilePhoto:u}=e;window.__c={n:"UIEditableUserAvatar"};const[p,m]=(0,d.useState)(!1),g=(0,_e.yK)((e=>{const i=(t??18)/2,n=Math.ceil(Math.sqrt(i/2)-8);return(0,_e.EM)({avatarButton:{position:"relative",padding:0,border:0,background:"none",borderRadius:"50%"},removeIconButton:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:n+2,right:n+2,height:16,width:16,padding:0,borderRadius:"50%",border:"none",background:"light"===e.mode?e.contentBackground:e.tooltipBackground,boxShadow:e.lightBoxShadow,transition:"background 0.2s ease"},removeIcon:{fill:"light"===e.mode?ho.FN.light.gray[400]:ho.FN.dark.gray[800],height:10,width:10},buttonPressed:{borderRadius:"50%",background:"light"===e.mode?ho.FN.light.gray[200]:ho.FN.dark.gray[600]},buttonHovered:{borderRadius:"50%",background:"light"===e.mode?ho.FN.light.gray[100]:ho.FN.dark.gray[500]}})}),[t]),h=(0,d.useCallback)((()=>p?a()(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.remove",defaultMessage:"Remove photo",description:"Tooltip explaining how to a remove your profile photo."}):"photo"===n.type?a()(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.replace",defaultMessage:"Replace photo",description:"Tooltip explaining how to a replace your profile photo."}):a()(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.upload",defaultMessage:"Upload photo",description:"Tooltip explaining how to a profile photo."})),[n.type,p]);return r?a()(Ns,{size:t??18,isOffline:o,avatarType:n,loading:r}):a()(Oe.Z,s?{disableTooltip:!l,renderTooltip:()=>l,placement:Oe.Z.Placement.Bottom,alignment:Oe.Z.Alignment.Center,render:e=>d.createElement("div",e,a()(Ns,{size:t??18,isOffline:o,avatarType:n}))}:{renderTooltip:h,placement:Oe.Z.Placement.Bottom,alignment:Oe.Z.Alignment.Center,render:(e,s)=>a()(Mi.Z,{style:{...g.avatarButton,...i},pressedStyle:g.buttonPressed,hoveredStyle:g.buttonHovered,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:c},void 0,a()(Ns,{size:t??18,isOffline:o,avatarType:n}),s&&"photo"===n.type&&a()(Mi.Z,{style:g.removeIconButton,pressedStyle:g.buttonPressed,hoveredStyle:g.buttonHovered,onClick:e=>{u(),e.stopPropagation()},onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1)},void 0,Ge.Z.closeSmall(g.removeIcon)))})}function Ns(e){let{size:t,isOffline:i,loading:n,avatarType:o}=e;window.__c={n:"UserAvatar"};const s=(0,_e.yK)((e=>(0,_e.EM)({avatarWrapStyle:{background:e.buttonHoveredBackground,borderRadius:"100%",boxShadow:"none",..."light"===e.mode?{border:`1px solid ${ho.FN.light.gray[100]}`}:{}},avatarStyle:{borderRadius:"100%",width:t,height:t,maxWidth:"100%",maxHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none",WebkitUserSelect:"none",opacity:i?.3:1},avatarIcon:{width:Math.ceil(.6*t),height:Math.ceil(.6*t),color:e.mediumIconColor},imageBox:{width:"100%",height:"100%",borderRadius:"100%"},initialStyle:{boxSizing:"content-box",border:"none",borderRadius:"100%",width:t-2,height:t-2,lineHeight:t-2+"px",overflow:"hidden",textAlign:"center",fontSize:Math.max(t*(14/32),10),userSelect:"none",WebkitUserSelect:"none",color:e.regularIconColor,opacity:i?.3:1}})),[t,i]),r=(0,d.useMemo)((()=>n?a()(Re.Z,{}):"photo"===o.type?a()(Ls.Z,{stripGoogleIconQuery:!0,url:o.profilePhoto,isAuthenticated:!1,width:t||18,render:(e,t)=>a()(Rs.Z,{src:t,style:s.imageBox})}):"initial"===o.type?a()("div",{style:s.initialStyle},void 0,o.firstUpperCasedGrapheme):"icon"===o.type?Ge.Z.plus(s.avatarIcon):void 0),[o,t,n,s]);return a()("div",{style:s.avatarWrapStyle},void 0,a()("div",{style:s.avatarStyle},void 0,r))}function Vs(e){const{profilePhoto:t,name:i,email:n}=e;if(t)return{type:"photo",profilePhoto:t};const a=Ds.p4(i)[0]||Ds.p4(n)[0];return a?{type:"initial",firstUpperCasedGrapheme:a.toUpperCase()}:{type:"icon"}}var Us=i(13490),Ws=i(64964),zs=i(53471);const Ks=(0,f.defineMessages)({uploadFailed:{defaultMessage:"Upload failed.",id:"identityAndProvisioning.managedUsers.modal.failedUpload",description:"An error message shown when a profile photo upload has failed."}});function qs(e){window.__c={n:"WorkspacesOverview"};const{userId:t,workspaces:i,spaceStore:n,removeWorkspaceFromUser:o}=e,s=(0,_e.yK)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",gap:8,marginTop:12}})),[]);return a()("div",{style:s.container},void 0,i.map(((e,s)=>a()(d.Fragment,{},e.id,a()(Hs,{userId:t,spaceStore:n,workspace:e,removeWorkspaceFromUser:o}),s<i.length-1?a()(Fo.Z,{size:8}):null))))}function Hs(e){window.__c={n:"WorkspaceOverview"};const{userId:t,spaceStore:i,workspace:n,removeWorkspaceFromUser:o}=e,s=(0,f.useIntl)(),r=(0,ke.O7)(),l=(0,_e.yK)((()=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%",gap:12,overflow:"hidden"},workspaceContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",gap:12,overflow:"hidden"},iconContainer:{alignSelf:"center"},textContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},name:{fontSize:14,fontWeight:500},nameUntitled:{fontSize:14,fontWeight:500,opacity:.25},byline:{lineHeight:1.3,fontSize:12,opacity:.5}})),[]),d=(0,Te.VK)((()=>N.default.checkGate("enable_remove_managed_user_from_space")),[]);const c=n.icon?{pointer:{table:pa.bx,id:n.id,spaceId:n.id},icon:n.icon}:void 0;return a()("div",{style:l.container},void 0,a()("div",{style:l.workspaceContainer},void 0,a()("div",{style:l.iconContainer},void 0,a()(Ke.Z,{disabled:!0,icon:c,isEmptyPage:!1,size:28,title:n.name,isLarge:!0,emojiSize:24,isRaw:!1})),a()("div",{style:l.textContainer},void 0,a()(xe.Z,{style:l.name,isMultiline:!0},void 0,a()(hs,{workspace:n})),a()(xe.Z,{style:l.byline},void 0,Array.isArray(n.membersCount)?1===n.membersCount.length?a()(f.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd}+ members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersLowerEndRange",description:"Provides a base range of the number of members in the workspace. Note that `lowerEnd` should always be plural since it's always greater than 1.",values:{plan:(0,K.t1)(n.plan,s),lowerEnd:n.membersCount[0]}}):a()(f.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd} - {higherEnd} members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersRange",description:"Provides a range of the number of members in the workspace. Note that `higherEnd` should always be plural since it's always greater than 1.",values:{plan:(0,K.t1)(n.plan,s),lowerEnd:n.membersCount[0],higherEnd:n.membersCount[1]}}):a()(f.FormattedMessage,{defaultMessage:"{plan} · {numMembers} {numMembers, plural, one {member} other {members}}",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembers",description:"Provides the exact number of members in the workspace.",values:{plan:(0,K.t1)(n.plan,s),numMembers:n.membersCount}}))),a()("div",{},void 0,d?a()($e.Z,{isRed:!0,onClick:async function(){const{accept:e}=await S.confirmUserActionV2({message:a()(xe.Z,{style:S.dialogStyles.title},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.message",defaultMessage:"Remove user from workspace?",description:"The message for a confirmation popup to confirm the user wants to remove this user from the selected workspace."})),description:a()(xe.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,n.membersCount>1?a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.description",defaultMessage:"This user will no longer have access to the workspace you are removing them from. This action is not reversible.",description:"The description for a confirmation popup to confirm the user wants to remove this user from the selected workspace."}):a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.descriptionWithDeletion",defaultMessage:"This user will no longer have access to the workspace you are removing them from. <b>The workspace will be deleted</b> since this user is the only member. This action is not reversible.",description:"The description for a confirmation popup to confirm the user wants to remove this user from the selected workspace and that the workspace will be deleted.",values:{b:e=>a()("b",{},void 0,e)}})),acceptLabel:a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.acceptLabel",defaultMessage:"Remove",description:"The accept label for a confirmation popup to confirm the user wants to remove this user from the selected workspace."}),cancelLabel:a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.cancelLabel",defaultMessage:"Go back",description:"The cancel label for a confirmation popup to confirm the user wants to remove this user from the selected workspace."})});if(!e)return;"success"===(await ge.removeManagedUserFromSpace(r,{userId:t,targetSpaceId:n.id,requestingSpaceId:i.id})).type?(o(t,n.id),Ws.oV({label:a()(f.FormattedMessage,{defaultMessage:"Successfully removed user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceConfirmation",description:"Confirmation toast explaining that the user was successfully removed from the workspace.",values:{workspaceName:n.name}})})):Ws.oV({label:a()(f.FormattedMessage,{defaultMessage:"Failed to remove user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceFailure",description:"Failure toast explaining that the user was not successfully removed from the workspace.",values:{workspaceName:n.name}})})}},void 0,a()(f.FormattedMessage,{defaultMessage:"Remove",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspace",description:"Button text that explains this action will remove the user from this workspace."})):null)))}const Gs=(0,f.defineMessages)({namePlaceholder:{defaultMessage:"Display name",id:"identityAndProvisioning.managedUsers.table.userAccess.namePlaceholder",description:"A placeholder for the input field that has the value for the user's name."},emailPlaceholder:{defaultMessage:"Email",id:"identityAndProvisioning.managedUsers.table.userAccess.emailPlaceholder",description:"A placeholder for the input field that has the value for the user's email."}});function js(e){let{spaceStore:t,managedUser:i,onClose:n,removeWorkspaceFromUser:o}=e;window.__c={n:"ManagedUserDetailsModal"};const s=Boolean(i);return a()($o.Z,{open:s,onDismiss:n,preventHideChildrenWhileOpening:!0,render:()=>i?a()($s,{spaceStore:t,managedUser:i,removeWorkspaceFromUser:o}):null})}function $s(e){let{spaceStore:t,managedUser:i,removeWorkspaceFromUser:n}=e;window.__c={n:"ManagedUserDetailsScene"};const o=(0,f.useIntl)(),s=(0,ke.O7)(),r=(0,Te.VK)((()=>new ze.U6(s,{id:i.userId,table:Kt.KJ})),[i,s]),{hasStagedChanges:l,resetState:c,saveChanges:u,loading:p,profilePhoto:m,name:g,email:h}=function(e){const{userStore:t}=e,i=(0,f.useIntl)(),n=(0,ke.O7)(),{userProfilePhoto:o,userName:s,userEmail:r}=(0,Te.VK)((()=>({userProfilePhoto:t.getProfilePhoto(),userName:t.getFullName(i),userEmail:t.getEmail()})),[t,i]),[l,c]=(0,d.useState)({loading:!1,error:void 0}),[u,p]=(0,d.useState)({value:o,loading:!1}),[m,g]=(0,d.useState)(s),[h,v]=(0,d.useState)(r);return{hasStagedChanges:u.value!==o||m!==s||h!==r,saveChanges:async function(){var e;const i=null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(!i)return;const{accept:o}=await S.confirmUserActionV2({message:a()(xe.Z,{style:S.dialogStyles.title},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.message",defaultMessage:"Confirm changes",description:"The message for a confirmation popup to confirm the user wants to make these profile changes."})),description:a()(xe.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.description",defaultMessage:"Changes made to this user's account will be reflected across all workspaces they have access to.",description:"The description for a confirmation popup to confirm the user wants to make these profile changes."}),a()("br",{}),a()("br",{}),a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.descriptionForScim",defaultMessage:"If this user is being provisioned through SCIM, your changes be later overwritten by the next SCIM sync.",description:"The description for a confirmation popup to confirm the user wants to make these profile changes."})),acceptLabel:a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.acceptLabel",defaultMessage:"Save changes",description:"The accept label for a confirmation popup to confirm the user wants to make these profile changes."}),cancelLabel:a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.cancelLabel",defaultMessage:"Go back",description:"The cancel label for a confirmation popup to confirm the user wants to make these profile changes."})});if(!o)return;c({loading:!0,error:void 0});const s=await ge.updateUserProfile(n,{userId:t.id,spaceId:i,name:m,email:h,profilePhoto:u.value});if("failed"===s.type)return S.showErrorMessage(s.error.message),void c({loading:!1,error:s.error});Ws.oV({label:"Successfully updated user's profile"}),setTimeout((()=>{c({loading:!1,error:void 0})}),500)},resetState:function(){p({value:o,loading:!1}),g(s),v(r)},loading:l.loading,error:l.error,profilePhoto:{value:u.value,loading:u.loading,set:function(){zs.cR({environment:n,onStart:()=>{p((e=>({...e,loading:!0})))},bucket:"public",onError:()=>{p((e=>({...e,loading:!1}))),S.showErrorMessage(i.formatMessage(Ks.uploadFailed))},onComplete:e=>{const t=e[0];p({value:t,loading:!1})},accept:"image/*"})},remove:function(){p({value:"",loading:!1})}},name:{value:m,set:g},email:{value:h,set:v}}}({userStore:r}),v=(0,Te.VK)((()=>Vs({profilePhoto:m.value,name:g.value,email:h.value})),[m.value,g.value,h.value]),y=(0,_e.yK)((e=>({container:{position:"relative",display:"flex",flexDirection:"column",background:e.popoverBackground,width:420,maxHeight:520,overflow:"hidden",borderRadius:8},innerContainer:{position:"relative",display:"flex",flexDirection:"column",width:"100%",height:"100%",overflowY:"auto",padding:"36px 24px",gap:16},label:{color:e.mediumTextColor},value:{color:e.regularTextColor},input:{padding:"4px 4px 4px 10px",margin:"0 auto 8px",width:"100%",background:e.modalBackground},avatarContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},iconStyle:{border:`1px solid ${e.tableDividerColor}`,color:e.lightTextColor,fontWeight:500},inputContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%",gap:8},inputRow:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},infoContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%"},infoRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},footer:{position:"absolute",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",paddingInline:4,boxShadow:e.borderBoxShadow,background:e.popoverBackground,left:0,right:0,bottom:0,height:48},button:{height:30,marginInline:4}})),[]),b=(0,As.E2)(o),w=(0,Te.VK)((()=>!Ie.Z.state.online),[]),M=i.mfaMethods.filter((e=>"backup_code"!==e)),C=o.formatList(M.map((e=>(0,Bs.cR)(e))),{type:"conjunction"});return a()("div",{style:y.container},void 0,a()("div",{style:y.innerContainer},void 0,a()("div",{style:y.avatarContainer},void 0,a()(Os,{size:56,avatarType:v,isOffline:w,loading:m.loading,onUploadProfilePhoto:m.set,onRemoveProfilePhoto:m.remove})),a()("div",{style:y.inputContainer},void 0,a()("div",{style:y.inputRow},void 0,a()(Us.Z,{},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.nameLabel",defaultMessage:"Name",description:"Label for the input that displays the selected user's name."})),a()(Li.Z,{style:y.input,disabled:p,value:g.value,placeholder:o.formatMessage(Gs.namePlaceholder),onChange:e=>{g.set(e.target.value)}})),a()("div",{style:y.inputRow},void 0,a()(Us.Z,{},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emailLabel",defaultMessage:"Email",description:"Label for the input that displays the selected user's name."})),a()(Li.Z,{style:y.input,disabled:p,value:h.value,placeholder:o.formatMessage(Gs.emailPlaceholder),onChange:e=>{h.set(e.target.value)}}))),a()("div",{style:y.infoContainer},void 0,a()("div",{style:y.infoRow},void 0,a()(xe.Z,{style:y.label,isSmall:!0},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.accountCreatedLabel",defaultMessage:"Account created",description:"Label for the field that shows when the user's account was created."})),i.accountCreatedAt?a()(xe.Z,{isSmall:!0,style:y.value},void 0,(0,Vn.Yx)(i.accountCreatedAt,"medium",b)):a()(xe.Z,{isSecondaryColor:!0,isSmall:!0},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyAccountCreated",defaultMessage:"Incomplete",description:"Label indicating that the user's account has not completed the onboarding flow."}))),a()(Fo.Z,{size:16}),a()("div",{style:y.infoRow},void 0,a()(xe.Z,{style:y.label,isSmall:!0},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.lastActiveLabel",defaultMessage:"Last active",description:"Label for the field that shows when the user's account was last active."})),i.lastActiveAt?a()(xe.Z,{isSmall:!0,style:y.value},void 0,(0,Le.gs)(i.lastActiveAt)):a()(xe.Z,{isSecondaryColor:!0,isSmall:!0},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyLastActive",defaultMessage:"No activity",description:"Label indicating that the user has no activity data to show."}))),a()(Fo.Z,{size:16}),a()("div",{style:y.infoRow},void 0,a()(xe.Z,{style:y.label,isSmall:!0},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.mfaLabel",defaultMessage:"MFA",description:"Label for the field that shows what the user's multi-factor authentication status is."})),M.length>0?a()(xe.Z,{isSmall:!0,style:y.value},void 0,C):a()(xe.Z,{isSecondaryColor:!0,isSmall:!0},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyMfa",defaultMessage:"Not configured",description:"Label indicating that the user's multi-factor authentication setting is not configured."})))),a()("div",{},void 0,i.workspaces.length>0?d.createElement(d.Fragment,null,a()(Us.Z,{},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.workspacesLabel",defaultMessage:"Workspaces",description:"Label for the list of workspaces the user is a part of."})),a()(qs,{userId:i.userId,workspaces:i.workspaces,spaceStore:t,removeWorkspaceFromUser:n})):null)),a()(Es.Z,{isVisible:l||p,enterAnimationStyle:{translateY:48,opacity:0},animationStyle:{opacity:1,translateY:0},exitAnimationStyle:{translateY:48,opacity:0},render:()=>a()("div",{style:y.footer},void 0,a()(Ae.Z,{isRed:!0,disabled:p,style:y.button,onClick:c},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.cancelButton",defaultMessage:"Cancel",description:"Label for the button that cancels changes."})),a()(je.Z,{disabled:p,style:y.button,onClick:u},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.saveButton",defaultMessage:"Save changes",description:"Label for the button that saved changes."})))}))}function Ys(e){let{selectedSpaceId:t,setSelectedSpaceId:i,spaceData:n}=e;window.__c={n:"WorkspacesFilter"};const o=(0,f.useIntl)(),s=(0,_e.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:8},optionTitle:{display:"block"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"},container:{padding:"6px 0 6px"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:6,fill:"currentColor"}})),[]),r=(0,Te.VK)((()=>n.map((e=>{const t=e.name,i=e.icon?{pointer:{table:pa.bx,id:e.id,spaceId:e.id},icon:e.icon}:void 0;return{key:e.id,value:e.id,title:a()("div",{style:s.optionContainer},void 0,a()(Ke.Z,{disabled:!0,icon:i,isEmptyPage:!1,size:24,title:t,isLarge:!0,emojiSize:24,isRaw:!1}),a()("div",{style:{paddingTop:4,paddingBottom:4}},void 0,a()(xe.Z,{style:s.optionTitle},void 0,t),a()(xe.Z,{style:s.optionCaption},void 0,(0,K.t1)(e.subscriptionTier,o))))}}))),[n,o,s]);return a()(Zs,{pillTitle:a()(f.FormattedMessage,{id:"managedUsersTab.table.filters.workspaces.title",description:"Title of the workspace filter for the managed users table.",defaultMessage:"Workspace"}),pillIcon:Ge.Z.settingsWorkspace,selectedItem:t,setSelectedItem:i,items:r})}const Qs=(0,f.defineMessages)({placeholder:{id:"identityProvisioningSettings.managedUsers.searchInput.placeholder",defaultMessage:"Search name, email, or user ID",description:"Placeholder text for the search input on the user management table."}});function Xs(e){let{spaceStore:t,samlConfigStore:i}=e;window.__c={n:"ManagedUsersPage"};const{navigateTo:n}=(0,d.useContext)(ls),o=(0,ke.O7)(),s=(0,_e.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:h.Z.fontWeight.semibold,fontSize:17},byline:{fontSize:14,fontWeight:h.Z.fontWeight.regular,color:e.mediumTextColor,paddingBottom:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"},filters:{display:"flex",justifyContent:"flex-start",alignItems:"center",width:"100%",margin:"0 auto 12px"}})),[]),r=(0,Te.VK)((()=>i.state.spaceIds.map((e=>cs.Z.getPublicSpaceData(o,e)||void 0)).filter(T.$K)),[i,o]),[c,u]=(0,d.useState)();const{managedUsers:p,filters:m,loadNextPage:g,setFilters:v,removeWorkspaceFromUser:y,loading:b}=function(e){let{spaceStore:t,samlConfigStore:i}=e;const n=(0,ke.O7)(),[a,o]=(0,d.useState)(us),s=(0,d.useRef)(a.filters),r=(0,Te.VK)((()=>Boolean(i.state.id)&&i.state.id===t.id),[i,t]),c=(0,Te.VK)((()=>i.state.emailDomains),[i]),u=(0,Te.VK)((()=>N.default.checkGate("enable_managed_users_dashboard")),[]),p=(0,d.useCallback)((async e=>{if(!u)return;if(0===c.length)return;if(!r)return;let i=a.loading,l=a.error,d=a.hasNextPage,p=a.paginationToken;if(e.restartSearch&&(o((e=>({...us,filters:e.filters}))),i=us.loading,l=us.error,d=us.hasNextPage,p=us.paginationToken),d&&!i&&!l){o((e=>({...e,loading:!0}))),s.current=a.filters;try{const e=await ge.getManagedUsers(n,{spaceId:t.id,emailDomains:c,query:a.filters.query,multiFactorStatus:a.filters.multiFactorStatus,workspaceId:a.filters.workspaceId,paginationToken:p});if("failed"===e.type)throw e.error;const i=e.data.nextPaginationToken,s=e.data.results;o((e=>{const t=[...e.managedUsers],n=new Set(e.managedUsers.map((e=>e.userId)));for(const i of s)n.has(i.userId)||t.push(i);return{...e,managedUsers:t,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:i,hasNextPage:Boolean(i)}}))}catch(m){const e=(0,rn.tg)(m);o((t=>({...t,loading:!1,error:e})))}}}),[n,t,u,c,r,a.loading,a.error,a.hasNextPage,a.paginationToken,a.filters]);(0,d.useEffect)((()=>{l().isEqual(s.current,a.filters)||p({restartSearch:!0})}),[a.filters,p]);const m=(0,d.useCallback)((()=>p({restartSearch:!1})),[p]),g=(0,d.useCallback)((e=>{o((t=>({...t,filters:{...t.filters,...e}})))}),[]),h=(0,d.useCallback)(((e,t)=>{o((i=>({...i,managedUsers:i.managedUsers.map((i=>i.userId===e?{...i,workspaces:i.workspaces.filter((e=>e.id!==t))}:i))})))}),[]);return{managedUsers:a.managedUsers,filters:a.filters,loading:a.loading,error:a.error,removeWorkspaceFromUser:h,setFilters:g,hasNextPage:a.hasNextPage,loadNextPage:m}}({spaceStore:t,samlConfigStore:i}),S=(0,d.useMemo)((()=>p.find((e=>{let{userId:t}=e;return t===c}))),[c,p]);return a()(Ze.Z,{},void 0,a()(Ao.Z,{style:s.link,onClick:()=>n(as)},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.breadcrumb",defaultMessage:"← Identity & Provisioning",description:"Link for navigating back to the previous 'Identity & Provisioning' settings page."})),a()(Pe.Z,{large:!0,style:s.title},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.title",defaultMessage:"User management",description:"Title for the user management section."})),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:s.byline},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.byline",defaultMessage:"Manage accounts that are using your verified domains.",description:"Byline for the user management section."})),a()(Ji,{mode:Qi.Button,query:m.query,setQueryFilter:e=>{v({query:e})},placeholderText:V.default.formatMessage(Qs.placeholder)}),a()("div",{style:s.filters},void 0,a()(Ys,{selectedSpaceId:m.workspaceId,setSelectedSpaceId:e=>{v({workspaceId:e})},spaceData:r}),a()(Ps,{selectedMfaMethod:m.multiFactorStatus,setSelectedMfaMethod:e=>{v({multiFactorStatus:e})}})),a()(Is,{managedUsers:p,loading:b,loadMoreManagedUsers:g,onEditDetails:function(e){u(e.userId)}}),a()(js,{spaceStore:t,managedUser:S,onClose:function(){u(void 0)},removeWorkspaceFromUser:y}))}function Js(e){let{environment:t,samlConfigStore:i}=e;const n=i.state.emailDomains.length>0,a=(0,q.zt)();return n||("business"===a||"enterprise"===a)}async function er(e){let{onRequest:t,onSuccess:i}=e;const n=await t();switch(n.type){case"success":i&&await i(n);break;case"failed":S.showErrorMessage(n.error.message);break;default:(0,T.t1)(n)}}function tr(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n}=e;const a=(0,ke.O7)(),o=(0,Te.VK)((()=>i.state.emailDomains),[i]),s=(0,Te.VK)((()=>"disabled"!==i.state.status&&"unconfigured"!==i.state.status),[i]),r=(0,Te.VK)((()=>Js({environment:a,samlConfigStore:i})),[i,a]),l=(0,Te.VK)((()=>r&&(!i.state.id||i.state.id===t.id)),[r,i,t]),c=(0,Te.VK)((()=>n.state.emailDomains.length>0&&(0,q.wP)()),[n]),u=(0,Te.VK)((()=>o.length>0),[o]),p=(0,d.useCallback)((async()=>{if(i.state.emailDomains.length>0)return er({onRequest:()=>ge.updateWorkspaceCreationForEmailDomains(a,{emailDomains:i.state.emailDomains,workspaceCreationEnum:n.state.spaceCreation,spaceId:t.id}),onSuccess:()=>{n.setState({...n.state,emailDomains:i.state.emailDomains})}})}),[a,t,n,i]),m=(0,d.useCallback)((async()=>{if(i.state.emailDomains.length>0)return er({onRequest:()=>ge.updateEmailDomainSettings(a,{emailDomains:i.state.emailDomains,spaceId:t.id,preventProfileEdits:n.state.settings.prevent_profile_edits,preventMembersJoiningExternalWorkspace:n.state.settings.prevent_members_joining_external_workspace}),onSuccess:()=>{n.setState({...n.state,emailDomains:i.state.emailDomains})}})}),[a,t,n,i]),g=(0,Te.VK)((()=>r&&(0,q.wP)()),[r]);return{verifiedDomains:o,isSamlStatusEnabled:s,isSamlAvailable:r,isSamlEditable:l,isDomainSettingsAvailable:c,isClaimSpacesAvailable:g,canSaveWorkspaceCreationSetting:u,saveWorkspaceCreationSetting:p,saveEmailDomainSettings:m}}function ir(e){let{title:t,byline:i,settingItem:n}=e;window.__c={n:"GenericSetting"};const o=(0,_e.yK)((e=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},settingLeft:{width:"60%"},settingTitle:{fontWeight:h.Z.fontWeight.regular},settingByline:{marginBottom:4}})),[]);return a()("div",{style:o.settingContainer},void 0,a()("div",{style:o.settingLeft},void 0,a()(Pe.Z,{smallMarginBottom:!0,style:o.settingTitle},void 0,t),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:o.settingByline},void 0,i)),n)}var nr=i(93678),ar=i(91718);function or(e){let{title:t,byline:i,targetTier:n}=e;const o=(0,ke.O7)(),s=(0,d.useCallback)((()=>nr.y(o,{from:"space_saml",for:n})),[o,n]);return d.createElement(d.Fragment,null,a()(Pe.Z,{smallMarginBottom:!0,style:{fontWeight:h.Z.fontWeight.regular,display:"flex",alignItems:"center"}},void 0,a()("span",{style:{marginRight:8}},void 0,t),a()(ar.Z,{subscriptionTier:n,analyticsName:"space_saml",onClick:s})),a()(xe.Z,{isSmall:!0,isMultiline:!0},void 0,i))}const sr={browseWorkspaces:a()(f.FormattedMessage,{defaultMessage:"Browse workspaces",id:"identityAndProvisioning.claimWorkspaces.button",description:"Message explaining that there are some workspaces that the user can claim."}),noWorkspaces:a()(f.FormattedMessage,{defaultMessage:"No workspaces",id:"identityAndProvisioning.claimWorkspaces.buttonEmpty",description:"Message explaining that there are no workspaces to claim."}),loadingError:a()(f.FormattedMessage,{defaultMessage:"Error loading workspaces.",id:"identityAndProvisioning.claimWorkspaces.errorByline",description:"Message explaining that there there was an error loading claimable workspaces."})};function rr(e){let{promptUpgrade:t}=e;window.__c={n:"ClaimSpaces"};const{navigateTo:i,loadingSpaces:n,hasBrowsableSpaces:o,errorClaimableSpaces:r}=(0,d.useContext)(ls),l=Boolean(r),c=!o||n,u=!o&&!n,p=a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces",description:"Title for this section's content being about claiming domains."}),m=a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.message",defaultMessage:"Claim workspaces created by users with a verified domain or require owners to use an external domain.",description:"Byline talking about how workspaces created with a verified domain can be claimed."}),g=(0,_e.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:c?.5:1,minWidth:160},settingErrorByline:{color:e.errorText,marginTop:8,fontSize:13}})),[c]);if(t)return a()(or,{title:p,byline:m,targetTier:"enterprise"});let h;return h=n?a()(Re.Z,{}):o?sr.browseWorkspaces:sr.noWorkspaces,a()("div",{style:g.settingContainer},void 0,a()(ir,{title:p,byline:m,settingItem:a()("div",{style:g.buttonAndErrorContainer},void 0,a()(Oe.Z,{placement:Oe.Z.Placement.Top,alignment:Oe.Z.Alignment.End,render:e=>d.createElement(Ae.Z,s()({disabled:c,isLarge:!0,style:g.button,onClick:()=>i(os)},e),h),disableTooltip:!u,renderTooltip:()=>a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.tooltip",defaultMessage:"There are no available workspaces to claim",description:"Tooltip explaining that the button is disabled because there are no workspaces to claim."})}),l?a()(xe.Z,{isSmall:!0,isMultiline:!0,style:g.settingErrorByline},void 0,sr.loadingError):null)}))}var lr=i(52507),dr=i(47478);function cr(e){let{spaceStore:t,samlConfigStore:i,promptUpgrade:n,disabled:o,saveWorkspaceCreationSetting:s}=e;window.__c={n:"EmailDomains"};const r=(0,ke.O7)(),l=(0,Te.qz)(void 0,lr.ZP),c=(0,_e.yK)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{position:"relative",marginLeft:"auto",marginRight:0,opacity:o?.5:1},plusIcon:{width:14,height:14,fill:"inherit",marginRight:"6px"}})),[o]),u=a()(f.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains",description:"Title describing how the content in this section is for verified email domains."}),p=a()(f.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single-sign on.",description:"Caption explaining what it means to verify a domain."}),m=[...(0,Te.VK)((()=>i.state.emailDomains.map(dr.f4)),[i]),...(0,Te.VK)((()=>i.state.domainVerifications.filter((e=>!i.state.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map(dr.UV)),[i])],g=(0,d.useCallback)((async()=>{await ns({environment:r,spaceId:t.id,store:i})}),[r,t,i]),{resetInitialClaimableSpaces:v}=(0,d.useContext)(ls),y=(0,d.useCallback)((async e=>{switch(e.type){case"verified":return er({onRequest:()=>ge.setSamlConfig(r,{spaceId:t.id,removedEmailDomains:[e.domain]}),onSuccess:async()=>{await g(),v()}});case"unverified":case"invalid":return er({onRequest:()=>ge.deleteDomainVerificationCode(r,{id:e.id}),onSuccess:()=>g()})}}),[r,t,g,v]),b=(0,d.useCallback)((()=>er({onRequest:()=>ge.setSamlConfig(r,{spaceId:t.id}),onSuccess:()=>g()})),[r,g,t]),S=(0,d.useCallback)((async()=>{await g(),await s()}),[s,g]);return n?a()(or,{title:u,byline:p,targetTier:"business"}):a()(dr.ZP,{disabled:o,domains:m,onRemoveDomain:y,domainVerificationStore:l,verificationType:"saml_config",verificationTargetId:t.id,refreshDomains:S,onClickAddDomain:b,renderOverrideAddDomainButton:e=>a()("div",{style:c.flex},void 0,a()("div",{},void 0,a()(Pe.Z,{smallMarginBottom:!0,style:{fontWeight:h.Z.fontWeight.medium}},void 0,u),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginBottom:4}},void 0,p)),a()("div",{},void 0,a()($e.Z,{isBlue:!0,style:c.button,icon:e=>Ge.Z.plus({...e,...c.plusIcon}),disabled:o,onClick:e},void 0,a()(f.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain",description:"Button for adding a new domain verification record."}))))})}function ur(e){let{domainSettingsStore:t,samlConfigStore:i,disabled:n,verifiedDomains:o,tooltip:r,saveWorkspaceCreationSetting:l}=e;window.__c={n:"WorkspaceCreation"};const c=(0,ke.O7)(),u=(0,_e.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),p=(0,Te.VK)((()=>{const e=i.state.id;if(!e)return;return new ze.H2(c,{table:pa.bx,id:e}).getName()}),[c,i]),m=(0,d.useCallback)((async e=>{t.setState({...t.state,spaceCreation:e}),await l(),b.tir(c,{workspace_creation:e})}),[t,l,c]),g=(0,Te.VK)((()=>o.length>0?t.state.spaceCreation:"admins_only"),[t,o]),h=a()(f.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} workspace owners",description:"Dropdown option to restrict workspace creation to workspace owners",values:{primaryWorkspaceName:p}}),v=a()(f.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.title",defaultMessage:"Only workspace owners",description:"Dropdown option to restrict workspace creation to workspace owners"});return a()(Oe.Z,{placement:Oe.Z.Placement.Top,alignment:Oe.Z.Alignment.End,render:e=>d.createElement("div",s()({},e,{style:u.settingContainer}),a()(Bo.Z,{isMobile:c.device.isMobile,disabled:n,title:a()(f.FormattedMessage,{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation",description:"Title of workspace creation dropdown"}),caption:a()(f.FormattedMessage,{id:"domainSettings.workspaceCreation.byline",defaultMessage:"Customize who can create new workspaces.",description:"Caption of workspace creation dropdown"}),type:"dropdown",currentOption:g,options:[{key:"unrestricted",label:a()(f.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.title",defaultMessage:"Anyone",description:"Dropdown option to remove restrictions on workspace creation"}),caption:a()(f.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.caption",defaultMessage:"Any user can create new workspaces.",description:"Caption providing more detail for how any users can create a new space with this setting"})},{key:"admins_only",label:p?h:v,caption:a()(f.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.captionWithSpaceName",defaultMessage:"Only workspace owners of this workspace can create new workspaces.",description:"Caption providing more detail for how only workspace owners can create a new space with this setting"})}],onSelectOption:m})),disableTooltip:!r,renderTooltip:()=>r})}function pr(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n}=e;const{verifiedDomains:o,isSamlAvailable:s,saveWorkspaceCreationSetting:r,isSamlEditable:l,isDomainSettingsAvailable:c,canSaveWorkspaceCreationSetting:u,isClaimSpacesAvailable:p}=tr({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),m=c&&l;return d.createElement(d.Fragment,null,a()(cr,{disabled:!l,promptUpgrade:!s,spaceStore:t,samlConfigStore:i,saveWorkspaceCreationSetting:r}),a()(ur,{disabled:!m||!u,verifiedDomains:o,samlConfigStore:i,domainSettingsStore:n,tooltip:0===o.length?a()(f.FormattedMessage,{id:"domainSettings.workspaceCreation.disabledTooltip",defaultMessage:"There must be at least one verified domain to configure the workspace creation setting.",description:"Tooltip explaining that the workspace creation setting is disabled if there are no verified domains."}):void 0,saveWorkspaceCreationSetting:r}),a()(rr,{promptUpgrade:!p}))}function mr(e){let{promptUpgrade:t,hasVerifiedDomains:i,disabled:n}=e;window.__c={n:"ManageUsersButton"};const{navigateTo:o}=(0,d.useContext)(ls),r=a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.title",defaultMessage:"User dashboard",description:"Title for this section's content being about managing users."}),l=a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.message",defaultMessage:"Manage accounts that are using your verified domains.",description:"Byline talking about how workspaces created with a verified domain can be claimed."}),c=(0,_e.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!n&&i?1:.5}})),[i,n]);return a()("div",{style:c.settingContainer},void 0,t?a()(or,{title:r,byline:l,targetTier:"enterprise"}):a()(ir,{title:r,byline:l,settingItem:a()("div",{style:c.buttonAndErrorContainer},void 0,a()(Oe.Z,{placement:Oe.Z.Placement.Top,alignment:Oe.Z.Alignment.End,render:e=>d.createElement(Ae.Z,s()({disabled:n||!i,isLarge:!0,style:c.button,onClick:()=>o(ss)},e),a()(f.FormattedMessage,{defaultMessage:"View dashboard",id:"identityAndProvisioning.managedUsers.button",description:"Label for a button that brings the user to a page where they can manage their users."})),disableTooltip:i,renderTooltip:()=>a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users",description:"Tooltip explaining that the button is disabled because there are no verified domains."})}))}))}function gr(e){let{domainSettingsStore:t,samlConfigStore:i,saveEmailDomainSettings:n,promptUpgrade:o,hasVerifiedDomains:s,disabled:r}=e;window.__c={n:"PreventMembersJoiningExternalSpaces"};const l=(0,ke.O7)(),d=(0,_e.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),c=(0,Te.VK)((()=>Boolean(t.state.settings.prevent_members_joining_external_workspace)),[t]),u=(0,Te.VK)((()=>{const e=i.state.id;if(!e)return;return new ze.H2(l,{table:pa.bx,id:e}).getName()}),[l,i]),p=a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.title",defaultMessage:"External workspace access",description:"Title for the setting that allows managed users to join external workspaces."}),m=a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.message",defaultMessage:"Control if managed accounts are able to join workspaces that not owned by your organization.",description:"Byline for the setting that allows managed users to join external workspaces."});if(o)return a()("div",{style:d.settingContainer},void 0,a()(or,{title:p,byline:m,targetTier:"enterprise"}));const g=c?"on":"off";return a()("div",{style:d.settingContainer},void 0,a()(Bo.Z,{isMobile:l.device.isMobile,disabled:r,title:p,caption:m,type:"dropdown",currentOption:g,options:[{key:"on",label:a()(f.FormattedMessage,u?{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} workspace owners",description:"Dropdown option to restrict workspace creation to workspace owners",values:{primaryWorkspaceName:u}}:{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.titleGeneric",defaultMessage:"Only workspace owners",description:"Dropdown option to restrict workspace creation to workspace owners"}),caption:a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.caption",defaultMessage:"Only workspace owners of this workspace can join external workspaces.",description:"Caption providing more detail for how only workspace owners can create a new space with this setting"})},{key:"off",label:a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.titleWithSpaceName",defaultMessage:"Anyone",description:"Caption providing more detail for how anyone can join external"}),caption:a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.caption",defaultMessage:"All users can join any workspace.",description:"Caption providing more detail for how any users can create a new space with this setting"})}],onSelectOption:async function(){t.setState({...t.state,settings:{...t.state.settings,prevent_members_joining_external_workspace:Boolean(!t.state.settings.prevent_members_joining_external_workspace)}}),await n()}}))}var hr=i(24006);function fr(e){let{title:t,byline:i,isOn:n,onToggle:o,disabled:s,tooltipForDisabled:r}=e;function l(){s||o()}return window.__c={n:"SettingsToggle"},a()(Oe.Z,{placement:Oe.Z.Placement.Top,alignment:Oe.Z.Alignment.End,disableTooltip:!r||!s,renderTooltip:()=>r,render:e=>d.createElement("div",e,a()(ir,{title:t,byline:i,settingItem:a()(hr.Z,{on:n,disabled:s,onClick:l})}))})}function vr(e){let{domainSettingsStore:t,saveEmailDomainSettings:i,promptUpgrade:n,hasVerifiedDomains:o,disabled:s}=e;window.__c={n:"PreventProfileEditsSetting"};const r=(0,_e.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),l=(0,Te.VK)((()=>N.default.checkGate("enable_set_email_domain_settings")),[]),d=(0,Te.VK)((()=>Boolean(t.state.settings.prevent_profile_edits)),[t]),c=a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.title",defaultMessage:"Allow users to change account information",description:"Title for the setting that allows managed users to change their account information."}),u=a()(f.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.message",defaultMessage:"Control if managed accounts can change their own name, email address, and profile photo.",description:"Byline for the setting that allows managed users to change their account information."});return a()("div",{style:r.settingContainer},void 0,n?a()(or,{title:c,byline:u,targetTier:"enterprise"}):l?a()(fr,{title:a()("div",{style:r.settingsTitle},void 0,c),byline:u,isOn:!d,onToggle:async function(){t.setState({...t.state,settings:{...t.state.settings,prevent_profile_edits:Boolean(!t.state.settings.prevent_profile_edits)}}),await i()},disabled:s||!o}):null)}function yr(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n}=e;const{verifiedDomains:o,isDomainSettingsAvailable:s,isSamlEditable:r,saveEmailDomainSettings:l}=tr({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),c=s&&r,u=(0,Te.VK)((()=>(0,q.wP)()),[]),p=(0,Te.VK)((()=>N.default.checkGate("enable_managed_users_dashboard")),[]),m=(0,Te.VK)((()=>N.default.checkGate("enable_set_email_domain_settings")),[]);return d.createElement(d.Fragment,null,m?d.createElement(d.Fragment,null,a()(vr,{promptUpgrade:!u,hasVerifiedDomains:o.length>0,domainSettingsStore:n,saveEmailDomainSettings:l,disabled:!c}),a()(gr,{promptUpgrade:!u,hasVerifiedDomains:o.length>0,domainSettingsStore:n,samlConfigStore:i,saveEmailDomainSettings:l,disabled:!c})):null,p?a()(mr,{promptUpgrade:!u,hasVerifiedDomains:o.length>0,disabled:!c}):null)}var br=i(74523);function Sr(e){let{spaceStore:t,samlConfigStore:i}=e;const n=(0,ke.O7)();return{updateSamlIdpUrl:(0,d.useCallback)((async e=>{let a=!1;return await er({onRequest:()=>ge.setSamlConfig(n,{spaceId:t.id,idpMetadataUrl:e}),onSuccess:()=>{a=!0,i.setState({...i.state,useMetadataUrl:!0,idpMetadataUrl:e,idpMetadata:void 0})}}),a}),[i,t,n]),updateSamlIdpXml:(0,d.useCallback)((async e=>{let a=!1;return await er({onRequest:()=>ge.setSamlConfig(n,{spaceId:t.id,idpMetadata:e}),onSuccess:()=>{a=!0,i.setState({...i.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:e})}}),a}),[i,t,n]),updateStatus:(0,d.useCallback)((e=>er({onRequest:()=>ge.setSamlConfig(n,{spaceId:t.id,status:e}),onSuccess:()=>{i.setState({...i.state,status:e})}})),[i,t,n]),updateCreateAccount:(0,d.useCallback)((e=>er({onRequest:()=>ge.setSamlConfig(n,{spaceId:t.id,createAccount:e}),onSuccess:()=>{i.setState({...i.state,createAccount:e})}})),[i,t,n])}}function wr(e){let{spaceStore:t,samlConfigStore:i,disabled:n}=e;window.__c={n:"CreateAccountSetting"};const{updateCreateAccount:o}=Sr({samlConfigStore:i,spaceStore:t}),s=(0,ke.O7)(),r=(0,_e.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),l=(0,Te.VK)((()=>i.state.createAccount),[i]);return a()("div",{style:r.settingContainer},void 0,a()(fr,{title:a()("div",{style:r.settingsTitle},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation",description:"Title describing how this setting is for automatically creating accounts on sign in."}),a()(Zt.Z,{icon:Ge.Z.help,onClick:()=>w.navigateToExternalURL({environment:s,url:(0,W.UY)("guides.samlJIT")})})),byline:a()(f.FormattedMessage,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO.",description:"Byline further describing how this setting is for automatically creating accounts on sign in."}),isOn:l,onToggle:async function(){await o(!i.state.createAccount)},disabled:n}))}function Mr(e){let{spaceStore:t,samlConfigStore:i,disabled:n}=e;window.__c={n:"SamlEnforceSetting"};const o=(0,ke.O7)(),{updateStatus:s}=Sr({samlConfigStore:i,spaceStore:t}),r=(0,_e.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),l=(0,Te.VK)((()=>"enforced"===i.state.status?"enforced":"not_enforced"),[i]);return a()("div",{style:r.settingContainer},void 0,a()(Bo.Z,{isMobile:o.device.isMobile,disabled:n,title:a()(f.FormattedMessage,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method",description:"Title of authentication dropdown"}),caption:a()(f.FormattedMessage,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access SAML SSO-enabled workspaces.",description:"Caption of authentication creation dropdown"}),type:"dropdown",currentOption:l,options:[{key:"enforced",label:a()(f.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO",description:"Dropdown option to enforce SSO on log in."})},{key:"not_enforced",label:a()(f.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method",description:"Dropdown option to not enforce SSO on log in. Users can log in using SSO or another log method, for example, username/password."})}],onSelectOption:async function(){"enforced"===i.state.status?await s("configured"):await s("enforced")}}))}var Cr=i(5228);function kr(e){let{isOpen:t,...i}=e;window.__c={n:"SamlConfigModal"};const n=(0,Te.VK)((()=>({active:i.samlConfigStore.state.useMetadataUrl?"url":"xml",url:i.samlConfigStore.state.idpMetadataUrl||"",xml:i.samlConfigStore.state.idpMetadata||""})),[i.samlConfigStore]);return a()($o.Z,{open:t,onDismiss:i.onClose,render:()=>d.createElement(Tr,s()({},i,{initialConfiguration:n}))})}function Tr(e){let{onSaveChanges:t,initialConfiguration:i,samlConfigStore:n,spaceStore:o,onClose:s}=e;window.__c={n:"SamlConfigSettings"};const[r,l]=(0,d.useState)(i),c=(0,ke.O7)(),u=(0,_e.yK)((e=>({container:{background:e.popoverBackground,width:450,padding:24,borderRadius:3,transition:"all 500ms ease"},title:{fontFamily:h.Z.getCompositeFontFamily(ra.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:h.Z.getCompositeFontFamily(ra.SP).sans,fontSize:14,fontWeight:500,lineHeight:"19px",margin:"20px 0 0"},copyButton:{borderRadius:3,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:h.Z.getCompositeFontFamily(ra.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},url:{width:"100%",color:e.mediumTextColor,fontFamily:h.Z.getCompositeFontFamily(ra.SP).sans,fontSize:14,fontWeight:400,lineHeight:"18px"},readonlyInput:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:3},divider:{margin:"20px auto 20px"},radioContainer:{display:"flex",justifyContent:"space-evenly",flexDirection:"column",height:60},radioOption:{display:"flex",alignItems:"center"},caption:{margin:"4px 0 8px"},centeredCaption:{margin:"4px 24px 8px",textAlign:"center"},buttonContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:24},buttonSpacing:{marginRight:8},feedback:{color:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400],display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px",height:20}})),[]),p=(0,d.useMemo)((()=>Ir(r)),[r]),m=(0,Te.VK)((()=>"unconfigured"===n.state.status),[n]),g=(0,Te.VK)((()=>(0,Cr.v9)(o.id,Qe.Z.domainBaseUrl)),[o]),v=(0,d.useCallback)((()=>{Mt.RD({environment:c,stringValue:g,copiedMessage:Mt.tq.copiedLinkToClipboard})}),[c,g]),y=(0,d.useCallback)((()=>{l((e=>({...e,active:"url"})))}),[]),b=(0,d.useCallback)((()=>{l((e=>({...e,active:"xml"})))}),[]),S=(0,_e.yK)((e=>({input:{transition:"all 200ms ease-in-out",boxShadow:"none",margin:"12px 0",width:"100%",background:e.popoverBackground,border:`1px solid ${e.outlineButtonBorder}`}})),[]),w=(0,d.useMemo)((()=>"url"===r.active?{placeholder:"https://...",value:r.url,onChange:e=>{const t=e.target.value;l((e=>({...e,url:t})))},style:{height:32,...S.input}}:{placeholder:'<md:EntityDescriptor entityID="...',value:r.xml,onChange:e=>{const t=e.target.value;l((e=>({...e,xml:t})))},textarea:!0,style:{height:118,...S.input},inputStyle:{width:"100%",height:"100%"}}),[r,S]),M=(0,d.useCallback)((()=>{t(r)}),[t,r]);return a()("div",{style:u.container},void 0,a()(xe.Z,{style:u.title},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.title",defaultMessage:"SAML SSO Configuration",description:"Modal title indicating the content is about configuring SAML settings."})),a()(xe.Z,{isSmall:!0,style:u.centeredCaption,isMultiline:!0},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",description:"Label explaining what to do with the Assertion Consumer Service (ACS) URL.",values:{guidelink:e=>a()(Ao.Z,{href:(0,W.UY)("guides.samlSettings"),external:!0},void 0,e)}})),a()(xe.Z,{style:u.subtitle},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsTitle",defaultMessage:"Assertion Consumer Service (ACS) URL",description:"Label indicating the URL below is the Assertion Consumer Service (ACS) URL."})),a()(xe.Z,{isSmall:!0,style:u.caption,isMultiline:!0},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsByline",defaultMessage:"Enter this in your IDP's SAML configuration.",description:"Label explaining what to do with the Assertion Consumer Service (ACS) URL."})),a()("div",{style:u.readonlyInput},void 0,a()(xe.Z,{style:u.url},void 0,g),a()(Mi.Z,{onClick:v,style:u.copyButton},void 0,Ge.Z.copy(u.copyIcon),a()(f.FormattedMessage,{id:"verifyDomainModal.editSamlConfig.copy",defaultMessage:"Copy",description:"Button for copying the SSO URL."}))),a()(xe.Z,{style:u.subtitle},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpTitle",defaultMessage:"Identity Provider Details",description:"Label indicating the fields below are for the IDP details."})),a()(xe.Z,{isSmall:!0,style:u.caption},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrlByline",defaultMessage:"Enter the value provided by your IDP.",description:"Label explaining what to do with the IDP SAML URL."})),a()("div",{style:u.radioContainer},void 0,a()($e.Z,{style:u.radioOption,onClick:y},void 0,a()(gi.Z,{isSelected:"url"===r.active}),a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrl",defaultMessage:"Identity Provider URL",description:"Describes the value of this button to be for the IDP URL"}))),a()($e.Z,{style:u.radioOption,onClick:b},void 0,a()(gi.Z,{isSelected:"xml"===r.active}),a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpXml",defaultMessage:"Identity Provider Metadata XML",description:"Describes the value of this button to be for the IDP XML"})))),d.createElement(Li.Z,w),a()("div",{style:u.feedback},void 0,a()(_r,{validation:p})),a()("div",{style:u.buttonContainer},void 0,a()(Ae.Z,{isLarge:!0,style:u.buttonSpacing,onClick:s},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.cancel",defaultMessage:"Cancel",description:"Button that cancels changes"})),a()(je.Z,{isLarge:!0,disabled:"invalid"===p.type,onClick:M},void 0,a()(f.FormattedMessage,m?{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML",description:"Button that saves changes and enables SAML"}:{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes",description:"Button that saves changes"}))))}function _r(e){let t,{validation:i}=e;if("valid"===i.type)return null;switch(i.reason){case"empty":t=a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.empty",defaultMessage:"You cannot leave this field blank",description:"Feedback message explaining this field cannot be left blank."});break;case"signed_request":t=a()(f.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.signed_request",defaultMessage:"Requests cannot be signed",description:"Feedback message explaining the WantAuthnRequestsSigned property must be set to false"})}return d.createElement(d.Fragment,null,Ge.Z.warning({height:16,width:16,margin:"0 4px 0 8px"}),a()("span",{},void 0,t))}function Ir(e){return"url"===e.active?(0,Cr.jY)(e.url):"xml"===e.active?(0,Cr.a7)(e.xml):void(0,T.t1)(e.active)}function xr(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n,isSamlStatusEnabled:o,promptUpgrade:s,disabled:r}=e;const[l,c]=(0,d.useState)({isOpened:!1,enableSamlOnSave:!1}),{updateStatus:u,updateSamlIdpUrl:p,updateSamlIdpXml:m}=Sr({samlConfigStore:i,spaceStore:t}),{verifiedDomains:g}=tr({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),v=(0,_e.yK)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:r?"default":"pointer"},settingTitle:{fontWeight:h.Z.fontWeight.medium},settingByline:{marginBottom:4},configButton:{marginTop:14,opacity:r?.5:1}})),[r]),y=a()(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO",description:"Title describing how the content in this section is for verified email domains."}),b=a()(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO.",description:"Byline describing how enabling SAML will use verified email domains for SSO."});return s?a()(or,{title:y,byline:b,targetTier:"business"}):d.createElement(d.Fragment,null,a()(fr,{title:y,byline:b,isOn:o,disabled:r,tooltipForDisabled:0===g.length?a()(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML.",description:"Tooltip explaining that SAML configuration is disabled if there are no verified domains."}):void 0,onToggle:function(){if(r)return;const{useMetadataUrl:e,idpMetadata:t,idpMetadataUrl:n}=i.state,a=e&&n||!e&&t;switch(i.state.status){case"disabled":a?u("configured"):c({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":c({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":u("disabled")}}}),a()(Ae.Z,{disabled:r,isLarge:!0,style:v.configButton,onClick:function(){r||c({isOpened:!0,enableSamlOnSave:!1})}},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration",description:"Button for opening the modal that allows the user to configure their SSO configuration."})),a()(kr,{isOpen:l.isOpened,onClose:()=>c({isOpened:!1,enableSamlOnSave:!1}),onSaveChanges:async function(e){if("invalid"===Ir(e).type)return;let t=!1;switch(e.active){case"url":t=await p(e.url);break;case"xml":t=await m(e.xml)}t&&(l.enableSamlOnSave&&await u("configured"),c({isOpened:!1,enableSamlOnSave:!1}))},spaceStore:t,samlConfigStore:i}))}var Zr=i(39634);const Pr={id:"name",headerTitle:a()(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",description:"Title of the 'Name' column in the secondary workspaces table.",defaultMessage:"Name"}),renderCell:e=>a()(Rr,{space:e.space,isCurrentSpace:e.isCurrentSpace}),widthData:{width:50},sortable:!0},Fr={id:"memberCount",headerTitle:a()(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",description:"Title of the 'Members' column in the secondary workspaces table.",defaultMessage:"Members"}),renderCell:e=>a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",description:"Describes how many members are in the row.",defaultMessage:"{count} members",values:{count:e.space.memberCount}})),widthData:{width:20},sortable:!0},Ar={id:"createdAt",headerTitle:a()(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",description:"Title of the 'Created At' column in the secondary workspaces table.",defaultMessage:"Created at"}),renderCell:e=>a()(xe.Z,{},void 0,e.space.createdTime&&(0,Vn.Yx)(e.space.createdTime,"medium",ra.SP)),widthData:{width:20},sortable:!0},Br=[Pr,Fr,Ar];function Er(e){let{spaceStore:t,spaces:i}=e;window.__c={n:"WorkspacesTable"};const[n,o]=(0,d.useState)({column:Pr,sortAscending:!1}),s=(0,Te.VK)((()=>i.map((e=>({id:e.id,isClickable:!1,isCurrentSpace:t.id===e.id,space:e})))),[i,t]),r=(0,_e.yK)((e=>(0,De.b)({columnRenderInfo:Br,theme:e,containerMarginTop:12})),[]);return a()(De.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Br,rows:Dr(s,n),sortState:n,onSortStateChanged:o,renderNoRowsComponent:()=>a()(xe.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces.",description:"Message displayed on the table that shows linked workspaces if there are no workspaces to show."})),styles:r})}function Dr(e,t){let{column:i,sortAscending:n}=t,a=[];switch(i.id){case"name":a=l().sortBy(e,(e=>e.space.name));break;case"createdAt":a=l().sortBy(e,(e=>e.space.createdTime));break;case"memberCount":a=l().sortBy(e,(e=>e.space.memberCount))}return n?a:a.reverse()}function Rr(e){window.__c={n:"WorkspaceNameCell"};const t=(0,_e.yK)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",gap:4}})),[]);return a()(xe.Z,{style:t.container},void 0,e.space.name,e.isCurrentSpace?a()(Fn.Z,{},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name.currentBadge",description:"Badge shown next to the current workspace.",defaultMessage:"Current"})):null)}function Lr(e){let{spaceStore:t,spaceIds:i}=e;window.__c={n:"SecondaryWorkspaces"};const n=(0,ke.O7)(),o=(0,_e.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),s=(0,Te.VK)((()=>i.map((e=>cs.Z.getPublicSpaceData(n,e)||void 0)).filter(T.$K)),[i,n]),r=(0,d.useCallback)((()=>{Zr.j({environment:n,from:"saml_settings",prepopulatedContent:`Request to add or remove a workspace for SAML Single Sign-on on workspace ${t.id}.`})}),[t,n]);return a()("div",{style:o.settingContainer},void 0,a()(ir,{title:a()(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces",description:"Title describing that this section contains linked workspaces."}),byline:a()(f.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.message",defaultMessage:"This SAML SSO configuration applies to the following other workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",description:"Describes that the SSO configuration on this page is being applied to the following workspaces.",values:{contactlink:e=>a()(Ao.Z,{onClick:r},void 0,e)}}),settingItem:null}),a()(Er,{spaceStore:t,spaces:s}))}function Or(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n}=e;const{verifiedDomains:o,isSamlAvailable:s,isSamlEditable:r,isSamlStatusEnabled:l}=tr({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),c=!r||!s||!l,u=(0,Te.VK)((()=>i.state.spaceIds),[i]);return d.createElement(d.Fragment,null,a()(br.Z,{title:a()(f.FormattedMessage,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO",description:"Button that links to help center that talks about SAML SSO."}),href:(0,W.UY)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),a()(xr,{disabled:!r||0===o.length,promptUpgrade:!s,isSamlStatusEnabled:l,spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),a()(Mr,{disabled:c,spaceStore:t,samlConfigStore:i}),a()(wr,{disabled:c,spaceStore:t,samlConfigStore:i}),a()(Lr,{spaceStore:t,spaceIds:u}))}const Nr=(0,f.defineMessages)({failedCreatingNewScimToken:{id:"scimTokenSettings.error.failedCreatingNewScimToken",defaultMessage:"Failed to create a new SCIM token, please try again later.",description:"The error message shown when a SCIM token cannot be created."}});function Vr(e){window.__c={n:"NewScimTokenButton"};const[t,i]=(0,d.useState)(!1),n=(0,ke.O7)();const o=!t&&"Able"===e.tokenCreationAbility,r=t||"Able"!==e.tokenCreationAbility,l=a()($e.Z,{isBlue:o,isLightGray:r,disabled:r,style:{position:"relative",marginLeft:"auto",marginRight:0},icon:e=>Ge.Z.plus({...e,width:14,height:14,fill:"inherit",marginRight:"6px"}),onClick:async function(){i(!0);try{const t=await async function(e){let{environment:t,spaceStore:i,userStore:n}=e;const{botStore:a,transactionPromise:o}=so.lz({environment:t,spaceStore:i,name:"SCIM",userId:n.id,spaceRole:"editor",type:"scim"});return await o,a.id}({...e,environment:n});e.onNewScimToken(t)}catch(t){S.showErrorMessage(V.default.formatMessage(Nr.failedCreatingNewScimToken))}i(!1)}},void 0,a()(f.FormattedMessage,{id:"scimTokenSettings.NewSCIMTokenButton.title",defaultMessage:"Add token",description:"Button to create a new SCIM token."}));let c;switch(e.tokenCreationAbility){case"Able":return l;case"Undefined":c=a()(f.FormattedMessage,{defaultMessage:"Not able to create a new SCIM token right now. Please try again later.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.undefined",description:"Message shown when the user cannot create a new SCIM token just yet. We might be waiting to hear back from the server and update the status."});break;case"SpaceHasExistingToken":c=a()(f.FormattedMessage,{defaultMessage:"To create a new SCIM token, please revoke the existing token.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.spaceHasLegacyToken",description:"Message shown when the user cannot create a new SCIM token because an existing one is present. They must first revoke that token to create a new one."});break;case"UserHasExistingToken":c=a()(f.FormattedMessage,{defaultMessage:"You already have a registered SCIM token. To create a new one, please revoke the token created by you.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.userHasExistingToken",description:"Message shown when the user already has a new SCIM token, and cannot create another one."});break;default:(0,T.t1)(e.tokenCreationAbility)}return a()(Oe.Z,{textWrap:!1,renderTooltip:()=>c,placement:Oe.Z.Placement.Right,render:e=>d.createElement("div",s()({},e,{style:{paddingLeft:"4px"}}),l)})}var Ur=i(15070),Wr=i(7424);function zr(e){let{userId:t,currentSpaceStore:i}=e;return ze.U6.createChildStore(i,{table:Kt.KJ,id:t})}var Kr=i(62385);const qr={container:{display:"flex",alignItems:"center",fontSize:h.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},userName:{flexShrink:1,...h.Z.textOverflowStyle}};function Hr(e,t){const i=Wr.kk.fromValue(At.cZ,e);return i.getCreatedByTable()===Kt.KJ&&i.getCreatedById()===t}const Gr={buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:20,width:20,marginRight:1},menuItemButton:{minWidth:200}};function jr(e){let{onRevokeToken:t}=e;const i=(0,_e.Fg)();return d.createElement(d.Fragment,null,a()(Oe.Z,{textWrap:!1,renderTooltip:()=>d.createElement(d.Fragment,null,a()(f.FormattedMessage,{defaultMessage:"Revoke this token.",id:"revokeTokenButton.tooltip"})),placement:Oe.Z.Placement.Right,render:e=>a()(xt.Z,{popupType:xt.Z.PopupType.Popup,placementToOrigin:xt.Z.Placement.Right,renderOrigin:t=>d.createElement(Mi.Z,s()({className:L.TAd,style:Gr.buttonStyle,mobileFeedback:!1},e,t),Ge.Z.trash({fill:i.mediumIconColor,width:12,height:12})),onClick:()=>{S.confirmUserAction({message:a()(f.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.message",defaultMessage:"Are you sure you want to revoke this token?",description:"Title of the modal asking admin users if they want to revoke a SCIM token."}),description:a()(f.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.description",defaultMessage:"Existing SCIM configurations that use this token will no longer work once the token is revoked, and you'll have to provide them with a new token.",description:"Body of the modal asking admin users if they want to revoke a SCIM token, and explaining that integrations that use the token will only work again once a new token is generated and provided to the integration."}),acceptLabel:a()(f.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.acceptButton.label",defaultMessage:"Revoke token",description:"Button confirming that the SCIM token will be revoked."}),cancelLabel:a()(f.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.cancelButton.label",defaultMessage:"Cancel",description:"Button cancelling the action of deleting a SCIM token."})}).then((e=>e&&t()))},render:e=>(e.close(),d.createElement(d.Fragment,null))})}))}const $r=()=>{window.__c={n:"OutdatedWarningIcon"};const e=(0,_e.Fg)();return a()(Oe.Z,{textWrap:!1,renderTooltip:()=>d.createElement(d.Fragment,null,a()(f.FormattedMessage,{defaultMessage:"Outdated token. Revoke this token and generate a new one to view its contents.",id:"manageScimTokenTable.OutdatedWarningIcon.tooltip"})),placement:Oe.Z.Placement.Right,render:t=>d.createElement("div",s()({},t,{style:{paddingLeft:"4px"}}),Ge.Z.warning({fill:(0,ho.fi)("orange",e).fill,width:12,height:12}))})};function Yr(e){let{clipboardTextFn:t}=e;window.__c={n:"RenderCopyToClipboardButton"};const i=(0,ke.O7)();const n=(0,_e.Fg)(),o={height:25,background:n.whiteButtonBackground,color:n.regularTextColor,fontWeight:h.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return a()(Kr.Z,{onClick:async function(){const e=await t();void 0!==e&&Mt.RD({environment:i,stringValue:e,copiedMessage:Mt.tq.copiedTokenToClipboard,showCopyModal:!!i.device.isSafari||void 0})},style:o},void 0,Ge.Z.copy({height:16,width:16,paddingRight:4}),a()(f.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"}))}const Qr="•••••••••••";function Xr(){return window.__c={n:"RenderTokenThatCannotBeViewed"},a()(Oe.Z,{textWrap:!1,renderTooltip:()=>a()(f.FormattedMessage,{defaultMessage:"This token can only be viewed by its creator.",id:"manageScimTokenTable.renderTokenThatCannotBeViewed.tooltip"}),placement:Oe.Z.Placement.Right,render:e=>d.createElement("div",e,Qr)})}function Jr(e){let{row:t}=e;const i=(0,ke.O7)();return t.legacy?d.createElement(d.Fragment,null,Qr,a()($r,{})):t.ownedByCurrentUser?d.createElement(d.Fragment,null,Qr,a()(Yr,{clipboardTextFn:()=>so.VG({environment:i,botId:t.id})})):a()(Xr,{})}const el={id:"token",headerTitle:a()(f.FormattedMessage,{id:"manageScimTokenTable.columnTitle.token",description:"Title of the 'Token' column in the manage SCIM token table.",defaultMessage:"Token"}),renderCell:e=>a()(Jr,{row:e}),widthData:{width:40},sortable:!1,hasClickableContents:!0},tl=()=>{window.__c={n:"LegacyUserCell"};const e=qr;return a()(Oe.Z,{textWrap:!1,renderTooltip:()=>a()(f.FormattedMessage,{defaultMessage:"This token was created by a user who is no longer an admin in the workspace.",id:"scimTableLegacyUserCell.tooltip"}),placement:Oe.Z.Placement.Right,render:t=>d.createElement("div",t,a()("div",{style:e.container},void 0,a()(Ht.Z,{style:e.userAvatar,avatarShouldShowShadow:!0,size:20}),a()("div",{style:e.userName},void 0,a()("i",{},void 0,"Deactivated user"))))})},il={id:"addedBy",headerTitle:a()(f.FormattedMessage,{id:"manageScimTokenTable.columnTitle.addedBy",description:"Title of the 'Added by' column in the manage SCIM token table.",defaultMessage:"Added by"}),renderCell:e=>{if(e.legacy)return a()(tl,{});{const t=e.ownedByCurrentUser?a()(xe.Z,{isSecondaryColor:!0,style:{marginLeft:4,textAlign:"center"}},void 0,a()(f.FormattedMessage,{id:"manageSCIMTokenTable.colums.addedBy.selfIndicator",defaultMessage:"(you)",description:"Displayed next to a user's name to indicate they're the user who generated a SCIM token. Example: John Doe (you)"})):d.createElement(d.Fragment,null);return d.createElement(d.Fragment,null,a()(Qt,{isClickable:!1,userStores:[e.ownerUserStore]}),t)}},widthData:{width:40},sortable:!1,hasClickableContents:!1},nl={id:"created",headerTitle:a()(f.FormattedMessage,{id:"manageScimTokenTable.columnTitle.created",description:"Title of the 'Created' (i.e. when it was created) column in the manage SCIM token table.",defaultMessage:"Created"}),renderCell:e=>a()(Ve,{includeTime:!0,dateTs:e.createdAt}),widthData:{width:40},sortable:!0,hasClickableContents:!1},al=[el,il,nl,{id:"revokeToken",headerTitle:void 0,renderCell:e=>a()(jr,{onRevokeToken:()=>{e.onRevokeToken()}}),widthData:{width:10},sortable:!1,hasClickableContents:!0}];function ol(e,t){let{column:i,sortAscending:n}=t;const a=null==i?void 0:i.id;let o=e=>e.id;switch(a){case"name":o=e=>e.name;break;case"created":o=e=>e.createdAt;break;case"token":case"addedBy":case"revokeToken":case void 0:break;default:(0,T.t1)(a)}const s=l().sortBy(e,o);return n||s.reverse(),s}function sl(e){let{botStores:t,onRevokeToken:i}=e;window.__c={n:"ManageScimTokenTable"};const n=(0,Te.VK)((()=>I.default.state.currentUserStore),[]),o=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),s=(0,f.useIntl)(),r=(0,Te.VK)((()=>{if(!o)return[];const e=null==n?void 0:n.id;return l().compact(t.map((t=>{const n=t.getModel();if(!n||!(0,Ur.xe)(n))return;const a={id:n.id,isClickable:!1,createdAt:n.getCreatedAt(),userLocale:s.locale,name:n.getName(),onRevokeToken:()=>{i(n.id)}},r=function(e){const t=Wr.kk.fromValue(At.cZ,e);return"notion_user"===t.getCreatedByTable()&&t.getCreatedById()===Kt.s$.id}(n);return r?{...a,legacy:r}:{...a,legacy:r,ownedByCurrentUser:Hr(n,e),ownerUserStore:"notion_user"===n.getCreatedByTable()?zr({userId:n.getCreatedById(),currentSpaceStore:o}):void 0}})))}),[t,o,n,s.locale,i]),[c,u]=(0,d.useState)({column:nl,sortAscending:!1}),p=(0,_e.yK)((e=>(0,De.b)({columnRenderInfo:al,theme:e,containerMarginTop:0})),[]);return a()(De.D,{columnRenderInfo:al,rows:ol(r,c),sortState:c,onSortStateChanged:u,onRowClick:()=>d.createElement(d.Fragment,null),renderNoRowsComponent:()=>a()(xe.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,a()(f.FormattedMessage,{id:"manageSCIMTokenTable.noTokensFound.message",defaultMessage:"No active SCIM tokens.",description:"Message displayed on the table that shows SCIM tokens if there are no active tokens."})),styles:p})}async function rl(e){let{environment:t,spaceId:i}=e;return(await so.Yw({environment:t,table:pa.bx,id:i,type:"scim"})).botIds}const ll=function(e){let{botIds:t,setBotIds:i,spaceStore:n}=e;const o=(0,ke.O7)(),s=n.id;if((0,d.useEffect)((()=>{void 0===t&&rl({environment:o,spaceId:s}).then(i)}),[t,o,i,s]),t){const e=t.map((e=>ze.t1.createChildStore(n,{table:At.cZ,id:e,spaceId:s})));return a()(sl,{botStores:e,onRevokeToken:e=>{so.P0({environment:o,botId:e,onSuccess:()=>{rl({environment:o,spaceId:s}).then(i)}})}})}return a()(Re.Z,{})};function dl(e){let{userStore:t,spaceStore:i,promptUpgrade:n}=e;const[o,s]=(0,d.useState)(void 0),r=(0,ke.O7)(),l=(0,Te.VK)((()=>function(e){let{botIds:t,spaceStore:i,environment:n}=e;if(void 0===t)return"Undefined";const a=t.map((e=>ze.t1.createChildStore(i,{table:At.cZ,id:e,spaceId:i.id}))).filter((e=>e.isDefined()));if(a.some((e=>e.getCreatedByTable()===Kt.KJ&&e.getCreatedById()===Kt.s$.id)))return"SpaceHasExistingToken";if(a.some((e=>e.getCreatedByTable()===Kt.KJ&&e.getCreatedById()===n.currentUser.id)))return"UserHasExistingToken";return"Able"}({botIds:o,spaceStore:i,environment:r})),[o,r,i]),c=a()(f.FormattedMessage,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens",description:"Title describing how this section is for SCIM tokens."}),u=a()(f.FormattedMessage,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM.",description:"Byline describing how this section is for SCIM tokens."});return n?a()(or,{title:c,byline:u,targetTier:"enterprise"}):d.createElement(d.Fragment,null,a()(ir,{title:c,byline:u,settingItem:a()(Vr,{onNewScimToken:e=>s((t=>[...t??[],e])),spaceStore:i,userStore:t,tokenCreationAbility:l})}),a()(br.Z,{title:a()(f.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,W.UY)("guides.scim"),analyticsFrom:"scim_settings"}),a()(ll,{spaceStore:i,userStore:t,botIds:o,setBotIds:s}))}function cl(e){let{userStore:t,spaceStore:i}=e;window.__c={n:"ScimSection"};const n=(0,Te.VK)((()=>(0,q.wP)()),[]);return a()(dl,{promptUpgrade:!n,userStore:t,spaceStore:i})}function ul(e){let{primarySpaceName:t}=e;window.__c={n:"SecondaryWorkspaceNotice"};const i=(0,_e.yK)((e=>({container:{background:e.accentColors.blue[100],padding:"18px 24px",borderRadius:4,margin:"0 0 24px"}})),[]);return a()("div",{style:i.container},void 0,a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableTitle",defaultMessage:"The primary workspace is <bold>{primaryWorkspaceName}</bold>.",description:"Short message pointing out the primary workspace for this current workspace",values:{primaryWorkspaceName:t,bold:e=>a()("span",{style:{fontWeight:h.Z.fontWeight.semibold}},void 0,e)}})),a()("br",{}),a()(xe.Z,{isMultiline:!0},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableMessage",defaultMessage:"The domain management settings and SAML SSO configuration are being managed by the workspace <bold>{primaryWorkspaceName}</bold>. Please navigate there or contact an admin of that workspace to edit the verified domains or SSO configuration.",description:"Short message telling the customer that the current workspace has its SAML and domain settings being managed by another workspace.",values:{primaryWorkspaceName:t,bold:e=>a()("span",{style:{fontWeight:h.Z.fontWeight.semibold}},void 0,e)}})))}var pl=i(89101);function ml(e){let{children:t,gap:i}=e;window.__c={n:"Grid"};const n=(0,_e.yK)((e=>({root:{display:"grid",gridAutoColumns:"minmax(0, 1fr)",gridAutoFlow:"column",gap:i}})),[i]);return a()("div",{style:n.root},void 0,t)}function gl(e){let{children:t,row:i,rowEnd:n,col:o,colEnd:s}=e;window.__c={n:"GridCell"};const r=(0,_e.yK)((e=>({cell:{gridRowStart:i,gridRowEnd:n,gridColumnStart:o,gridColumnEnd:s}})),[i,n,o,s]);return a()("div",{style:r.cell},void 0,t)}function hl(e){let{spaceStore:t,isEnterprise:i}=e;window.__c={n:"SetupInformation"};const n=(0,f.useIntl)(),o=(0,Te.VK)((()=>t.id),[t]);return a()(ml,{gap:8},void 0,a()(gl,{row:1,col:1},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.workspaceId",defaultMessage:"Workspace ID",description:"Label next to copy workspace ID button"}))),a()(gl,{row:1,col:2},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0},void 0,a()(fl,{text:o,tooltip:n.formatMessage({id:"securitySAMLSettings.SetupInformationSection.workspaceId.copyTooltip",defaultMessage:"Click to copy ID",description:"Tooltip shown when hovering on copy workspace button"})}))),i?d.createElement(d.Fragment,null,a()(gl,{row:2,col:1},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityIDLink",defaultMessage:"SAML SSO/SAML Entity ID",description:"Label next to copy saml/sso entity ID button"}))),a()(gl,{row:2,col:2},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0},void 0,a()(fl,{text:(0,Cr.AE)(Qe.Z.domainBaseUrl),tooltip:n.formatMessage({id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityID.copyTooltip",defaultMessage:"Click to copy link",description:"Tooltip shown when hovering on copy saml/sso entity ID button"})}))),a()(gl,{row:3,col:1},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl",defaultMessage:"SCIM base URL",description:"Label next to copy scim base URL button"}))),a()(gl,{row:3,col:2},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0},void 0,a()(fl,{text:Qe.Z.domainBaseUrl+pl._j.scimApiBasePath,tooltip:n.formatMessage({id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl.copyTooltip",defaultMessage:"Click to copy link",description:"Tooltip shown when hovering on copy scim base URL button"})})))):null)}function fl(e){let{tooltip:t,text:i}=e;window.__c={n:"CopyableText"};const n=(0,ke.O7)();return a()(Oe.Z,{delayThreshold:0,renderTooltip:()=>t,render:e=>d.createElement(Ao.Z,s()({onClick:()=>{Mt.RD({environment:n,stringValue:i,copiedMessage:Mt.tq.copiedPropertyToClipboard})}},e),i)})}function vl(e){let{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o}=e;window.__c={n:"SettingsPage"};const s=(0,ke.O7)(),r=(0,Te.VK)((()=>Ie.Z.state.online),[]),{loadingSaml:l,loadedSaml:c,errorSaml:u}=(0,d.useContext)(ls),p=(0,Te.VK)((()=>function(e){let{environment:t,samlConfigStore:i,spaceStore:n}=e;const a=Js({environment:t,samlConfigStore:i}),o=!i.state.id||i.state.id===n.id;return a&&o}({environment:s,samlConfigStore:n,spaceStore:i})),[s,n,i]),m=(0,Te.VK)((()=>n.state.id?cs.Z.getPublicSpaceData(s,n.state.id):void 0),[s,n]),g=(0,_e.yK)((()=>({header:{marginTop:48}})),[]),h=(0,Te.VK)((()=>N.default.checkGate("enable_managed_users_dashboard")||N.default.checkGate("enable_set_email_domain_settings")),[]),v=(0,Te.VK)((()=>(0,q.wP)()),[]);return r?l?a()(Ze.Z,{},void 0,a()(Re.Z,{style:{margin:"0 auto"}})):u?(S.showErrorMessage(u.message),null):c?a()(Ze.Z,{},void 0,!p&&m?a()(ul,{primarySpaceName:m.name}):null,a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management",description:"Domain settings menu title"})),a()(pr,{spaceStore:i,samlConfigStore:n,domainSettingsStore:o}),h?d.createElement(d.Fragment,null,a()(Pe.Z,{large:!0,divider:"full",style:g.header},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.userManagement.title",defaultMessage:"User management",description:"User management settings menu title"})),a()(yr,{spaceStore:i,samlConfigStore:n,domainSettingsStore:o})):null,a()(Pe.Z,{large:!0,divider:"full",style:g.header},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML Single sign-on (SSO)",description:"SAML SSO settings menu title"})),a()(Or,{spaceStore:i,samlConfigStore:n,domainSettingsStore:o}),a()(Pe.Z,{large:!0,divider:"full",style:g.header},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning",description:"SCIM settings menu title"})),a()(cl,{userStore:t,spaceStore:i}),a()(Pe.Z,{large:!0,divider:"full",style:g.header},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.setupInfo.title",defaultMessage:"Setup information",description:"Setup information settings menu title"})),a()(hl,{spaceStore:i,isEnterprise:v})):null:a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,a()(f.FormattedMessage,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message",description:"Offline message for the Identity and Provisioning settings menu"})))}function yl(e,t){return(void 0===e||!(0,m.XR)(e))&&(!(void 0===e||!(0,m.TZ)(e)||0!==t)||1===t)}var bl=i(47425),Sl=i(63143),wl=i(27242),Ml=i(73420);function Cl(){return window.__c={n:"PendingSpaceClaimMessage"},a()(Oe.Z,{renderTooltip:()=>a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceClaim.Explanation",defaultMessage:"Workspace claim request is being processed.",description:"Indicator that the space in this row is in a pending state for being claimed."}),render:e=>d.createElement(xe.Z,e,a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingClaim",defaultMessage:"Pending",description:"Indicator that the space in this row is in a pending state for being claimed."}))})}function kl(e){let{admin:t}=e;window.__c={n:"PendingSpaceTransferMessage"};const i=(0,f.useIntl)();return a()(Oe.Z,{renderTooltip:()=>a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceTransferExplanation",defaultMessage:"Waiting for {name} to transfer the workspace to an external account.",description:"Indicator that the space in this row is in a pending state for being transferred.",values:{name:(0,qt.Nz)(i,t)}}),render:e=>d.createElement(xe.Z,e,a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingTransfer",defaultMessage:"Pending",description:"Indicator that the space in this row is in a pending state for being transferred."}))})}let Tl;function _l(e){window.__c={n:"SpaceActionsMenu"};const{space:t,mode:i}=e,n=(0,Te.qz)(void 0,Tt.Z),o=(0,_e.yK)((()=>({container:{minWidth:325}})),[]);return i===Tl.Single?a()(xl,{action:e.action,space:t}):a()(xt.Z,{popupType:st.kQ.Popup,style:o.container,buttonPopupStore:n,renderOrigin:e=>d.createElement(Zt.Z,s()({icon:Ge.Z.dots},e)),render:()=>a()(Il,{space:t,actions:e.actions,popupStore:n})})}function Il(e){let{space:t,actions:i,popupStore:n}=e;window.__c={n:"ActionsMenu"};const o={key:"workspace-actions",render:e=>d.createElement(rt.Z,e),items:i.map((e=>{const i=!!e.getDisabledState&&e.getDisabledState(t),n=e.getTooltip?e.getTooltip(t):null;return{key:e.id,render:t=>a()(Oe.Z,{render:n=>d.createElement(ys.Z,s()({},t,n,{shouldWrapCaption:!0,svg:t=>e.getIcon(t),title:e.name,caption:e.caption,style:{paddingTop:8,paddingBottom:8,opacity:i?.5:1},disabled:i})),renderTooltip:()=>n,disableTooltip:!Boolean(n),placement:Oe.Z.Placement.Left}),action:()=>e.onAction(t)}}))};return a()(at.Z,{menuType:Je.og.Popup},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:[o],onAccept:()=>{n.setState({open:!1})}}))}function xl(e){window.__c={n:"SingleSpaceActionButton"};const{action:t,space:i}=e,n=(0,_e.yK)((e=>({button:{paddingLeft:5,paddingRight:5}})),[]),o=d.useCallback((()=>{t.onAction(i)}),[t,i]);return a()($e.Z,{isSmall:!0,style:n.button,onClick:o},void 0,t.name)}function Zl(e){let{id:t,name:i,icon:n,subscriptionTier:o,memberCount:s,highlightIconContainer:r}=e;window.__c={n:"SpaceSummary"};const l=(0,f.useIntl)(),d=n?{pointer:{table:pa.bx,id:t,spaceId:t},icon:n}:void 0,c=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%"},summaryContainer:{width:"calc(100% - 38px)"},iconContainer:{height:38,width:38,flexGrow:0,flexShrink:0,flexBasis:38,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",background:r?e.selectLightGray[50]:void 0,borderRadius:6},name:{fontSize:14,fontWeight:500},byline:{fontSize:12,opacity:.5}})),[r]);return a()("div",{style:c.container},void 0,a()("div",{style:c.iconContainer},void 0,a()(Ke.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:32,title:i,isLarge:!0,emojiSize:28,isRaw:!1})),a()("div",{style:c.summaryContainer},void 0,a()(xe.Z,{style:c.name,showTooltipWhenTruncated:!0},void 0,i),a()(xe.Z,{style:c.byline},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.summaryByline",defaultMessage:"{subscriptionTier} · {memberCount, plural, one {{memberCount} member} other {{memberCount} members}}",description:"Label for the workspace indicating number of workspace members and workspace plan type.",values:{subscriptionTier:Pl(o,l),memberCount:s}}))))}function Pl(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(K.MB.free);case"personal":return t.formatMessage(K.MB.personal);case"plus":case"team":return t.formatMessage(K.MB.plusPlan);case"business":return t.formatMessage(K.MB.business);default:(0,T.t1)(e)}}function Fl(e){let{users:t,deletedUserEmailDomain:i}=e;window.__c={n:"SpaceUsers"};const n=(0,Te.qz)(void 0,Tt.Z),o=(0,_e.yK)((()=>({container:{minWidth:275}})),[]);return a()(xt.Z,{popupType:st.kQ.Popup,style:o.container,buttonPopupStore:n,renderOrigin:e=>d.createElement(El,s()({users:t,deletedUserEmailDomain:i},e)),render:()=>a()(Al,{users:t,popupStore:n})})}function Al(e){let{users:t,popupStore:i}=e;window.__c={n:"WorkspaceUsersMenu"};const n=(0,ke.O7)(),o={key:"workspace-users-menu",render:e=>d.createElement(rt.Z,e),items:t.map((e=>({key:e.id,render:t=>d.createElement(Bl,s()({user:e},t)),action:()=>w.navigateToExternalURL({environment:n,url:`mailto:${e.email}`})})))};return a()(at.Z,{menuType:Je.og.Popup},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:0,sections:[o],onAccept:()=>{i.setState({open:!1})}}))}function Bl(e){let{user:t,...i}=e;window.__c={n:"EmailableUserSummary"};const n=(0,f.useIntl)(),o=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8,margin:"0 6px"},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return d.createElement($e.Z,s()({style:o.container},i),a()("div",{style:o.avatarContainer},void 0,a()(Ht.Z,{userValue:t,size:24})),a()("div",{style:o.nameContainer},void 0,a()(xe.Z,{style:o.name},void 0,(0,qt.Nz)(n,t)),a()(xe.Z,{style:o.email},void 0,t.email)),a()("div",{style:o.copyContainer},void 0,Ge.Z.mail({height:18,width:18})))}function El(e){let{users:t,deletedUserEmailDomain:i,...n}=e;window.__c={n:"MultiUsersDisplay"};const o=(0,f.useIntl)(),r=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginLeft:"-8px",maxWidth:"100%"},empty:{fontSize:14,maxWidth:150,opacity:.5},name:{fontSize:14,maxWidth:150},plusMore:{opacity:.5,display:"inline"}})),[]);return 0===t.length?a()(Oe.Z,{render:e=>d.createElement($e.Z,s()({style:r.container,disabled:!0},n,e),a()(xe.Z,{style:r.empty},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.empty",defaultMessage:"Deleted user",description:"Empty state for when there are no users to display."}))),disableTooltip:!i,renderTooltip:()=>a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.emptyTooltip",defaultMessage:"Deleted user from {domain}",description:"Detailed empty state for when there are no users to display.",values:{domain:`@${i}`}})}):d.createElement($e.Z,s()({style:r.container},n),a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.name",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} <gray>+{remainingCount}</gray>} other {{firstUser} <gray>+{remainingCount}</gray>}}",description:"Shows the name of the first user in the list, followed by the number of additional users left that are not shown.",values:{firstUser:(0,qt.Nz)(o,t[0]),remainingCount:t.length-1,gray:e=>a()(xe.Z,{style:r.plusMore},void 0,e)}})))}!function(e){e.Single="single",e.Multi="multi"}(Tl||(Tl={}));const Dl=[{id:"spaces",headerTitle:a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.name",defaultMessage:"Workspaces",description:"Header for the name column in the unauthorized workspaces table."}),renderCell:e=>a()(Zl,{id:e.space.id,name:e.space.name,icon:e.space.icon,subscriptionTier:e.space.subscriptionTier,memberCount:e.space.memberCount}),widthData:{width:60},sortable:!1},{id:"admins",headerTitle:a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.admins",defaultMessage:"Workspace owners",description:"Header for the workspace owners column in the unauthorized workspaces table."}),renderCell:e=>a()(Fl,{users:e.space.admins}),widthData:{width:40},sortable:!1},{id:"createdBy",headerTitle:a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdBy",defaultMessage:"Created by",description:"Header for the created by column in the unauthorized workspaces table."}),renderCell:e=>e.space.creator?a()(Fl,{users:[e.space.creator]}):a()(Fl,{users:[],deletedUserEmailDomain:e.space.creatorEmailDomain}),widthData:{width:40},sortable:!1},{id:"createdAt",headerTitle:a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdAt",defaultMessage:"Created date",description:"Header for the created date column in the unauthorized workspaces table."}),renderCell:e=>a()(xe.Z,{style:{opacity:.5}},void 0,(0,Le.gs)(e.space.createdAt)),widthData:{width:30},sortable:!1},{id:"action",headerTitle:null,renderCell:e=>{if((0,m.DI)(e.space.spaceRequest))return a()(kl,{admin:e.space.admins[0]});if((0,m.XR)(e.space.spaceRequest))return a()(Cl,{});if((0,m.TZ)(e.space.spaceRequest)){const t=e.actions.find((e=>"recover-space"===e.id));return t&&a()(_l,{space:e.space,action:t,mode:Tl.Single})}return e.actions.length>0?a()(_l,{space:e.space,actions:e.actions.filter((e=>"recover-space"!==e.id)),mode:Tl.Multi}):null},widthData:{width:15},sortable:!1}];function Rl(e){let{claimableSpaces:t,spaceActions:i,loadMoreClaimableSpaces:n,loading:o}=e;const s=t.map((e=>({id:e.id,isClickable:!1,space:e,actions:i}))),r=(0,_e.yK)((e=>(0,De.b)({columnRenderInfo:Dl,theme:e,containerMarginTop:0})),[]);return d.createElement(d.Fragment,null,a()(De.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Dl,rows:s,renderNoRowsComponent:()=>a()(xe.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,!o&&a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.empty",defaultMessage:"No claimable workspaces.",description:"Message displayed on the table that shows workspaces if there are no workspaces to show."})),styles:r,getStyleForRow:function(e){if((0,m.DI)(e.space.spaceRequest)||(0,m.XR)(e.space.spaceRequest)||(0,m.TZ)(e.space.spaceRequest))return{opacity:.5}},onScrollBottom:n}),o&&a()(Re.Z,{style:{margin:"24px auto 24px"}}))}var Ll=i(33728),Ol=i(16354);const Nl=(0,f.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.placeholder",defaultMessage:"it@example.com",description:"Placeholder text for it contact email address"}}),Vl=e=>{let{onDismiss:t,spaceQueuedForTransfer:i,currentSpaceId:n}=e;window.__c={n:"PersonalTransferSpaceConfirmationModal"};const[o,s]=(0,d.useState)(),[r,l]=(0,d.useState)(!1),{setSpaceRequest:c}=(0,d.useContext)(ls),u=(0,ke.O7)(),p=(0,_e.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:h.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:h.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},dividerContainer:{marginTop:20},dividerInner:{borderBottomColor:e.regularDividerColor},contactEmailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},contactEmailTitle:{fontWeight:h.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},primaryButton:{width:"100%",marginTop:32},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:h.Z.fontWeight.medium,color:e.lightTextColor},buttonCaptionError:{color:e.errorText,marginTop:8,fontSize:13}})),[]),m=Boolean(i);return a()($o.Z,{open:m,innerStyle:p.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>d.createElement(d.Fragment,null,a()("div",{style:p.closeIconContainer},void 0,a()($e.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0},void 0,Ge.Z.closeSmall(p.closeIcon))),a()("div",{},void 0,Ge.Z.personBadgeExclamationMark(p.modalIcon)),a()(xe.Z,{style:p.title},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.selfServe.title",defaultMessage:"Require account change",description:"Title for the transfer workspace modal."}),a()(Ol.Z,{href:(0,W.UY)("guides.domainManagement")},void 0,a()(Zt.Z,{icon:Ge.Z.help}))),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:p.description},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.byline",defaultMessage:"You’re about to require the Workspace Owner of 1 workspace to use an external Notion accounts. They will be unable to use the workspace until the change is made.",description:"Details explaining what it means to transfer a workspace."})),a()("div",{style:p.workspaceContainer},void 0,i?a()(Zl,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):null,a()("div",{style:p.checkContainer},void 0,Ge.Z.thinCheck(p.check))),a()(Fo.Z,{size:"100%",innerStyle:p.dividerInner,style:p.dividerContainer}),a()("div",{style:p.contactEmailContainer},void 0,a()(xe.Z,{style:p.contactEmailTitle},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.title",defaultMessage:"Send request from",description:"Title for contact email input field"}),a()(Oe.Z,{renderTooltip:()=>a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingExplanation",defaultMessage:"The Workspace Owner can contact this email for inquiries",description:"Explanation that email is for unmanaged workspace owner to reach out admin for questions about the request."}),render:e=>d.createElement("span",e,Ge.Z.help(p.helpIcon))})),a()(Li.Z,{value:o,placeholder:V.default.formatMessage(Nl.emailPlaceholder),onChange:e=>{l(!1),s(e.target.value)}}),r&&a()(xe.Z,{isSmall:!0,style:p.buttonCaptionError},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.error",defaultMessage:"Invalid email address",description:"Error for missing or invalid email address"}))),a()(je.Z,{isLarge:!0,style:p.primaryButton,onClick:async()=>{const e=(0,Ll.H3)(o);var s;if((0,Ll.oH)(e)){if(i&&e){const o=await ge.initiateWorkspaceTransfer(u,{requestingSpaceId:n,targetSpaceId:i.id,contactEmail:e});if("failed"===o.type)S.showErrorMessage(o.error.message);else{const n=o.data.workspaceTransfer;c(i.id,n),b.azK(u,{contactEmail:e,currentOwners:i.admins.map((e=>e.id)),targetSpaceId:i.id,verifiedDomain:i.creatorEmailDomain,subscriptionTier:i.subscriptionTier}),t(),s=i.name,Ws.oV({label:a()(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.toast",defaultMessage:"Account change successfully requested for “{spaceName}“",description:"Message in toast to indicate a workspace transfer has been successfully requested.",values:{spaceName:s}})})}}}else l(!0)}},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.confirm",defaultMessage:"Confirm change",description:"Primary action for initiating the transfer process."})),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:p.buttonCaption},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.buttonCaption",defaultMessage:"This cannot be undone",description:"Button caption about the timeline"})),a()($e.Z,{style:p.secondaryButton,onClick:t},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.cancel",defaultMessage:"Cancel",description:"Canceling the current action"})))})};const Ul=e=>{let{onDismiss:t,spaceQueuedForClaiming:i,requestingSpaceId:n}=e;window.__c={n:"SalesAssistedClaimSpaceConfirmationModal"};const o=(0,ke.O7)(),{setSpaceRequest:s}=(0,d.useContext)(ls),r=(0,_e.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},title:{fontWeight:h.Z.fontWeight.medium,fontSize:16,marginBottom:8,display:"inline-flex",alignItems:"center",justifyContent:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:h.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:h.Z.fontWeight.medium,color:e.lightTextColor},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12}})),[]),l=Boolean(i),c=async()=>{if(!i)return;const e=await ge.requestClaimAndUpgrade(o,{requestingSpaceId:n,targetSpaceId:i.id});var r;"failed"===e.type?S.showError(e):(b.eO1(o,{currentOwners:i.admins.map((e=>e.id)),targetSpaceId:i.id,verifiedDomain:i.creatorEmailDomain,memberCount:i.memberCount}),s(i.id,e.data.spaceRequest),r=i.name,Ws.oV({label:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.toast",defaultMessage:"Workspace claim successfully requested for “{spaceName}“",description:"Message in toast to indicate a workspace claim has been successfully requested.",values:{spaceName:r}})})),t()};return a()($o.Z,{open:l,innerStyle:r.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>d.createElement(d.Fragment,null,a()("div",{style:r.closeIconContainer},void 0,a()($e.Z,{isSmall:!0,onClick:t},void 0,Ge.Z.closeSmall(r.closeIcon))),a()(xe.Z,{style:r.title},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.title",defaultMessage:"Request workspace claim",description:"Title for the claim workspace modal."}),a()(Ol.Z,{href:(0,W.UY)("guides.domainManagement")},void 0,a()(Zt.Z,{icon:Ge.Z.help}))),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:r.description},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",description:"Details explaining what it means to claim and upgrade a workspace.",values:{currentWorkspaceName:i?i.name:"the workspace below"}})),a()("div",{style:r.workspaceContainer},void 0,i?a()(Zl,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):null,a()("div",{style:r.checkContainer},void 0,Ge.Z.thinCheck(r.check))),a()(je.Z,{isLarge:!0,style:r.primaryButton,onClick:c},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.sendRequest",defaultMessage:"Send request",description:"Primary action for continuing the claim process to the payment step."})),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:r.buttonCaption},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.buttonCaption",defaultMessage:"This request may take a few days to process. For more information, contact your <accountmanageremail>Account Management team</accountmanageremail>.",description:"Button caption about the timeline",values:{accountmanageremail:e=>a()(Ao.Z,{href:"mailto:am@makenotion.com"},void 0,e)}})),a()($e.Z,{style:r.secondaryButton,onClick:t},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.cancel",defaultMessage:"Cancel",description:"Canceling the current action"})))})};const Wl=e=>{let{onDismiss:t,spaceQueuedForClaiming:i}=e;window.__c={n:"SelfServeClaimSpaceConfirmationModal"};const n=(0,_e.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:h.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:h.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:h.Z.fontWeight.medium,color:e.lightTextColor}})),[]),o=Boolean(i);return a()($o.Z,{open:o,innerStyle:n.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>d.createElement(d.Fragment,null,a()("div",{style:n.closeIconContainer},void 0,a()($e.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0},void 0,Ge.Z.closeSmall(n.closeIcon))),a()("div",{},void 0,Ge.Z.arrowUpCircled(n.modalIcon)),a()(xe.Z,{style:n.title},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.title",defaultMessage:"Claim workspace",description:"Title for the claim workspace modal."}),a()(Ol.Z,{href:(0,W.UY)("guides.domainManagement")},void 0,a()(Zt.Z,{icon:Ge.Z.help}))),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:n.description},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",description:"Details explaining what it means to claim and upgrade a workspace.",values:{currentWorkspaceName:i?i.name:"the workspace below"}})),a()("div",{style:n.workspaceContainer},void 0,i?a()(Zl,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):null,a()("div",{style:n.checkContainer},void 0,Ge.Z.thinCheck(n.check))),a()(je.Z,{isLarge:!0,style:n.primaryButton,onClick:()=>{i&&k.Xb(i)}},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.reviewAndPay",defaultMessage:"Review and pay",description:"Primary action for continuing the claim process to the payment step."})),a()($e.Z,{style:n.secondaryButton,onClick:t},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.cancel",defaultMessage:"Cancel",description:"Canceling the current action"})))})},zl=(0,f.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.placeholder",defaultMessage:"it@example.com",description:"Placeholder text for IT contact email address"}}),Kl=e=>{let{onDismiss:t,spaceQueuedForDeletion:i,currentSpaceId:n}=e;window.__c={n:"SpaceDeletionConfirmationModal"};const[o,s]=(0,d.useState)({email:void 0,didError:!1}),[r,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!1),{setSpaceRequest:p}=(0,d.useContext)(ls),m=(0,_e.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],height:24,width:24},title:{fontWeight:h.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:h.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},checkboxContainer:{display:"inline-flex",marginTop:8,alignItems:"center"},checkbox:{color:"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[200],marginRight:8},primaryButton:{width:"100%",marginTop:32,background:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],justifyContent:"center",fontWeight:h.Z.fontWeight.medium,color:ho.ZP.white},primaryButtonHovered:{background:"dark"===e.mode?(0,ho._j)(e.accentColors.red[700],.3):(0,ho._j)(e.accentColors.red[500],.3)},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:h.Z.fontWeight.medium,color:e.lightTextColor},checkboxCaption:{color:e.mediumTextColor,textAlign:"center",fontSize:12},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),g=(0,ke.O7)(),v=(0,d.useCallback)((()=>{s({email:void 0,didError:!1}),l(!1),u(!1),t()}),[t]),y=(0,d.useCallback)((e=>{s({didError:!1,email:e.target.value})}),[]),w=(0,d.useCallback)((()=>l((e=>!e))),[]),M=(0,d.useCallback)((async()=>{const e=(0,Ll.H3)(o.email);if(!(0,Ll.oH)(e))return void s({...o,didError:!0});if(!i)return;u(!0);const t=await ge.deleteSpaceForDomain(g,{requestingSpaceId:n,targetSpaceId:i.id,contactEmail:e});if("failed"===t.type)u(!1),S.showErrorMessage(t.error.message);else{const n=t.data.spaceDeletion;p(i.id,n),b.QFO(g,{contactEmail:e,currentOwners:i.admins.map((e=>e.id)),targetSpaceId:i.id,verifiedDomain:i.creatorEmailDomain,targetSubscriptionTier:i.subscriptionTier}),v(),r=i.name,Ws.oV({label:a()(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.toast",defaultMessage:"Successfully deleted “{spaceName}“",description:"Message in toast to indicate a workspace has been successfully deleted.",values:{spaceName:r}})})}var r}),[v,o,n,g,p,i]),C=Boolean(i);return a()($o.Z,{open:C,innerStyle:m.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:v,render:()=>d.createElement(d.Fragment,null,a()("div",{style:m.closeIconContainer},void 0,a()($e.Z,{isSmall:!0,onClick:v,ignoreLocalHoverState:!0},void 0,Ge.Z.closeSmall(m.closeIcon))),a()("div",{},void 0,Ge.Z.trash(m.modalIcon)),a()(xe.Z,{style:m.title},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.title",defaultMessage:"Delete workspace",description:"Title for the delete workspace modal."}),a()(Ol.Z,{href:(0,W.UY)("guides.domainManagement")},void 0,a()(Zt.Z,{icon:Ge.Z.help}))),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:m.description},void 0,i?a()(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.byline",defaultMessage:"You’re about to permanently delete {currentWorkspaceName} and all of its contents. The workspace owner will be notified.",description:"Details explaining what it means to delete the workspace.",values:{currentWorkspaceName:i.name}}):void 0),a()("div",{style:m.workspaceContainer},void 0,i?a()(Zl,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):void 0,a()("div",{style:m.checkContainer},void 0,Ge.Z.thinCheck(m.check))),a()(Fo.Z,{size:0,style:m.dividerContainer,innerStyle:m.divider}),a()(ql,{value:o.email,placeholder:V.default.formatMessage(zl.emailPlaceholder),onChange:y,labelMessage:a()(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.title",defaultMessage:"Contact email",description:"Title for contact email input field"}),helpMessage:a()(f.FormattedMessage,{id:"identityAndProvisioning.deleteWorkspaces.deletionModal.tooltipExplanation",defaultMessage:"The Workspace Owner of the deleted workspace can contact this email for inquiries",description:"Explanation that email is for unmanaged workspace owner to reach out admin for questions about the request."}),errorMessage:o.didError?a()(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.error",defaultMessage:"Invalid email address",description:"Error message for missing or invalid email address."}):void 0}),a()($e.Z,{disabled:!r||!o.email||c,disabledFeedback:!0,isLarge:!0,style:m.primaryButton,hoveredStyle:m.primaryButtonHovered,onClick:M},void 0,c?a()(Re.Z,{}):a()(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.deleteButton",defaultMessage:"Delete workspace",description:"Button prompting the user to delete the workspace"})),a()("div",{style:m.checkboxContainer},void 0,a()(nt.Z,{style:m.checkbox,size:14,checked:r,onClick:w}),a()(xe.Z,{isSmall:!0,style:m.checkboxCaption},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.checkboxLabel",defaultMessage:"I'm sure I want to delete this workspace",description:"Label for checkbox confirming the user wants to delete the workspace"}))),a()($e.Z,{style:m.secondaryButton,onClick:v},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.cancel",defaultMessage:"Cancel",description:"Canceling the current action"})))})};function ql(e){window.__c={n:"EmailInput"};const t=(0,_e.yK)((e=>({emailInputTitle:{fontWeight:h.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},emailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},inputCaptionError:{color:e.errorText,marginTop:8,fontSize:13},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16}})),[]);return a()("div",{style:t.emailContainer},void 0,a()(xe.Z,{style:t.emailInputTitle},void 0,e.labelMessage,e.helpMessage&&a()(Oe.Z,{renderTooltip:()=>e.helpMessage,render:e=>d.createElement("span",e,Ge.Z.help(t.helpIcon))})),a()(Li.Z,{value:e.value,placeholder:e.placeholder,onChange:e.onChange}),e.errorMessage&&a()(xe.Z,{isSmall:!0,style:t.inputCaptionError},void 0,e.errorMessage))}const Hl=e=>{let{onDismiss:t,onAccept:i,spaceQueued:n,descriptionMessage:o,divider:s,modalIcon:r,title:l,acceptMessage:c,isLoading:u}=e;window.__c={n:"ClaimableSpaceConfirmationModal"};const p=(0,_e.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{height:24,width:24,fill:e.mediumIconColor},title:{fontWeight:h.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:h.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32,justifyContent:"center",fontWeight:h.Z.fontWeight.medium},secondaryButton:{margin:"8px auto 0",width:"100%",justifyContent:"center",fontWeight:h.Z.fontWeight.medium,color:e.lightTextColor},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),m=Boolean(n);return a()($o.Z,{open:m,innerStyle:p.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>d.createElement(d.Fragment,null,a()("div",{style:p.closeIconContainer},void 0,a()($e.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0},void 0,Ge.Z.closeSmall(p.closeIcon))),r&&a()("div",{},void 0,r(p.modalIcon)),a()(xe.Z,{style:p.title},void 0,l,a()(Ol.Z,{href:(0,W.UY)("guides.domainManagement")},void 0,a()(Zt.Z,{icon:Ge.Z.help}))),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:p.description},void 0,o),a()("div",{style:p.workspaceContainer},void 0,n?a()(Zl,{id:n.id,name:n.name,icon:n.icon,subscriptionTier:n.subscriptionTier,memberCount:n.memberCount}):void 0,a()("div",{style:p.checkContainer},void 0,Ge.Z.thinCheck(p.check))),s&&a()(Fo.Z,{size:0,style:p.dividerContainer,innerStyle:p.divider}),a()(je.Z,{isLarge:!0,style:p.primaryButton,onClick:i,disabled:u},void 0,u?a()(Re.Z,{}):c),a()($e.Z,{style:p.secondaryButton,onClick:t},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimableSpaceConfirmationModal.cancel",defaultMessage:"Cancel",description:"Canceling the current action"})))})};const Gl=e=>{let{onDismiss:t,spaceQueuedForRecovery:i,currentSpaceId:n}=e;window.__c={n:"SpaceRecoveryConfirmationModal"};const{setSpaceRequest:o}=(0,d.useContext)(ls),s=(0,ke.O7)(),[r,l]=(0,d.useState)(!1),c=(0,d.useCallback)((()=>{l(!1),t()}),[t]),u=(0,d.useCallback)((async()=>{if(!n||!i)return;l(!0);const e=await ge.cancelSpaceDeletionForDomain(s,{requestingSpaceId:n,targetSpaceId:i.id});if("failed"===e.type)return l(!1),void S.showErrorMessage(e.error.message);var t;o(i.id,void 0),b.JvT(s,{targetSpaceId:i.id,verifiedDomain:i.creatorEmailDomain}),c(),t=i.name,Ws.oV({label:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.table.recoverSpace.toast",defaultMessage:"Successfully recovered “{spaceName}“",description:"Message in toast to indicate a workspace was successfully recovered.",values:{spaceName:t}})})}),[o,n,s,i,c]);return a()(Hl,{onDismiss:c,onAccept:u,spaceQueued:i,modalIcon:Ge.Z.showDeletedPages,title:a()(f.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.title",defaultMessage:"Recover workspace",description:"Title for the recover workspace modal."}),descriptionMessage:i?a()(f.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.byline",defaultMessage:"Restore workspace content and the workspace owner's access.",description:"Details explaining what it means to recover the workspace.",values:{currentWorkspaceName:i.name}}):void 0,acceptMessage:a()(f.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.deleteButton",defaultMessage:"Recover",description:"Button prompting the user to recover the workspace"}),isLoading:r,divider:!1})};function jl(e){let{spaceStore:t}=e;window.__c={n:"WorkspacesPage"};const{claimableSpaces:i,domainVerifications:n,loadingSpaces:o,errorClaimableSpaces:s,errorVerifications:r,navigateTo:l,removeClaimableSpace:c,loadMoreClaimableSpaces:u,tab:p,setSelectedTab:m,verifiedDomains:g}=(0,d.useContext)(ls),v=(0,ke.O7)(),y=(0,Te.VK)((()=>!wl.Z.state.open&&Boolean(wl.Z.state.succeeded)),[]),[b,w]=(0,d.useState)(),[M,C]=(0,d.useState)(),[k,T]=(0,d.useState)(),[_,I]=(0,d.useState)(),x=(0,Te.VK)((()=>K.Q6(Se.default.state.data)),[]);function Z(){w(void 0),C(void 0),T(void 0),I(void 0)}(0,d.useEffect)((()=>{y&&b&&(c(b.id),w(void 0),wl.Z.reset())}),[y,b,c,w]);const P=(0,_e.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:h.Z.fontWeight.semibold,fontSize:17},byline:{fontSize:14,fontWeight:h.Z.fontWeight.regular,color:e.mediumTextColor,marginRight:"auto",paddingRight:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"}})),[]);if(s)return S.showErrorMessage(s.message),null;if(r)return S.showErrorMessage(r.message),null;const F=i.filter((e=>yl(e.spaceRequest,e.memberCount))),A=i.filter((e=>!yl(e.spaceRequest,e.memberCount))),B=[{id:"external-transfer",getIcon:e=>Ge.Z.arrowsDiverging({...e,height:14,width:14}),name:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransfer",defaultMessage:"Require account change",description:"Button option for starting an external transfer of this workspace's ownership."}),caption:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransferCaption",defaultMessage:"Owner will be prompted to change workspace ownership to a personal account.",description:"Caption for the external transfer button."}),onAction:e=>C(e)},{id:"space-deletion",getIcon:e=>Ge.Z.trash({...e,height:14,width:14}),name:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace",defaultMessage:"Delete workspace",description:"Button option for deleting a workspace."}),caption:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpaceCaption",defaultMessage:"Owner will lose access to the workspace immediately.",description:"Caption for the delete workspace button."}),onAction:e=>T(e),getDisabledState:e=>{const{isEligible:t}=$l(n,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling||!(0,bl.QM)(e.subscriptionTier)},getTooltip:e=>{const t=$l(n,e.creatorEmailDomain);return t.isEligible?!(0,bl.QM)(e.subscriptionTier)||e.isDelinquent||e.isPendingBilling?a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for deletion.",description:"Tooltip informing users that workspace is ineligible for deletion "}):void 0:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:a()("br",{})},description:"Tooltip explaining that this feature is disabled for some amount of time."})}},{id:"recover-space",getIcon:()=>{},name:a()(f.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.actions.recoverSpace",defaultMessage:"Recover",description:"Button that allows the Enterprise workspace owner to recover the space they deleted."}),caption:void 0,onAction:e=>I(e)}],E=[{id:"claim-and-upgrade",getIcon:e=>Ge.Z.arrowUpCircled({...e,height:14,width:14}),name:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgrade",defaultMessage:"Claim and upgrade",description:"Button option for starting a claim and upgrade workflow for the selected workspace."}),caption:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgradeCaption",defaultMessage:"Take ownership of the workspace and upgrade it to an Enterprise plan",description:"Caption for the claim and upgrade button."}),onAction:e=>w(e),getDisabledState:e=>{const{isEligible:t}=$l(n,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling},getTooltip:e=>{const t=$l(n,e.creatorEmailDomain);return e.isDelinquent||e.isPendingBilling?a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for claiming.",description:"Tooltip informing users that workspace is ineligible for claiming "}):t.isEligible?void 0:a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:a()("br",{})},description:"Tooltip explaining that this feature is disabled for some amount of time."})}}];return a()(Ze.Z,{},void 0,a()(Ao.Z,{style:P.link,onClick:()=>l(as)},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.breadcrumb",defaultMessage:"← Identity & Provisioning",description:"Link for navigating back to the previous 'Identity & Provisioning' settings page."})),a()(Pe.Z,{large:!0,style:P.title},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.title",defaultMessage:"Manage workspaces",description:"Title for the manage workspaces section."})),a()(Ml.X2,{},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0,style:P.byline},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.byline",defaultMessage:"Claim verified-domain workspaces to your Enterprise plan or require Owners to use an external domain.",description:"Byline for the claim workspaces section."})),a()(Ae.Z,{isLarge:!0,onClick:()=>{Fe.g({environment:v,data:{spaceId:t.id,emailDomains:g}})}},void 0,a()(f.FormattedMessage,{id:"identityProvisioningSettings.exportClaimableWorkspaces.button",defaultMessage:"Export to CSV",description:"Button to export info of claimable workspace into CSV."}))),a()(Eo.Z,{tabs:[a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.singleSpaces",defaultMessage:"Single-member",description:"Title for the table that shows all claimable single member workspaces."},"single"),a()(f.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.multiSpaces",defaultMessage:"Multi-member",description:"Title for the table that shows all claimable multi-member workspaces."},"multi")],selectedIndex:p,onChange:e=>m(e),style:P.tabBarMenu}),a()(Vl,{onDismiss:Z,spaceQueuedForTransfer:M,currentSpaceId:t.id}),p===rs.Single?a()(Rl,{claimableSpaces:F,spaceActions:B,loadMoreClaimableSpaces:u,loading:o},"single"):a()(Rl,{claimableSpaces:A,spaceActions:E,loadMoreClaimableSpaces:u,loading:o},"multi"),x?a()(Ul,{onDismiss:Z,spaceQueuedForClaiming:b,requestingSpaceId:t.id}):a()(Wl,{onDismiss:Z,spaceQueuedForClaiming:b}),a()(Kl,{onDismiss:Z,spaceQueuedForDeletion:k,currentSpaceId:t.id}),a()(Gl,{onDismiss:Z,spaceQueuedForRecovery:_,currentSpaceId:t.id}))}function $l(e,t){const i=e.find((e=>{let{domain:i}=e;return t===i}));if(!i||!i.verified_at)return{isEligible:!0};const n=(Date.now()-i.verified_at)/Sl.A0;return n>=14?{isEligible:!0}:{isEligible:!1,daysUntilEligible:Math.ceil(14-n)}}function Yl(e){let{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o}=e;const{page:s}=(0,d.useContext)(ls),r=(0,Te.VK)((()=>N.default.checkGate("enable_managed_users_dashboard")),[]);switch(s){case as:return a()(vl,{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o});case os:return a()(jl,{spaceStore:i});case ss:return r?a()(Xs,{spaceStore:i,samlConfigStore:n}):a()(vl,{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o})}}const Ql=function(e){let{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o}=e;return window.__c={n:"IdentityProvisioningTab"},a()(ds,{spaceStore:i,samlConfigStore:n,domainSettingsStore:o},void 0,a()(Yl,{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o}))};var Xl=i(41311),Jl=i(22756),ed=i(1800),td=(i(40902),i(99036),i(41432),i(23482),i(74446));i(6287),i(18844),i(70279);i(58129),i(70921),i(30842),i(39050),i(88179),i(80926),i(98963),i(7470),i(60014),i(13493),i(75908),i(6359);var id=i(7678),nd=(i(73409),i(60897));i(33709),i(44312),i(4986),i(52719),i(58912),i(73387),i(36077),i(97715),i(32161),i(82447),i(49953),i(14710),i(62643),i(57883),i(66726),i(30754),i(6946),i(25753),i(84683),i(38429),i(65311),i(16427),i(70017),i(89470),i(49126),i(4137),i(80396),i(24836),i(86135),i(78929),i(84323),i(83200),i(67627),i(65963),i(14130),i(34406),i(42314),i(16663),i(19221),i(93646),i(63787),i(38952),i(40837),i(96740),i(55514),i(75990),i(57829),i(63188),i(56877),i(76413),i(47238),i(77858),i(37202),i(26195),i(60113),i(14718),i(14327),i(53412),i(65836),i(5505),i(66295),i(10354),i(19716),i(98897),i(63408),i(66079),i(58161),i(28182),i(35794),i(73360);i(38297),i(98459);const ad=ln.Ak.create();Date.now();const od=td.mF.fromRecordMap(ad);td.zF.fromRecordMap(ad),Wr.om.fromRecordMap(ad);var sd=i(30397),rd=i(29551);const ld=function(){const e=(0,Te.VK)((()=>Jl.Z.state),[]);return e.result?d.createElement(d.Fragment,null,a()(xe.Z,{isMultiline:!0},void 0,a()(f.FormattedMessage,{id:"asanaImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported.",description:"Text confirming that user's asana data has been imported."})),a()("div",{style:{marginTop:32}},void 0,e.result.map((e=>a()(dd,{importStatus:e},e.asanaTeamId))))):d.createElement(d.Fragment,null)};function dd(e){let{importStatus:t}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const i=(0,_e.Fg)(),[n,o]=(0,d.useState)(!1),s=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),r=(0,Te.VK)((()=>Jl.Z.state.teamsAndProjects),[]),l=(0,Te.VK)((()=>I.default.state.currentSpaceViewStore),[]),c=(0,Te.VK)((()=>{if(!l)return;const e=l.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:a()(bt.p,{disabled:!0,store:e})})));return s?(e||[]).concat({id:l.id,name:"Private",icon:a()("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:ho.FN.light.gray[75]}},void 0,Ge.Z.lockedFilled({color:i.mediumIconColor,width:12.5,height:12.5}))}):e}),[l,s,i]),{notionTeamspaceName:u,notionTeamspaceIcon:p}=(0,d.useMemo)((()=>{const e=null==c?void 0:c.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[c,t]),m=(0,d.useMemo)((()=>{const e=r.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[r,t]);return a()(rd.gq,{style:{marginTop:16}},void 0,a()(Zt.Z,{ariaLabel:"collapse toggle",icon:Ge.Z.triangle,onClick:()=>o((e=>!e)),style:{transform:n?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),a()(zo.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:a()(rd.gq,{alignItems:"center",gap:2},void 0,a()(xe.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"}},void 0,m)),style:{width:300}},{key:"importedInto",header:a()(rd.gq,{gap:4},void 0,a()(rd.gq,{style:{alignItems:"center",gap:4}},void 0,a()(xe.Z,{isSmall:!0},void 0,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.importedInto",defaultMessage:"Imported into",description:"Header text for imported into teamspace column."})),Ge.Z.arrowRight({width:12})),a()(rd.gq,{style:{alignItems:"center",gap:4}},void 0,p,u)),style:{width:300}}],rows:function(e){let{collapsed:i}=e;return i?[]:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[a()(rd.gq,{gap:8,alignItems:"center"},e.projectId,Ge.Z.circleCheckFilled({width:12,color:ho.FN.dark.green[600]}),a()(xe.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300}},void 0,e.name)),a()(xe.Z,{isSmall:!0},`${e.projectId}-tasks-count`,e.numberOfTasks,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks",description:"Helper text to callout tasks"}))]})))}({collapsed:n})}))}var cd=i(41892);const ud=function(){var e;window.__c={n:"AsanaImportStepImportingDataFailedTab"};const t=(0,Te.VK)((()=>Jl.Z.state),[]),i=(0,_e.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},closeIconStyle:{width:16,height:16,fill:e.redBadgeBackground},lightText:{color:e.lightTextColor}})),[]);return a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"}},void 0,a()(rd.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"}},void 0,a()("img",{style:{width:32,height:32,marginRight:8},src:cd.Z.images.import.asanaPng}),Ge.Z.dot(i.iconStyle),Ge.Z.dot(i.iconStyle),Ge.Z.dot(i.iconStyle),Ge.Z.clearInput(i.closeIconStyle),Ge.Z.dot(i.iconStyle),Ge.Z.dot(i.iconStyle),Ge.Z.dot(i.iconStyle),a()("img",{style:{width:32,height:32,marginLeft:8},src:cd.Z.images.notionLogoPng})),a()(xe.Z,{style:i.lightText},void 0,a()(f.FormattedMessage,{id:"asanaImport.importingData.failed.problemsOccured",defaultMessage:"Some problems occurred while importing data from your Asana workspace.",description:"Helper text for the user to understand the import has failed."})),a()(xe.Z,{style:i.lightText},void 0,a()(f.FormattedMessage,{id:"asanaImport.importingData.failed.viewLoggerPage",defaultMessage:"Please try again or read the {link} to troubleshoot.",description:"Helper text for the user to understand the import failure reasons and next steps.",values:{link:a()("a",{style:{color:ho.ZP.black,cursor:"pointer"},href:`/${null===(e=t.loggerPageId)||void 0===e?void 0:e.replaceAll("-","")}`},void 0,a()(f.FormattedMessage,{id:"asanaImport.importingData.failed.linkText",defaultMessage:"import logs",description:"Text for the link"}))}})))};const pd=function(e){window.__c={n:"LoaderWithDots"};const{dotCount:t=6,speed:i=800}=e,[n,o]=(0,d.useState)(1),s=(0,_e.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor,opacity:.5},iconStyleBold:{width:6,height:6,fill:e.lightIconColor}})),[]);return(0,d.useEffect)((()=>{const e=setInterval((()=>o((e=>e<t?e+1:1))),i);return()=>clearInterval(e)}),[t,i]),a()(rd.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"}},void 0,Array.from({length:t},((e,t)=>t+1)).map((e=>a()("div",{},e,Ge.Z.dot(n===e?s.iconStyleBold:s.iconStyle)))))};const md=function(){window.__c={n:"AsanaImportStepImportingDataTab"};const e=(0,_e.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},iconStyleBold:{width:8,height:8,fill:e.mediumIconColor},lightText:{color:e.lightTextColor}})),[]);return a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"}},void 0,a()(rd.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"}},void 0,a()("img",{style:{width:32,height:32,marginRight:8},src:cd.Z.images.import.asanaPng}),a()(pd,{}),a()("img",{style:{width:32,height:32,marginLeft:8},src:cd.Z.images.notionLogoPng})),a()(rd.gq,{},void 0,a()(xe.Z,{style:e.lightText},void 0,a()(f.FormattedMessage,{id:"asanaImport.importingData.feelFreeToLeave",defaultMessage:"Data is being imported. Feel free to leave this window.",description:"Helper text for the user to leave the window."}))),a()(rd.gq,{},void 0,a()(xe.Z,{style:e.lightText},void 0,a()(f.FormattedMessage,{id:"asanaImport.importingData.sendEmail",defaultMessage:"We will send you an email when the import is complete or if any problems occur.",description:"Helper text for the user to leave the window."}))))};var gd=i(57688),hd=i(11066),fd=i(93963);const vd=function(){const e=(0,ke.O7)(),t=(0,f.useIntl)(),i=(0,Te.VK)((()=>Jl.Z.getState()),[]),{workspaces:n,selectedWorkspace:o,teamsAndProjects:s}=i;return(0,d.useEffect)((()=>{o&&Xl.y2({selectedWorkspace:o,environment:e}).catch((()=>{}))}),[o,e]),d.createElement(d.Fragment,null,a()(xe.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4}},void 0,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time.",description:"Helper text for the user about workspace selection."})),a()(bd,{onSelectOption:e=>{Jl.Z.setState({...i,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:n.map((e=>({key:e.gid,label:e.name}))),currentOption:i.selectedWorkspace,placeHolder:t.formatMessage({id:"asanaImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace",description:"Placeholder for select a workspace"})}),i.selectedWorkspace?a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.semibold,marginTop:18}},void 0,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects",description:"Heading to select projects that the user wants to import."})):d.createElement(d.Fragment,null),i.isLoadingProjects?a()(rd.gq,{style:{gap:8,marginTop:32,alignItems:"center"}},void 0,a()(Re.Z,{style:{fontSize:12}}),a()(xe.Z,{isSmall:!0,style:{color:ho.FN.light.gray[400]}},void 0,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace...",description:"Text to indicate to the user the projects in workspace are currently being loaded."}))):s.filter((e=>0!==e.projects.length)).map((e=>a()(yd,{team:e,selectedWorkspace:o},`${e.gid}-table`))))};function yd(e){var t;let{team:i,selectedWorkspace:n}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const o=(0,ke.O7)(),s=(0,f.useIntl)(),r=(0,_e.Fg)(),[l,c]=(0,d.useState)(!1),[u,p]=(0,d.useState)(!1),[m,g]=(0,d.useState)(),v=(0,Te.VK)((()=>Jl.Z.getState()),[]),y=(0,Te.VK)((()=>I.default.state.currentSpaceViewStore),[]),b=(0,Te.VK)((()=>{const e=null==y?void 0:y.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:a()(bt.p,{disabled:!0,store:e})})))}),[y]);(0,d.useEffect)((()=>{if(!b||!y)return;if(!v.selectedProjectsAndTeamspaces[i.gid]){g("private"),Xl.B3({teamId:i.gid,spaceId:null==y?void 0:y.id});for(const n of b){var e,t;if((null===(e=n.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=i.name)||void 0===t?void 0:t.toLowerCase())){g(n.id),Xl.B3({teamId:i.gid,spaceId:n.id});break}}}}),[b,i,y,v.selectedProjectsAndTeamspaces]);const S=(0,d.useCallback)((e=>{Xl.B3({teamId:i.gid,spaceId:e}),g(e)}),[i.gid]),w=(0,d.useCallback)((e=>{if("create"===e)return void gd.lo("asana_importer",{onClose:S});let t;if("private"===e){if(null==y||!y.id)return;t=y.id}else t=e;Xl.B3({teamId:i.gid,spaceId:t}),g(e)}),[null==y?void 0:y.id,i.gid,S]),{importCompletedTasks:M}=v,C=[{key:"private",searchTerm:"private",label:a()(rd.gq,{alignItems:"center",style:{gap:8}},void 0,a()("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:ho.FN.light.gray[75]}},void 0,Ge.Z.lockedFilled({color:r.mediumIconColor,width:12.5,height:12.5})),a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.regular}},void 0,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private",description:"Private space of the user option."})))}];return b&&C.push(...b.map((e=>({key:e.id,searchTerm:e.name,label:a()(rd.gq,{alignItems:"center",style:{gap:8}},void 0,e.icon,e.name)})))),C.push({key:"create",searchTerm:"New teamspace",label:a()(rd.gq,{alignItems:"center",style:{gap:4}},void 0,Ge.Z.plusThick({color:r.mediumIconColor,width:16,height:16}),a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace",description:"Create a new teamspace to import data into"})))}),a()(rd.gq,{style:{marginLeft:-18}},void 0,a()(Zt.Z,{ariaLabel:"collapse toggle",icon:Ge.Z.triangle,onClick:()=>c((e=>!e)),style:{transform:l?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),a()(zo.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:a()(rd.gq,{alignItems:"center",gap:2},void 0,a()(Sd,{onSelectOption:e=>{var t;Jl.Z.setState({...v,selectedProjectsAndTeamspaces:{...v.selectedProjectsAndTeamspaces,[i.gid]:{notionTeamspaceId:null===(t=v.selectedProjectsAndTeamspaces[i.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(()=>{var e;const t=null===(e=v.selectedProjectsAndTeamspaces[i.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),a()(xe.Z,{style:{width:280,textOverflow:"ellipsis"}},void 0,i.name)),style:{width:300}},{key:"importInto",header:a()(rd.gq,{style:{alignItems:"center"}},void 0,a()("div",{},void 0,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.importInto",defaultMessage:"Import into",description:"Header text for import into teamspace column."})),a()("div",{style:{marginRight:16,marginLeft:8}},void 0,Ge.Z.arrowRight({width:12})),a()(rd.gq,{style:{alignItems:"center",gap:8}},void 0,a()("img",{src:cd.Z.emails.notionLogoBlackSmallPng,height:18}),a()(bd,{options:C,onSelectOption:w,currentOption:null===(t=C.find((e=>e.key===m)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:s.formatMessage({id:"asanaImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace",description:"Placeholder for select a teamspace"})}))),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const s=i.projects.map((e=>({key:e.gid,columns:[a()(rd.gq,{alignItems:"center",gap:6,style:{marginLeft:20}},`${e.gid}-container`,a()(nt.Z,{style:{marginRight:2},onClick:()=>{const t={...v.selectedProjectsAndTeamspaces[i.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:a}=t;let o;o="all"===a||"in_complete"===a?[]:a.includes(e.gid)?a.filter((t=>t!==e.gid)):a.concat(e.gid),Jl.Z.setState({...v,selectedProjectsAndTeamspaces:{...v.selectedProjectsAndTeamspaces,[i.gid]:{notionTeamspaceId:n,projects:o}}})},checked:(()=>{const t={...v.selectedProjectsAndTeamspaces[i.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),a()(fd.z,{color:e.color,size:6}),a()("div",{style:{width:240,wordWrap:"break-word"}},void 0,e.completed?a()(xe.Z,{isMultiline:!0,style:{color:r.lightTextColor}},void 0,e.name,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.completedHelperText",defaultMessage:" (Completed)",description:"Helper text to callout completed projects."})):a()(xe.Z,{isMultiline:!0},void 0,e.name))),a()(xe.Z,{isSmall:!0},`${i.gid}-tasks-count`,M?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks",description:"Helper text to callout tasks"}))]})));return i.nextPage&&s.push({key:"loadMore",columns:[a()(hd.Z,{disabled:u,style:{marginLeft:20,color:ho.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!n)return;p(!0);const e=await ge.getTeamsAndProjectsInAsanaWorkspace(o,{workspaceId:n,teamId:i.gid,size:5,nextPage:i.nextPage}),{teamsAndProjects:t}={...v},a=t.find((e=>e.gid===i.gid));if(a){if("success"===e.type){const n=e.data.find((e=>e.gid===i.gid));if(!n)return;a.projects.push(...n.projects),a.nextPage=n.nextPage,Jl.Z.setState({...v,teamsAndProjects:t,loadMoreClicks:v.loadMoreClicks+1})}p(!1)}}},`${i.gid}-loadmore`,u?a()(rd.gq,{alignItems:"center",gap:8},void 0,a()(Re.Z,{style:{fontSize:12}}),a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingMoreProjects",defaultMessage:"Loading more projects...",description:"Helper showing more projects are being loaded currently."})):a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadMoreProjects",defaultMessage:"Load more projects...",description:"Load more projects button title."}))]}),s}({collapsed:l})}))}function bd(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:i,options:n,currentOption:o,placeHolder:r,narrow:l,allowSearch:c}=e,u=(0,f.useIntl)(),[p,m]=(0,d.useState)(""),g=null===(t=n.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,v=(0,_e.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return a()(xt.Z,{popupType:xt.Z.PopupType.Popup,placementToOrigin:xt.Z.Placement.Bottom,renderOrigin:e=>d.createElement($e.Z,s()({},e,{style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${ho.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:o?void 0:ho.FN.light.gray[50],color:o?void 0:ho.FN.light.gray[300]},disabled:!1}),a()(xe.Z,{style:{textOverflow:"ellipsis"}},void 0,g||r),Ge.Z.chevronDown(v.icon)),render:e=>{const t={menuType:Je.og.Popup,width:250,left:50},o=[{key:"asanaImport.dropdown.menuList",render:e=>d.createElement(rt.Z,e),items:(p.trim()?n.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase())})):n).map((t=>{let{key:n,label:o}=t;return{key:n,action:()=>{i(n),e.close()},render:e=>d.createElement(it.Z,s()({},e,{title:o,shouldWrapCaption:!0,right:g===o?a()("div",{style:{width:14}},void 0,Ge.Z.check()):void 0}))}}))}];return d.createElement(d.Fragment,null,c?a()("input",{style:{width:"100%",borderRadius:0,backgroundColor:ho.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${ho.FN.light.gray[100]}`,justifyContent:"space-between",background:ho.FN.light.gray[50],fontSize:h.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:u.formatMessage({id:"asanaImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace",description:"Placeholder for select for a teamspace"}),onChange:e=>m(e.target.value),value:p}):d.createElement(d.Fragment,null),d.createElement(at.Z,t,a()(ot.Z,{type:ot.i.Vertical,sections:o,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})))}})}function Sd(e){var t;window.__c={n:"CheckboxDropdown"};const{onSelectOption:i,options:n,currentOption:o}=e,r=null===(t=n.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,l=(0,d.useMemo)((()=>void 0!==o&&"specific"!==o&&("all"===o||"partial")),[o]);return a()(xt.Z,{popupType:xt.Z.PopupType.Popup,placementToOrigin:xt.Z.Placement.Bottom,alignmentToOrigin:xt.Z.Alignment.Start,renderOrigin:e=>d.createElement($e.Z,s()({},e,{style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{}}),a()(nt.Z,{checked:l,disabled:!0,size:14,checkSize:8})),render:e=>{const t={menuType:Je.og.Popup,width:250,left:50},o=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>d.createElement(rt.Z,e),items:n.map((t=>{let{key:n,label:o}=t;return{key:n,action:()=>{i(n),e.close()},render:e=>d.createElement(it.Z,s()({},e,{title:o,shouldWrapCaption:!0,right:r===o?a()("div",{style:{width:14}},void 0,Ge.Z.check()):void 0}))}}))}];return d.createElement(at.Z,t,a()(ot.Z,{type:ot.i.Vertical,sections:o,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}}))}})}const wd=function(e){let{tab:t,fetchActiveImportTasks:i}=e;window.__c={n:"AsanaImportStepTab"};const n=(0,ke.O7)(),o=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),s=(0,Te.VK)((()=>sd.Z.state.teams),[]),r=(0,Te.VK)((()=>Jl.Z.state),[]),l=(0,Te.VK)((()=>ne.Z.state),[]).flowId||(0,p.ZP)(),{workspaces:c}=r,u=(0,d.useCallback)((()=>Object.values(r.selectedProjectsAndTeamspaces).some((e=>0!==e.projects.length))),[r.selectedProjectsAndTeamspaces]),m=(0,_e.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return a()(Ze.Z,{controlRow:(e=>"selectData"===e?a()("div",{style:{display:"flex",justifyContent:"space-between"}},void 0,a()(Ae.Z,{style:{border:0},disabled:!c.length,onClick:()=>{i(),Jl.Z.resetImport()}},void 0,a()(f.FormattedMessage,{id:"asanaImport.selectData.backButtonText",defaultMessage:"Back",description:"Back button text on select data tab."})),a()(rd.gq,{alignItems:"center",gap:8},void 0,a()(hr.Z,{on:r.importCompletedTasks,onClick:()=>Jl.Z.setState({...r,importCompletedTasks:!r.importCompletedTasks})}),r.selectedWorkspace?a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"importsTab.selectData.importCompletedTasks",defaultMessage:"Import completed tasks",description:"Import completed tasks switcher button text."})):d.createElement(d.Fragment,null),a()(je.Z,{style:{marginLeft:16},disabled:!u()||r.templateCreationInProgress,onClick:()=>{o&&Xl.T_({environment:n,spaceStore:o,teamsStores:s,flowId:l}).catch((()=>{}))}},void 0,r.templateCreationInProgress?a()(rd.gq,{alignItems:"center",gap:2},void 0,a()(Re.Z,{isWhite:!0}),a()(f.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates",description:"Loader text showing creating templates."})):a()(f.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next",description:"Next button title on select data tab."})))):"importingData"===e?a()("div",{style:{display:"flex",justifyContent:"right"}},void 0,a()(Ae.Z,{disabled:!c.length,onClick:()=>{i(),Jl.Z.resetImport()}},void 0,a()(f.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close",description:"Close button title on importing data tab."}))):"confirm"===e?a()("div",{style:{display:"flex",justifyContent:"right"}},void 0,a()(je.Z,{onClick:()=>{r.loggerPageId&&w.navigate({url:(0,ed.Z)({pageId:r.loggerPageId,pageValue:od({table:dn.iU,id:r.loggerPageId}),baseUrl:Qe.Z.domainBaseUrl}),environment:n}),Jl.Z.resetImport(),be.Z.reset()}},void 0,a()(f.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done",description:"Done button title on confirm tab page."}))):"failure"===e?a()("div",{style:{display:"flex",justifyContent:"right"}},void 0,a()(Ae.Z,{disabled:!c.length,onClick:()=>{i(),Jl.Z.resetImport()}},void 0,a()(f.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close",description:"Close button title on importing data tab."}))):void 0)(t),controlRowPaddingTopBottom:20},void 0,a()("div",{style:{position:"absolute",top:12,right:12}},void 0,a()(hd.Z,{onClick:()=>{i(),Jl.Z.resetImport()},style:m.closeButton,hoveredStyle:m.closeButtonHover},void 0,Ge.Z.closeSmall(m.closeButtonIcon))),a()(xe.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:h.Z.fontWeight.medium,width:"100%"}},void 0,function(e){switch(e){case"selectData":return a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.semibold}},void 0,a()(f.FormattedMessage,{id:"asanaImport.importsTab.selectData.tabTitle",defaultMessage:"Select Asana workspace",description:"Select workspace tab title."}));default:return d.createElement(d.Fragment,null)}}(t)),(e=>"selectData"===e?a()(vd,{}):"importingData"===e?a()(md,{}):"confirm"===e?a()(ld,{}):"failure"===e?a()(ud,{}):void 0)(t))};const Md=function(e){let{fetchActiveImportTasks:t}=e;window.__c={n:"AsanaImportModal"};const i=(0,Te.VK)((()=>Jl.Z.state),[]);return a()($o.Z,{open:i.isModalOpen,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>a()(Go.Z,{capture:!0,allowEsc:!0,render:()=>a()(jo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>(()=>{const{currentTab:e}=i;return a()(wd,{fetchActiveImportTasks:t,tab:e})})()})}),onDismiss:()=>{Jl.Z.resetImport()}})};var Cd=i(95543);const kd=function(){const e=(0,Te.VK)((()=>I.default.state),[]),t=(0,Te.VK)((()=>Jl.Z.state),[]),{currentSpaceStore:i,mainEditorCurrentBlockStore:n,currentSpaceViewStore:o,currentUserSettingsStore:s}=e,l=(0,ke.O7)(),{device:c}=(0,ke.O7)(),[u,p]=(0,d.useState)([]);(0,d.useEffect)((()=>{Xl.bA({environment:l}).catch((()=>{}))}),[l]);const m=(0,d.useCallback)((async()=>{if(null==i||!i.id)return;const e=await ge.getActiveImportTasks(l,{spaceId:i.id});"success"===e.type&&p(e.data)}),[i,l]);return(0,d.useEffect)((()=>{m().catch((()=>{}));const e=setInterval(m,6e4);return()=>clearInterval(e)}),[i,l,m]),(0,d.useEffect)((()=>{let e;const i=async t=>{const a=await ge.getAsanaWorkspacesNames(l,{});if(t+=1,"success"===a.type)if(null!=a&&a.data.account)Jl.Z.setState({...Jl.Z.state,account:a.data.account,workspaces:a.data.workspaces,isLoadingAsanaWorkspaces:!1,isAccountLinkingInProgress:!1});else{if(t>n)return;e=setTimeout((()=>i(t)),2e3)}},n=180;if(t.isAccountLinkingInProgress){i(0).catch((()=>{}))}return()=>{clearTimeout(e)}}),[t.isAccountLinkingInProgress,l]),i&&o&&o&&s?d.createElement(d.Fragment,null,a()(Pe.Z,{large:!c.isMobile||void 0,divider:c.isMobile?void 0:"full"},void 0,a()(f.FormattedMessage,{id:"importsTab.title",defaultMessage:"Import data",description:"Available imports tab title."})),a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"importsTab.subtitle",defaultMessage:"You can easily import data from any of the following sources.",description:"Subtitle for imports tab."})),a()(xe.Z,{isSmall:!0},void 0,a()(f.FormattedMessage,{id:"importsTab.unsupportedImportsHelperText",defaultMessage:"If your data is located somewhere we don't support yet, you can try importing it via CSV file.",description:"Helper text for importing data from unsupported sources."})),a()("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"}},void 0,a()(Cd.Z,{pageStore:n,spaceStore:i,spaceViewStore:o,userSettingsStore:s,analyticsFrom:"modal",onComplete:e=>{w.navigateToBlock({environment:l,store:e}),be.Z.reset()},readOnlyCreditButton:!1,isLoadingNewConnections:t.isLoadingAsanaWorkspaces}),a()(Md,{fetchActiveImportTasks:m})),a()("div",{style:{marginTop:32}},void 0,a()(xe.Z,{isMultiline:!0},void 0,a()(f.FormattedMessage,{id:"importsTab.activeImports.title",defaultMessage:"Active Imports",description:"Title for the section showing import history."})),a()(zo.Z,{tableStyle:{borderTop:0},columns:[{key:"importTime",header:a()(f.FormattedMessage,{id:"importsTab.activeImports.importTime",defaultMessage:"Import time",description:"Time at which the import was started at in the timezone of the user."})},{key:"importFrom",header:a()(f.FormattedMessage,{id:"importsTab.activeImports.importFrom",defaultMessage:"Import from",description:"Source from which the data is being imported into Notion."})},{key:"importStatus",header:a()(f.FormattedMessage,{id:"importsTab.activeImports.importStatus",defaultMessage:"Status",description:"Status of the import."})}],rows:u.map((e=>({key:`table-${e.taskId}`,columns:[e.startedAt?`${(0,Vn.Yx)(e.startedAt,"long",V.default.getIntl().locale)} ${(0,Vn.Yx)(e.startedAt,"time",V.default.getIntl().locale)}`:"",(0,r.startCase)(e.source),a()(hi.Z,{isRound:!0,showRemoveButton:!1,value:a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"activeImports.status.inProgress",defaultMessage:"In progress",description:"Label for in-progress imports."})),backgroundColor:ho.FN.light.blue[200],showColoredDot:"blue",format:ui.l.Small,isSingle:!0},`progress-${e.taskId}`)]})))}),u.length?d.createElement(d.Fragment,null):a()(xe.Z,{isSmall:!0,style:{marginTop:16}},void 0,a()(f.FormattedMessage,{id:"importsTab.activeImportsTable.noActiveImports",defaultMessage:"There are no ongoing imports associated with your account.",description:"Placeholder text when there are no active imports going on"})))):d.createElement(d.Fragment,null)};var Td=i(79092),_d=i(54153),Id=i(84908),xd=i(84075);var Zd=i(65680),Pd=i(31194);class Fd extends c.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:Tt.Z},this.handleSelectChange=e=>{const{label:t}=this.getItemLabelAndCaption(e);if(this.props.confirm){const i=()=>{this.props.onChange(e)};S.showDialog({showCancel:!0,keepFocus:!1,message:a()(f.FormattedMessage,{id:"languagePicker.changeLanguage.confirmationMessage",defaultMessage:"Are you sure you want to update the language to {language}?",values:{language:t}}),items:[{label:a()(f.FormattedMessage,{id:"languagePicker.changeLanguage.updateButton.label",defaultMessage:"Update"}),color:"red",onAccept:i}]})}else this.props.onChange(e)}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const t="ja-JP"===this.props.currentLocale&&N.default.checkGate("japan_full_launch");return a()(xt.Z,{popupType:xt.Z.PopupType.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>d.createElement(d.Fragment,null,d.createElement($e.Z,s()({style:{marginLeft:-8,paddingLeft:8,paddingRight:8}},e),this.props.pickerLabel?this.props.pickerLabel:this.getItemLabelAndCaption(this.props.currentLocale).label,(0,Zd.ay)(this.props.currentLocale)&&!t&&a()(Fn.Z,{desktopStyle:{marginLeft:4}},void 0,a()(f.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})),Ge.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))),placementToOrigin:Pd.Iw.Bottom,alignmentToOrigin:Pd.lU.Start,render:e=>{let t;t=N.default.checkGate("polyglot")?[...Zd.tp,...Zd.is]:[...Zd.tp];const i=[{key:"languages",render:e=>d.createElement(rt.Z,s()({},e,{topBorder:0!==e.index})),items:t.map((t=>({key:t,render:e=>this.getItem(t,e.focused,e),action:()=>{this.handleSelect(t),e.close()}})))}],n={menuType:Je.og.Popup,width:240};return d.createElement(at.Z,s()({className:L.hKO},n),a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:i}))}})}renderItem(e){const t="ja-JP"===e.locale&&N.default.checkGate("japan_full_launch");return d.createElement(it.Z,s()({},e.props,{title:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{...e.style,marginRight:0}},void 0,e.label)),caption:e.caption&&a()("span",{style:{color:this.theme.mediumTextColor}},void 0,e.caption),shouldWrapCaption:!0,right:(0,Zd.ay)(e.locale)&&!t&&a()(Fn.Z,{},void 0,a()(f.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"}))}))}handleSelect(e){this.props.currentLocale!==e&&this.handleSelectChange(e)}getItemLabelAndCaption(e){var t;return{"en-US":{label:"English",caption:(t=this.props.intl).formatMessage({defaultMessage:"English (US)",id:"languagePicker.captions.englishUS"})},"de-DE":{label:"Deutsch",caption:t.formatMessage({defaultMessage:"German",id:"languagePicker.captions.germanDE",description:"The name of a language represented in a list of languages"})},"ko-KR":{label:"한국어",caption:t.formatMessage({defaultMessage:"Korean",id:"languagePicker.captions.koreanKo"})},"zh-CN":{label:"简体中文",caption:t.formatMessage({defaultMessage:"Simplified Chinese",id:"languagePicker.captions.chineseS"})},"zh-TW":{label:"繁體中文",caption:t.formatMessage({defaultMessage:"Traditional Chinese",id:"languagePicker.captions.chineseT"})},"ja-JP":{label:"日本語",caption:t.formatMessage({defaultMessage:"Japanese",id:"languagePicker.captions.japaneseJa"})},"es-ES":{label:"Español (España)",caption:t.formatMessage({defaultMessage:"Spanish (Spain)",id:"languagePicker.captions.spanishEs"})},"es-LA":{label:"Español (Latinoamérica)",caption:t.formatMessage({defaultMessage:"Spanish (Latin America)",id:"languagePicker.captions.spanishLatam"})},"pt-BR":{label:"Português (Brasil)",caption:t.formatMessage({defaultMessage:"Portuguese (Brazil)",id:"languagePicker.captions.portugueseBr"})},"fr-FR":{label:"Français (France)",caption:t.formatMessage({defaultMessage:"French",id:"languagePicker.captions.frenchFr"})},"da-DK":{label:"Dansk",caption:t.formatMessage({defaultMessage:"Danish",id:"languagePicker.captions.danishDk",description:"Allows the user to change their language setting to Danish."})},"fi-FI":{label:"Suomi",caption:t.formatMessage({defaultMessage:"Finnish",id:"languagePicker.captions.finnishFi",description:"Allows the user to change their language setting to Finnish."})},"nb-NO":{label:"Norsk",caption:t.formatMessage({defaultMessage:"Norwegian",id:"languagePicker.captions.norwegianNo",description:"Allows the user to change their language setting to Norwegian."})},"nl-NL":{label:"Nederlands",caption:t.formatMessage({defaultMessage:"Dutch",id:"languagePicker.captions.dutchNl",description:"Allows the user to change their language setting to Dutch."})},"sv-SE":{label:"Svenska",caption:t.formatMessage({defaultMessage:"Swedish",id:"languagePicker.captions.swedishSe",description:"Allows the user to change their language setting to Swedish."})},pseudo:{label:"🤡Pseudolocale🤡",caption:t.formatMessage({defaultMessage:"Pseudolocale",id:"languagePicker.captions.pseudolocale",description:"[Do not translate] A fake language added for localization QA purposes."})}}[e]}getItem(e,t,i){return this.renderItem({...this.getItemLabelAndCaption(e),focused:t,props:i,locale:e})}}Fd.displayName="LanguagePicker";const Ad=(0,f.injectIntl)(Fd);class Bd extends c.Z{renderComponent(){return a()("div",{style:this.getSettingsOptionStyle()},void 0,a()("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"}},void 0,a()("div",{style:{flex:1}},void 0,a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"languageRegionSettings.language.label",defaultMessage:"Language"})),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,a()(f.FormattedMessage,{id:"languageSettings.languageSwitcher.subtitle",defaultMessage:"Change the language used in the user interface."}))),a()(Ad,{confirm:!0,onChange:async e=>{b.A01(this.environment,{locale:e});const t=await ge.setLocale(this.environment,{locale:e});"success"===t.type?(_d.Z.set("preferredLocale",e),await xd.transactionQueue.drain(),this.environment.device.isElectron?Id.refreshAll({includeFocusedWindow:!0}):window.location.reload()):S.showError(t)},currentLocale:this.props.locale})))}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}Bd.displayName="LanguageSettings";const Ed=Bd;var Dd=i(32056);function Rd(e){var t,i;return(null==e||null===(t=e.getSettingsStore())||void 0===t||null===(i=t.getKeyStore("regional_format_settings"))||void 0===i?void 0:i.getKeyStore("region").getValue())||"US"}function Ld(e,t){var i,n;const a=null==e||null===(i=e.getKeyStore("settings"))||void 0===i||null===(n=i.getKeyStore("regional_format_settings"))||void 0===n?void 0:n.getValue();return"full_date"===t?null!=a&&a.use_default_region_settings?Od(Rd(e)):(null==a?void 0:a.full_date)||Od(Rd(e)):"short_date"===t?null!=a&&a.use_default_region_settings?{type:"short"}:(null==a?void 0:a.short_date)||{type:"short"}:"number"===t?null!=a&&a.use_default_region_settings?"number":(null==a?void 0:a.number)||"number":"week_start_on"===t?null!=a&&a.use_default_region_settings?"sunday":(null==a?void 0:a.week_start_on)||"sunday":(0,T.t1)(t)}function Od(e){return"JP"===e?{type:"short"}:{type:"long"}}const Nd={full_date:(0,f.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,f.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,f.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,f.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})},Vd=(0,f.defineMessages)({full_date:{defaultMessage:"Full date",id:"regionalFormatSettings.defaultSetting.fullDate"},short_date:{defaultMessage:"Short date",id:"regionalFormatSettings.defaultSetting.shortDate"},number:{defaultMessage:"Numbers",id:"regionalFormatSettings.defaultSetting.numbers"},week_start_on:{defaultMessage:"Week starts",id:"regionalFormatSettings.defaultSetting.weekStart"}});function Ud(e,t){if("full_date"===t){return Nd[t][Ld(e,t).type]}if("short_date"===t){return Nd[t][Ld(e,t).type]}if("number"===t){return Nd[t][Ld(e,t)]}if("week_start_on"===t){return Nd[t][Ld(e,t)]}return(0,T.t1)(t)}function Wd(e,t){return(0,Dd.uf)(1234567,e,t)}const zd=(0,f.defineMessages)({sunday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.sunday",defaultMessage:"Sunday"},monday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.monday",defaultMessage:"Monday"}});function Kd(e,t){const i=e.type;return"short"===i||"long"===i||"medium"===i?(0,Vn.Yx)(Date.now(),i,(0,As.E2)(t)):"iso"===i?(0,Vn.$6)(Date.now()):(0,Vn.Yx)(Date.now(),"long",(0,As.E2)(t))}function qd(e,t){const i=e.type;return"iso"===i?(0,Vn.$6)(Date.now()):"short"===i?(0,Vn.Yx)(Date.now(),i,(0,As.E2)(t)):(0,Vn.Yx)(Date.now(),"short",(0,As.E2)(t))}var Hd=i(68894),Gd=i(95030);const jd={full_date:(0,f.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,f.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,f.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,f.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})};function $d(e){window.__c={n:"CustomRegionalFormatSettingPicker"};const[,,t]=(0,Te.AF)(void 0,Tt.Z),i=(0,_e.Fg)(),[n,o]=(0,Te.VK)((()=>[e.userSettingsStore.isDefined(),Ud(e.userSettingsStore,e.option)]),[e.option,e.userSettingsStore]);return n?a()(xt.Z,{popupType:xt.Z.PopupType.Popup,buttonPopupStore:t,renderOrigin:e=>d.createElement($e.Z,e,V.default.formatMessage(o),Ge.Z.chevronDown({width:10,marginLeft:4,fill:i.lightIconColor})),placementToOrigin:Pd.Iw.Bottom,alignmentToOrigin:Pd.lU.Start,render:t=>"week_start_on"===e.option||"number"===e.option?a()(Yd,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):"full_date"===e.option||"short_date"===e.option?a()(Qd,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):(0,T.t1)(e.option)}):a()(Re.Z,{})}function Yd(e){window.__c={n:"SimpleFormatPicker"};const t=(0,ke.O7)(),i=(0,f.useIntl)();return a()(at.Z,{menuType:Je.og.Popup,width:216},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>d.createElement(rt.Z,s()({},e,{topBorder:0!==e.index})),items:(0,T.Yd)(jd[e.option]).map((n=>({key:n,render:t=>{const a="number"===e.option?Wd(n,i):void 0;return d.createElement(it.Z,s()({},t,{title:V.default.formatMessage(jd[e.option][n]),caption:a}))},action:()=>{B.createAndCommit({userAction:"CustomRegionalFormatSettings.SimpleFormatPicker",environment:t,perform:t=>{E.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:Rd(e.userSettingsStore),[e.option]:n}},transaction:t})}}),e.onAccept()}})))}]}))}function Qd(e){window.__c={n:"CustomizableFormatPicker"};const t=(0,ke.O7)(),[i,n]=(0,d.useState)((()=>{})),o=(0,f.useIntl)(),r=(0,T.Yd)(jd[e.option]),l=n=>{const a="custom"===n?{type:n,format:i}:{type:n};B.createAndCommit({userAction:"CustomRegionalFormatSettings.onAction",environment:t,perform:t=>{E.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:Rd(e.userSettingsStore),[e.option]:a}},transaction:t})}}),e.onAccept()};return a()(at.Z,{menuType:Je.og.Popup,width:216},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>d.createElement(rt.Z,s()({},e,{topBorder:0!==e.index})),items:r.map((t=>({key:t,render:r=>{if("custom"===t)return d.createElement(Gd.Z,s()({},r,{renderOrigin:i=>d.createElement(it.Z,s()({},i,{title:V.default.formatMessage(jd[e.option][t])})),onFocus:()=>{},renderExtension:()=>a()(Xd,{customFormat:i,onChange:e=>{n(e)},onAccept:()=>{l(t)}}),title:V.default.formatMessage(jd[e.option][t])}));{const i="full_date"===e.option?Kd({type:t},o):qd({type:t},o);return d.createElement(it.Z,s()({},r,{title:V.default.formatMessage(jd[e.option][t]),caption:i}))}},action:()=>{l(t)}})))}]}))}function Xd(e){window.__c={n:"CustomDateFormatExtension"};const t=(0,_e.yK)((e=>({container:{},label:{color:e.mediumTextColor,fontWeight:h.Z.fontWeight.semibold,paddingTop:6,paddingBottom:6,paddingLeft:14,paddingRight:14},actionButton:{marginTop:6}})),[]);return a()("div",{style:t.container},void 0,a()("div",{},void 0,a()(xe.Z,{isSmall:!0,style:t.label},void 0,a()(f.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.title",defaultMessage:"Custom format"}))),a()(Hd.ZP,{focus:!0,value:e.customFormat||"",onChange:t=>{e.onChange(t.target.value)}}),a()(it.Z,{style:t.actionButton,focused:!1,onClick:e.onAccept,title:a()(f.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.applyChanges",defaultMessage:"Apply changes"})}))}function Jd(e){window.__c={n:"RegionalFormatSettings"};const t=(0,_e.yK)((()=>({container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]),i=(0,Te.VK)((()=>e.userSettingsStore.isReady()),[e.userSettingsStore]),n=(0,Te.VK)((()=>e.userSettingsStore.shouldUseDefaultRegionalFormatting()),[e.userSettingsStore]),o=(0,ke.O7)();return i?a()("div",{style:t.container},void 0,a()("div",{style:t.controlRow},void 0,a()("div",{style:t.label},void 0,a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"regionalFormatSettings.label.title",defaultMessage:"Use regional defaults"})),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle},void 0,a()(f.FormattedMessage,{id:"regionalFormatSettings.label.subtitle",defaultMessage:"Automatically apply standard formats of your region"}))),a()(hr.Z,{on:n,onClick:()=>{B.createAndCommit({userAction:"RegionalFormatSettings.RegionalFormatSettings",environment:o,perform:t=>{const i=n?{use_default_region_settings:!1,full_date:void 0,short_date:void 0,time:void 0,number:void 0,week_start_on:void 0}:{use_default_region_settings:!0};E.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{region:Rd(e.userSettingsStore),...i}},transaction:t})}})}})),a()("div",{},void 0,a()(n?ec:ac,{userSettingsStore:e.userSettingsStore}))):a()(Re.Z,{})}function ec(e){window.__c={n:"DefaultRegionalFormatSettings"};const t=(0,_e.yK)((()=>({container:{marginTop:12}})),[]);return a()("div",{style:t.container},void 0,nc.map((t=>a()(tc,{userSettingsStore:e.userSettingsStore,option:t}))))}function tc(e){window.__c={n:"DefaultRegionalFormatSetting"};const t=(0,_e.yK)((e=>({container:{display:"flex"},option:{color:e.lightTextColor,fontSize:h.Z.fontSize.UIRegular.desktop,width:100},example:{color:e.mediumTextColor,fontSize:h.Z.fontSize.UIRegular.desktop}})),[]),i=(0,f.useIntl)(),[n,o]=(0,Te.VK)((()=>[e.userSettingsStore.isDefined(),ic(e.userSettingsStore,i,e.option)]),[i,e.option,e.userSettingsStore]);return n?a()("div",{style:t.container},void 0,a()("div",{style:t.option},void 0,V.default.formatMessage(Vd[e.option])),a()("div",{style:t.example},void 0,o)):a()(Re.Z,{})}function ic(e,t,i){if("full_date"===i){return Kd(Ld(e,i),t)}if("short_date"===i){return qd(Ld(e,i),t)}if("number"===i){return Wd(Ld(e,i),t)}if("week_start_on"===i){return function(e){return"sunday"===e?V.default.formatMessage(zd.sunday):"monday"===e?V.default.formatMessage(zd.monday):(0,T.t1)(e)}(Ld(e,i))}return(0,T.t1)(i)}const nc=["full_date","short_date","number","week_start_on"];function ac(e){return window.__c={n:"CustomRegionalFormatSettings"},a()("div",{},void 0,nc.map((t=>a()(oc,{userSettingsStore:e.userSettingsStore,option:t}))))}function oc(e){const t=(0,f.useIntl)(),[i,n,o]=(0,Te.VK)((()=>[e.userSettingsStore.isDefined(),Rd(e.userSettingsStore),ic(e.userSettingsStore,t,e.option)]),[t,e.option,e.userSettingsStore]),s=(0,_e.yK)(sc,[]);return i?d.createElement(d.Fragment,null,a()(Fo.Z,{size:24}),a()("div",{style:s.container},void 0,a()("div",{style:s.controlRow},void 0,a()("div",{style:s.label},void 0,a()(xe.Z,{},void 0,V.default.formatMessage(Vd[e.option])),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:s.subtitle},void 0,o)),a()($d,{userSettingsStore:e.userSettingsStore,region:n,option:e.option})))):a()(Re.Z,{})}function sc(){return{container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}}var rc=i(80994),lc=i(31942);function dc(e){window.__c={n:"RegionSettings"};const t=(0,_e.yK)((()=>({container:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]);return a()("div",{style:t.container},void 0,a()("div",{style:t.label},void 0,a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"regionSettings.region.label",defaultMessage:"Region"})),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle},void 0,a()(f.FormattedMessage,{id:"regionSettings.region.subtitle",defaultMessage:"Affects the default formats for dates, numbers, and currencies"}))),a()(cc,{userSettingsStore:e.userSettingsStore,onChange:e.onChange,pickerLabel:e.pickerLabel}))}function cc(e){window.__c={n:"RegionPicker"};const t=(0,_e.Fg)(),[,,i]=(0,Te.AF)(void 0,Tt.Z),n=(0,Te.VK)((()=>Rd(e.userSettingsStore)),[e.userSettingsStore]),[o,r]=d.useState("");return a()(xt.Z,{popupType:xt.Z.PopupType.Popup,buttonPopupStore:i,renderOrigin:i=>d.createElement($e.Z,i,e.userSettingsStore?n:e.pickerLabel,Ge.Z.chevronDown({width:10,marginLeft:4,fill:t.lightIconColor})),placementToOrigin:Pd.Iw.Bottom,alignmentToOrigin:Pd.lU.Start,render:t=>a()(at.Z,{menuType:Je.og.Popup,width:216,header:a()(pc,{value:o,onChange:e=>r(e)})},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:[{key:"regions",render:e=>d.createElement(rt.Z,s()({},e,{topBorder:0!==e.index})),items:(0,lc.ZP)(o,rc.hW,(e=>e.name)).map((i=>({key:i.countryCode,render:e=>d.createElement(it.Z,s()({},e,{title:i.name})),action:()=>{e.onChange(i.countryCode),t.close(),r("")}})))}]}))})}const uc=(0,f.defineMessages)({regionSearchPlaceholder:{defaultMessage:"Search for a region...",id:"settings.regionSettings.regionSearch"}});function pc(e){return window.__c={n:"RegionPickerSearchHeader"},a()(rt.Z,{isInput:!0},void 0,a()(Hd.ZP,{value:e.value,onChange:t=>{e.onChange(t.target.value)},focus:!0,placeholder:V.default.formatMessage(uc.regionSearchPlaceholder),focusAfterAnimation:!0}))}var mc=i(758),gc=i(2911);const hc=function(e){window.__c={n:"SpellcheckerLanguagesPicker"};const[t,i]=d.useState([]),[n,o]=d.useState([]),r=(0,ke.O7)(),l=(0,Te.qz)(void 0,Tt.Z),c=(0,_e.yK)((e=>({span:{color:e.mediumTextColor},plainButton:{paddingLeft:8,paddingRight:8,marginLeft:-8},icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function u(e){return n.some((t=>t.code===e.code))}(0,d.useEffect)((()=>{const e=r.SpellCheckStore;e&&!(0,mc.x)(e)&&(e.getAvailableLanguages().then(i).catch((e=>{ca.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getAvailableLanguages",error:(0,gc.Ui)(e)})})),e.getLanguages().then(o).catch((e=>{ca.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getLanguages",error:(0,gc.Ui)(e)})})))}),[r]),(0,d.useEffect)((()=>{const e=r.SpellCheckStore;if(!e||(0,mc.x)(e))return;const t=n.map((e=>{let{code:t}=e;return t}));e.setLanguages(t)}),[n,r.SpellCheckStore]);const p=n.length>0?n.slice(0,3).map((e=>{let{name:t}=e;return t})).join(", ")+(n.length>3?"…":""):a()(f.FormattedMessage,{id:"languageRegionSettings.spellchecker.picker.label",defaultMessage:"Select languages",description:"This is a fallback message - if no languages are selected, we will display this message. If languages are selected, we will use them as label."});return a()(xt.Z,{popupType:xt.Z.PopupType.Popup,buttonPopupStore:l,renderOrigin:e=>d.createElement(d.Fragment,null,d.createElement($e.Z,s()({style:c.plainButton},e),p,Ge.Z.chevronDown(c.icon))),placementToOrigin:Pd.Iw.Bottom,alignmentToOrigin:Pd.lU.Start,render:e=>{const i=[{key:"spellcheckerlanguages",render:e=>d.createElement(rt.Z,s()({},e,{topBorder:0!==e.index})),items:t.map((e=>({key:e.code,render:t=>function(e){const t=e.language.name||e.language.code;return d.createElement(it.Z,s()({},e.props,{title:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{marginRight:0}},void 0,t)),shouldWrapCaption:!0,right:u(e.language)?Ge.Z.checkmark({width:12,height:12}):void 0}))}({language:e,props:t}),action:()=>{u(e)?o(n.filter((t=>t.code!==e.code))):o([...n,e])}})))}],r={menuType:Je.og.Popup,width:240};return d.createElement(at.Z,s()({className:L.hKO},r),a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:i}))}})};const fc=function(e){const t=(0,ke.O7)();return t.device.isElectron&&t.device.isWindows&&!mc.x(t.SpellCheckStore)?d.createElement(d.Fragment,null,a()(Fo.Z,{size:24,isHidden:!0}),a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"}},void 0,a()("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"}},void 0,a()("div",{style:{flex:1}},void 0,a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"languageRegionSettings.spellchecker.label",defaultMessage:"Spellchecker languages",description:"This is the label for the spellchecker languages picker."})),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,a()(f.FormattedMessage,{id:"languageSettings.spellcheckerSwitcher.subtitle",defaultMessage:"Change the languages used by the spellchecker.",description:"This is the subtitle for the spellchecker languages picker."}))),a()(hc,{})))):null};class vc extends c.Z{renderComponent(){return Ie.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(f.FormattedMessage,{defaultMessage:"Please go online to manage your language and region.",id:"languageSettings.offline.message"})))}renderSettings(){var e;const{currentUserSettingsStore:t}=I.default.state;if(!t)return;const i=(null===(e=t.getSettings())||void 0===e?void 0:e.preferred_locale)||As.al,n="on"===N.default.getGroup("aloha");return a()(Ze.Z,{},void 0,a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})),a()(Ed,{locale:i,userSettingsStore:t}),a()(fc,{}),a()(Fo.Z,{size:24}),n?a()("div",{style:{marginTop:12}},void 0,a()(dc,{locale:i,userSettingsStore:t,onChange:e=>{}}),a()(Fo.Z,{size:24}),a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"languageSettings.formatsSection.title",defaultMessage:"Formats"})),a()(Jd,{locale:i,userSettingsStore:t}),a()(Fo.Z,{size:24})):a()(Td.Z,{}))}}vc.displayName="LanguageRegionSettings";const yc=vc;var bc=i(83590),Sc=i(5851),wc=i(33689),Mc=i(69435);class Cc extends c.Z{constructor(){super(...arguments),this.storeTypes={tokenOptionsButtonPopupStore:Tt.Z,domainVerificationStore:lr.ZP},this.handleDisablePublicAccessSwitcherClick=async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disablePublicAccess;if(!t){if(!(await S.confirmUserAction({message:a()(f.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.message",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:a()(f.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}this.handleSave({disablePublicAccess:!t})},this.handleAllowDisableGuestsSwitcherClick=async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disableGuests;if(!t){if(!(await S.confirmUserAction({message:a()(f.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.message",defaultMessage:"Are you sure? All guests in this workspace will be removed."}),acceptLabel:a()(f.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}this.handleSave({disableGuests:!t})},this.handleToggleClick=(e,t)=>{if(!t)return this.handleUpgradeClick();const{securitySettingsStore:i}=this.props;this.handleSave({[e]:!i.state[e]})},this.handleUpgradeClick=()=>{nr.y(this.environment,{from:"space_saml",for:"enterprise"})}}renderComponent(){return Ie.Z.state.online?a()(Ze.Z,{},void 0,this.renderSecuritySettings()):this.renderOfflineMessage()}renderUpsell(){if(!(0,wc.J)({environment:this.environment}))return a()("div",{style:{border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:3,padding:16,marginTop:(0,U.uT)()?void 0:24,marginBottom:24}},void 0,!(0,q.Rs)()&&a()(Mc.Z,{for:"business",from:"space_saml",upgradeMessage:a()(f.FormattedMessage,{id:"securitySAMLSettings.upsell.button.business",defaultMessage:"Upgrade to Business",description:"Business plan upsell button on security settings page"}),title:a()(f.FormattedMessage,{id:"securitySAMLSettings.upsell.title.business",defaultMessage:"Upgrade for SAML SSO & more admin tools",description:"Heading over upsell on security settings page"}),caption:a()(f.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.business",defaultMessage:"The Business Plan includes single sign-on to manage employee access at scale, private teamspaces to collaborate on sensitive docs, and more.",description:"Caption for upsell on security settings page"}),learnMoreRoute:"guides.securitySettings",style:{marginBottom:"20px"}}),a()(Mc.Z,{for:"enterprise",from:"space_saml",upgradeMessage:a()(f.FormattedMessage,{id:"securitySAMLSettings.upsell.button.enterprise",defaultMessage:"Upgrade to Enterprise",description:"Enterprise plan upsell button on security settings page"}),title:a()(f.FormattedMessage,{id:"securitySAMLSettings.upsell.title.enterprise",defaultMessage:"Upgrade for SCIM, advanced security & more",description:"Heading over upsell on security settings page"}),caption:a()(f.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.enterprise",defaultMessage:"The Enterprise Plan allows you to automatically provision users and groups, and gain more visibility and controls across the workspace.",description:"Caption for upsell on security settings page"}),learnMoreRoute:"guides.securitySettings"}))}renderSecuritySettings(){const{securitySettingsStore:e}=this.props,t=.5,i=a()(ar.Z,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:this.handleUpgradeClick,desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),n=n=>a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:n?this.handleDisablePublicAccessSwitcherClick:this.handleUpgradeClick},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.label",defaultMessage:"Disable public page sharing"}),!n&&i,a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.caption",defaultMessage:"Disable the Share to web option in the Share menu on every page in this workspace."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(hr.Z,{on:e.state.disablePublicAccess,disabled:!n}))),a()(Fo.Z,{size:24,style:{opacity:0}})),o=n=>{if(!(0,_.bq)())return a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick("disableSpacePageEdits",n)},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),!n&&i,a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"}},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(hr.Z,{on:e.state.disableSpacePageEdits,disabled:!n}))),a()(Fo.Z,{size:24,style:{opacity:0}}))},s=n=>a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:n?this.handleAllowDisableGuestsSwitcherClick:this.handleUpgradeClick},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.label",defaultMessage:"Disable guests"}),!n&&i,a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.caption",defaultMessage:"Prevent anyone from inviting people outside the workspace to pages."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(hr.Z,{on:e.state.disableGuests,disabled:!n}))),a()(Fo.Z,{size:24,style:{opacity:0}})),r=n=>a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick("disableMoveToSpace",n)},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable duplicating pages to other workspaces"}),!n&&i,a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from duplicating pages to other workspaces via the Move To or Duplicate To actions."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(hr.Z,{on:e.state.disableMoveToSpace,disabled:!n}))),a()(Fo.Z,{size:24,style:{opacity:0}})),{state:l}=e,c=n=>a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick("disableExport",n)},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),!n&&i,a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(hr.Z,{on:e.state.disableExport,disabled:!n}))),a()(Fo.Z,{size:24,style:{opacity:0}}));const u=e=>{(0,U.uT)()};return(0,wc.J)({environment:this.environment})?a()(d.Fragment,{},void 0,a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})),u(),n(!0),o(!0),s(!0),r(!0),c(!0),a()("div",{style:{height:36}})):a()(d.Fragment,{},void 0,this.renderUpsell(),a()("div",{style:this.getHeaderStyle()},void 0,a()("span",{style:{marginRight:8}},void 0,a()(f.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"}))),u(),n(l.disablePublicAccess),o(l.disableSpacePageEdits),s(l.disableGuests),r(l.disableMoveToSpace),c(l.disableExport),a()("div",{style:{height:32}}))}renderOfflineMessage(){return a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,a()(f.FormattedMessage,{defaultMessage:"Please go online to manage security settings.",id:"securitySAMLSettings.offline.message"})))}handleSave(e){const{securitySettingsStore:t,spaceStore:i}=this.props;Sc.y(this.environment,{spaceStore:i,securitySettingsStore:t,fields:e})}getHeaderStyle(){return{fontWeight:h.Z.fontWeight.medium,fontSize:18,borderBottom:`1px solid ${this.theme.regularDividerColor}`,paddingBottom:6,marginBottom:12,display:"flex",alignItems:"center"}}getTitleStyle(){return{fontSize:14,marginRight:8,flexGrow:1}}}Cc.displayName="SecuritySettings";const kc=(0,f.injectIntl)(Cc);class Tc extends c.Z{renderComponent(){return a()("div",{style:this.getStyle(),onMouseDown:this.props.onMouseDown,onClick:this.props.onClick,onDoubleClick:this.props.onDoubleClick,onContextMenu:this.props.onContextMenu},void 0,a()("div",{style:this.getSidebarStyle()},void 0,this.props.sidebar),a()("div",{style:this.getChildrenStyle()},void 0,this.props.children))}getStyle(){return{display:"flex",height:"100%",flexDirection:this.props.isReversed?"row-reverse":"row"}}getSidebarStyle(){return{height:"100%",background:this.theme.cardSidebarBackground,flexGrow:0,flexShrink:0,width:240,overflowY:"auto"}}getChildrenStyle(){return{flexGrow:1,position:"relative",zIndex:1,height:"100%"}}}Tc.displayName="SidebarBox";const _c=Tc,Ic="last_90_days",xc={field:"last_active",direction:"desc"};async function Zc(e){var t,i;const{environment:n,filter:a,spaceId:o,spaceAnalyticsStore:s}=e,r=null===(t=s.usersTabData)||void 0===t?void 0:t.dailyUsersData;if(!r||a!==(null===(i=s.usersTabData)||void 0===i?void 0:i.graphFilter)||s.currentSpaceId!==o){const e=await ge.getDailyUsersAnalytics(n,{spaceId:o,activeWindow:"all_time"===a?"last_90_days":a});return"failed"===e.type?e.body:e.data}return r}async function Pc(e){var t,i,n;const{environment:a,filter:o,sort:s,spaceStore:r,spaceAnalyticsStore:l}=e,d=null===(t=l.usersTabData)||void 0===t?void 0:t.tableFilter,c=null===(i=l.usersTabData)||void 0===i?void 0:i.userTableSort;if(null===(n=l.usersTabData)||void 0===n||!n.usersAndStats||d!==o||!c||c.direction!==s.direction||c.field!==s.field||l.currentSpaceId!==r.id){const e=await ge.loadWorkspaceAnalyticsUsers(a,{spaceId:r.id,filters:{timeRange:o},sort:s});return"failed"===e.type?e.body:e.data.users.map((e=>({stats:e,userStore:ze.U6.createChildStore(r,{table:Kt.KJ,id:e.userId})}))).filter((e=>{let{userStore:t}=e;return t.isDefined()}))}return l.usersTabData.usersAndStats}function Fc(e,t){return(0,vn.Jx)(e)?e.message:t.formatMessage({defaultMessage:"Failed to retrieve analytics. Try refreshing and reopening the settings.",id:"workspaceAnalytics.usersTab.refershUserAnalytics.defaultFailed",description:"Default error message when retrieving user analytics fails and no localized message available."})}const Ac={pageViews:0,uniquePageViews:0,pagesCreated:0,pageEdits:0,topPages:[]};const Bc={activeMembersCount:0,previousActiveMembersCount:0,activeGuestsCount:0,previousActiveGuestsCount:0,topTeamspaces:[],topViewers:[],topEditors:[]};function Ec(e){return window.__c={n:"ExportAnalyticsButton"},a()(xt.Z,{popupType:st.kQ.Popup,alignmentToOrigin:la.v.End,render:t=>{let{close:i}=t;return a()(Dc,{closePopup:i,analyticsType:e.analyticsType})},renderOrigin:t=>{let{onClick:i}=t;return a()(Ae.Z,{style:e.style,onClick:i},void 0,a()(f.FormattedMessage,{id:"spaceAnalytics.usersTab.export",defaultMessage:"Export as CSV",description:"Export analytics table as a CSV file button."}))}})}function Dc(e){window.__c={n:"ExportAnalyticsMenu"};const{analyticsType:t,closePopup:i}=e,n=(0,ke.O7)(),o=(0,Te.VK)((()=>{var e;return null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),s=(0,d.useCallback)((async e=>{if(o){switch(t){case de.Users:b.LbR(n,{daysFilter:e}),await Fe.Tp(n,{spaceId:o,daysFilter:e});break;case de.Content:b.ZaS(n,{daysFilter:e}),await Fe.hN(n,{spaceId:o,daysFilter:e});break;default:(0,T.t1)(t)}i()}}),[n,o,t,i]),r=ma.Hz.map((e=>a()(it.Z,{focused:!1,onClick:()=>s(e),title:V.default.formatMessage(ma.Rh[e])},e)));return a()(at.Z,{menuType:Je.og.Popup},void 0,a()(rt.Z,{},void 0,r))}const Rc=(0,f.defineMessages)({emptyAnalyticsHeading:{id:"workspaceAnalyticsTabs.empty.heading",defaultMessage:"No workspace analytics yet",description:"Heading for the empty state of the workspace analytics tab."},emptyAnalyticsDescription:{id:"workspaceAnalyticsTabs.empty.description",defaultMessage:"It may take some time for workspace analytics information to appear.",description:"Description for the empty state of the workspace analytics tab."},disabledAnalyticsHeading:{id:"workspaceAnalyticsTabs.disabled.heading",defaultMessage:"Analytics are disabled",description:"Heading for the disabled state of the workspace analytics tab."},disabledAnalyticsDescription:{id:"workspaceAnalyticsTabs.disabled.description",defaultMessage:"A workspace owner has turned off page view recording for {name}.{br}This information will not be available in your workspace settings or on individual pages.",description:"Description for the disabled state of the workspace analytics tab."},disabledAnalyticsDescriptionNoSpaceName:{id:"workspaceAnalyticsTabs.disabled.description.unnamed",defaultMessage:"A workspace owner has turned off page view recording for this space.{br}This information will not be available in your workspace settings or on individual pages.",description:"Description for the disabled state of the workspace analytics tab when the space has no name"}});function Lc(e){window.__c={n:"SpaceAnalyticsEmptyState"};const t=(0,_e.yK)((e=>({outerDiv:{display:"flex",flexDirection:"column",justifyContent:"center",height:"80%",gap:24},innerDiv:{display:"flex",flexDirection:"column",textAlign:"center",alignItems:"center",gap:4},header:{fontSize:16,fontWeight:500},analyticsIcon:{fill:e.mediumTextColor,padding:20,height:150,width:150},learnMoreIcon:{width:14,height:14},learnMore:{gap:4}})),[]),i=(0,ke.O7)(),{type:n,spaceName:o}=e,r=function(e,t){switch(e){case"empty":return{heading:V.default.formatMessage(Rc.emptyAnalyticsHeading),description:V.default.formatMessage(Rc.emptyAnalyticsDescription)};case"disabled":const e=t?d.createElement(f.FormattedMessage,s()({},Rc.disabledAnalyticsDescription,{values:{name:t,br:a()("br",{})}})):d.createElement(f.FormattedMessage,s()({},Rc.disabledAnalyticsDescriptionNoSpaceName,{values:{br:a()("br",{})}}));return{heading:V.default.formatMessage(Rc.disabledAnalyticsHeading),description:e}}}(n,o);return a()("div",{style:t.outerDiv},void 0,a()("div",{style:t.innerDiv},void 0,Ge.Z.analyticsSearch(t.analyticsIcon),a()(xe.Z,{isSecondaryColor:!0,style:t.header},void 0,r.heading),a()(xe.Z,{isSecondaryColor:!0},void 0,r.description),a()($e.Z,{onClick:()=>w.navigateToExternalURL({environment:i,url:(0,W.UY)("guides.workspaceAnalytics")}),style:t.learnMore},void 0,Ge.Z.help(t.learnMoreIcon),a()(xe.Z,{isSmall:!0},void 0,a()(f.FormattedMessage,{id:"workspaceAnalyticsTabs.disabled.learnMore",defaultMessage:"Learn more",description:"Link to learn more about workspace analytics"})))))}var Oc=i(35314);function Nc(e){let{num:t,abbreviateNumber:i}=e;window.__c={n:"NumberDisplay"};const n=(0,f.useIntl)(),o=(0,As.E2)(n),s=t.toLocaleString(o),r=Intl.NumberFormat(o,{notation:"compact",maximumFractionDigits:1}).format(t);return i?a()(Oe.Z,{placement:Oe.Z.Placement.Bottom,render:e=>d.createElement("span",e,r),renderTooltip:()=>s}):a()("span",{},void 0,s)}function Vc(e){let{icon:t,iconStyles:i,textStyles:n,style:o,title:s,byline:r,loading:l,error:d}=e;window.__c={n:"AnalyticsCardOverview"};const c=function(e,t,i){return(0,_e.yK)((n=>({title:{fontWeight:h.Z.fontWeight.medium,fontSize:16},byline:{fontSize:h.Z.fontSize.UISmall.desktop,marginTop:4},textContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",...t},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:8},icon:{height:28,width:28,color:n.lightTextColor,fill:"currentcolor",...e},container:{height:"100%",flex:1,display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",border:`1px solid ${n.outlineButtonBorder}`,borderRadius:4,padding:12,gap:8,...i},loadingTitle:{display:"block",width:"40%"},loadingByline:{display:"block",width:"60%",marginTop:8,marginBottom:6},errorTitle:{textAlign:"center",color:ho.ZP.red}})),[e,t,i])}(i,n,o);return l?a()("div",{style:c.container},void 0,a()("div",{style:c.textContainer},void 0,a()("div",{style:c.loadingTitle},void 0,a()(ia.Z,{paragraphs:[{lineHeight:18,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]})),r?a()("div",{style:c.loadingByline},void 0,a()(ia.Z,{paragraphs:[{lineHeight:14,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]})):null)):d?a()("div",{style:c.container},void 0,a()("div",{style:c.titleContainer},void 0,a()(xe.Z,{style:c.errorTitle},void 0,(0,vn.Jx)(d)?d.message:a()(f.FormattedMessage,{id:"spaceAnalytics.basicErrorMessage",defaultMessage:"Something went wrong.{br}Try refreshing the page.",description:"An error messaging saying that something went wrong and suggesting to refresh the page.",values:{br:a()("br",{})}})))):a()("div",{style:c.container},void 0,t?t(c.icon):null,a()("div",{style:c.textContainer},void 0,a()(xe.Z,{style:c.title},void 0,s),r?a()(xe.Z,{style:c.byline},void 0,r):null))}var Uc=i(67579);const Wc=640;function zc(e){let{data:t,loading:i,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"ContentAnalyticsSummaries"};const[l,c]=(0,Oc.e)(),u=(0,_e.yK)((e=>({title:{fontWeight:h.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center",justifyContent:"center"},infoIcon:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{pageViews:p,uniquePageViews:m,pagesCreated:g,pageEdits:v}=t,y=(0,ke.O7)(),S=(0,d.useCallback)((e=>{b.kyK(y,{daysFilter:e}),r(e)}),[y,r]);return d.createElement("div",{style:u.container,ref:l},a()("div",{style:u.titleContainer},void 0,a()(xe.Z,{style:u.title},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.title",defaultMessage:"Content engagement",description:"Title of the user engagement section of the workspace analytics overview."}),a()(Oe.Z,{placement:la.u.Bottom,render:e=>d.createElement(br.Z,s()({},e,{href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:u.infoIcon})),renderTooltip:()=>a()(f.FormattedMessage,"all_time"!==o?{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all workspace pages (includes private and shared) over the {dateRange}",description:"Describe what content engagement is for the overview tab of workspace analytics.",values:{dateRange:V.default.formatMessage(ma.xX[o])}}:{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace (includes private and shared)",description:"Describe what content engagement is for the overview tab of workspace analytics."})})),a()(Uc.f,{currentFilter:o,onChangeFilter:S})),a()(ml,{gap:16},void 0,a()(gl,{row:1,col:1},void 0,a()(Vc,{style:u.cardContainer,textStyles:u.cardTextContainer,loading:i,error:n,icon:Ge.Z.eyePadded,iconStyles:{height:48,width:48},title:a()(f.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.totalViews",defaultMessage:"{pageViews} total views",description:"Title of the content page total views analytics card.",values:{pageViews:a()(Nc,{abbreviateNumber:c<Wc,num:p})}}),byline:a()(xe.Z,{isSecondaryColor:!0},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews} unique page views",description:"Byline of the content page views analytics card telling how many unique views there are.",values:{uniquePageViews:a()(Nc,{abbreviateNumber:c<Wc,num:m})}}))})),a()(gl,{row:1,col:2},void 0,a()(Vc,{style:u.cardContainer,textStyles:u.cardTextContainer,loading:i,error:n,icon:Ge.Z.searchInPage,iconStyles:{height:36,width:36},title:a()(f.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.pagesCreated",defaultMessage:"{pagesCreated} pages created",description:"Title of the content pages created analytics card.",values:{pagesCreated:a()(Nc,{abbreviateNumber:c<Wc,num:g})}}),byline:a()(xe.Z,{isSecondaryColor:!0},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.pageEdits.byline",defaultMessage:"{pageEdits} edits",description:"Byline of the content page views analytics card telling how many page edits there are.",values:{pageEdits:a()(Nc,{abbreviateNumber:c<Wc,num:v})}}))}))))}function Kc(e){window.__c={n:"TooltipColumnHeader"};const{tooltipMessageDescriptor:t,columnHeader:i}=e;return a()(Oe.Z,{placement:Oe.Z.Placement.Top,renderTooltip:e=>d.createElement("div",e,d.createElement(f.FormattedMessage,t)),render:e=>d.createElement("div",e,V.default.formatMessage(i))})}function qc(e){let{blockStore:t}=e;window.__c={n:"PageCellActions"};const i=(0,ke.O7)(),n=(0,Te.qz)(void 0,Tt.Z),o=(0,_e.yK)((e=>({changePermissionsIcon:{height:18,width:18,color:e.regularIconColor,fill:"currentColor"},copyLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor"},openLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor",transform:"rotate(-45deg)"}})),[]);const r={key:"actions",render:e=>d.createElement(rt.Z,e),items:[{key:"copy-link",render:e=>d.createElement(it.Z,s()({},e,{icon:Ge.Z.link(o.copyLinkIcon),title:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page",description:"Title of the action that will copy a link to this page."})})),action:async function(){const e=(0,Ct.ZP)({store:t});await Mt.RD({environment:i,stringValue:e,copiedMessage:Mt.tq.copiedLinkToClipboard}),n.setState({open:!1})}},{key:"open-page-in-new-tab",render:e=>d.createElement(it.Z,s()({},e,{icon:Ge.Z.arrowRight(o.openLinkIcon),title:a()(f.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.openLink",defaultMessage:"Open in new tab",description:"Title of the action that will open a link to this page in a new tab."})})),action:function(){const e=(0,Ct.ZP)({store:t});w.navigateToExternalURL({environment:i,url:e}),n.setState({open:!1})}}]};return a()(xt.Z,{popupType:st.kQ.Popup,alignmentToOrigin:st.ZP.Alignment.Center,placementToOrigin:st.ZP.Placement.Right,style:{width:248},render:()=>a()(at.Z,{menuType:Je.og.Popup,width:248},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:[r]})),buttonPopupStore:n,renderOrigin:e=>d.createElement(Zt.Z,s()({icon:Ge.Z.dots},e))})}const Hc=(0,f.defineMessages)({views:{id:"workspaceAnalytics.contentTab.contentTable.viewsColumn.tooltip",defaultMessage:"Number of times users have viewed the page",description:"Tooltip for the All views column in the content table of workspace analytics"},uniqueViews:{id:"workspaceAnalytics.contentTab.contentTable.uniqueViewsColumn.tooltip",defaultMessage:"Total number of users that have viewed page in the selected period",description:"Tooltip for the Unique views column in the content table of workspace analytics"}}),Gc={id:"page",headerTitle:a()(iu,{message:ma.y3.page}),renderCell:e=>a()(He,{blockStore:e.navigableBlockStore,rightIcon:a()(qc,{blockStore:e.navigableBlockStore})}),widthData:{width:320,maxWidth:320},sortable:!1},jc={id:"location",headerTitle:a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.table.location.name",defaultMessage:"Location",description:"Header for the team column in the admin content search table."}),renderCell:e=>a()(wt,{blockStore:e.navigableBlockStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},$c={id:"audience",headerTitle:a()(iu,{message:ma.y3.audience}),renderCell:e=>a()(xe.Z,{},void 0,vt(e.audience)),widthData:{width:140},sortable:!1},Yc={id:"views",headerTitle:a()(Kc,{tooltipMessageDescriptor:Hc.views,columnHeader:ma.y3.allViews}),renderCell:e=>a()(xe.Z,{},void 0,e.views.toLocaleString()),widthData:{width:100},sortable:!0},Qc={id:"uniqueViews",headerTitle:a()(Kc,{tooltipMessageDescriptor:Hc.uniqueViews,columnHeader:ma.y3.uniqueViews}),renderCell:e=>a()(xe.Z,{},void 0,e.uniqueViews.toLocaleString()),widthData:{width:100},sortable:!0},Xc={id:"createdBy",headerTitle:a()(iu,{message:ma.y3.createdBy}),renderCell:e=>e.createdById?a()(ei,{blockStore:e.navigableBlockStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},Jc={id:"createdTime",headerTitle:a()(iu,{message:ma.y3.createdAt}),renderCell:e=>a()(Ve,{dateTs:e.createdTime}),widthData:{width:100},sortable:!1},eu=[Gc,Yc,Qc,jc,$c,{id:"lastEditedBy",headerTitle:a()(iu,{message:ma.y3.lastEditedBy}),renderCell:e=>e.lastEditedById?a()(ei,{blockStore:e.navigableBlockStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},{id:"lastEditedTime",headerTitle:a()(iu,{message:ma.y3.lastEditedAt}),renderCell:e=>a()(Ve,{dateTs:e.lastEditedTime}),widthData:{width:100},sortable:!1},Xc,Jc];function tu(e){let{navigableBlockStores:t,analyticsByPageId:i,runNewSearch:n,sort:o,setSort:s,loadNextPage:r,loading:l,error:c}=e;const u=(0,Te.VK)((()=>t.map((e=>{var t,n,a;return{id:e.id,isClickable:!1,navigableBlockStore:e,teamStore:(0,Ee.VP)(e),views:(null===(t=i.get(e.id))||void 0===t?void 0:t.pageViews)||0,uniqueViews:(null===(n=i.get(e.id))||void 0===n?void 0:n.uniquePageViews)||0,createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById(),audience:(null===(a=i.get(e.id))||void 0===a?void 0:a.audience)||"private"}}))),[t,i]),p=(0,d.useMemo)((()=>function(e){const t=eu.find((t=>"pageViews"===e.field&&"views"===t.id||"uniquePageViews"===e.field&&"uniqueViews"===t.id));return t?{column:t,sortAscending:"asc"===e.direction}:void 0}(o)),[o]),m=(0,_e.yK)((e=>(0,De.b)({columnRenderInfo:eu,theme:e,containerMarginTop:0})),[]),g=(0,_e.yK)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return c?a()(Xe,{error:c,runNewSearch:n}):d.createElement(d.Fragment,null,a()(De.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:eu,rows:u,sortState:p,onSortStateChanged:e=>{s(function(e){const t="views"===e.column.id?"pageViews":"uniquePageViews",i=e.sortAscending?"asc":"desc";return{field:t,direction:i}}(e))},onScrollBottom:r,renderNoRowsComponent:()=>a()(xe.Z,{isSmall:!0,style:g.emptyQuery},void 0,!l&&0===t.length&&a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.table.empty",defaultMessage:"No pages found with your query.",description:"Message displayed on the table that shows workspace pages if there are no pages to show."})),styles:m}),l?a()(Re.Z,{style:g.loadingSpinner}):null)}function iu(e){let{message:t}=e;const i=(0,f.useIntl)();return d.createElement(d.Fragment,null,i.formatMessage(t))}const nu={query:"",createdBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},au={field:"pageViews",direction:"desc"},ou=Ic,su={filters:nu,sort:au,timeRange:ou,navigableBlockStores:[],analyticsByPageId:new Map,numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};const ru=(0,f.defineMessages)({placeholder:{id:"settings.workspaceAnalytics.contentTab.placeholder",defaultMessage:"Search by title",description:"Placeholder text for writing a new query textbox."}});function lu(e){let{spaceStore:t,timeRange:i,filters:n,runNewSearch:o,setFilters:s,setTimeRange:r}=e;window.__c={n:"SearchInputsSection"};const l=(0,Te.VK)((()=>sd.Z.state.teams),[]),d=(0,_e.yK)((e=>({container:{width:"100%",margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItems:"center"},timeRangeContainer:{display:"flex",flexDirectionRow:"row",alignItems:"center",justifyContent:"center",gap:4,borderRight:`1px solid ${e.tableDividerColor}`,marginRight:12,paddingRight:6}})),[]);return a()("div",{style:d.container},void 0,a()(Ji,{mode:Qi.OnChange,query:n.query,setQueryFilter:function(e){s({query:e},{runSearchAfter:!0})},placeholderText:V.default.formatMessage(ru.placeholder)}),a()("div",{style:d.filterPillsContainer},void 0,a()("div",{style:d.timeRangeContainer},void 0,a()(xe.Z,{isSecondaryColor:!0},void 0,a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.timeRange",defaultMessage:"Views from",description:"Description that prepends the time filter in the content analytics table."})),a()(Uc.f,{currentFilter:i,onChangeFilter:r})),a()(nn,{selectedTeamIds:n.teamIds,setSelectedTeamIds:function(e){s({teamIds:e})},onMenuClose:o,teamStores:l}),a()(bi,{spaceStore:t,createdByFilterIds:n.createdBy,setCreatedByFilter:function(e){s({createdBy:e})},runNewSearch:o,includeGuests:!1}),a()(ji,{lastEditedTime:n.lastEditedTime,createdTime:n.createdTime,setLastEditedTime:function(e){s({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){s({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}})))}function du(e){var t;let{spaceStore:i,contentEngagement:n}=e;window.__c={n:"SpaceAnalyticsContentTab"};const o=(0,d.useRef)(!1),{loadNextPage:s,navigableBlockStores:r,analyticsByPageId:c,runNewSearch:u,setFilters:p,setTimeRange:m,timeRange:g,filters:h,sort:f,setSort:v,loading:y,error:S}=function(e){let{spaceStore:t}=e;const i=(0,ke.O7)(),[n,a]=(0,d.useState)(su),o=(0,d.useRef)(nu),s=(0,d.useRef)(au),r=(0,d.useRef)(ou),c=(0,d.useCallback)((async e=>{let{fetchFromFirstPage:d,ignoreSearchInputComparison:c}=e;const u=!l().isEqual(n.filters,o.current)||!l().isEqual(n.sort,s.current)||!l().isEqual(n.timeRange,r.current);if(!c&&!u)return;o.current=n.filters,s.current=n.sort,r.current=n.timeRange;let p=n.loading,m=n.error,g=n.hasNextPage,h=n.paginationToken;if(d&&(a((e=>({...su,filters:e.filters,timeRange:e.timeRange,sort:e.sort}))),p=su.loading,m=su.error,g=su.hasNextPage,h=su.paginationToken),!g||p)return;if(m)return;a((e=>({...e,loading:!0})));const f=await ge.loadContentAnalytics(i,{spaceId:t.id,sort:n.sort,titleQuery:n.filters.query,filters:{inTeams:n.filters.teamIds,lastEditedTime:(0,Q.Hq)(n.filters.lastEditedTime),createdTime:(0,Q.Hq)(n.filters.createdTime),createdBy:n.filters.createdBy},timeRange:n.timeRange,startCursor:h});if("failed"===f.type)return void a((e=>({...e,loading:!1,error:f.error})));const v=f.data.results;a((e=>{const t=[],n=new Map(e.analyticsByPageId),a=new Set(e.navigableBlockStores.map((e=>e.id)));for(const s of v){const e=s.id,o=s.analytics;if(!a.has(e)){const a=new ze.G(i,{table:dn.iU,id:e});t.push(a),n.set(e,o)}}const o=[...e.navigableBlockStores,...t];return{...e,navigableBlockStores:o,analyticsByPageId:n,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:f.data.nextCursor,hasNextPage:Boolean(f.data.nextCursor)}}))}),[i,t,n.filters,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]);(0,d.useEffect)((()=>{n.shouldReRunSearch&&(a((e=>({...e,shouldReRunSearch:!1}))),c({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,c]);const u=(0,d.useCallback)((async()=>{n.shouldReRunSearch||await c({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,c]),p=(0,d.useCallback)((async e=>{await c({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[c]),m=(0,d.useCallback)(((e,t)=>{a((i=>({...i,filters:{...i.filters,...e},...null!=t&&t.runSearchAfter?{shouldReRunSearch:null==t?void 0:t.runSearchAfter}:void 0})));for(const n of(0,T.Yd)(e))l().isEqual(e[n],nu[n])||b.uSc(i,{filter:n,value:"createdBy"===n||"teamIds"===n?e[n]:void 0})}),[i]),g=(0,d.useCallback)((e=>{a((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),b.e2(i,{daysFilter:e})}),[i]),h=(0,d.useCallback)((e=>{a((t=>({...t,sort:e,shouldReRunSearch:!0}))),b.jMN(i,{column:e.field,isAscending:"asc"===e.direction})}),[i]);return{...n,loadNextPage:u,runNewSearch:p,setFilters:m,setTimeRange:g,setSort:h}}({spaceStore:i}),w=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:16}})),[]),M=(0,Te.VK)((()=>Boolean(i.canAdmin())),[i]);(0,d.useEffect)((()=>{o.current||(u(!0),o.current=!0)}),[u]);const C=(0,Te.VK)((()=>i.getName()),[i]);return"NotFoundError"===(null==n||null===(t=n.error)||void 0===t?void 0:t.name)?a()(Lc,{type:"empty",spaceName:C}):a()("div",{style:w.container},void 0,a()(zc,{data:n.data,loading:n.loading,error:n.error,daysFilter:n.daysFilter,setDaysFilter:n.setDaysFilter}),a()(cu,{canAdmin:M,daysFilter:g}),a()(lu,{spaceStore:i,runNewSearch:u,setFilters:p,filters:h,timeRange:g,setTimeRange:m}),a()(tu,{navigableBlockStores:r,analyticsByPageId:c,runNewSearch:u,sort:f,setSort:v,loadNextPage:s,loading:y,error:S}))}function cu(e){window.__c={n:"ContentTableHeader"};const t=(0,_e.yK)((()=>({sectionTitle:{fontWeight:h.Z.fontWeight.semibold,fontSize:16},sectionTitleSection:{display:"flex",flexFlow:"row",alignItems:"center"},helpInfo:{marginLeft:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:12},exportButton:{marginLeft:5}})),[]),{canAdmin:i,daysFilter:n}=e,o=a()("div",{style:t.sectionTitleSection},void 0,a()(xe.Z,{style:t.sectionTitle},void 0,a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.title",defaultMessage:"Pages",description:"Section title above the content analytics table."})),a()(Oe.Z,{placement:Oe.Z.Placement.Bottom,render:e=>d.createElement(br.Z,s()({},e,{href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:t.helpInfo})),renderTooltip:()=>a()(f.FormattedMessage,"all_time"!==n?{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.lastDays",defaultMessage:"Activity from the {dateRange} on pages you have access to",description:"Describe what content engagement is for the overview tab of workspace analytics.",values:{dateRange:V.default.formatMessage(ma.xX[n])}}:{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.allTime",defaultMessage:"All time activity on pages you have access to in the workspace",description:"Describe what content engagement is for the overview tab of workspace analytics."})}));return a()("div",{style:t.wrapper},void 0,o,i&&a()(Ec,{style:t.exportButton,analyticsType:de.Content}))}var uu=i(76798);function pu(e){let{title:t,items:i,loading:n,error:o}=e;window.__c={n:"AnalyticsCardList"};const s=(0,_e.yK)((e=>({title:{fontWeight:h.Z.fontWeight.semibold,marginBottom:8},container:{flex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",height:"100%",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,padding:12}})),[]);return a()("div",{style:s.container},void 0,a()(xe.Z,{style:s.title},void 0,t),n?d.createElement(d.Fragment,null,a()(gu,{}),a()(gu,{}),a()(gu,{}),a()(gu,{}),a()(gu,{})):o?d.createElement(d.Fragment,null,a()(hu,{})):i.map(((e,t)=>a()(mu,{item:e},t))))}function mu(e){let{item:t}=e;window.__c={n:"CardListItem"};const{store:i,caption:n}=t,o=(0,f.useIntl)(),s=fu(),r=(0,Te.VK)((()=>{switch(i.table){case"block":return a()("div",{style:s.nameAndIconContainer},void 0,a()(Ke.Z,{icon:i.getIcon(),size:18,isEmptyPage:!1,disabled:!0}),a()(uu.ZP,{store:i}));case"notion_user":return a()("div",{style:s.nameAndIconContainer},void 0,a()(Ht.Z,{userStore:i,size:18}),a()(xe.Z,{},void 0,i.getDisplayName(o)));case"team":const e=i.getName();return a()("div",{style:s.nameAndIconContainer},void 0,a()(bt.p,{disabled:!0,store:i,size:20}),a()(xe.Z,{},void 0,e));default:(0,T.t1)(i)}}),[i,s.nameAndIconContainer,o]);return a()("div",{style:s.container},void 0,a()(xe.Z,{style:s.label},void 0,r),a()("div",{style:s.caption},void 0,a()(xe.Z,{isSecondaryColor:!0,isSmall:!0},void 0,n)))}function gu(){window.__c={n:"LoadingCardListItem"};const e=fu();return a()("div",{style:e.container},void 0,a()(xe.Z,{style:e.label},void 0,a()(ia.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})),a()("div",{style:e.loadingCaption},void 0,a()(ia.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})))}function hu(){window.__c={n:"ErrorCardListItem"};const e=fu();return a()("div",{style:e.container},void 0,a()(xe.Z,{style:e.errorLabel},void 0,a()(f.FormattedMessage,{id:"spaceAnalytics.basicErrorMessage",defaultMessage:"Something went wrong.{br}Try refreshing the page.",description:"An error messaging saying that something went wrong and suggesting to refresh the page.",values:{br:a()("br",{})}})))}function fu(){return(0,_e.yK)((e=>({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBlock:4,gap:4},nameAndIconContainer:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:8,alignItems:"center",width:"100%"},label:{width:"100%"},caption:{display:"flex",justifyContent:"center",alignItems:"center"},loadingCaption:{display:"block",width:"50%"},errorLabel:{width:"100%",textAlign:"center",color:ho.ZP.red}})),[])}function vu(e){let{data:t,loading:i,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"ContentEngagement"};const l=(0,ke.O7)(),c=(0,_e.yK)((e=>({title:{fontWeight:h.Z.fontWeight.medium,fontSize:16,marginBlock:"9px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},overviewCard:{width:"fit-content"}})),[]),[u,p]=(0,Oc.e)(),{pageViews:m,uniquePageViews:g,pageEdits:v,topPages:y}=t,S=(0,Te.VK)((()=>y.map((e=>{let{pageId:t,pageViews:i}=e;return{store:new ze.G(l,{id:t,table:dn.iU}),caption:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.caption.pageView",defaultMessage:"{pageViews} views",description:"Caption of a data point that shows how many page views the page has.",values:{pageViews:a()(Nc,{abbreviateNumber:!1,num:i})}})}}))),[l,y]),w=(0,d.useCallback)((e=>{r(e),b.m0A(l,{filter:"content_engagement",daysFilter:e})}),[l,r]);return d.createElement("div",{style:c.container,ref:u},a()("div",{style:c.titleContainer},void 0,a()(xe.Z,{style:c.title},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.title",defaultMessage:"Content engagement",description:"Title of the user engagement section of the workspace analytics overview."}),a()(Oe.Z,{placement:la.u.Bottom,render:e=>d.createElement(br.Z,s()({},e,{href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:c.helpInfo})),renderTooltip:()=>a()(f.FormattedMessage,"all_time"!==o?{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all pages in the workspace over the {dateRange}",description:"Describe what content engagement is for the overview tab of workspace analytics.",values:{dateRange:V.default.formatMessage(ma.xX[o])}}:{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace",description:"Describe what content engagement is for the overview tab of workspace analytics."})})),a()(Uc.f,{currentFilter:o,onChangeFilter:w})),a()(ml,{gap:16},void 0,a()(gl,{row:1,col:1,colEnd:3},void 0,a()(Vc,{loading:i,error:n,icon:Ge.Z.eyePadded,textStyles:c.overviewCard,title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.views",defaultMessage:"{pageViews} total views",description:"Title of the content page views analytics card.",values:{pageViews:a()(Nc,{abbreviateNumber:p<640,num:m})}})})),a()(gl,{row:2,col:1,colEnd:3},void 0,a()(Vc,{loading:i,error:n,icon:Ge.Z.personCircle,textStyles:c.overviewCard,iconStyles:{height:18,width:18},title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews} unique page views",description:"Title of the content unique views analytics card.",values:{uniquePageViews:a()(Nc,{abbreviateNumber:p<640,num:g})}})})),a()(gl,{row:3,col:1,colEnd:3},void 0,a()(Vc,{loading:i,error:n,icon:Ge.Z.editPropertyType,textStyles:c.overviewCard,iconStyles:{height:18,width:18},title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.pageEdits",defaultMessage:"{pageEdits} edits",description:"Title of the content edits analytics card.",values:{pageEdits:a()(Nc,{abbreviateNumber:p<640,num:v})}})})),a()(gl,{row:1,rowEnd:4,col:3,colEnd:5},void 0,a()(pu,{loading:i,error:n,title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.popularPages",defaultMessage:"Most popular pages",description:"Title of the popular pages analytics card."}),items:S}))))}function yu(e){let{data:t,loading:i,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"UserEngagement"};const l=(0,ke.O7)(),{activeMembersCount:c,previousActiveMembersCount:u,activeGuestsCount:p,previousActiveGuestsCount:m,topTeamspaces:g,topViewers:v,topEditors:y}=t,S=(0,_e.yK)((e=>({title:{fontWeight:h.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},summaryCard:{height:70},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16}})),[]),[w,M]=(0,Oc.e)(),C=(0,d.useCallback)((e=>{b.m0A(l,{filter:"user_engagement",daysFilter:e}),r(e)}),[l,r]),k=(0,Te.VK)((()=>g.map((e=>{let{teamspaceId:t,pageViews:i}=e;return{store:new ze.zX(l,{id:t,table:ht.e0}),caption:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageViews",defaultMessage:"{pageViews} views",description:"Caption of a data point that shows how many views the teamspace has.",values:{pageViews:a()(Nc,{abbreviateNumber:!0,num:i})}})}})).filter((e=>e.store.canRead())).slice(0,5)),[l,g]),T=(0,Te.VK)((()=>v.map((e=>{let{userId:t,pageViews:i}=e;return{store:new ze.U6(l,{id:t,table:Kt.KJ}),caption:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageView",defaultMessage:"{pageViews} views",description:"Caption of a data point that shows how many page views the user has.",values:{pageViews:a()(Nc,{abbreviateNumber:!0,num:i})}})}})).slice(0,5)),[l,v]),_=(0,Te.VK)((()=>y.map((e=>{let{userId:t,pageEdits:i}=e;return{store:new ze.U6(l,{id:t,table:Kt.KJ}),caption:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageEdits",defaultMessage:"{pageEdits} edits",description:"Caption of a data point that shows how many edits the user has made.",values:{pageEdits:a()(Nc,{abbreviateNumber:!0,num:i})}})}})).slice(0,5)),[l,y]);return d.createElement("div",{style:S.container,ref:w},a()("div",{style:S.titleContainer},void 0,a()(xe.Z,{style:S.title},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.title",defaultMessage:"User engagement",description:"Title of the user engagement section of the workspace analytics overview."}),a()(Oe.Z,{placement:la.u.Bottom,render:e=>d.createElement(br.Z,s()({},e,{href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:S.helpInfo})),renderTooltip:()=>a()(f.FormattedMessage,"all_time"!==o?{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",description:"Describe what user engagement is for the overview tab of workspace analytics.",values:{dateRange:V.default.formatMessage(ma.xX[o])}}:{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace",description:"Describe what user engagement is for the overview tab of workspace analytics."})})),a()(Uc.f,{currentFilter:o,onChangeFilter:C})),a()(ml,{gap:16},void 0,a()(gl,{row:1,col:1},void 0,a()(Vc,{style:S.summaryCard,loading:i,error:n,title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",description:"Title of the active members analytics card.",values:{activeMembersCount:a()(Nc,{abbreviateNumber:M<640,num:c})}}),byline:void 0!==u?a()(bu,{userType:"members",daysFilter:o,count:c,previousCount:u}):null})),a()(gl,{row:1,col:2},void 0,a()(Vc,{style:S.summaryCard,loading:i,error:n,title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",description:"Title of the active guests analytics card.",values:{activeGuestsCount:a()(Nc,{abbreviateNumber:M<640,num:p})}}),byline:void 0!==m?a()(bu,{userType:"guests",daysFilter:o,count:p,previousCount:m}):null}))),a()(ml,{gap:16},void 0,a()(gl,{row:1,col:1},void 0,a()(pu,{loading:i,error:n,title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeTeamspaces",defaultMessage:"Most active teamspaces",description:"Title of the active teamspaces analytics card."}),items:k})),a()(gl,{row:1,col:2},void 0,a()(pu,{loading:i,error:n,title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeViewers",defaultMessage:"Most active viewers",description:"Title of the active viewers analytics card."}),items:T})),a()(gl,{row:1,col:3},void 0,a()(pu,{loading:i,error:n,title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeEditors",defaultMessage:"Most active editors",description:"Title of the active editors analytics card."}),items:_}))))}function bu(e){let{userType:t,daysFilter:i,count:n,previousCount:o}=e;window.__c={n:"MetricsChangeMessage"};const s=0===n&&0===o?0:Math.round((n-o)/o*100);let r;r=s===1/0?function(e,t,i){if("all_time"===i)return a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet",description:"Message explaining that there are no changes in analytics yet."});return a()(f.FormattedMessage,"guests"===e?{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.guests.positive",defaultMessage:"{changeValue} more guests than previous {numberOfDays} days",description:"Message explaining the upward change in number of guests in the last 90 days.",values:{changeValue:t.toLocaleString(),numberOfDays:ma.ez[i].toLocaleString()}}:{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.members.positive",defaultMessage:"{changeValue} more members than previous {numberOfDays} days",description:"Message explaining the upward change in number of guests in the last number of days.",values:{changeValue:t.toLocaleString(),numberOfDays:ma.ez[i].toLocaleString()}})}(t,n,i):function(e,t){switch(t){case"all_time":return a()(f.FormattedMessage,0===e?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet",description:"Message explaining that there are no changes in analytics yet."}:e>0?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.positive",defaultMessage:"{changeInPercentage}% more since the start",description:"Message explaining the upward change in analytics since the starting time period.",values:{changeInPercentage:Math.abs(e)}}:{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.negative",defaultMessage:"{changeInPercentage}% less since the start",description:"Message explaining the downward change in analytics since the starting time period.",values:{changeInPercentage:Math.abs(e)}});case"last_90_days":return a()(f.FormattedMessage,0===e?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.none",defaultMessage:"No changes in previous 90 days",description:"Message explaining that there are no changes in analytics in the past 90 days."}:e>0?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.positive",defaultMessage:"{changeInPercentage}% more than previous 90 days",description:"Message explaining the upward change in analytics in the last 90 days.",values:{changeInPercentage:Math.abs(e)}}:{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.negative",defaultMessage:"{changeInPercentage}% less than previous 90 days",description:"Message explaining the downward change in analytics in the last 90 days.",values:{changeInPercentage:Math.abs(e)}});case"last_28_days":return a()(f.FormattedMessage,0===e?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.none",defaultMessage:"No changes in previous 28 days",description:"Message explaining that there are no changes in analytics in the past 28 days."}:e>0?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.positive",defaultMessage:"{changeInPercentage}% more than previous 28 days",description:"Message explaining the upward change in analytics in the last 28 days.",values:{changeInPercentage:Math.abs(e)}}:{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.negative",defaultMessage:"{changeInPercentage}% less than previous 28 days",description:"Message explaining the downward change in analytics in the last 28 days.",values:{changeInPercentage:Math.abs(e)}});case"last_7_days":return a()(f.FormattedMessage,0===e?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.none",defaultMessage:"No changes in previous 7 days",description:"Message explaining that there are no changes in analytics in the past 7 days."}:e>0?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.positive",defaultMessage:"{changeInPercentage}% more than previous 7 days",description:"Message explaining the upward change in analytics in the last 7 days.",values:{changeInPercentage:Math.abs(e)}}:{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.negative",defaultMessage:"{changeInPercentage}% less than previous 7 days",description:"Message explaining the downward change in analytics in the last 7 days.",values:{changeInPercentage:Math.abs(e)}});default:(0,T.t1)(t)}}(s,i);const l=s>0?Ge.Z.alias({height:12,width:12,fill:"currentColor"}):s<0?Ge.Z.alias({height:12,width:12,transform:"rotate(90deg)",fill:"currentColor"}):void 0,d=(0,_e.yK)((e=>({text:{color:s>0?e.accentColors.green[500]:s<0?e.accentColors.red[500]:e.lightTextColor,display:"flex",alignItems:"center",gap:4}})),[s]);return a()("span",{style:d.text},void 0,l,r)}function Su(e){var t,i;let{onUserTabFilterChange:n,spaceStore:o,contentEngagement:s,userEngagement:r}=e;window.__c={n:"SpaceAnalyticsOverviewTab"};const l=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:24}})),[]),d=(0,Te.VK)((()=>o.getName()),[o]);if("NotFoundError"===(null===(t=s.error)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(i=r.error)||void 0===i?void 0:i.name))return a()(Lc,{type:"empty",spaceName:d});return a()("div",{style:l.container},void 0,a()(yu,{data:r.data,loading:r.loading,error:r.error,daysFilter:r.daysFilter,setDaysFilter:function(e){n({graphFilter:"all_time"===e?"last_90_days":e}),r.setDaysFilter(e)}}),a()(vu,{data:s.data,loading:s.loading,error:s.error,daysFilter:s.daysFilter,setDaysFilter:s.setDaysFilter}))}const wu={field:"num_searches",direction:"desc"},Mu=Ic,Cu={sort:wu,timeRange:Mu,searchAnalyticsDataList:[],numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};const ku=(0,f.defineMessages)({numSearches:{id:"workspaceAnalytics.searchTab.searchTable.searches.tooltip",defaultMessage:"Number of times users in the workspace have searched the query",description:"Describes meaning of Unique searchess column in the search query table in workspace analytics"},numUniqueUsers:{id:"workspaceAnalytics.searchTab.searchTable.uniqueSearches.tooltip",defaultMessage:"Total number of users that have searched the query",description:"Describes meaning of Unique searchess column in the search query table in workspace analytics"},ctr:{id:"workspaceAnalytics.searchTab.searchTable.ctr.tooltip",defaultMessage:"Percentage of times users have opened page from results of this query",description:"Describes meaning of Click through rate column in the search query table in workspace analytics"}}),Tu=(0,f.defineMessages)({queryText:{id:"spaceAnalyticsSearchTable.column.query",defaultMessage:"Query",description:"Name of the query column for search query tab in workspace analytics"},numSearches:{id:"spaceAnalyticsSearchTable.column.searches",defaultMessage:"Searches",description:"Name of the searches column for search query tab in workspace analytics"},numUniqueUsers:{id:"spaceAnalyticsSearchTable.column.uniqueSearches",defaultMessage:"Unique searches",description:"Name of the unique searches column for search query tab in workspace analytics"},ctr:{id:"spaceAnalyticsSearchTable.column.ctr",defaultMessage:"Click-through rate",description:"Name of the click through rate column for search query tab in workspace analytics"}}),_u={queryText:{id:"queryText",headerTitle:V.default.formatMessage(Tu.queryText),renderCell:e=>a()(xe.Z,{},void 0,e.queryText),widthData:{width:200,maxWidth:300},sortable:!1},numSearches:{id:"numSearches",headerTitle:a()(Kc,{tooltipMessageDescriptor:ku.numSearches,columnHeader:Tu.numSearches}),renderCell:e=>a()(Zu,{value:e.numSearches}),widthData:{width:120,maxWidth:120},sortable:!0},numUniqueUsers:{id:"numUniqueUsers",headerTitle:a()(Kc,{tooltipMessageDescriptor:ku.numUniqueUsers,columnHeader:Tu.numUniqueUsers}),renderCell:e=>a()(Zu,{value:e.numUniqueUsers}),widthData:{width:120,maxWidth:120},sortable:!0},ctr:{id:"ctr",headerTitle:a()(Kc,{tooltipMessageDescriptor:ku.ctr,columnHeader:Tu.ctr}),renderCell:e=>a()(Zu,{value:Math.round(1e3*e.ctr)/1e3,isPercentage:!0}),widthData:{width:120,maxWidth:120},sortable:!0}},Iu=(0,T.Yd)(_u).map((e=>_u[e]));function xu(e){let{searchAnalyticsDataList:t,runNewSearch:i,sort:n,setSort:o,loadNextPage:s,loading:r,error:l}=e;window.__c={n:"SpaceAnalyticsTable"};const c=(0,Te.VK)((()=>t.map((e=>({id:e.queryText,isClickable:!1,...e})))),[t]),u=(0,d.useMemo)((()=>function(e){const t=ma.Fi[e.field];if(!t)return;return{column:_u[t],sortAscending:"asc"===e.direction}}(n)),[n]),p=(0,_e.yK)((e=>(0,De.b)({columnRenderInfo:Iu,theme:e,containerMarginTop:0})),[]),m=(0,_e.yK)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return l?a()(Xe,{error:l,runNewSearch:i}):a()("div",{},void 0,a()(De.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Iu,rows:c,sortState:u,onSortStateChanged:e=>{o(function(e){const t=ma.hx[e.column.id],i=e.sortAscending?"asc":"desc";if(!t)return{field:"num_searches",direction:i};return{field:t,direction:i}}(e))},onScrollBottom:s,renderNoRowsComponent:()=>a()(xe.Z,{isSmall:!0,style:m.emptyQuery},void 0,!r&&0===t.length&&a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.searchTable.table.empty",defaultMessage:"No search query analytics to display.",description:"Message displayed on the table that shows search query analytics when there are no data to display."})),styles:p}),r?a()(Re.Z,{style:m.loadingSpinner}):null)}function Zu(e){let{value:t,isPercentage:i}=e;window.__c={n:"CenteredNumericCell"};const n=(0,_e.yK)((e=>({centered:{width:"100%",textAlign:"center"}})),[]),o=i?`${t}%`:t;return a()(xe.Z,{style:n.centered},void 0,o)}function Pu(e){const{spaceStore:t}=e,i=(0,_e.yK)((()=>({header:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontWeight:h.Z.fontWeight.semibold,fontSize:16,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4}})),[]),n=(0,d.useRef)(!1),{searchAnalyticsDataList:o,timeRange:r,sort:c,loading:u,error:p,loadNextPage:m,runNewSearch:g,setTimeRange:v,setSort:y}=function(e){let{spaceStore:t}=e;const i=(0,ke.O7)(),[n,a]=(0,d.useState)(Cu),o=(0,d.useRef)(wu),s=(0,d.useRef)(Mu),r=(0,d.useCallback)((async e=>{let{fetchFromFirstPage:r,ignoreSearchInputComparison:d}=e;const c=!l().isEqual(n.sort,o.current)||!l().isEqual(n.timeRange,s.current);if(!d&&!c)return;o.current=n.sort,s.current=n.timeRange;let u=n.loading,p=n.error,m=n.hasNextPage,g=n.paginationToken;if(r&&(a((e=>({...Cu,timeRange:e.timeRange,sort:e.sort}))),u=Cu.loading,p=Cu.error,m=Cu.hasNextPage,g=Cu.paginationToken),!m||u)return;if(p)return;a((e=>({...e,loading:!0})));const h=await ge.loadSearchAnalytics(i,{spaceId:t.id,sort:n.sort,timeRange:n.timeRange,startCursor:g});if("failed"===h.type)return void a((e=>({...e,loading:!1,error:h.body})));const f=h.data.results;a((e=>{const t=[],i=new Set(e.searchAnalyticsDataList.map((e=>e.queryText)));for(const a of f){const e=a.queryText;i.has(e)||(t.push(a),i.add(e))}const n=[...e.searchAnalyticsDataList,...t];return{...e,searchAnalyticsDataList:n,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:h.data.nextCursor,hasNextPage:Boolean(h.data.nextCursor)}}))}),[i,t,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]);(0,d.useEffect)((()=>{n.shouldReRunSearch&&(a((e=>({...e,shouldReRunSearch:!1}))),r({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,r]);const c=(0,d.useCallback)((async()=>{n.shouldReRunSearch||await r({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,r]),u=(0,d.useCallback)((async e=>{await r({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[r]),p=(0,d.useCallback)((e=>{"all_time"!==e&&(a((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),b.yef(i,{daysFilter:e}))}),[i]),m=(0,d.useCallback)((e=>{a((t=>({...t,sort:e,shouldReRunSearch:!0}))),b.$fF(i,{column:e.field,isAscending:"asc"===e.direction})}),[i]);return{...n,loadNextPage:c,runNewSearch:u,setTimeRange:p,setSort:m}}({spaceStore:t});(0,d.useEffect)((()=>{n.current||(g(!0),n.current=!0)}),[g]);const S=(0,Te.VK)((()=>t.getName()),[t]);return"NotFoundError"===(null==p?void 0:p.name)?a()(Lc,{type:"empty",spaceName:S}):d.createElement(d.Fragment,null,a()("div",{style:i.header},void 0,a()(xe.Z,{style:i.sectionTitle},void 0,a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.title",defaultMessage:"Search queries",description:"Section title above the search queries table."}),a()(Oe.Z,{placement:Oe.Z.Placement.Bottom,render:e=>d.createElement(br.Z,s()({},e,{href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:i.helpInfo})),renderTooltip:()=>a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.tooltip",defaultMessage:"Displays popular search queries in the workspace from the {dateRange}",description:"Describe the search queries table is for in workspace analytics.",values:{dateRange:V.default.formatMessage(ma.xX[r])}})})),a()(Uc.f,{currentFilter:r,onChangeFilter:v,hideAllTime:!0})),a()(xu,{searchAnalyticsDataList:o,runNewSearch:g,sort:c,setSort:y,loadNextPage:m,loading:u,error:p}))}var Fu=i(16444);function Au(e){let{data:t,loading:i,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"UsersAnalyticsSummaries"};const[l,c]=(0,Oc.e)(),u=(0,_e.yK)((e=>({title:{fontWeight:h.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},container:{display:"flex",flexDirection:"column",gap:16},helpInfo:{marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},summaryCard:{height:70},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{activeMembersCount:p,previousActiveMembersCount:m,activeGuestsCount:g,previousActiveGuestsCount:v}=t;return d.createElement("div",{style:u.container,ref:l},a()("div",{style:u.titleContainer},void 0,a()(xe.Z,{style:u.title},void 0,a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.title",defaultMessage:"User engagement",description:"User engagement section title for users tab of workspace analytics."}),a()(Oe.Z,{placement:la.u.Bottom,render:e=>d.createElement(br.Z,s()({},e,{href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:u.helpInfo})),renderTooltip:()=>a()(f.FormattedMessage,"all_time"!==o?{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",description:"Describe what user engagement is for the users tab of workspace analytics.",values:{dateRange:V.default.formatMessage(ma.xX[o])}}:{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace",description:"Describe what user engagement is for the users tab of workspace analytics."})})),a()(Uc.f,{currentFilter:o,onChangeFilter:r})),a()(ml,{gap:16},void 0,a()(gl,{row:1,col:1},void 0,a()(Vc,{style:u.summaryCard,loading:i,error:n,title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",description:"Title of the active members analytics card.",values:{activeMembersCount:a()(Nc,{abbreviateNumber:c<640,num:p})}}),byline:void 0!==m?a()(bu,{userType:"members",daysFilter:o,count:p,previousCount:m}):null})),a()(gl,{row:1,col:2},void 0,a()(Vc,{style:u.summaryCard,loading:i,error:n,title:a()(f.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",description:"Title of the active guests analytics card.",values:{activeGuestsCount:a()(Nc,{abbreviateNumber:c<640,num:g})}}),byline:void 0!==v?a()(bu,{userType:"guests",daysFilter:o,count:g,previousCount:v}):null}))))}var Bu=i(88775);const Eu=(0,f.defineMessages)({page_views:{id:"workspaceAnalytics.usersTab.usersTable.pageViews.tooltip",defaultMessage:"Total number of page views for the user across all pages in the workspace",description:"Describes meaning of Page views column in the users table in workspace analytics"},page_edits:{id:"workspaceAnalytics.usersTab.usersTable.pageEdits.tooltip",defaultMessage:"Total number of page edits for the user across all pages in the workspace",description:"Describes meaning of Page edits column in the users table in workspace analytics"}}),Du=(0,f.defineMessages)({user:{id:"spaceAnalyticsUsersTab.column.user",defaultMessage:"User",description:"Name of the user column for users tab in workspace analytics"},page_views:{id:"spaceAnalyticsUsersTab.column.pageViews",defaultMessage:"Page views",description:"Name of the page views column for users tab in workspace analytics"},page_edits:{id:"spaceAnalyticsUsersTab.column.pageEdits",defaultMessage:"Page edits",description:"Name of the page edits column for users tab in workspace analytics"},last_active:{id:"spaceAnalyticsUsersTab.column.lastActive",defaultMessage:"Last active",description:"Name of the last active column for users tab in workspace analytics"},teams:{id:"spaceAnalyticsUsersTab.column.teams",defaultMessage:"Teamspaces",description:"Name of the teamspaces column for users tab in workspace analytics"}}),Ru={user:{id:"user",renderCell:function(e){window.__c={n:"UserCell"};const t=(0,_e.yK)((e=>({container:{height:52}})),[]);return a()(aa.Z,{containerStyle:t.container,actorStore:e.userStore,spaceRole:e.role&&(0,aa.K)(e.role)})},headerTitle:V.default.formatMessage(Du.user),widthData:{width:100},sortable:!1},page_views:{id:"page_views",renderCell:function(e){window.__c={n:"PageViewsCell"};const{page_views:t}=e,i=(0,_e.yK)((e=>({eyeHideIcon:{width:20,height:20,color:e.lightIconColor},cell:{marginLeft:10}})),[]);if(void 0===t)return a()(Oe.Z,{placement:Oe.Z.Placement.Bottom,render:e=>d.createElement("div",e,Ge.Z.eyeHidePadded(i.eyeHideIcon)),renderTooltip:e=>a()(f.FormattedMessage,{id:"spaceAnalyticsUsersTab.optedOutUser.icon.tooltip",defaultMessage:"User has disabled page view tracking",description:"Message displayed in tooltip that shows when hovering over the user opted out icon in workspace analytics"})});return a()(xe.Z,{},void 0,t)},headerTitle:a()(Kc,{tooltipMessageDescriptor:Eu.page_views,columnHeader:Du.page_views}),widthData:{width:80},sortable:!0},page_edits:{id:"page_edits",renderCell:function(e){window.__c={n:"PageEditsCell"};const{page_edits:t}=e;return a()(xe.Z,{},void 0,t)},headerTitle:a()(Kc,{tooltipMessageDescriptor:Eu.page_edits,columnHeader:Du.page_edits}),widthData:{width:80},sortable:!0},last_active:{id:"last_active",renderCell:function(e){window.__c={n:"LastActiveCell"};const t=e.last_active;let i;i=t?a()(Ve,{dateTs:t}):a()(xe.Z,{isSecondaryColor:!0},void 0,a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userTable.lastActiveTimestamp.noLastActive",defaultMessage:"No activity",description:"Message displayed when user has no activity in the selected time range."}));return a()("div",{},void 0,i)},headerTitle:V.default.formatMessage(Du.last_active),widthData:{width:50},sortable:!0},teams:{id:"teams",renderCell:function(e){window.__c={n:"TeamsCell"};const{userStore:t,role:i}=e;if(!i)return a()(xe.Z,{},void 0,a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.teamsColumn.guest",defaultMessage:"None",description:"Value for teamspaces column when user is guest"}));return a()(Bu.Z,{member:{userId:t.id,role:i}})},headerTitle:V.default.formatMessage(Du.teams),widthData:{width:50},sortable:!1}};const Lu=(0,T.Yd)(Ru).map((e=>Ru[e]));function Ou(e){const t=(0,ke.O7)(),[i,n]=(0,d.useState)(25),{usersAndStats:o,filter:s,onUserTabFilterChange:r,usersAndStatsError:l}=e,c=(0,Te.VK)((()=>{const{currentSpaceStore:e}=I.default.state,t=(null==e?void 0:e.getPermissionItems().filter(gt.jg))||[],i={};for(const n of t)i[n.user_id]=n.role;return i}),[]),[u,p]=(0,d.useState)({column:Ru.last_active,sortAscending:!1}),m=(0,d.useCallback)((e=>{b.gEE(t,{column:e.column.id,isAscending:e.sortAscending}),p(e)}),[p,t]),g=o.map((e=>{let{userStore:t,stats:i}=e;return{id:i.userId,userStore:t,isClickable:!1,last_active:i.lastActive,page_views:i.numPageViews,page_edits:i.numPageEdits,role:c[i.userId]}})).sort(function(e){switch(e.column.id){case"last_active":return(t,i)=>(0,ma.Zj)(t.last_active,i.last_active,e.sortAscending);case"page_views":return(t,i)=>(0,ma.yM)(t.page_views,i.page_views,e.sortAscending);case"page_edits":return(t,i)=>e.sortAscending?t.page_edits-i.page_edits:i.page_edits-t.page_edits;default:return(e,t)=>0}}(u)),h=(0,d.useMemo)((()=>g.slice(0,i)),[g,i]),v=(0,_e.yK)((e=>({error:{color:ho.ZP.red},dateFilterPill:{display:"flex",marginTop:10,marginBottom:15,flexFlow:"row",alignItems:"center"},timeFilterDescription:{marginRight:5}})),[]);const y=(0,d.useCallback)((e=>{b.IwD(t,{daysFilter:e}),r({tableFilter:e})}),[t,r]),S=(0,_e.yK)((e=>(0,De.b)({columnRenderInfo:Lu,theme:e,containerMarginTop:0})),[]);return d.createElement(d.Fragment,null,l&&a()(xe.Z,{isMultiline:!1,style:v.error},void 0,l),a()("div",{style:v.dateFilterPill},void 0,a()(xe.Z,{isSecondaryColor:!0,style:v.timeFilterDescription},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.timeFilter.description",defaultMessage:"Views and edits from",description:"Description that prepends the time filter in the users analytics table"})),a()(Uc.f,{currentFilter:s,onChangeFilter:y})),a()(De.D,{allowHorizontalScroll:!0,hideHeaderRowPadding:!0,setStickyHeaderRow:!0,maxHeight:500,sortState:u,onSortStateChanged:m,columnRenderInfo:Lu,rows:h,renderNoRowsComponent:()=>a()("div",{},void 0,"N/A"),styles:S,onScrollBottom:function(){i<o.length&&n(i+25)}}))}function Nu(e){var t,i;let{spaceStore:n,usersTabData:o,onUserTabFilterChange:r,userEngagement:l}=e;window.__c={n:"SpaceAnalyticsUsersTab"};const[c,u]=(0,Oc.e)(),p=(0,_e.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},sectionTitle:{fontWeight:h.Z.fontWeight.medium,fontSize:16},sectionTitleLeft:{marginBlock:"8px 4px",marginBottom:5,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-around"},numUsersCaption:{display:"flex"},overviewText:{textAlign:"center"},error:{color:ho.ZP.red},tableHeader:{marginTop:20,flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"end"},tooltip:{marginLeft:3},infoIcon:{height:14,width:14,color:e.mediumTextColor}})),[]),m=(0,ke.O7)(),g=(0,f.useIntl)(),v=(0,d.useCallback)((e=>{b.KCu(m,{daysFilter:e});r({graphFilter:"all_time"===e?"last_90_days":e}),l.setDaysFilter(e)}),[r,l,m]),y=(0,Te.VK)((()=>n.getName()),[n]);if("NotFoundError"===(null==o||null===(t=o.usersAndStatsError)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(i=l.error)||void 0===i?void 0:i.name))return a()(Lc,{type:"empty",spaceName:y});const S=Math.floor(u-8);return a()("div",{style:p.container},void 0,a()(Au,{data:l.data,loading:l.loading,error:l.error,daysFilter:l.daysFilter,setDaysFilter:v}),a()(Vu,{},void 0,d.createElement("div",{ref:c},o?a()(Uu,{width:S,dailyUsersData:o.dailyUsersData,userEngagementDaysFilter:l.daysFilter,daysFilter:o.graphFilter,dailyUsersError:o.dailyUsersError&&Fc(o.dailyUsersError,g)}):a()(Wu,{}))),a()("div",{style:p.tableHeader},void 0,a()("div",{style:p.sectionTitleLeft},void 0,a()(xe.Z,{style:p.sectionTitle},void 0,a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.allUsers.title",defaultMessage:"All members in Notion",description:"Section title above users graph for workspace analytics."})),a()(Oe.Z,{placement:la.u.Bottom,render:e=>d.createElement(br.Z,s()({},e,{href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:p.helpInfo})),renderTooltip:()=>o&&"all_time"!==o.tableFilter?a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.lastDays",defaultMessage:"Per member workspace activity over the {dateRange}",description:"Describe what user engagement is for the users tab of workspace analytics.",values:{dateRange:V.default.formatMessage(ma.xX[o.tableFilter])}}):a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.allTime",defaultMessage:"All time per member workspace activity",description:"Describe what user engagement is for the users tab of workspace analytics."})})),a()(Ec,{analyticsType:de.Users})),o?a()(Ou,{filter:o.tableFilter,usersAndStats:o.usersAndStats,onUserTabFilterChange:r,usersAndStatsError:o.usersAndStatsError&&Fc(o.usersAndStatsError,g)}):null)}function Vu(e){window.__c={n:"DisplayBox"};const t=(0,_e.yK)((e=>({border:{borderRadius:3,overflow:"hidden",border:`1px solid ${e.regularDividerColor}`,backgroundColor:e.contentBackground,color:e.regularTextColor,padding:20}})),[]);return a()("div",{style:t.border},void 0,e.children)}function Uu(e){const{width:t,dailyUsersData:i,userEngagementDaysFilter:n,daysFilter:o,dailyUsersError:r}=e,l=(0,_e.yK)((e=>({graphHeader:{marginBottom:10,display:"flex",justifyContent:"space-between"},graphTitle:{fontSize:h.Z.fontSize.UIRegular.desktop,fontWeight:"bolder",display:"flex",alignItems:"center",height:24},graphCaption:{fontSize:h.Z.fontSize.UISmall.desktop},graphTooltip:{marginLeft:5,width:14,height:14},helpInfo:{marginLeft:4},emptyGraphBody:{textAlign:"center",paddingTop:50,paddingBottom:50},error:{color:ho.ZP.red},graphSubLabel:{paddingTop:4,color:"grey"}})),[]),{blueLayer:c}=(0,Fu.useTimeSeriesPalette)(),u=(0,Te.VK)((()=>{if(0===i.length)return;return{startDate:i[0].ds,endDate:i[i.length-1].ds}}),[i]),p=(0,Te.VK)((()=>i.map((e=>({ds:e.ds,values:{active_members:e.active_members||0}})))),[i]);let m;return m=!u||i.length<3?a()("div",{style:l.emptyGraphBody},void 0,a()(xe.Z,{isSecondaryColor:!0},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.emptyGraph",defaultMessage:"Not enough data to display graph",description:"Placeholder text when there is not enough data points to display the user over time graph."}))):a()(kt.LazyTimeSeries,{startDate:u.startDate,endDate:u.endDate,width:t,data:p,height:300,layers:[{key:"active_members",...c,renderLabel:e=>a()(f.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers",defaultMessage:"{activeMembers, plural, one {1 active member} other {{activeMembers} active members}}",description:"A label active (logged in and used Notion) members in a workspace per day in the users analytics graph.",values:{activeMembers:e}})}],renderTooltipSubLabel:()=>a()("div",{style:l.graphSubLabel},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers.sublabel",defaultMessage:"Viewed a page in the {dateRange}",description:"Provides a definition of the active members on the graph",values:{dateRange:V.default.formatMessage(ma.xX[o])}}))}),d.createElement(d.Fragment,null,a()("div",{style:l.graphHeader},void 0,a()(xe.Z,{style:l.graphTitle},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.membersOverTime.title",defaultMessage:"Active members over time",description:"Title of the user analytics daily user graph."}),"all_time"===n&&a()(Oe.Z,{placement:la.u.Bottom,render:e=>d.createElement(br.Z,s()({},e,{href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:l.helpInfo})),renderTooltip:()=>a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.membersOverTime.allTimeTooltip",defaultMessage:"All Time selection shows members who have viewed a page in the last 90 days.",description:"Describes edge case of the members over time graph where All Time defaults to last 90 days instead."})}))),r&&a()(xe.Z,{isMultiline:!1,style:l.error},void 0,r),m)}function Wu(){return window.__c={n:"LoadingUsersOverTimeGraph"},a()("div",{},void 0,a()(ia.Z,{paragraphs:[{lineHeight:18,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]}),a()(ia.Z,{paragraphs:[{lineHeight:300,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:12}]}))}const zu={[de.Overview]:a()(f.FormattedMessage,{id:"workspaceAnalyticsTabs.overview.title",defaultMessage:"Overview",description:"Title for the overview tab in workspace analytics"}),[de.Users]:a()(f.FormattedMessage,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members",description:"Title for the members tab in workspace analytics"}),[de.Content]:a()(f.FormattedMessage,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content",description:"Title for the content tab in workspace analytics"}),[de.Search]:a()(f.FormattedMessage,{id:"workspaceAnalyticsTabs.search.title",defaultMessage:"Search",description:"Title for the search tab in workspace analytics"})};const Ku=function(e){let{spaceStore:t}=e;window.__c={n:"SpaceAnalytics"};const i=(0,_e.yK)((e=>({headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:h.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},title:{display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},tabsStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14}})),[]),n=(0,ke.O7)(),o=(0,Te.VK)((()=>{var e;return null===(e=I.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),r=function(e){let{spaceId:t}=e;const i=(0,ke.O7)(),[n,a]=(0,d.useState)("last_90_days"),[{status:o,value:s,error:r}]=(0,is.r5)((async()=>{const e=await ge.getContentEngagementAnalytics(i,{spaceId:t,daysFilter:n});switch(e.type){case"success":return{pageViews:e.data.pageViews,uniquePageViews:e.data.uniquePageViews,pagesCreated:e.data.pagesCreated,pageEdits:e.data.pageEdits,topPages:e.data.topPages};case"failed":throw e.body;default:(0,T.t1)(e)}}),[i,t,n]);return{data:(0,d.useMemo)((()=>s||Ac),[s]),loading:"pending"===o||"idle"===o,error:r,daysFilter:n,setDaysFilter:a}}({spaceId:t.id}),l=function(e){let{spaceStore:t,userId:i}=e;const n=(0,ke.O7)(),[a,o]=(0,d.useState)("last_90_days"),[{status:s,value:r,error:l}]=(0,is.r5)((async()=>{if(!i||!(0,m.wv)({permissions:t.getPermissionItems()},i))return Bc;const e=await ge.getUserEngagementAnalytics(n,{spaceId:t.id,daysFilter:a});switch(e.type){case"success":return{activeMembersCount:e.data.activeMembersCount,previousActiveMembersCount:e.data.previousActiveMembersCount,activeGuestsCount:e.data.activeGuestsCount,previousActiveGuestsCount:e.data.previousActiveGuestsCount,topTeamspaces:e.data.topTeamspaces,topViewers:e.data.topViewers,topEditors:e.data.topEditors};case"failed":throw e.body;default:(0,T.t1)(e)}}),[n,t,i,a]);return{data:(0,d.useMemo)((()=>r||Bc),[r]),loading:"pending"===s||"idle"===s,error:l,daysFilter:a,setDaysFilter:o}}({spaceStore:t,userId:o}),[c,u]=(0,Te.AF)(ue),p=(0,Te.VK)((()=>Boolean(null==t?void 0:t.getSettings().disable_page_analytics)),[t]),g=(0,Te.VK)((()=>null==t?void 0:t.getName()),[t]),v=(0,d.useCallback)((async e=>{await async function(e){var t,i,n;const{environment:a,spaceStore:o,spaceAnalyticsStore:s,setState:r,graphFilter:l,tableFilter:d}=e,c=l||(null===(t=s.usersTabData)||void 0===t?void 0:t.graphFilter)||Ic,u=d||(null===(i=s.usersTabData)||void 0===i?void 0:i.tableFilter)||Ic,p=(null===(n=s.usersTabData)||void 0===n?void 0:n.userTableSort)||xc,[m,g]=await Promise.all([Zc({environment:a,filter:c,spaceId:o.id,spaceAnalyticsStore:s}),Pc({environment:a,filter:u,sort:p,spaceStore:o,spaceAnalyticsStore:s})]),h=(0,vn.Rp)(m)||!m?[]:m,f=(0,vn.Rp)(g)||!g?[]:g;r({currentSpaceId:o.id,currentTab:s.currentTab,usersTabData:{graphFilter:c,tableFilter:u,userTableSort:p,dailyUsersError:(0,vn.Rp)(m)?m:void 0,dailyUsersData:h,usersAndStatsError:(0,vn.Rp)(g)?g:void 0,usersAndStats:f}})}({environment:n,spaceStore:t,spaceAnalyticsStore:c,setState:u,graphFilter:e.graphFilter,tableFilter:e.tableFilter})}),[n,t,c,u]),y=(0,d.useCallback)((e=>{b.nKJ(n,{tab:e}),u({...c,currentTab:e})}),[u,c,n]),S=(0,Te.VK)((()=>{const e=[];return function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(de.Overview),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(de.Users),e.push(de.Content),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(de.Search),e}),[t]),M=(0,Te.VK)((()=>S.length>1),[S]),C=c.currentTab||S[0];(0,d.useEffect)((()=>{!async function(){const e=t.id;e&&ue.shouldRefreshState(e)&&(C===de.Users?await v({graphFilter:"last_90_days",tableFilter:"last_90_days"}):C===de.Content||C===de.Overview||C===de.Search||(0,T.t1)(C))}()}));const k=(0,d.useCallback)((()=>{w.navigateToExternalURL({environment:n,url:(0,W.UY)("guides.workspaceAnalytics")})}),[n]),_=(0,Te.VK)((()=>t.getCreatedTime()<16593264e5),[t]),x=S.map((e=>zu[e])),Z=p?a()(Lc,{type:"disabled",spaceName:g}):d.createElement(d.Fragment,null,M&&a()(Eo.Z,{tabs:x,selectedIndex:S.indexOf(C),onChange:e=>{y(S[e])},style:i.tabsStyle}),function(e){const{currentTab:t,spaceAnalyticsStore:i,onUserTabFilterChange:n,spaceStore:o}=e;switch(t){case de.Content:return a()(du,{spaceStore:o,contentEngagement:e.contentEngagementData});case de.Users:return a()(Nu,{spaceStore:o,usersTabData:i.usersTabData,onUserTabFilterChange:n,userEngagement:e.userEngagementData});case de.Overview:return a()(Su,{contentEngagement:e.contentEngagementData,userEngagement:e.userEngagementData,spaceStore:o,onUserTabFilterChange:n});case de.Search:return a()(Pu,{spaceStore:o});default:(0,T.t1)(t)}}({currentTab:C,spaceAnalyticsStore:c,onUserTabFilterChange:v,spaceStore:t,contentEngagementData:r,userEngagementData:l}));return a()(Ze.Z,{},void 0,a()(Pe.Z,{large:!0,style:i.headingStyle},void 0,a()("div",{style:i.title},void 0,a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics",description:"Header for workspace analytics page in settings modal"}),_&&a()(Oe.Z,{placement:la.u.Right,render:e=>d.createElement(br.Z,s()({},e,{href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:i.helpInfo})),renderTooltip:()=>a()(f.FormattedMessage,{id:"settings.workspaceAnalytics.dataDisclaimerTooltip",defaultMessage:"Data available from August 1, 2022 onwards",description:"Disclaimer that data fro workspace analytics only starts from August 1, 2022 onwards"})})),a()(Ae.Z,{isSmall:!0,onClick:k,icon:Ge.Z.help},void 0,a()(f.FormattedMessage,{id:"workspaceAnalytics.title.helpButton",defaultMessage:"Learn more",description:"Button to send feedback about the user analytics tab."}))),Ze.Z.renderDivider(),Z)};var qu=i(86080);var Hu=i(51456),Gu=i(38755);class ju extends Z.Z{getInitialState(){return{churnSurveyModalOpen:!1,page:"default"}}}const $u=ju;var Yu=i(12318),Qu=i(1119),Xu=i(13630);const Ju=function(e){let{handleExportClick:t}=e;window.__c={n:"ExportSpaceTab"};const i=(0,Te.VK)((()=>I.default.state),[]),{currentSpaceStore:n}=i,o=(0,Te.VK)((()=>Xu.Z.state),[]),s=(0,ke.O7)();return(0,d.useEffect)((()=>{Fe.zh({environment:s,spaceId:null==n?void 0:n.id})}),[null==n?void 0:n.id,s]),a()(d.Fragment,{},void 0,a()(Pe.Z,{},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.title",defaultMessage:"Export content"})),a()("div",{style:{display:"flex",alignItems:"center",gap:8}},void 0,a()(Ae.Z,{disabled:!!o.count,isLarge:!0,onClick:t},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportButton.label",defaultMessage:"Export all workspace content"})),o.count?a()(rd.gq,{gap:4},void 0,a()(Re.Z,{}),a()(xe.Z,{isSmall:!0},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportInProgress",defaultMessage:"Export in progress",description:"Text indicating the number of exports in progress"}))):d.createElement(d.Fragment,null)),a()("div",{style:{height:12}}),a()(br.Z,{title:a()(f.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.helpButton.caption",defaultMessage:"Learn about exporting workspaces."}),href:(0,W.UY)("guides.exportWorkspace"),analyticsFrom:"space_settings"}),Ze.Z.renderDivider())};var ep=i(93007),tp=i(33411);const ip=(0,f.defineMessages)({workspaceDomainInputPlaceholder:{id:"spaceBasicSettingsDomain.domainSection.workspaceDomainInput.placeholder",defaultMessage:"Your domain",description:"Placeholder text for inputting a domain."},copyDomainTooltip:{id:"spaceBasicSettingsDomain.workspaceDomain.tooltip",defaultMessage:"Click to copy link",description:"Tooltip for a button to copy link."}}),np=()=>{window.__c={n:"AvailableField"};const e=(0,_e.Fg)();return a()("div",{style:{color:e.invoiceGreen,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"}},void 0,Ge.Z.circleCheckFilled({height:16,width:16,margin:"0 4px 0 8px",color:e.invoiceGreen}),a()("span",{},void 0,a()(f.FormattedMessage,{defaultMessage:"Available",description:"website domain is available for selection",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.available"})))},ap=()=>(window.__c={n:"UsedField"},a()("div",{style:{color:ho.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"}},void 0,Ge.Z.warning({height:16,width:16,margin:"0 4px 0 8px"}),a()("span",{},void 0,a()(f.FormattedMessage,{defaultMessage:"Used",description:"website domain is currently in use by another workspace",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.used"})))),op=()=>(window.__c={n:"DisallowedField"},a()("div",{style:{color:ho.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"}},void 0,Ge.Z.warning({height:16,width:16,margin:"0 4px 0 8px"}),a()("span",{},void 0,a()(f.FormattedMessage,{defaultMessage:"Not allowed",description:"website domain is not available for selection",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.notAllowed"})))),sp=()=>(window.__c={n:"renderLoadingSpinner"},a()(tp.Z,{show:!0,showDelay:500,showHold:300,render:()=>a()(Re.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})})),rp=e=>{const[t,i]=(0,Te.AF)(e.spaceBasicSettingsStore),{domain:n,domainState:o}=t,r=(0,ke.O7)(),l=(0,_e.Fg)(),[c,u]=(0,d.useState)(!0),p=d.createRef();return d.createElement(d.Fragment,null,a()(Pe.Z,{},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.domainSection.title",defaultMessage:"Domain"})),a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{background:l.inputBackground,borderRadius:3,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex"}},void 0,d.createElement(Li.Z,{type:"text",style:{background:"none",boxShadow:"none",padding:"4px 6px",width:255},ref:p,value:n,placeholder:V.default.formatMessage(ip.workspaceDomainInputPlaceholder),readOnly:!e.canAdminSpaceStore,onChange:e.handleSpaceUrlChange,onFocus:e=>{u(!1),e.target.select()}})),c&&e.domainIsAutogenerated&&a()("div",{style:{color:ho.ZP.blue,fontSize:h.Z.fontSize.UIRegular.desktop,fontWeight:500,textAlign:"right",padding:"4px 6px",whiteSpace:"nowrap"},onClick:()=>{var e;null===(e=p.current)||void 0===e||e.focusInput(),u(!1),i({...t,domain:""})}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.changeDomain.cta.text",defaultMessage:"Set your own",description:"Prompt beside an autogenerated domain name that encourages the user to set / customize their public website domain name"})),n&&"available"===o&&a()(np,{}),"inuse"===o&&a()(ap,{}),"disallowed"===o&&a()(op,{}),"loading"===o&&sp()),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,((e,t)=>{window.__c={n:"renderDomainCaption"};const i=t=>a()(Oe.Z,{delayThreshold:0,renderTooltip:()=>V.default.formatMessage(ip.copyDomainTooltip),render:i=>d.createElement(Ao.Z,s()({onClick:()=>{Mt.RD({environment:e,stringValue:t,copiedMessage:Mt.tq.copiedLinkToClipboard})}},i),t)});return a()("div",{style:{paddingTop:8}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.viewPublicPage.caption",defaultMessage:"Pages shared to web will be under {linkText}.",values:{linkText:i(`${t}.${Qe.Z.publicDomainName}`)}}),a()("div",{style:{paddingTop:6}}),a()(f.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.joinWorkspace.caption",defaultMessage:"Anyone with an allowed email domain can join this workspace via {linkText}.",values:{linkText:i(`${window.location.host}/${t}`)}}))})(r,n)))},lp=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageInputMenu"};const t=(0,f.useIntl)(),i=(0,_e.Fg)(),n=(0,ke.O7)(),o=(0,Te.VK)((()=>(0,K.M9)(n)),[n]),s=!Boolean(o),[r,l]=(0,Te.AF)(le);return a()("div",{onClick:()=>{o&&nr.y(n,{from:"public_domain_home_page",for:o})}},void 0,d.createElement(Li.Z,{type:"text",ref:e.textInputRef,style:{background:i.inputBackground,borderRadius:3,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex",padding:"4px 6px"},value:r.query,onChange:e=>{l({...r,query:e.target.value})},onFocus:()=>{s&&l({...r,openDropdown:!0})},disabled:!s,left:Ge.Z.searchThick({fill:i.mediumIconColor,width:16,height:16,marginRight:8,marginLeft:8,flexGrow:0,flexShrink:0}),placeholder:t.formatMessage({defaultMessage:"Select a page shared to web",id:"spaceBasicSettings.PublicHomePageSection.input.placeholder"})}))};var dp=i(29026),cp=i(11470);const up=()=>(window.__c={n:"renderSpinner"},a()(tp.Z,{show:!0,showDelay:500,showHold:300,render:()=>a()(Re.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})})),pp=async(e,t)=>{if(!Ie.Z.state.online)return[];const i=await yn.UJ({environment:t,query:e,source:"public_home_page_menu",limit:dp.Xv});return""===e?i.splice(0,5):i},mp=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSearchResults"};const t=(0,ke.O7)(),[i,n]=(0,Te.AF)(e.spaceBasicSettingsStore,me),[o,r]=(0,Te.AF)(le),{query:l}=o,[{value:c,status:u}]=(0,is.r5)((()=>pp(l,t)),[l,t]),p=(0,Te.VK)((()=>(0,D.RM)()),[]);if(!(l||c&&0!==c.length))return null;return a()("div",{style:{marginTop:2,marginBottom:2}},void 0,a()(ot.Z,{type:ot.i.Vertical,sections:[{key:"recent public pages section",render:e=>d.createElement(rt.Z,e),items:"idle"===u||"pending"===u?[{key:"loading spinner",render:up,action:()=>{}}]:p&&c&&0!==c.length?[...c.map((e=>{const t=ze.G.createChildStore(p,{table:dn.iU,id:e.id});return{key:`${e.id} page`,render:e=>d.createElement(cp.Z,s()({store:t},e)),action:()=>{n({...i,publicHomePage:e.id}),r({...o,openDropdown:!1,displaySummary:!0})}}}))]:[{key:"no results",render:()=>a()(xe.Z,{isSmall:!0,style:{marginLeft:8}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel.noResults",defaultMessage:"No results"})),action:()=>{}}]}],initialFocus:void 0}))};var gp=i(17755),hp=i(22808);class fp extends d.PureComponent{render(){return a()("div",{style:{height:this.getSize(),width:this.getSize(),...fp.wrapStyle,verticalAlign:"top",marginTop:1,...this.props.style}},void 0,this.renderIcon())}renderIcon(){const{icon:e}=this.props;if(e){if((0,hp.Z)(e.icon))return a()("div",{style:{fontSize:this.getEmojiSize()}},void 0,e.icon);{const t=gp.EK({url:e.icon,baseUrl:this.props.baseUrl,fullyQualified:!0,permissionRecord:e.pointer,width:this.getImageSize(),userId:void 0});return a()("img",{alt:"icon",src:t,style:{width:this.getImageSize(),height:this.getImageSize(),...fp.imageStyle}})}}}getSize(){return this.props.size}getEmojiSize(){return.9*this.props.size}getImageSize(){return.888*this.props.size}}fp.wrapStyle={display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3},fp.imageStyle={objectFit:"cover",borderRadius:3,marginTop:1};const vp=fp,yp=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSummary"};const[t,i]=(0,Te.AF)(e.spaceBasicSettingsStore,me),[n,o]=(0,Te.AF)(le),[s,r]=(0,Te.VK)((()=>{const e=(0,D.RM)();if(!e||!t.publicHomePage)return[];const i=ze.G.createChildStore(e,{table:dn.iU,id:t.publicHomePage});return[i,i.getIcon()]}),[t]);return s?a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{display:"flex",paddingRight:8}},void 0,r&&a()(vp,{baseUrl:"",icon:r,size:18,style:{display:"inline-flex",marginRight:2,verticalAlign:"text-top"}}),a()(uu.ZP,{store:s,style:{display:"inline",whiteSpace:"normal",marginRight:Boolean(r)?3:0,wordBreak:"break-word"}})),a()(Ae.Z,{onClick:()=>{o({...n,displaySummary:!1}),i({...t,publicHomePage:void 0})}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel",defaultMessage:"Clear"}))):null},bp=e=>{const t=(0,ke.O7)(),i=d.createRef(),[n,o]=(0,Te.AF)(le),[r]=(0,Te.AF)(e.spaceBasicSettingsStore),{openDropdown:l,displaySummary:c}=n,{publicHomePage:u,domain:p}=r,m=`${p}.${Qe.Z.publicDomainName}`,g=(0,Te.VK)((()=>(0,K.M9)(t)),[t]),h=!Boolean(g);return d.createElement(d.Fragment,null,a()(Pe.Z,{style:{display:"flex",alignItems:"center"}},void 0,a()("span",{style:{marginRight:8}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.title",defaultMessage:"Public home page"})),g&&a()(ar.Z,{subscriptionTier:g,analyticsName:"public_domain_home_page",desktopStyle:{marginTop:-1}})),h&&u&&c?a()(yp,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}):a()(st.ZP,{alignmentToOrigin:st.ZP.Alignment.Start,keepFocus:t.device.isPhone,onDismiss:()=>{var e;null===(e=i.current)||void 0===e||e.handleBlur(),o({...n,openDropdown:!1,displaySummary:!0})},origin:a()(lp,{textInputRef:i}),open:l,popupType:st.ZP.PopupType.Popup,style:{width:250},render:()=>a()(at.Z,{menuType:Je.og.Popup,width:250},void 0,a()(mp,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}))}),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption",defaultMessage:"Access your public home page via {linkText}.",values:{linkText:a()(Oe.Z,{delayThreshold:0,renderTooltip:()=>a()(f.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption.tooltip",defaultMessage:"Click to copy link"}),render:e=>d.createElement(Ao.Z,s()({onClick:()=>{Mt.RD({environment:t,stringValue:m,copiedMessage:Mt.tq.copiedLinkToClipboard})}},e),m)})}})))};function Sp(){return window.__c={n:"SpaceNameCaption"},a()(f.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your organization or company name. Keep it simple.",description:"The caption below the text input where a user edits the name of their workspace"})}const wp=(0,f.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}});class Mp extends c.Z{constructor(){super(...arguments),this.storeTypes={spaceBasicSettingsStore:me,securitySettingsStore:se.Z,store:$u,tokenQuery:Yu.default.of("")},this.handleEnableAiFeatureClick=()=>{const{securitySettingsStore:e}=this.props;e&&e.setState({...e.state,enableAiFeature:!e.state.enableAiFeature})},this.handleSpaceNameChange=e=>{this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,name:e.target.value})},this.handleCheckDomainAvailability=e=>{const{spaceBasicSettingsStore:t}=this.stores,{spaceStore:i}=this.props;M._u({environment:this.environment,spaceStore:i,domain:e}).then((e=>{if("success"!==e.type)this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:"loading"});else{const i=e.data.domain===t.state.domain;this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:i?e.data.domainState:t.state.domainState})}}))},this.checkSpaceDomainAvailabilityDebounced=r.debounce(this.handleCheckDomainAvailability,250),this.handleSpaceUrlChange=e=>{const t=M.$U(e.target.value);this.checkSpaceDomainAvailabilityDebounced(t),this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domain:t}),this.forceUpdate()},this.handleConfirm=async()=>{const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t,securitySettingsStore:i}=this.stores;await M.Y5({environment:this.environment,spaceId:e.id,spaceBasicSettingsStore:t})&&(await M.OF({environment:this.environment,spaceStore:e,spaceBasicSettingsStore:t,securitySettingsStore:i}),le.setState(le.getInitialState()),be.Z.setState({...be.Z.state,open:!1}))},this.handleCancelClick=()=>{be.Z.setState({...be.Z.state,open:!1}),le.setState(le.getInitialState())},this.handleExportClick=()=>{const{currentSpaceStore:e}=I.default.state;e&&Fe.q$({environment:this.environment,root:{table:"space",id:e.id,spaceId:e.id},isCollectionViewExportTypeSupported:!0})},this.handleExportMembersClick=()=>{const{currentSpaceStore:e}=I.default.state,{data:t}=Se.default.state;e&&t&&"subscribed_admin"===t.type&&Fe.$G({spaceStore:e,subscriptionData:t,intl:this.props.intl})},this.handleLeaveClick=()=>{const{spaceStore:e}=this.props,{currentUserSettingsStore:t}=I.default.state;t&&S.showDialog({message:a()(f.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:a()(f.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await M.bf({environment:this.environment,spaceId:e.id,userSettingsStore:t})&&(b.z01(this.environment),be.Z.setState({...be.Z.state,open:!1}))}}]})},this.renderChurnSurveyModal=()=>{const{data:e}=Se.default.state,t=this.stores.store.state,i=K.XX(e);if(i&&t.churnSurveyModalOpen)return a()(Qu.Z,{churnType:t.churnType,currentPlan:t.churnType,isWorkspaceDeletion:!0,periodEnd:i.periodEnd,hasAI:g.de(i.addOns),hasPendingChanges:Boolean(i.schedule||i.willCancelAt),customerId:i.customerId,onAccept:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onAccept()},onClose:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()}})},this.handleDeleteClick=async()=>{const e=(0,q.zt)();if(!e)return;const{data:t}=Se.default.state,i=K.XX(t);if(b.YO0(this.environment),i){if(!(await new Promise((t=>{const{store:i}=this.stores;i.setState({...i.state,churnType:e,churnSurveyModalOpen:!0,onAccept:async()=>{t(!0),await this.showWorkspaceDeletionConfirmation()},onClose:()=>t(!1)})}))))return}await this.showWorkspaceDeletionConfirmation()},this.showWorkspaceDeletionConfirmation=async()=>{const{currentUserSettingsStore:e}=I.default.state;if(!e)return;const{spaceStore:t,intl:i}=this.props,n=(0,Gu.rn)(this.environment,t)||i.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"}),o=(0,Zd.Bd)(ra.SP)?a()(f.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."}):d.createElement(d.Fragment,null,a()(ep.Z,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}}));await qu.b({message:a()("div",{},void 0,a()("div",{},void 0,o)),acceptLabel:a()(f.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:n})&&(M.Ns({environment:this.environment,spaceId:t.id,userSettingsStore:e}),b.BPl(this.environment),be.Z.setState({...be.Z.state,open:!1}))},this.handleRecordIconChange=e=>{const{spaceStore:t}=this.props;B.createAndCommit({userAction:"SpaceBasicSettings.handleRecordIconChange",environment:this.environment,perform:i=>{po.sO({store:t.getIconStore(),value:e,transaction:i})}})}}willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{spaceBasicSettingsStore:i}=this.stores,n=i.getValueForSpace(t);n&&i.setState(n)}renderComponent(){return Ie.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})))}validateDomain(){const{spaceBasicSettingsStore:e}=this.stores,{domain:t,domainState:i}=e.state;return!!t&&("available"===i||"current-space"===i)}renderSettings(){const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t}=this.stores,{name:i}=t.state,{data:n}=Se.default.state,{device:o}=this.environment;if(!n)return;const s=e.canAdmin(),r=(0,Gu.Cx)(e),l=(0,Gu.jv)(e),c=K.qF(this.environment),u=s&&!e.getDisableExport(),p=s,m=(0,q.zt)(),g="subscribed_admin"===n.type&&("enterprise"===m||"business"===m),h=e.getSettings().disable_page_analytics,v=cs.Z.getPublicSpaceData(this.environment,e.id);return a()(Ze.Z,{controlRow:s&&this.renderControlRow()},void 0,this.renderSpaceBasicHeader(),r&&a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages and workspace settings."})),r&&Ze.Z.renderDivider(),s&&a()(d.Fragment,{},void 0,a()(Pe.Z,{},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})),a()(Li.Z,{value:i,placeholder:V.default.formatMessage(wp.nameInputPlaceholder),readOnly:!s,onChange:this.handleSpaceNameChange}),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,a()(Sp,{})),Ze.Z.renderDivider()),s&&a()(d.Fragment,{},void 0,a()(Pe.Z,{},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})),a()("div",{style:{width:72,height:72,border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"}},void 0,a()(Ke.Z,s?{bucket:"public",disabled:!1,icon:(0,Gu.Wd)(this.environment,e),isEmptyPage:!1,title:i,size:64,iconLoggingData:{recordTable:e.table,source:"workspace_settings"},onChange:this.handleRecordIconChange}:{disabled:!0,icon:(0,Gu.Wd)(this.environment,e),isEmptyPage:!1,title:i,size:64})),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})),Ze.Z.renderDivider()),(y=this.environment,!(null===(b=I.default.state.currentSpaceStore)||void 0===b||!b.canAdmin())&&(0,K.qb)(y,"enterprise")&&d.createElement(d.Fragment,null,this.renderSpaceBasicFeatureSubheader(),this.renderAiFeature(),Ze.Z.renderDivider())),this.renderSpaceBasicPublicSubHeader(),s&&d.createElement(d.Fragment,null,a()(rp,{canAdminSpaceStore:s,domainIsAutogenerated:null==v?void 0:v.domainIsAutogenerated,spaceStore:e,spaceBasicSettingsStore:t,handleSpaceUrlChange:this.handleSpaceUrlChange}),Ze.Z.renderDivider()),s&&c&&a()(d.Fragment,{},void 0,a()(Pe.Z,{},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})),this.renderAllowedEmailDomains(),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."})),Ze.Z.renderDivider()),s&&a()(d.Fragment,{},void 0,a()(bp,{spaceBasicSettingsStore:t}),Ze.Z.renderDivider()),u&&a()(Ju,{handleExportClick:this.handleExportClick}),p&&a()(d.Fragment,{},void 0,a()(Pe.Z,{style:{display:"flex",alignItems:"center"}},void 0,a()("span",{style:{marginRight:8}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})),!g&&a()(ar.Z,{subscriptionTier:"business",analyticsName:"space_export_members",desktopStyle:{marginTop:-1}})),a()("div",{style:{display:"flex"}},void 0,a()(Ae.Z,{isLarge:!0,disabled:!g,onClick:this.handleExportMembersClick,disabledFeedback:!0},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"}))),a()("div",{style:{height:12}}),a()(br.Z,{title:a()(f.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:(0,W.UY)("guides.exportMembers"),analyticsFrom:"space_settings"}),Ze.Z.renderDivider()),s&&a()(d.Fragment,{},void 0,a()(Pe.Z,{},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.analytics.title",defaultMessage:"Analytics",description:"Title for the analytics section in the space settings"})),a()("div",{style:{display:"flex",gap:12,flexDirection:"column"}},void 0,a()(Bo.Z,{isMobile:o.isMobile,title:a()(f.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.title",defaultMessage:"Save and display page view analytics",description:"Title for the page view analytics setting"}),caption:a()(f.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.description",defaultMessage:"People with edit or full access will be able to see how many views a page has. If this is turned off, page views will not be stored for all pages in {workspaceName}.",description:"Description for the page view analytics setting",values:{workspaceName:i}}),type:"toggle",isOn:!h,onToggle:()=>{const t=!h;B.createAndCommit({userAction:"SpaceBasicSettings.analyticsSettings.onSelectOption",environment:this.environment,perform:i=>{po.sW({store:e,data:{settings:{...e.getSettings(),disable_page_analytics:t}},transaction:i})}}),Hu.track(this.environment,t?"page_analytics_workspace_opt_out":"page_analytics_workspace_opt_in")}}),a()(br.Z,{title:a()(f.FormattedMessage,{defaultMessage:"Learn about workspace analytics.",id:"spaceBasicSettings.workspaceAnalytics.helpButton.caption",description:"Help button caption for the workspace analytics section in the space settings"}),href:(0,W.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq"})),Ze.Z.renderDivider()),a()(Pe.Z,{},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})),a()("div",{style:{display:"flex"}},void 0,(l.length>1||r)&&a()(Ae.Z,{isLarge:!0,onClick:this.handleLeaveClick,style:{marginRight:s?12:void 0}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})),s&&d.createElement(d.Fragment,null,this.renderModal(),a()(Ae.Z,{isLarge:!0,isRed:!0,onClick:this.handleDeleteClick},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"})))),s&&a()(d.Fragment,{},void 0,a()("div",{style:{height:12}}),a()(br.Z,{title:a()(f.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:(0,W.UY)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})));var y,b}renderAiFeature(){var e;return a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:this.handleEnableAiFeatureClick},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()("div",{style:{display:"flex",alignItems:"center"}},void 0,Ge.Z.sparkles({width:16,height:16,marginRight:6}),a()(f.FormattedMessage,{id:"spaceBasicSettings.aiFeature.label",defaultMessage:"Notion AI",description:"Label for the AI feature addon"})),a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.aiFeature.ga.caption",defaultMessage:"Enable to provide AI-powered functionality for all members of your workspace.{br}By enabling Notion AI, you are agreeing to the <inlinelink>Notion AI Supplementary Terms</inlinelink>",description:"Caption for the AI feature addon for GA.",values:{br:a()("br",{}),inlinelink:e=>a()(Ao.Z,{href:"https://notion.notion.site/fa9034c8b5a04818a6baf3eac2adddbb",external:!0,onClick:e=>e.stopPropagation()},void 0,e)}}))),a()("div",{style:{marginTop:5}},void 0,a()(hr.Z,{on:Boolean(null===(e=this.props.securitySettingsStore)||void 0===e?void 0:e.state.enableAiFeature)}))))}renderSpaceBasicPublicSubHeader(){return a()(Pe.Z,{large:!0,divider:"full",style:{paddingTop:12}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.public.subtitle",defaultMessage:"Public settings",description:"Subtitle for the public settings section"}))}renderSpaceBasicFeatureSubheader(){return a()(Pe.Z,{large:!0,divider:"full",style:{paddingTop:12}},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.feature.subtitle",defaultMessage:"Feature settings",description:"Subtitle for the feature settings section"}))}renderSpaceBasicHeader(){return a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"}))}renderControlRow(){return a()("div",{style:{display:"flex"}},void 0,a()(je.Z,{isLarge:!0,onClick:this.handleConfirm,disabled:!this.validateDomain()},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})),a()(Ae.Z,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick},void 0,a()(f.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})))}renderAllowedEmailDomains(){const{device:e}=this.environment,{spaceStore:t}=this.props,{spaceBasicSettingsStore:i}=this.stores,{emailDomains:n}=i.state,o=t.canAdmin();return a()(st.ZP,{popupType:e.isMobile?st.ZP.PopupType.SlideUp:st.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:this.stores.tokenQuery.get().length>0,origin:a()(fi.Z,{placeholder:V.default.formatMessage(wp.allowedEmailDomainsInputPlaceholder),value:this.stores.tokenQuery.get(),onChange:e=>this.stores.tokenQuery.set(e.target.value),readOnly:!o,onRemoveLastToken:()=>{const e=n.slice(0,n.length-1);i.setState({...i.state,emailDomains:e})},tokens:n.map((e=>a()(hi.Z,{showRemoveButton:!0,isSingle:!1,format:ui.l.Medium,onClickRemove:()=>{const t=n.filter((t=>t!==e));i.setState({...i.state,emailDomains:t})},value:e},e)))}),render:()=>{const t=this.stores.tokenQuery.get().trim(),{data:o}=Se.default.state,{spaceStore:r}=this.props,l=a()(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),c=a()(f.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),u=o?K.hn(o).map((e=>{if(("unsubscribed_admin"===o.type||"unsubscribed_member"===o.type||"subscribed_admin"===o.type)&&o.joinedMemberIds.includes(e.userId)){const t=ze.U6.createChildStore(r,{table:Kt.KJ,id:e.userId}).getEmail();return t&&(0,Ll.Gd)(t)}})).filter(((e,t,i)=>Boolean(e&&t===i.indexOf(e)&&!n.includes(e)))):[],p=(0,lc.ZP)(t,u,(e=>e)).map(((e,t)=>({key:t,render:t=>d.createElement(it.Z,s()({},t,{title:e})),action:()=>{const t=[...n,e];i.setState({...i.state,emailDomains:t}),this.stores.tokenQuery.set("")}})));let m;return m=e.isMobile?{menuType:Je.og.ActionSheet}:{menuType:Je.og.Popup,width:"100%"},d.createElement(at.Z,m,a()(ot.Z,{type:ot.i.Vertical,initialFocus:p.length>0?0:void 0,sections:[{key:0,render:e=>d.createElement(rt.Z,s()({},e,{disableDesktopPadding:!0,title:p.length>0?l:c})),items:p}]}))},onDismiss:()=>{this.stores.tokenQuery.set("")}})}renderModal(){const{churnSurveyModalOpen:e}=this.stores.store.state;return a()($o.Z,{innerStyle:{width:300,height:"auto",overflow:"scroll"},open:e,render:this.renderChurnSurveyModal,onDismiss:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()}})}getTitleStyle(){return{fontSize:14,marginRight:8,flexGrow:1}}}Mp.displayName="SpaceBasicSettings";const Cp=(0,f.injectIntl)(Mp);var kp=i(19091),Tp=i(97832),_p=i(33954),Ip=i(78873);let xp;!function(e){e.Password="Password",e.CurrentEmail="TemporaryPasscode"}(xp||(xp={}));class Zp extends Z.Z{getInitialState(){return{open:!1,authorized:!1,authorizationType:void 0}}}const Pp=Zp;var Fp=i(37770);class Ap extends c.Z{constructor(){super(...arguments),this.storeTypes={store:Pp},this.renderModalContent=()=>{const{store:e}=this.stores,{state:t}=e;return a()("div",{style:{...this.styles.modal,...this.getColors().modal}},void 0,a()(Fp.Z,{fetch:this.getAuthorizationType,loading:e=>e&&a()("div",{style:this.styles.loadingSpinner},void 0,a()(Re.Z,{})),render:()=>a()(d.Fragment,{},void 0,t.authorizationType===xp.Password?this.renderVerifyPassword(t):t.authorizationType===xp.CurrentEmail?this.renderVerifyCurrentEmail(t):void 0,t.authorized&&this.renderSetNewEmail(t))}))},this.renderSetNewEmail=e=>{const{store:t}=this.stores,{userValue:i}=this.props;if(t.state.authorized)return a()(d.Fragment,{},void 0,a()("p",{style:this.styles.paragraph},void 0,a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.newEmailInstructions",defaultMessage:"Please enter a new email and we will send you a verification code."})),a()("div",{},void 0,this.renderNewEmailInput()),t.state.newEmailContainsVerifiedDomain&&(0,Ll.Gd)(t.state.newEmail)!==(0,Ll.Gd)((null==i?void 0:i.email)||"")&&this.renderClaimedEmailDomainWarning(e),t.state.newEmailPasscodeSent?this.renderNewEmailPasscodeInput(e):this.renderSendNewEmailPasscodeButton(e),this.renderEducationPlanDowngradeWarning())},this.handleSendCurrentEmailVerification=async()=>{const{userValue:e}=this.props,{store:t}=this.stores;if(!e)return;t.setState({...t.state,loading:!0});const i=await ge.sendEmailVerification(this.environment,{email:e.email});"success"===i.type?t.setState({...t.state,currentEmailPasscodeSent:!0,currentEmailPasscode:"",error:void 0,loading:!1}):t.setState({...t.state,currentEmailPasscodeSent:!0,loading:!1,error:(0,_p.wf)(this.props.intl,i)})},this.handleChangeCurrentEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,currentEmailPasscode:e.currentTarget.value,error:void 0})},this.handleChangePassword=e=>{const{store:t}=this.stores;t.setState({open:!0,authorized:!1,authorizationType:xp.Password,password:e.currentTarget.value,error:void 0})},this.handleClearPassword=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:xp.Password,password:""})},this.handleSubmitAuthorization=async()=>{const{store:e}=this.stores;if(!e.state.authorized)if(e.state.authorizationType===xp.Password){if(!this.getUserCurrentEmail())return;e.setState({...e.state,loading:!0});const t=await ge.authVerifyPassword(this.environment,{password:e.state.password});if("failed"===t.type)return void e.setState({...e.state,loading:!1,error:(0,_p.wf)(this.props.intl,t)});e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})}else e.state.authorizationType===xp.CurrentEmail&&e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})},this.handleChangeNewEmail=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmail:e.currentTarget.value,error:void 0})},this.handleClearNewEmail=()=>{const{store:e}=this.stores;e.setState({...e.state,newEmail:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0})},this.handleSendNewEmailVerification=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=(0,Ll.Gd)(e.state.newEmail);e.setState({...e.state,loading:!0});const[i,n]=await Promise.all([await ge.sendEmailVerification(this.environment,{email:e.state.newEmail}),t?await ge.getVerifiedEmailDomain(this.environment,{emailDomain:t}):void 0]);if("success"===i.type){const t=(0,T.$K)(n)&&"failed"===n.type?(0,_p.wf)(this.props.intl,n):void 0;e.setState({...e.state,newEmailPasscodeSent:!0,newEmailPasscode:"",error:t,loading:!1,newEmailContainsVerifiedDomain:(0,T.$K)(n)&&"success"===n.type&&void 0!==n.data.id})}else e.setState({...e.state,loading:!1,error:(0,_p.wf)(this.props.intl,i)})},this.handleChangeNewEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmailPasscode:e.currentTarget.value,error:void 0})},this.handleSubmit=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=e.state.authorizationType===xp.Password?{type:"Password",password:e.state.password,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode}:{type:"CurrentEmail",currentEmailPasscode:e.state.currentEmailPasscode,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode};e.setState({...e.state,loading:!0});const i=await ge.changeEmail(this.environment,t);if("success"===i.type)b.txh(this.environment,{new_email:e.state.newEmail,error:void 0}),e.setState({...e.state,loading:!1}),await this.closeModal();else{var n;const t=(0,_p.wf)(this.props.intl,i);if(b.txh(this.environment,{new_email:e.state.newEmail,error:t}),"IntercomError"===(null===(n=i.body)||void 0===n?void 0:n.name))return e.setState({...e.state,loading:!1}),void(await this.closeModal());e.setState({...e.state,loading:!1,error:t})}},this.handleSendUsMessageClick=()=>{Zr.j({environment:this.environment,from:"change_email_student"})},this.openModal=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:void 0})},this.closeModal=async()=>{const{store:e}=this.stores,{hasEducationPlan:t}=this.props;e.reset(),t&&await k.bi(this.environment)},this.getAuthorizationType=async()=>{const{store:e}=this.stores,{intl:t}=this.props,i=this.getUserCurrentEmail();if(!i)return;const n=await Ip.c({environment:this.environment,userEmail:i});n.error?e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorFetchingAccountData",defaultMessage:"Could not fetch account information for {currentEmail}."},{currentEmail:i})}):n.value.isSamlEnforced||!n.value.hasPassword?e.setState({open:!0,authorized:!1,authorizationType:xp.CurrentEmail,currentEmailPasscodeSent:!1,currentEmailPasscode:""}):e.setState({open:!0,authorized:!1,authorizationType:xp.Password,password:""})},this.styles={modal:{width:460,padding:32,borderRadius:3,fontSize:14},loadingSpinner:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},paragraph:{marginTop:12,marginBottom:14},error:{color:ho.ZP.red,fontSize:12,marginTop:4,marginLeft:8},bold:{fontWeight:h.Z.fontWeight.bold},input:{padding:"4px 8px"},button:{marginTop:14,width:"100%"},educationPlanWarning:{display:"flex",marginTop:14,paddingTop:14},claimedEmailDomainWarning:{marginTop:14,marginBottom:14}}}renderComponent(){const{userValue:e}=this.props,{store:t}=this.stores;return d.createElement(d.Fragment,null,a()(Bo.Z,{type:"custom",isMobile:!1,title:a()(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.label",defaultMessage:"Email",description:"Label for email setting"}),caption:e&&e.email,customButton:this.renderChangeEmailButton()}),a()($o.Z,{open:t.state.open,onDismiss:this.closeModal,render:this.renderModalContent}))}renderChangeEmailButton(){const{userValue:e,areProfileEditsDisabled:t}=this.props,i=a()(Ae.Z,{isLarge:!0,onClick:t?()=>{}:this.openModal,disabled:t,disabledFeedback:t},void 0,a()(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.changeEmailButton.label",defaultMessage:"Change email",description:"Label for button that changes a user's email"}));return t?a()(Oe.Z,{renderTooltip:()=>a()(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",description:"Tooltip explaining that the user cannot edit their profile because their organization disabled that ability.",values:{emailDomain:e?(0,Ll.Gd)(e.email):""}}),placement:Oe.Z.Placement.Bottom,alignment:Oe.Z.Alignment.Center,render:e=>d.createElement("div",e,i)}):i}renderVerifyPassword(e){const{userValue:t}=this.props;if(t)return a()(d.Fragment,{},void 0,a()("p",{style:{margin:0}},void 0,this.renderCurrentEmail()),a()("p",{style:this.styles.paragraph},void 0,a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.enterPasswordInstructions",defaultMessage:"Please enter your password."})),a()(Li.Z,{style:{display:"none"},type:"text",value:t.email,autoComplete:"username",disabled:!0}),a()(Li.Z,{type:"password",disabled:e.authorized,value:e.password,onChange:this.handleChangePassword,showClearButton:!0,onClearButtonClick:this.handleClearPassword,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.passwordInput.label",defaultMessage:"Password"}),style:this.styles.input,focusInitial:!0,autoComplete:"current-password"}),!e.authorized&&e.error&&a()("div",{style:this.styles.error},void 0,e.error),!e.authorized&&a()(je.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization,disabled:e.loading},void 0,e.loading?a()(Re.Z,{}):a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue",description:"After the user verifies their current password or email, they click this button to continue changing their email."})))}renderVerifyCurrentEmail(e){return a()(d.Fragment,{},void 0,a()("p",{style:{...this.styles.paragraph,marginTop:0}},void 0,this.renderCurrentEmail()," ",e.currentEmailPasscodeSent?a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.sentVerificationCodeToCurrentEmail",defaultMessage:"We've sent a temporary verification code to this email."}):a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeToCurrentEmail",defaultMessage:"We'll send a temporary verification code to this email."})),e.currentEmailPasscodeSent?this.renderCurrentEmailPasscodeInput(e):this.renderSendCurrentEmailPasscodeButton())}renderSendCurrentEmailPasscodeButton(){return a()(je.Z,{isLarge:!0,onClick:this.handleSendCurrentEmailVerification,disabled:this.stores.store.state.loading},void 0,this.stores.store.state.loading?a()(Re.Z,{}):a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.sendCurrentEmailVerificationCode.label",defaultMessage:"Send verification code",description:"Sends a temporary verification passcode to the user's current email."}))}renderCurrentEmailPasscodeInput(e){return a()(d.Fragment,{},void 0,a()(Li.Z,{value:e.currentEmailPasscode,onChange:this.handleChangeCurrentEmailPasscode,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterCurrentEmailVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),!e.authorized&&a()(je.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization,disabled:e.loading},void 0,e.loading?a()(Re.Z,{}):a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue",description:"After the user verifies their current password or email, they click this button to continue changing their email."})))}renderNewEmailInput(){const{store:e}=this.stores;if(e.state.authorized)return a()(Li.Z,{value:e.state.newEmail,onChange:this.handleChangeNewEmail,onSubmit:this.handleSendNewEmailVerification,showClearButton:!0,onClearButtonClick:this.handleClearNewEmail,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.newEmailInput.placeholder",defaultMessage:"Enter new email"}),style:this.styles.input,focusInitial:!0})}renderSendNewEmailPasscodeButton(e){return a()(d.Fragment,{},void 0,e.error&&a()("div",{style:this.styles.error},void 0,e.error),a()(je.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSendNewEmailVerification,disabled:e.loading},void 0,e.loading?a()(Re.Z,{}):a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeButton.label",defaultMessage:"Send verification code"})))}renderNewEmailPasscodeInput(e){const t=this.getSubmitHandler();return a()(d.Fragment,{},void 0,a()("p",{style:this.styles.paragraph},void 0,a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.verificationCodeSentMessage",defaultMessage:"We just sent you a temporary verification code to {newEmail}.",values:{newEmail:a()("span",{style:this.styles.bold},void 0,e.newEmail)}})),a()(Li.Z,{value:e.newEmailPasscode,onChange:this.handleChangeNewEmailPasscode,onSubmit:t,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),e.error&&a()("div",{style:this.styles.error},void 0,e.error),a()(je.Z,{isLarge:!0,style:this.styles.button,onClick:t,disabled:e.loading},void 0,e.loading?a()(Re.Z,{}):a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.changeEmailButton.label",defaultMessage:"Change email"})))}renderEducationPlanDowngradeWarning(){const{hasEducationPlan:e}=this.props;if(e)return a()("div",{style:{...this.styles.educationPlanWarning,...this.getColors().educationPlanWarning}},void 0,Ge.Z.help({width:14,marginTop:4,marginRight:6,fill:this.theme.lightIconColor})," ",a()("div",{},void 0,a()(f.FormattedMessage,{defaultMessage:"Changing your email may downgrade your workspace on a Free Education Plan to the basic Free Plan. You won't lose any data, but you'll need to upgrade to re-access paid features. Have questions about this? <sendmessagelink>Message support</sendmessagelink>.",id:"emailChangeSettings.downgradeEducationPlan.warning.message",values:{sendmessagelink:e=>a()(Ao.Z,{onClick:this.handleSendUsMessageClick},void 0,e)}})))}renderCurrentEmail(){const{userValue:e}=this.props;if(e)return a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.currentEmail",defaultMessage:"Your current email is {currentEmail}.",values:{currentEmail:a()("span",{style:this.styles.bold},void 0,e&&e.email)}})}renderClaimedEmailDomainWarning(e){return a()(xe.Z,{isSmall:!0,isMultiline:!0,style:this.styles.claimedEmailDomainWarning},void 0,a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.claimedEmailDomainWarning",defaultMessage:"The email domain {newEmailDomain} has been claimed by an organization. If you continue with changing this email address, any workspaces created by this account can be managed by the organization. See <domainclaimlink>this page</domainclaimlink> for more info.",values:{newEmailDomain:(0,Ll.Gd)(e.newEmail)??e.newEmail,domainclaimlink:e=>a()(Ao.Z,{href:(0,W.UY)("guides.domainManagement"),external:!0},void 0,e)},description:"A message notifying the user that the email they wish to use has an email domain that has been verified by an organization"}))}showConfirmationModal(e){return S.confirmUserAction({message:a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.title",defaultMessage:"Are you sure you want to change your email?",description:"Title of the modal asking users to confirm if they want to change their email."}),description:a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.description",defaultMessage:"If you continue changing this email address to this domain, any workspaces created by this account can be managed by the organization.",values:{verifiedDomain:(0,Ll.Gd)(e)},description:"A message notifying the user that the email they wish to use has an email domain that has been verified by an organization"}),acceptLabel:a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.acceptButton.label",defaultMessage:"Change email",description:"Button confirming that the email will be changed."}),cancelLabel:a()(f.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.cancelButton.label",defaultMessage:"Go back",description:"Button prompting the user to go back to the change email modal."})})}getUserCurrentEmail(){const{store:e}=this.stores,{userValue:t,intl:i}=this.props;if(t)return t.email;e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:i.formatMessage({id:"profileSettings.changeEmailModal.errorNoUserValue",defaultMessage:"User value is undefined."})})}getSubmitHandler(){const{store:e}=this.stores,{userValue:t}=this.props;if(!e.state.authorized)return()=>{};if(e.state.newEmailContainsVerifiedDomain&&(0,Ll.Gd)(e.state.newEmail)!==(0,Ll.Gd)((null==t?void 0:t.email)||"")){const t=e.state.newEmail;return async()=>{await this.showConfirmationModal(t)&&await this.handleSubmit()}}return this.handleSubmit}getColors(){return{modal:{background:this.theme.contentBackground},educationPlanWarning:{color:this.theme.lightTextColor,borderTop:`1px solid ${this.theme.regularDividerColor}`}}}}Ap.displayName="EmailChangeSettings";const Bp=(0,f.injectIntl)(Ap);class Ep extends Z.Z{getInitialState(){return{open:!1}}}const Dp=new Ep;class Rp extends c.Z{constructor(){super(...arguments),this.handleLogOutFromActiveSessions=async()=>{b.AQD(this.environment),await ge.logoutActiveSessions(this.environment,{}),this.openConfirmationModal()}}renderComponent(){const e=a()(f.FormattedMessage,{id:"manageActiveSessions.title",defaultMessage:"Log out of all devices"}),t=a()(f.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.label",defaultMessage:"Log out of all other active sessions on other devices besides this one.",description:"Caption describing that the user will be logged out of other devices"});return d.createElement(d.Fragment,null,a()(Bo.Z,{type:"custom",isMobile:!1,title:e,caption:t,customButton:a()(Mi.Z,{style:{borderRadius:"0.25em"},onClick:this.handleLogOutFromActiveSessions},void 0,Ge.Z.chevronRightRoundedThin(this.getIconStyle()))}),this.renderManageActiveSessionsModal())}renderManageActiveSessionsModal(){const{open:e}=Dp.state,t=this.getUserEmailAddress();return a()($o.Z,{open:e,onDismiss:this.closeConfirmationModal,innerStyle:{width:350,padding:24,display:"flex",flexDirection:"column"},render:()=>d.createElement(d.Fragment,null,a()("div",{style:{marginBottom:24}},void 0,a()(f.FormattedMessage,t?{id:"manageActiveSessions.confirmationModal.withEmail",defaultMessage:"You have been logged out from other active sessions for {email}.",values:{email:t}}:{id:"manageActiveSessions.confirmationModal.withoutEmail",defaultMessage:"You have been logged out from other active sessions for your account."})),a()(je.Z,{onClick:this.closeConfirmationModal},void 0,a()(f.FormattedMessage,{id:"manageActiveSessions.confirmationModal.close",defaultMessage:"Close"})))})}openConfirmationModal(){Dp.setState({...Dp.state,open:!0})}closeConfirmationModal(){Dp.setState({...Dp.state,open:!1})}getUserEmailAddress(){let e;const{currentUserStore:t}=I.default.state;return t&&(e=t.getEmail()),e}getSettingTextStyle(){return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"}}getSettingStyle(){return{display:"flex",flexDirection:"row",alignItems:"center"}}getIconStyle(){return{width:20,height:20,fill:this.theme.lightIconColor}}}Rp.displayName="ManageActiveSessions";const Lp=Rp;var Op=i(1799),Np=i(16010);class Vp extends Z.Z{getInitialState(){return{step:"backupCodesUninitialized"}}}class Up extends Np.o{constructor(e,t){super(e,"backupCodes"),this.service=void 0,this.service=t}backupCodesInitialSetup(e){if(!this.checkStep("backupCodesUninitialized"))return;const{onLoadingComplete:t,onComplete:i}=e;this.store.setState({step:"backupCodesLoading"}),this.doCreateBackupCodes({forceRecreate:!1,onComplete:i,onLoadingComplete:t}).catch(this.handleUnexpectedError)}backupCodesShowCreate(){this.checkStep("backupCodesUninitialized")&&this.store.setState({step:"backupCodesRegenerateCodes"})}backupCodesRegenerateCodes(){this.checkStep("backupCodesRegenerateCodes")&&(this.store.setState({step:"backupCodesRegenerateCodes",isLoading:!0}),this.doCreateBackupCodes({forceRecreate:!0,onComplete:()=>{},onLoadingComplete:()=>{}}).catch(this.handleUnexpectedError))}exit(){this.store.setState({step:"backupCodesUninitialized"})}async doCreateBackupCodes(e){const{forceRecreate:t,onComplete:i,onLoadingComplete:n}=e,a=await this.withStep(["backupCodesLoading","backupCodesRegenerateCodes"],(()=>this.service.createBackupCodes(t)));if(!a)return;const{result:o}=a;if("already-exists"===o.status)i();else{const e=function(e){const t=V.default.getIntl(),i=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.title",defaultMessage:"Notion Backup Codes",description:"Title of the text file containing backup codes used for 2-step verification. In this case, Notion refers to the product itself."}),n=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.createdAt",defaultMessage:"Created at {createdAt}",description:"Description of when the backup codes used for 2-step verification was created."},{createdAt:`${new Date}`}),a=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.warningMessage",defaultMessage:"Please store these in a secure location and mark off codes as they are used.",description:"Warning to the users telling them where to store these codes and how to keep track of usage."}),o=`${i}\n${n}\n\n${e.map(Op.K).join("\n")}\n\n${a}\n`;return encodeURIComponent(o)}(o.backupCodes);this.store.setState({step:"backupCodesShowCodes",backupCodes:o.backupCodes,mfaSettingId:o.mfaSettingId,backupCodesFile:e}),n()}}}var Wp=i(75752),zp=i(88175);function Kp(e){let{errorMessage:t,isLoading:i,onDisplayBackupCodes:n,onCancel:o,onDismiss:s}=e;window.__c={n:"MFAPromptRegenerateBackupCodes"};const r=a()(f.FormattedMessage,{id:"mfa.regenerateBackupCodes.title",defaultMessage:"Regenerate backup codes",description:"Title of MFA modal that prompts user generate new backup codes"}),l=a()(f.FormattedMessage,{id:"mfa.regenerateBackupCodes.message",defaultMessage:"Backup codes are used to log in if you lose access to your password and second factors. <boldtext>Your existing codes won't work after regenerating new ones.</boldtext>",description:"Caption that explains to the user what will happen when generating new backup codes.",values:{boldtext:e=>a()("span",{style:{fontWeight:h.Z.fontWeight.semibold}},void 0,e)}}),d={text:i?a()(Re.Z,{}):a()(f.FormattedMessage,{id:"mfa.regenerateBackupCodes.regenerateBackupCodes.button.message",defaultMessage:"Generate new backup codes",description:"Button advancing user to generate new backup codes"}),onClick:n,view:"outline",disabled:i,isRed:!0},c=[{text:a()(f.FormattedMessage,{id:"mfa.regenerateBackupCodes.cancel.button.message",defaultMessage:"Cancel",description:"Button that cancels re-generating backup codes"}),onClick:o,view:"outline",type:"button"}];return a()(zp.Z,{title:r,header:l,errorMessage:t,primaryAction:d,secondaryActions:c,onDismiss:s})}function qp(e){window.__c={n:"MFABackupCodesNumbers"};const{backupCodes:t}=e,i=(0,_e.yK)((e=>({pane:{display:"flex",whiteSpace:"pre-line",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:4,backgroundColor:ho.FN.light.yellow[50],paddingTop:8,paddingBottom:8,marginBottom:10},textCode:{fontFamily:h.Z.getHeaderFontFamily({pageFont:"mono",locale:ra.SP}),fontWeight:h.Z.fontWeight.regular,fontSize:h.Z.fontSize.UIRegular.desktop,font:h.Z.baseFontFamily.emailMono,color:ho.FN.light.brown[500],textAlign:"center"}})),[]),n=a()("div",{style:i.textCode},void 0,t.map(Op.K).join("\n"));return a()("div",{style:i.pane},void 0,n)}function Hp(e){let{backupCodes:t,backupCodeDownload:i,backupCodeFileName:n,errorMessage:o,onNoted:s,onDownload:r}=e;window.__c={n:"MFAPromptShowBackupCodes"};const l=a()(f.FormattedMessage,{id:"mfa.showBackupCodes.title",defaultMessage:"Save your backup codes",description:"Title of MFA modal that shows backup codes"}),c=d.createElement(d.Fragment,null,a()(f.FormattedMessage,{id:"mfa.showBackupCodes.message",defaultMessage:"<boldtext>You can only see this once</boldtext>, so be sure to keep them to avoid getting locked out of your account.",description:"Caption for the MFA modal prompting users to save backup codes",values:{boldtext:e=>a()("span",{style:{fontWeight:h.Z.fontWeight.semibold}},void 0,e)}})),u={text:a()(f.FormattedMessage,{id:"mfa.showBackupCodes.codesNotedDown.button.message",defaultMessage:"I've saved them",description:"Button ensuring user has saved the backup codes"}),onClick:s},p=[{text:a()(f.FormattedMessage,{id:"mfa.showBackupCodes.downloadAsTextFile.button.message",defaultMessage:"Download as text file",description:"Button that will save backup codes as a text file"}),href:`data:text/plain;charset=UTF-8,${i}`,saveAs:n,view:"outline",type:"link",onClick:r}];return a()(zp.Z,{title:l,header:c,errorMessage:o,primaryAction:u,secondaryActions:p},void 0,a()(qp,{backupCodes:t}))}function Gp(e){const{backupCodesStateMachine:t,onGoToSettings:i,onDismiss:n}=e,o=t.useCurrentStep(),s=()=>t.backupCodesRegenerateCodes();switch(o.step){case"backupCodesUninitialized":case"backupCodesLoading":return null;case"backupCodesRegenerateCodes":return a()(Kp,{isLoading:o.isLoading,errorMessage:o.error,onDisplayBackupCodes:s,onDismiss:n,onCancel:i});case"backupCodesShowCodes":return a()(Hp,{errorMessage:o.error,backupCodes:o.backupCodes,backupCodeDownload:o.backupCodesFile,backupCodeFileName:"Notion Backup Codes.txt",onNoted:i});default:return(0,T.t1)(o)}}var jp=i(99657);function $p(e){let{type:t,errorMessage:i,onDismiss:n,onAddMethod:o}=e;window.__c={n:"MFAPromptSetupComplete"};const s=(0,_e.yK)(Yp,[]),r=a()(f.FormattedMessage,{id:"mfa.setupComplete.confirmation.header",defaultMessage:"Every time you enter your password, Notion will ask you for a verification code to confirm your identity.",description:"Label that confirms you are now required to use MFA whenever you login"}),l=[{text:a()(f.FormattedMessage,{id:"mfa.setupComplete.confirmation.viewTwoStepMethods.button.message",defaultMessage:"View 2-step methods",description:"A button to view all 2-step verification methods"}),onClick:o,type:"button",view:"outline"}];return a()(zp.Z,{title:"totp"===t?a()(f.FormattedMessage,{id:"mfa.totp.setupComplete.confirmation.title",defaultMessage:"2-step verification with authenticator is turned on",description:"Title for a prompt confirming TOTP MFA has been setup"}):"sms"===t?a()(f.FormattedMessage,{id:"mfa.sms.setupComplete.confirmation.title",defaultMessage:"2-step verification with phone number is turned on",description:"Title for a prompt confirming SMS MFA has been setup"}):(0,T.t1)(t),header:r,errorMessage:i,icon:Ge.Z.circleCheck(s.confirmationIcon),secondaryActions:l,onDismiss:n})}function Yp(e){return(0,_e.EM)({confirmationIcon:{width:30,fill:"green"}})}var Qp=i(4387),Xp=i(49682);const Jp={name:"United States",countryCode:"1",regionCode:"US"},em=[{name:"China",countryCode:"86",regionCode:"CN"}];function tm(e){let{isLoading:t,phoneNumber:i,country:n,errorMessage:o,onDismiss:r,onBack:c,onContinue:u}=e;window.__c={n:"MFAPromptSMSAddPhone"};const p=(0,_e.yK)(im,[]),m=(0,f.useIntl)(),[g,h]=(0,d.useState)(i??""),[v,y]=(0,d.useState)([]),[b,S]=(0,d.useState)(""),[w,M]=(0,d.useState)(n??Jp),C=(0,Te.qz)(void 0,Tt.Z),[k,T]=(0,d.useState)(void 0),_=(0,d.useMemo)((()=>(0,Qp.PG)(w.regionCode)),[w.regionCode]),I=(0,d.useCallback)((e=>{const t=e.target.value.replace(/\D/g,"");h(_.reset(t))}),[_]);(0,d.useEffect)((()=>{h(n!==w?_.reset(g??""):_.reset(i??""));const e=new Intl.DisplayNames(["en"],{type:"region"}),t=(0,Qp.wJ)();let a=-1;const o=t.map(((t,i)=>{const n=(0,Qp.t7)(t).toString(),o=e.of(t);return t===w.regionCode&&(a=i),{name:o??t,countryCode:n,regionCode:t}}));-1!==a&&o.unshift(o.splice(a,1)[0]),y(o),em.some((e=>l().isEqual(e,w)))?T(Xp.Qj.smsUnsupportedPhoneNumber(w.name)):T(void 0)}),[w]);const x=a()(f.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneTitle",defaultMessage:"Add a phone number",description:"Title for a prompt that asks you for a phone number for SMS Verification."}),Z=a()(f.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneHeader",defaultMessage:"Enter your phone number to receive a 2-step verification code.",description:"Label describing that you need to provide a phone number for this form of 2FA."}),P={text:t?a()(Re.Z,{}):a()(f.FormattedMessage,{id:"profileSettings.mfa.sms.continueButton",defaultMessage:"Continue",description:"A button that navigates to the next step."}),onClick:()=>u(w,g.trim()),disabled:t||""===g||void 0!==k},F=[{text:a()(f.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneNeedHelp",defaultMessage:"Need help?",description:"A button to use when you need help inputting your phone number."}),href:(0,W.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}],A=m.formatMessage({id:"profileSettings.mfa.sms.phoneNumberInput.placeholder",defaultMessage:"Enter phone number",description:"Placeholder text for an input to add a phone number"}),B=m.formatMessage({defaultMessage:"Search country code",id:"profileSettings.mfa.sms.countryCodeSelect.placeholder",description:"Placeholder text for the input to search country codes"}),E=e=>a()("div",{style:p.countryCodeSelectTitle},void 0,e.name,a()(xe.Z,{isSmall:!0},void 0,`+${e.countryCode}`)),D=a()(xt.Z,{popupType:xt.Z.PopupType.Popup,placementToOrigin:Pd.Iw.Bottom,alignmentToOrigin:Pd.lU.Start,buttonPopupStore:C,renderOrigin:e=>d.createElement(Ae.Z,e,`+${w.countryCode}`),render:e=>a()(at.Z,{menuType:Je.og.Popup,minWidth:280,maxHeight:"30vh",header:a()(rt.Z,{isInput:!0},void 0,a()(Hd.ZP,{value:b,onChange:e=>S(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:B}))},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:0,sections:[{key:"countries",render:e=>d.createElement(rt.Z,e),items:(0,lc.ZP)(b,v,(e=>/\d/.test(b)?`${e.countryCode}`:e.name)).map((t=>({key:t.regionCode,render:e=>d.createElement(it.Z,s()({},e,{title:E(t),right:t.name===w.name?Ge.Z.thinCheck(p.selectedCountryCodeIcon):void 0})),action:()=>{S(""),M(t),e.close()}})))}]}))});return a()(zp.Z,{onDismiss:r,onBack:c,title:x,header:Z,errorMessage:k||o,primaryAction:P,secondaryActions:F},void 0,a()("div",{style:p.container},void 0,a()("div",{style:p.countryCodeDropdownMenu},void 0,D),a()(Li.Z,{autoFocus:!0,value:g,placeholder:A,spellCheck:!1,style:p.phoneNumberInput,onChange:I,disabled:t||void 0!==k,customElementAttributes:Bs.pf})))}function im(e){return(0,_e.EM)({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:16,marginBottom:4},countryCodeDropdownMenu:{marginRight:5},selectedCountryCodeIcon:{width:15,height:15},countryCodeSelectTitle:{paddingTop:8,paddingBottom:8},phoneNumberInput:{background:"light"===e.mode?ho.ZP.transparent:e.inputBackground}})}var nm=i(56839);function am(e){const{smsStateMachine:t,onGoToSettings:i,onDismiss:n,onStartBackupCodes:o}=e,s=t.useCurrentStep();switch(s.step){case"smsUninitialized":return null;case"smsSendingSMS":case"smsSetPhoneNumber":return a()(tm,{phoneNumber:s.phoneNumber,country:s.country,isLoading:"smsSendingSMS"===s.step,errorMessage:s.error,onDismiss:n,onBack:i,onContinue:(e,i)=>t.smsCreateSMS(e,i)});case"smsVerifyCode":case"smsResendSMS":case"smsBackupCodesLoading":case"smsVerifying":return a()(nm.ZP,{isLoading:"smsVerifying"===s.step||"smsBackupCodesLoading"===s.step,errorMessage:s.error,phoneNumber:`+${s.country.countryCode} ${s.phoneNumber}`,onDismiss:n,onBack:()=>t.smsRestart(),onVerifyCode:e=>t.smsVerifyCode({code:e,onVerified:o}),resentStatus:"smsResendSMS"===s.step?"resending":"resentAt"in s&&void 0!==s.resentAt?"resent":"not-resent",resentAt:"resentAt"in s&&s.resentAt?s.resentAt:0,onResendLink:()=>t.smsResendSMS()});case"smsVerified":return null;case"smsComplete":return a()($p,{type:"sms",errorMessage:s.error,onAddMethod:i,onDismiss:n});default:return(0,T.t1)(s)}}function om(e){window.__c={n:"MFAAuthenticatorNameInput"};const{placeholder:t,value:i,maxlength:n,style:o,onChange:s}=e,r=(0,_e.yK)((e=>(0,_e.EM)({input:{background:ho.ZP.transparent,color:e.darkTextColor,...o}})),[o]);return a()(Li.Z,{value:i,placeholder:t,maxlength:n,style:r.input,inputStyle:h.Z.textOverflowStyle,autoFocus:!0,spellCheck:!1,onChange:s,autoComplete:"off",customElementAttributes:Bs.pf})}function sm(e){let{isLoading:t,qrCode:i,friendlyName:n,errorMessage:o,onDismiss:s,onBack:r,onCantScanCode:l,onContinue:c}=e;window.__c={n:"MFAPromptTOTPScanQRCode"};const u=(0,_e.yK)(rm,[]),p=(0,f.useIntl)(),[m,g]=(0,d.useState)(n??""),h=(0,d.useCallback)((e=>{g(e.target.value)}),[g]),v=a()(f.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeTitle",defaultMessage:"Scan code in authenticator app",description:"Title for a prompt asks you to scan a QR Code for Authenticator"}),y=a()(f.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeHeader",defaultMessage:"Generate a verification code with an authenticator app, then enter a name to remember it by.",description:"Label describing how to generate a one time code."}),b={text:a()(f.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue",description:"A button that navigates to the next step."}),onClick:()=>c(m),disabled:!i||t||0===m.length},S=[{text:a()(f.FormattedMessage,{id:"profileSettings.mfa.totp.cantScanCodeButton",defaultMessage:"Can't scan code?",description:"A button to use when you are unable to scan a QR Code."}),onClick:l,type:"button",view:"plain",disabled:t}],w=p.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput.placeholder",defaultMessage:"Enter authenticator name",description:"Placeholder text for an input to name of the authenticator"});return a()(zp.Z,{onDismiss:s,onBack:r,title:v,header:y,errorMessage:o,primaryAction:b,secondaryActions:S},void 0,a()("div",{style:u.body},void 0,a()("div",{style:u.qrCodeContainer},void 0,i?a()("img",{style:u.qrCode,src:i}):a()(Re.Z,{})),a()(om,{placeholder:w,value:m,maxlength:30,onChange:h})))}function rm(e){return(0,_e.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},qrCodeContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:116,height:116,marginBottom:15},qrCode:{width:"100%"}})}function lm(e){let{textCode:t,friendlyName:i,errorMessage:n,isLoading:o,onDismiss:s,onBack:r,onUseQrCode:l,onContinue:c}=e;window.__c={n:"MFAPromptTOTPTypeTextCode"};const u=(0,_e.yK)(dm,[]),[p,m]=(0,d.useState)(i??""),g=(0,f.useIntl)(),h=(0,d.useCallback)((e=>{m(e.target.value)}),[m]),v=a()(f.FormattedMessage,{id:"profileSettings.mfa.totp.typeTextCodeTitle",defaultMessage:"Type code from authenticator app",description:"Title for a prompt asks you to type a textual code for Authenticator"}),y=a()(f.FormattedMessage,{id:"profileSettings.mfa.totp.typeText.message",defaultMessage:"Input this setup key in your authenticator app, then enter a name to remember it by.",description:"A message to describe how to use the text code.",values:{authenticatorlink:e=>a()(Ao.Z,{external:!0,href:(0,W.UY)("guides.mfa")},void 0,e)}}),b={text:a()(f.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue",description:"A button that navigates to the next step."}),onClick:()=>c(p),disabled:o||0===p.length},S=[{text:a()(f.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeButton",defaultMessage:"Scan QR code",description:"A button used if you prefer to scan a QR Code."}),onClick:l,type:"button",view:"plain",disabled:o}],w=g.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput",defaultMessage:"Enter authenticator name",description:"Placeholder text for an input to name of the authenticator"});return a()(zp.Z,{onDismiss:s,onBack:r,title:v,header:y,errorMessage:n,primaryAction:b,secondaryActions:S},void 0,a()("div",{style:u.body},void 0,a()("div",{style:u.content},void 0,a()("div",{style:u.textCode},void 0,t)),a()(om,{placeholder:w,value:p,maxlength:30,onChange:h})))}function dm(e){return(0,_e.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},textCode:{fontWeight:h.Z.fontWeight.medium,fontSize:h.Z.fontSize.UIRegular.desktop,color:e.darkTextColor,textAlign:"center",verticalAlign:"middle"},content:{display:"flex",flexDirection:"column",justifyContent:"center",height:50,marginBottom:15}})}var cm=i(18469);function um(e){const{totpStateMachine:t,onGoToSettings:i,onStartBackupCodes:n,onDismiss:o}=e,r=t.useCurrentStep();switch(r.step){case"totpUninitialized":return null;case"totpLoadingQRCode":case"totpDisplayQRCode":const e="totpLoadingQRCode"===r.step?{isLoading:!0,qrCode:void 0}:{isLoading:r.isLoading,qrCode:r.qrCode};return d.createElement(sm,s()({},e,{friendlyName:"totpDisplayQRCode"===r.step?r.friendlyName:void 0,errorMessage:r.error,onDismiss:o,onBack:i,onCantScanCode:()=>t.totpDisplayTextCode(),onContinue:e=>t.totpDisplayVerification(e)}));case"totpDisplayTextCode":return a()(lm,{textCode:r.rawString,friendlyName:r.friendlyName,errorMessage:r.error,isLoading:r.isLoading,onDismiss:o,onBack:i,onUseQrCode:()=>t.totpDisplayQRCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpVerifyCode":case"totpBackupCodesLoading":case"totpVerifying":return a()(cm.ZP,{isLoading:"totpVerifying"===r.step||"totpBackupCodesLoading"===r.step,errorMessage:r.error,onDismiss:o,onBack:()=>t.totpDisplayQRCode(),onVerifyCode:e=>t.totpVerifyCode({code:e,onVerified:n})});case"totpVerified":return null;case"totpComplete":return a()($p,{type:"totp",errorMessage:r.error,onDismiss:o,onAddMethod:i});default:return(0,T.t1)(r)}}function pm(e){const{rootStateMachine:t,settingsStateMachine:i,totpStateMachine:n,smsStateMachine:o,backupCodesStateMachine:r,onReloadSettings:l}=e,c=t.useCurrentStep(),[{showSettings:u,onRootExit:p}]=(0,d.useState)((()=>({onRootExit:()=>t.exit((()=>{i.exit(),n.exit(),o.exit(),r.exit(),l&&l()})),showSettings:()=>t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{i.settingsConfirmIdentityForSettings()}})}))),m=()=>t.rootCloseSettings((()=>{i.exit(),l&&l()})),g=()=>t.rootStartTOTP((()=>n.totpStart())),h=()=>t.rootStartSMS((()=>o.smsStart())),f=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{n.exit(),i.settingsShow({refresh:!0})}})},v=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{o.exit(),i.settingsShow({refresh:!0})}})},y=()=>{r.exit(),t.rootEndBackupCodes({completeTotp:()=>{n.totpComplete()},completeSMS:()=>{o.smsComplete()},showSettings:u})},b=()=>{r.backupCodesInitialSetup({onLoadingComplete:()=>{n.totpBackupCodesComplete(),t.rootShowBackupCodesFromTOTP()},onComplete:()=>{n.totpBackupCodesComplete(),n.totpComplete(),y()}})},S=()=>{r.backupCodesInitialSetup({onLoadingComplete:()=>{o.smsBackupCodesComplete(),t.rootShowBackupCodesFromSMS()},onComplete:()=>{o.smsBackupCodesComplete(),o.smsComplete(),y()}})},w=()=>{t.rootStartBackupCodesFromSettings((()=>r.backupCodesShowCreate()))},M=i.useCurrentStep(),C=n.useCurrentStep(),k=o.useCurrentStep(),_=r.useCurrentStep();let I;switch(c.step){case"rootUninitialized":break;case"rootSettings":I={open:"settingsUninitialized"!==M.step,onDismiss:p,render:()=>a()(jp.Z,{settingsStateMachine:i,onDismiss:m,onStartTOTP:g,onStartSMS:h,onStartBackupCodes:w})};break;case"rootTOTP":I={open:"totpUninitialized"!==C.step,onDismiss:p,render:()=>a()(um,{totpStateMachine:n,onGoToSettings:f,onStartBackupCodes:b,onDismiss:p})};break;case"rootSMS":I={open:"smsUninitialized"!==k.step,onDismiss:p,render:()=>a()(am,{smsStateMachine:o,onGoToSettings:v,onStartBackupCodes:S,onDismiss:p})};break;case"rootBackupCodes":I={open:"backupCodesUninitialized"!==_.step,onDismiss:"backupCodesRegenerateCodes"===_.step?p:void 0,render:()=>a()(Gp,{backupCodesStateMachine:r,onGoToSettings:y,onDismiss:p})};break;default:throw(0,T.t1)(c)}return I?d.createElement($o.Z,s()({},I,{preventHideChildrenWhileOpening:!0})):null}class mm extends Z.Z{getInitialState(){return{step:"rootUninitialized"}}}class gm extends Np.o{constructor(e){super(e,"root")}rootShowSettings(e){const{refresh:t,startConfirmIdentity:i}=e;if(this.checkStep("rootSettings")){if(!t)return}else this.store.setState({step:"rootSettings"});i()}rootStartBackupCodesFromSettings(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootBackupCodes",source:"settings"}),e())}rootStartTOTP(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootTOTP"}),e())}rootShowBackupCodesFromTOTP(){this.checkStep("rootTOTP")&&this.store.setState({step:"rootBackupCodes",source:"totp"})}rootStartSMS(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootSMS"}),e())}rootShowBackupCodesFromSMS(){this.checkStep("rootSMS")&&this.store.setState({step:"rootBackupCodes",source:"sms"})}rootEndBackupCodes(e){const t=this.checkStep("rootBackupCodes");if(t)switch(t.source){case"settings":return this.store.setState({step:"rootSettings"}),e.showSettings();case"sms":return this.store.setState({step:"rootSMS"}),e.completeSMS();case"totp":return this.store.setState({step:"rootTOTP"}),e.completeTotp();default:(0,T.t1)(t.source)}}rootCloseSettings(e){e(),this.store.setState({step:"rootUninitialized"})}exit(e){this.store.setState({step:"rootUninitialized"}),e()}}var hm=i(24173);class fm extends Z.Z{getInitialState(){return{step:"smsUninitialized"}}}class vm extends Np.o{constructor(e,t){super(e,"sms"),this.service=void 0,this.service=t}smsStart(){this.checkStep("smsUninitialized")&&this.store.setState({step:"smsSetPhoneNumber"})}smsRestart(){const e=this.checkStep(["smsResendSMS","smsVerifyCode","smsVerifying"]);e&&this.store.setState({step:"smsSetPhoneNumber",country:e.country,phoneNumber:e.phoneNumber,error:void 0})}smsCreateSMS(e,t){this.checkStep("smsSetPhoneNumber")&&(this.store.setState({country:e,phoneNumber:t,step:"smsSendingSMS"}),this.doCreateSMS().catch(this.handleUnexpectedError))}smsResendSMS(){const e=this.checkStep(["smsVerifyCode","smsVerifying"]);e&&(this.store.setState({...e,step:"smsResendSMS",error:void 0}),this.doResendSMS().catch(this.handleUnexpectedError))}smsVerifyCode(e){const{code:t,onVerified:i}=e,n=this.checkStep("smsVerifyCode");n&&(this.store.setState({...n,step:"smsVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:i}).catch(this.handleUnexpectedError))}smsBackupCodesComplete(){this.checkStep("smsBackupCodesLoading")&&this.store.setState({step:"smsVerified"})}smsComplete(){this.checkStep("smsVerified")&&this.store.setState({step:"smsComplete"})}exit(){this.store.setState({step:"smsUninitialized"})}async doCreateSMS(){const e=await this.withStep("smsSendingSMS",(e=>this.service.createSMS(e.country.countryCode,e.phoneNumber)));if(!e)return;const{result:t,state:i}=e;switch(t.status){case"created":this.store.setState({...i,step:"smsVerifyCode",mfaSettingId:t.mfaSettingId,error:void 0});break;case"already_verified_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:Xp.Qj.smsAlreadyVerifiedPhoneNumber});break;case"invalid_country_code":this.store.setState({step:"smsSetPhoneNumber",error:Xp.Qj.smsInvalidCountryCode});break;case"invalid_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:Xp.Qj.smsInvalidPhoneCode});break;default:return(0,T.t1)(t)}}async doVerifyCode(e){const{code:t,onVerified:i}=e,n=await this.withStep("smsVerifying",(e=>this.service.verifySMS({mfaSettingId:e.mfaSettingId,code:t})));if(!n)return;const{result:a,state:o}=n;switch(a.status){case"match":this.store.setState({step:"smsBackupCodesLoading",country:o.country,phoneNumber:o.phoneNumber}),i();break;case"error":this.store.setState({...o,step:"smsVerifyCode",error:Xp.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"smsVerifyCode",error:Xp.Qj.smsIncorrectCode});break;default:return(0,T.t1)(a.status)}}async doResendSMS(){const e=await this.withStep("smsResendSMS",(e=>this.service.sendSMS({mfaSettingId:e.mfaSettingId})));if(!e)return;const{result:t,state:i}=e;switch(t.status){case"ok":this.store.setState({...i,step:"smsVerifyCode",mfaSettingId:i.mfaSettingId,error:void 0,resentAt:Date.now()});break;case"error":this.store.setState({...i,step:"smsVerifyCode",mfaSettingId:i.mfaSettingId,error:Xp.Qj.unexpectedError});break;default:return(0,T.t1)(t.status)}}}class ym extends Z.Z{getInitialState(){return{step:"totpUninitialized"}}}class bm extends Np.o{constructor(e,t){super(e,"totp"),this.service=void 0,this.service=t}totpStart(){this.checkStep("totpUninitialized")&&(this.store.setState({step:"totpLoadingQRCode"}),this.doCreateTOTP().catch(this.handleUnexpectedError))}totpDisplayTextCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayQRCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayTextCode",error:void 0,isLoading:!1})}}totpDisplayQRCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayTextCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayQRCode",error:void 0,isLoading:!1})}}totpDisplayVerification(e){this.checkStep(["totpDisplayQRCode","totpDisplayTextCode"])&&this.doRenameTOTP(e).catch(this.handleUnexpectedError)}totpVerifyCode(e){const{code:t,onVerified:i}=e,n=this.checkStep("totpVerifyCode");n&&(this.store.setState({...n,step:"totpVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:i}).catch(this.handleUnexpectedError))}totpBackupCodesComplete(){this.checkStep("totpBackupCodesLoading")&&this.store.setState({step:"totpVerified"})}totpComplete(){this.checkStep("totpVerified")&&this.store.setState({step:"totpComplete"})}exit(){this.store.setState({step:"totpUninitialized"})}async doCreateTOTP(){const e=await this.withStep("totpLoadingQRCode",(()=>this.service.createTOTP()));if(!e)return;const{result:t}=e;this.store.setState({step:"totpDisplayQRCode",qrCode:t.qrCode,rawString:t.secret,mfaSettingId:t.mfaSettingId,isLoading:!1})}async doRenameTOTP(e){const t=await this.withStep(["totpDisplayQRCode","totpDisplayTextCode"],(t=>this.service.renameSettings({mfaSettingId:t.mfaSettingId,friendlyName:e})));if(!t)return;const{result:i,state:n}=t;switch(i.status){case"saved":this.store.setState({...n,step:"totpVerifyCode",friendlyName:e,error:void 0});break;case"duplicate":this.store.setState({...n,isLoading:!1,error:Xp.Qj.totpDuplicateFriendlyName});break;case"empty":this.store.setState({...n,isLoading:!1,error:Xp.Qj.totpEmptyFriendlyName});break;case"bad_friendly_name":this.store.setState({...n,isLoading:!1,error:Xp.Qj.totpBadFriendlyName});break;default:return(0,T.t1)(i)}}async doVerifyCode(e){const{code:t,onVerified:i}=e,n=await this.withStep("totpVerifying",(e=>this.service.verifyTOTP({mfaSettingId:e.mfaSettingId,code:t})));if(!n)return;const{result:a,state:o}=n;switch(a.status){case"match":this.store.setState({step:"totpBackupCodesLoading"}),i();break;case"error":this.store.setState({...o,step:"totpVerifyCode",error:Xp.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"totpVerifyCode",error:Xp.Qj.totpIncorrectCode});break;default:return(0,T.t1)(a.status)}}}function Sm(e){let{status:t,numMfaSettings:i,onReloadSettings:n}=e;const o=(0,ke.O7)(),[{rootStateMachine:s,settingsStateMachine:r,totpStateMachine:l,smsStateMachine:c,backupCodesStateMachine:u}]=(0,d.useState)((()=>{const e=new Wp.r(o),t={totpStore:new ym,settingsStore:new hm.c,smsStore:new fm,backupCodesStore:new Vp,rootStore:new mm};return{mfaService:e,rootStateMachine:new gm(t.rootStore),settingsStateMachine:new hm.W(t.settingsStore,e),totpStateMachine:new bm(t.totpStore,e),smsStateMachine:new vm(t.smsStore,e),backupCodesStateMachine:new Up(t.backupCodesStore,e)}})),p=o.device.isMobile,m=(0,_e.yK)((()=>({configureButton:{marginTop:p?12:0,marginBottom:p?4:0}})),[p]);return d.createElement(d.Fragment,null,a()(Bo.Z,{type:"toggleToButton",isMobile:!1,title:a()(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.label",defaultMessage:"2-step verification",description:"Label for 2-step verification setting"}),caption:a()(f.FormattedMessage,"on"===t?{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.settingConfigured.message",defaultMessage:"You have {numMfaSettings} verification methods turned on.",description:"Message describing the number of 2-step verification settings that are configured",values:{numMfaSettings:i}}:{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.message",defaultMessage:"Add an additional layer of security to your account during login.",description:"Message describing the 2-step verification setting"}),isOn:"on"===t,buttonStyle:m.configureButton,buttonLabel:a()(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.label",defaultMessage:"Change verification methods",description:"Button to change the method for verification."}),onClick:()=>{!function(e){let{rootStateMachine:t,settingsStateMachine:i}=e;t.rootShowSettings({refresh:!1,startConfirmIdentity:()=>i.settingsConfirmIdentityForSettings()})}({rootStateMachine:s,settingsStateMachine:r})},tooltipLabel:a()(f.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.tooltip",defaultMessage:"A password is required to enable 2-step verification",description:"Tooltip explaining that MFA requires a password to be set."}),disableTooltip:"disabled"!==t,disabled:"disabled"===t}),a()(pm,{onReloadSettings:n,rootStateMachine:s,settingsStateMachine:r,totpStateMachine:l,smsStateMachine:c,backupCodesStateMachine:u}))}var wm=i(1548),Mm=i(30045);class Cm extends c.Z{constructor(){super(...arguments),this.storeTypes={spaceProfileSettingsStore:ye,passwordRequestStore:lo.Z,isEducationStore:Yu.default.of(!1),emailDomainSettingsStore:Yu.default.of({}),accountSettingsStore:Yu.default.of({hasPassword:!1,canConfigurePassword:!1,isSamlEnforced:!1,mfaStatus:"loading",numMfaSettings:0})},this.handleUploadProfilePhoto=()=>{b.Her(this.environment),zs.cR({environment:this.environment,onStart:this.handleUploadStart,bucket:"public",onError:this.handleUploadError,onComplete:this.handleUploadComplete,accept:"image/*"})},this.handleRemoveProfilePhoto=()=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,profilePhoto:void 0}),B.createAndCommit({userAction:"SpaceProfileSettings.handleRemoveProfilePhoto",environment:this.environment,perform:e=>{const{currentUserStore:t}=I.default.state;t&&y.A({userStore:t,data:{profilePhoto:null},transaction:e})}})},this.handleNameChange=e=>{const t=e.target.value;b.O$H(this.environment,{from:this.stores.spaceProfileSettingsStore.state.name,to:t}),this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,name:t}),B.createAndCommit({userAction:"SpaceProfileSettings.handleNameChange",environment:this.environment,perform:e=>{const{currentUserStore:i}=I.default.state;i&&y.A({userStore:i,data:{name:t},transaction:e})}})},this.handleUploadStart=()=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,uploadingProfilePhoto:!0})},this.handleUploadError=()=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,uploadingProfilePhoto:!1}),S.showErrorMessage(a()(f.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadProfilePhotoError.message",defaultMessage:"Upload failed."}))},this.handleUploadComplete=e=>{const t=e[0];this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,profilePhoto:t,uploadingProfilePhoto:!1}),B.createAndCommit({userAction:"SpaceProfileSettings.handleUploadComplete",environment:this.environment,perform:e=>{const{currentUserStore:i}=I.default.state;i&&y.A({userStore:i,data:{profilePhoto:t},transaction:e})}})}}willMount(e){super.willMount(e);const{spaceProfileSettingsStore:t,isEducationStore:i}=this.stores,{currentUserStore:n,currentUserSettingsStore:a,currentUserRootStore:o}=I.default.state;if(n&&a){const i=t.getValueForUser(n,a,e.intl);i&&t.setState(i)}if(o){const e=((0,K.xR)({environment:this.environment,userRootStore:o})||[]).some((e=>e===Qe.Z.pricing.student.productId));i.set(e)}}renderComponent(){return Ie.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(f.FormattedMessage,{defaultMessage:"Please go online to manage your profile.",id:"profileSettings.offline.message"})))}renderSettings(){const{currentUserStore:e}=I.default.state;if(!e)return;const t=e.getValue();if(!t)return;const{name:i}=this.stores.spaceProfileSettingsStore.state,{passwordRequestStore:n}=this.stores;return a()(Ze.Z,{},void 0,a()(So.Z,{request:{},requestStore:n,performRequest:async()=>{if(N.default.checkGate("enable_managed_users_disabled_profile_edits")){const e=await ge.getEmailDomainSettings(this.environment,{});"success"===e.type&&this.stores.emailDomainSettingsStore.set(e.data)}try{const e=await(0,Bs.pu)(this.environment);this.stores.accountSettingsStore.set({...e})}catch(e){throw this.stores.accountSettingsStore.reset(),e}},render:(n,o,s)=>s?this.renderPersonalSettings({currentUserStore:e,currentUserValue:t,userName:i}):a()(Re.Z,{style:{margin:"50% auto"}})}))}renderPersonalSettings(e){const{userName:t,currentUserStore:i,currentUserValue:n}=e,o=function(e,t){return e.isDefined()?Vs({profilePhoto:e.getProfilePhoto(),name:e.getFullName(t),email:e.getEmail()}):{type:"icon"}}(i,V.default.getIntl()),s=(0,Ll.Gd)(n.email),r=Boolean(this.stores.emailDomainSettingsStore.get().prevent_profile_edits);return d.createElement(d.Fragment,null,this.renderMyProfileHeader(),a()("div",{style:{display:"flex",flexDirection:"column"}},void 0,a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},void 0,a()(Os,{size:60,avatarType:o,isOffline:!Ie.Z.state.online,onUploadProfilePhoto:this.handleUploadProfilePhoto,onRemoveProfilePhoto:this.handleRemoveProfilePhoto,disabled:r,disabledTooltipMessage:a()(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",description:"Tooltip explaining that the user cannot edit their profile because their organization disabled that ability.",values:{emailDomain:s}})}),a()("div",{style:{marginLeft:20,width:250}},void 0,a()(Us.Z,{},void 0,a()(f.FormattedMessage,{id:"profileSettings.personalInfoSection.nameInput.label",defaultMessage:"Preferred name",description:"User's name, may be full name or a nickname."})),this.renderUserNameDisplay({userName:t,emailDomainForUser:s,areProfileEditsDisabled:r}))),"photo"!==o.type&&a()("div",{style:{color:this.theme.mediumIconColor,fontSize:14,marginTop:8}},void 0,a()(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.addPhoto",defaultMessage:"Add photo",description:"Instructive text indicating to add a photo"}))),a()(Fo.Z,{size:48,isHidden:!0}),this.renderAccountSecuritySection({currentUserValue:n}),a()(Fo.Z,{size:48,isHidden:!0}),this.renderAccountSupportSection())}renderUserNameDisplay(e){const{userName:t,emailDomainForUser:i,areProfileEditsDisabled:n}=e;return n?a()(Oe.Z,{renderTooltip:()=>a()(f.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",description:"Tooltip explaining that the user cannot edit their profile because their organization disabled that ability.",values:{emailDomain:i}}),placement:Oe.Z.Placement.Bottom,alignment:Oe.Z.Alignment.Center,render:e=>d.createElement("div",s()({},e,{style:{opacity:.5}}),a()(Li.Z,{disabled:!0,value:t}))}):a()(Li.Z,{value:t,onChange:this.handleNameChange})}renderMyProfileHeader(){return a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"profileSettings.myProfile.title",defaultMessage:"My profile",description:"Title for profile section in profile settings"}))}renderAccountSecuritySection(e){const{currentUserValue:t}=e,i=this.stores.accountSettingsStore.get(),n=Boolean(this.stores.emailDomainSettingsStore.get().prevent_profile_edits),o=()=>{this.stores.passwordRequestStore.refresh()};return d.createElement(d.Fragment,null,a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"profileSettings.accountSecurity.title",defaultMessage:"Account security",description:"Title for account security section in profile settings"})),a()(Bp,{userValue:t,hasEducationPlan:this.stores.isEducationStore.get(),areProfileEditsDisabled:n}),a()(Fo.Z,{size:18,isHidden:!0}),a()(wm.Z,{hasPassword:i.hasPassword,hasPasswordActions:i.canConfigurePassword,isEducationPlan:this.props.isEducationPlan,samlEnforced:i.isSamlEnforced,email:t.email,isError:Boolean(this.stores.passwordRequestStore.state.error),onReloadSettings:o,mfaStatus:i.mfaStatus}),a()(Fo.Z,{size:18,isHidden:!0}),a()(Sm,{status:i.mfaStatus,numMfaSettings:i.numMfaSettings,onReloadSettings:o}))}renderAccountSupportSection(){return d.createElement(d.Fragment,null,a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"profileSettings.support.title",defaultMessage:"Support",description:"Title for support section in profile settings"})),a()(Mm.Z,{}),a()(Fo.Z,{size:18,isHidden:!0}),a()(Lp,{}),a()(Fo.Z,{size:18,isHidden:!0}),a()(Tp.Z,{}))}}Cm.displayName="SpaceProfileSettings";const km=(0,f.injectIntl)(Cm);function Tm(e){let{users:t,store:i,extraColumns:n,initialSort:o}=e;window.__c={n:"UserTableBox"};const[s,r]=(0,d.useState)(o),c=(0,f.useIntl)();function u(e,t){return a()(Mi.Z,{disabled:!t.sortable,ignoreLocalHoverState:!0,onClick:()=>{!function(e){r({column:e,asc:(null==s?void 0:s.column)===e&&!(null!=s&&s.asc)})}(e)},style:{display:"flex",alignItems:"center"}},void 0,t.title,t.sortable&&s&&s.column===e&&function(e){const{up:t}=e,i={width:10,height:10,marginLeft:4};return t?Ge.Z.arrowDownSmall({...i,transform:"rotate(180deg)"}):Ge.Z.arrowDownSmall(i)}({up:s.asc}))}const p=(0,d.useMemo)((()=>({title:a()(f.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>a()(aa.Z,{actorStore:e}),getValue:e=>e.getDisplayName(c)})),[c]),m=(0,d.useMemo)((()=>({name:p,...n})),[n,p]),g=l().keys(m).map((e=>({key:e,header:u(e,m[e]),style:m[e].style}))),h=(0,Te.VK)((()=>{const e=t.map((e=>ze.U6.createChildStore(i,{table:Kt.KJ,id:e.userId}))).filter((e=>e.isDefined()));return s?e.sort(((e,t)=>{const i=m[s.column].getValue(e),n=m[s.column].getValue(t);var a=i<n?-1:i>n?1:0;return s.asc?a:-1*a})):e}),[t,i,m,s]);return a()(zo.Z,{columns:g,rows:h.map((e=>{const t=Object.values(m).map((t=>t.renderer?t.renderer(e):d.createElement(d.Fragment,null,t.getValue(e))));return{key:e.id,columns:t}}))})}var _m;!function(e){e[e.UserUserSimilarity=0]="UserUserSimilarity"}(_m||(_m={}));const Im={[_m.UserUserSimilarity]:a()(f.FormattedMessage,{id:"spaceSettingsDebugZone.userUserSimilarity.title",defaultMessage:"User Similarity",description:"Title for a tab in a debug view where users can see how similar they are to other users in their workspace."})};function xm(){const e=(0,Xo.mS)();return["on"===N.default.getGroup("user_similarity_debugging")||e?_m.UserUserSimilarity:void 0].filter(T.$K)}function Zm(e){let{store:t}=e;window.__c={n:"DebugZoneUserUserSimilarityTab"};const{isOnline:i,subscriptionDataStoreData:n,userSimilarityData:o,visibleUsersLoaded:s,visibleUsers:r}=(0,Te.VK)((()=>{var e,i;const n=null===(e=Se.default.state)||void 0===e?void 0:e.data,a=n?K.CM(n):[],o=l().every(a.map((e=>ze.U6.createChildStore(t,{table:Kt.KJ,id:e.userId}).isReady())));return{isOnline:Ie.Z.state.online,subscriptionDataStoreData:n,userSimilarityData:(null===(i=Se.default.state.data)||void 0===i?void 0:i.userSimilarity)||{},visibleUsersLoaded:o,visibleUsers:a}}),[t]);if(!i)return a()(xe.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(f.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."}));if(!n)return a()(Re.Z,{style:{margin:"calc(50% - 1em) auto"}});if(!s)return a()(Re.Z,{style:{margin:"calc(50% - 1em) auto"}});const c={style:{},title:d.createElement(d.Fragment,null,"Similarity Score"),sortable:!0,renderer:e=>{var t;return d.createElement(d.Fragment,null,(null===(t=o[e.id])||void 0===t?void 0:t.toFixed(3))||0)},getValue:e=>o[e.id]||0};return a()(Tm,{users:r,store:t,extraColumns:{similarityColumn:c},initialSort:{column:"similarityColumn",asc:!1}})}function Pm(e){let{store:t}=e;window.__c={n:"SpaceSettingsDebugZone"};const{tabs:i}=(0,Te.VK)((()=>({tabs:xm()})),[]),[n,o]=(0,d.useState)(i[0]);return a()(Ze.Z,{},void 0,a()(Eo.Z,{tabs:i.map((e=>Im[e])),selectedIndex:i.indexOf(n),onChange:e=>o(i[e]),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),n===_m.UserUserSimilarity&&a()(Zm,{store:t}))}function Fm(){return window.__c={n:"NewBadge"},a()(Fn.Z,{innerStyle:{marginLeft:4}},void 0,a()(f.FormattedMessage,{id:"sideBar.newBadge",defaultMessage:"New",description:"New badge to indicate that audit log is a new feature"}))}const Am=(0,f.defineMessages)({accountTab:{id:"spaceSettingsSidebar.accountTab.title",defaultMessage:"My account"},settingsTab:{id:"spaceSettingsSidebar.settingsTab.title",defaultMessage:"Settings"},teamsTab:{id:"spaceSettingsSidebar.teamsTab.title",description:"Title of the workspace settings tab to edit high-level teamspace settings",defaultMessage:"Teamspaces"},peopleTab:{id:"spaceSettingsSidebar.peopleTab.title",defaultMessage:"People",description:"Title of the workspace settings tab to see the people in the workspace."},membersTab:{id:"spaceSettingsSidebar.membersTab.title",defaultMessage:"Members"},plansTab:{id:"spaceSettingsSidebar.plansTab.title",defaultMessage:"Plans"},upgradeTab:{id:"spaceSettingsSidebar.upgradeTab.title",defaultMessage:"Upgrade"},billingTab:{id:"spaceSettingsSidebar.billingTab.title",defaultMessage:"Billing"},subscriptionTab:{id:"spaceSettingsSidebar.subscriptionTab.title",defaultMessage:"Subscription"},connectedAppsTab:{id:"spaceSettingsSidebar.connectedAppsTab.title",defaultMessage:"My connected apps"},userConnectionsTab:{id:"spaceSettingsSidebar.userConnectionsTab.title",defaultMessage:"My connections",description:"Settings tab title for integrations/connections that user has installed"},creditTab:{id:"spaceSettingsSidebar.creditTab.title",defaultMessage:"Earn credit"},securitySAMLTab:{id:"spaceSettingsSidebar.securityAndSAMLTab.title",defaultMessage:"Security & identity",description:"Tab label for Security & identity settings"},securityTab:{id:"spaceSettingsSidebar.securityTab.title",defaultMessage:"Security",description:"Tab label for Security settings"},identityProvisioningTab:{id:"spaceSettingsSidebar.identity&ProvisioningTab.title",defaultMessage:"Identity & provisioning",description:"Tab label for Identity & Provisioning settings"},adminContentSearchTab:{id:"spaceSettingsSidebar.adminContentSearch.title",defaultMessage:"Content search",description:"Tab label for content search settings"},languageAndRegionTab:{id:"spaceSettingsSidebar.languageAndRegionTab.title",defaultMessage:"Language & region"},integrationsTab:{id:"spaceSettingsSidebar.integrationsTab.title",defaultMessage:"Integrations"},spaceConnectionsTab:{id:"spaceSettingsSidebar.spaceConnectionsTab.title",defaultMessage:"Connections",description:"Settings tab title for integrations/connections installed on workspace"},experimentsTab:{id:"spaceSettingsSidebar.experimentsTab.title",defaultMessage:"Experiments"},auditLogTab:{id:"spaceSettingsSidebar.auditLogTab.title",defaultMessage:"Audit log"},notificationsAndSettings:{id:"spaceSettingsSidebar.notificationsAndSettings.title",defaultMessage:"My notifications & settings"},debugZoneTab:{id:"spaceSettingsSidebar.debugZoneTab.title",defaultMessage:"Debug Zone",description:"Tab label for various debugging information"},analyticsTab:{id:"spaceSettingsSidebar.analyticsTab.title",defaultMessage:"Analytics",description:"Tab label for the analytics tab in settings modal"},importTab:{id:"spaceSettingsSidebar.importsTab.title",defaultMessage:"Import",description:"Import tab title for importing data into workspace"}}),Bm={width:20,height:20},Em={profile:e=>Ge.Z.typesCreatedBy(Bm),notifications_and_settings:()=>Ge.Z.settingsNotificationsAndPersonal(Bm),connected_apps:()=>Ge.Z.settingsConnectedApps(Bm),language_and_region:()=>Ge.Z.settingsLanguage(Bm),credit:()=>Ge.Z.settingsCredit(Bm),settings:()=>Ge.Z.settings(Bm),teams:()=>Ge.Z.settingsWorkspace(Bm),members:()=>Ge.Z.settingsMembers(Bm),plans:()=>{const{data:e}=Se.default.state;return e&&K.YK(e)?Ge.Z.settingsPlans(Bm):Ge.Z.settingsUpgrade(Bm)},billing:()=>Ge.Z.settingsBilling(Bm),subscription:()=>Ge.Z.settingsSubscription(Bm),security:()=>Ge.Z.settingsSecurity(Bm),identity_provisioning:()=>Ge.Z.settingsIdentityProvisioning(Bm),admin_content_search:()=>Ge.Z.contentSearch(Bm),integrations:()=>Ge.Z.settingsIntegration(Bm),experiments:()=>Ge.Z.sparkles(Bm),audit_log:()=>Ge.Z.ledger(Bm),debug_zone:()=>Ge.Z.templates(Bm),analytics:()=>Ge.Z.magnifyingGlass(Bm),imports:()=>Ge.Z.import(Bm)},Dm={profile:()=>`${V.default.formatMessage(Am.accountTab)}`,notifications_and_settings:()=>V.default.formatMessage(Am.notificationsAndSettings),connected_apps:()=>V.default.formatMessage(Am.userConnectionsTab),credit:()=>V.default.formatMessage(Am.creditTab),language_and_region:()=>V.default.formatMessage(Am.languageAndRegionTab),settings:()=>V.default.formatMessage(Am.settingsTab),teams:()=>V.default.formatMessage(Am.teamsTab),members:()=>(0,O.F$)()?V.default.formatMessage(Am.peopleTab):V.default.formatMessage(Am.membersTab),plans:()=>{const{data:e}=Se.default.state;return e&&K.YK(e)?V.default.formatMessage(Am.plansTab):V.default.formatMessage(Am.upgradeTab)},billing:()=>V.default.formatMessage(Am.billingTab),subscription:()=>V.default.formatMessage(Am.subscriptionTab),security:()=>V.default.formatMessage(Am.securityTab),identity_provisioning:()=>V.default.formatMessage(Am.identityProvisioningTab),admin_content_search:()=>V.default.formatMessage(Am.adminContentSearchTab),integrations:()=>V.default.formatMessage(Am.spaceConnectionsTab),experiments:()=>V.default.formatMessage(Am.experimentsTab),audit_log:()=>V.default.formatMessage(Am.auditLogTab),debug_zone:()=>V.default.formatMessage(Am.debugZoneTab),analytics:()=>V.default.formatMessage(Am.analyticsTab),imports:()=>V.default.formatMessage(Am.importTab)},Rm={profile:()=>null,notifications_and_settings:()=>null,connected_apps:()=>null,credit:()=>null,language_and_region:()=>null,settings:()=>null,teams:()=>null,members:()=>null,plans:()=>null,billing:()=>null,subscription:()=>null,security:()=>null,identity_provisioning:()=>null,admin_content_search:()=>a()(Fm,{}),integrations:()=>null,experiments:()=>null,audit_log:()=>null,debug_zone:()=>null,analytics:()=>a()(Fm,{}),imports:()=>null};var Lm=i(86664),Om=i(19234),Nm=i(6906);function Vm(e){return{AE:"ae_trn",AU:"au_abn",CA:"ca_bn",CH:"ch_vat",ES:"eu_vat",AT:"eu_vat",BE:"eu_vat",BG:"eu_vat",CY:"eu_vat",CZ:"eu_vat",DE:"eu_vat",EE:"eu_vat",FI:"eu_vat",FR:"eu_vat",GR:"eu_vat",HR:"eu_vat",HU:"eu_vat",IE:"eu_vat",IT:"eu_vat",LT:"eu_vat",LU:"eu_vat",LV:"eu_vat",MT:"eu_vat",NL:"eu_vat",PL:"eu_vat",PT:"eu_vat",RO:"eu_vat",RU:"ru_inn",SE:"eu_vat",SI:"eu_vat",SK:"eu_vat",GB:"gb_vat",IN:"in_gst",KR:"kr_brn",NZ:"nz_gst",SG:"sg_gst"}[e]}var Um=i(99498),Wm=i(89859),zm=i(17153),Km=i(16100);const qm={workspaceBalance:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var Hm=i(34859);class Gm extends Z.Z{getInitialState(){return{paymentMethodModalOpen:!1,billingIntervalModalOpen:!1,billingEmailModalOpen:!1,vatIdModalOpen:!1,addressModalOpen:!1,applyCreditModalOpen:!1,billingEventsLimit:20,applyCouponModalOpen:!1,addressErrorMessage:void 0}}setAddressField(e){const t=this.state.temporaryAddress?this.state.temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""};this.setState({...this.state,temporaryAddress:{...t,...e},addressErrorMessage:void 0})}}const jm=Gm;class $m extends Z.Z{getInitialState(){return{inputValue:void 0}}}const Ym=$m;class Qm extends c.Z{constructor(){super(...arguments),this.storeTypes={store:Ym},this.handleInputChange=e=>{const{store:t}=this.stores,i=e.target.value,n=this.inputValueToCents(i);let a;a=i?void 0!==n?i:this.getCurrentInputValue():"",t.setState({inputValue:a}),this.forceUpdate(),this.props.onChange(this.inputValueToCents(a)||0)}}renderComponent(){const{focus:e,selectAll:t,availableCredit:i}=this.props,n=this.getCurrentInputValue();return a()(Li.Z,{value:n,onChange:this.handleInputChange,focus:e,selectAll:t,disabled:i<=0,style:{maxWidth:120},inputStyle:{textAlign:"right"}})}getCurrentInputValue(){const{availableCredit:e}=this.props,{inputValue:t}=this.stores.store.state;return void 0===t?`${Math.floor(e/100)}`:t}inputValueToCents(e){const{availableCredit:t}=this.props,i=Math.floor(100*parseFloat(e));if(!isNaN(i)&&i<=t&&i>=0)return i}}Qm.displayName="ApplyCreditInput";const Xm=Qm;var Jm=i(84076);class eg extends c.Z{constructor(){super(...arguments),this.storeTypes={store:jm,billingHistoryRequestStore:lo.Z},this.performGetBillingHistoryRequest=async e=>{const{spaceStore:t}=this.props,i=await ge.getBillingHistory(this.environment,{spaceId:t.id,limit:e});if("failed"===i.type)throw i.error;return i.data},this.renderBillingHistoryResults=(e,t)=>{this.props.mockBillingHistoryResult&&(t=this.props.mockBillingHistoryResult);const{billingHistoryRequestStore:i}=this.stores;return a()("div",{},void 0,t&&0===t.events.length&&a()("div",{style:{color:this.theme.mediumTextColor,fontSize:14}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.noInvoicesMessage",defaultMessage:"This workspace has no payments yet."})),t&&t.events.length>0&&a()("table",{},void 0,a()("tbody",{},void 0,t.events.map(this.renderBillingHistoryEvent))),t&&!t.reachedEndOfResults&&a()($e.Z,{onClick:this.handleLoadMoreBillingEventsClick,style:{marginLeft:-4,width:"100%"}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.loadMoreInvoicesButton.label",defaultMessage:"Load more"})),i.state.loading&&a()(Re.Z,{}))},this.renderBillingHistoryEvent=(e,t)=>{let i;const{intl:n}=this.props;return i="paid"===e.status?e.total<0?a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.credited",defaultMessage:"Credited"}):a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.paid",defaultMessage:"Paid"}):e.attempted?a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.failed",defaultMessage:"Failed"}):a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.due",defaultMessage:"Due",description:"Label for the amount that the user owes on a given invoice"}),a()("tr",{style:{height:28,fontSize:14,whiteSpace:"nowrap"}},t,a()("td",{style:{width:"100%",paddingRight:18,color:this.theme.mediumTextColor}},void 0,(0,Vn.Yx)(e.timestamp,"long",ra.SP)),a()("td",{style:{paddingRight:18}},void 0,i),a()("td",{style:{paddingRight:18,textAlign:"right"}},void 0,(0,Dd.Dx)({amount:e.total,currency:"dollar",intl:n})),a()("td",{},void 0,a()(Jm.Z,{inline:!0,href:`/invoice/${e.id}`,external:!0,innerStyle:this.getViewInvoiceButtonStyle()},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.viewInvoiceButton",defaultMessage:"View invoice"}))))},this.handleLoadMoreBillingEventsClick=()=>{this.stores.store.setState({...this.stores.store.state,billingEventsLimit:this.stores.store.state.billingEventsLimit+eg.billingEventsLimitIncrement})}}renderComponent(){const{store:e,billingHistoryRequestStore:t}=this.stores,i={request:e.state.billingEventsLimit,performRequest:this.performGetBillingHistoryRequest,render:this.renderBillingHistoryResults};return a()("div",{},void 0,a()(Pe.Z,{large:!0,divider:"full",style:{marginTop:36}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.title",defaultMessage:"Invoices"})),d.createElement(So.Z,s()({},i,{requestStore:t})))}static getModalStyle(e){return{width:480,background:e.popoverBackground,padding:24,borderRadius:3}}getViewInvoiceButtonStyle(){return{color:this.theme.mediumTextColor,padding:"2px 3px",borderRadius:3}}}eg.displayName="BillingHistory",eg.billingEventsLimitIncrement=20,eg.modalTitleStyle={fontSize:18,marginBottom:16,fontWeight:h.Z.fontWeight.medium};const tg=(0,f.injectIntl)(eg);var ig=i(18647),ng=i(90850);class ag extends Z.Z{getInitialState(){return{temporaryCouponCode:void 0,couponCodeInput:void 0,error:void 0}}}const og=ag,sg=(0,f.defineMessages)({couponCodePlaceholder:{id:"couponEntryInput.placeholder",defaultMessage:"Coupon code"},couponCodeNotFoundError:{id:"couponEntryInput.error.noPromo",defaultMessage:"Invalid coupon code"}});class rg extends c.Z{constructor(){super(...arguments),this.storeTypes={couponCode:og}}didMount(){const e=(0,ng.Zk)(this.environment.currentUser.id);e&&this.stores.couponCode.setState({...this.stores.couponCode.state,temporaryCouponCode:e})}renderComponent(){return a()("div",{style:this.getContainerStyle()},void 0,a()("div",{style:{display:"flex",flexDirection:"row"}},void 0,a()(Li.Z,{textarea:!1,value:this.stores.couponCode.state.couponCodeInput,placeholder:V.default.formatMessage(sg.couponCodePlaceholder),onSubmit:()=>this.checkCouponCode(),onChange:e=>{this.stores.couponCode.setState({...this.stores.couponCode.state,couponCodeInput:e.target.value})},style:{height:32,paddingLeft:10,marginRight:this.props.hideApply?0:10}}),a()(So.Z,{request:this.stores.couponCode.state.temporaryCouponCode||null,performRequest:async e=>{if(e)return this.applyCouponCode(e)},render:(e,t,i)=>{if(!this.props.hideApply)return a()(Ae.Z,{isLarge:!1,onClick:()=>this.checkCouponCode()},void 0,a()(Vo.Z,{loaded:i,spinnerSize:16,showSpinnerTimeout:500},void 0,a()(f.FormattedMessage,{id:"couponEntryInput.button.apply",defaultMessage:"Apply"})))}})),this.stores.couponCode.state.error&&a()(xe.Z,{isMultiline:!1,style:{paddingTop:8,color:ho.ZP.red}},void 0,this.stores.couponCode.state.error))}checkCouponCode(){const e=this.stores.couponCode.state.couponCodeInput;e&&(this.stores.couponCode.setState({...this.stores.couponCode.state,temporaryCouponCode:e}),this.stores.couponCode.setState({...this.stores.couponCode.state,couponCodeInput:""}))}async applyCouponCode(e){const t=await ge.getPromoCode(this.environment,{code:e});if("success"===t.type){var i;if(t.data.promo)return null!==(i=t.data.promo.applies_to)&&void 0!==i&&i.length&&!t.data.promo.applies_to.includes(this.props.plan)?void this.showError(e):(this.stores.couponCode.setState({...this.stores.couponCode.state,error:void 0}),this.props.handlePromo(t.data.promo),b.p8V(this.environment,{code:e,valid:!0,id:t.data.promo.id}),t.data.promo);this.showError(e)}else if("failed"===t.type){const e=t.error.name;this.stores.couponCode.setState({...this.stores.couponCode.state,error:e})}else(0,T.t1)(t)}showError(e){this.stores.couponCode.setState({...this.stores.couponCode.state,error:V.default.formatMessage(sg.couponCodeNotFoundError)}),b.p8V(this.environment,{code:e,valid:!1,id:void 0})}getContainerStyle(){return{display:"flex",flexDirection:"column",...this.props.style?this.props.style:void 0}}}rg.displayName="CouponEntryInput";const lg=rg;var dg=i(58609),cg=i(6825),ug=i(1063);const pg=(0,f.defineMessages)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit",description:"Button a user clicks to apply Notion credits towards their Notion bill."},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});class mg extends c.Z{renderComponent(){const{title:e,caption:t,buttonArgs:i}=this.props,n=d.createElement(f.FormattedMessage,pg[i.buttonPurpose]);return a()("div",{style:{display:"flex",alignItems:"center",fontSize:14}},void 0,a()("div",{style:{marginRight:"auto"}},void 0,e),a()("div",{style:{color:this.theme.mediumTextColor}},void 0,t),a()("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"}},void 0,i.showButton&&a()($e.Z,{isBlue:!0,onClick:i.onClick,style:mg.buttonStyle},void 0,n)))}}mg.displayName="SubscriptionBillingSettingOption",mg.buttonStyle={marginLeft:18,marginRight:-4,fontWeight:h.Z.fontWeight.medium};const gg=(0,f.injectIntl)(mg);var hg=i(23855);const fg={offline:a()(f.FormattedMessage,{defaultMessage:"Please go online to manage billing.",id:"spaceSubscriptionBilling.offline.message"})};function vg(e){const{customerData:t,temporaryAddress:i}=e;if(i&&i!==t.address)return i}function yg(){return(0,_e.yK)((e=>({modal:{display:"flex",flexDirection:"column",maxHeight:"75vh"},modalBody:{width:500,background:e.popoverBackground,padding:24,borderRadius:12},modalTitle:{fontSize:18,marginBottom:16,fontWeight:h.Z.fontWeight.medium},modalFooter:{display:"flex",justifyContent:"flex-end",padding:"16px 24px"},blueButton:{marginLeft:12},errorMessage:{color:ho.ZP.red,marginTop:10}})),[])}function bg(e){window.__c={n:"AddressModal"};const{customerData:t,billingStore:i,handleModalClose:n,handleAddressAccept:o}=e,s=(0,cg.y0)(),r=yg(),l=(0,Km.useElementsOptions)({type:"address"}),[d,c,u]=(0,Te.VK)((()=>{const{state:e}=i;return[(0,q.mq)(),e.temporaryAddress,e.addressErrorMessage]}),[i]);return a()(Lm.Elements,{stripe:(0,Km.getStripe)(),options:l},void 0,a()("div",{style:r.modal},void 0,a()("div",{style:r.modalBody},void 0,a()("div",{style:r.modalTitle},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.changeYourAddressModal.title",defaultMessage:"Change your address"})),a()(dg.J,{address:c||{name:t.customerName||"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},availableCountries:s,updateAddress:e=>{i.setAddressField(e)},shouldShowBusinessName:d}),a()("div",{style:r.errorMessage},void 0,u)),a()("div",{style:r.modalFooter},void 0,a()(Ae.Z,{isLarge:!0,onClick:n},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingAddressModal.cancelButton.label",defaultMessage:"Cancel"})),a()(je.Z,{style:r.blueButton,isLarge:!0,disabled:void 0===vg({customerData:t,temporaryAddress:c}),onClick:o},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingAddressModal.updateButton.label",defaultMessage:"Update"})))))}function Sg(e){window.__c={n:"PaymentModal"};const{onClose:t,onAccept:i,customerData:n,spaceStore:o}=e,s=(0,ke.O7)(),r=(0,f.useIntl)(),l=(0,_e.Fg)(),d=(0,Km.useElementsOptions)({type:"setup",currency:"usd"});if(!(0,Te.VK)((()=>z.rR()),[]))return a()(kt.LazySpaceSubscriptionUpdatePaymentMethodModal,{customerData:n,spaceStore:o,onComplete:t});const c=[];return a()(Lm.Elements,{stripe:(0,Km.getStripe)(),options:d},void 0,a()(Lm.ElementsConsumer,{},void 0,(e=>{let{elements:n,stripe:d}=e;return a()(Mg,{theme:l,title:"Payment method",onAccept:async()=>{if(!n||!d)return;const{error:e}=await n.submit();if(e)return;const t=await d.createPaymentMethod({elements:n});!t.error&&t.paymentMethod?(await k.Mg({environment:s,spaceStore:o,paymentData:{type:"paymentMethodId",value:t.paymentMethod.id},from:"space_settings-billing_tab-update_payment_method"}),i()):t.error&&S.showErrorMessage(Km.translateStripeError(s,r,t.error))},onClose:t,acceptAction:"update"},void 0,a()(hg.k,{paymentMethods:c,temporaryPaymentMethod:"credit_card",payButtonState:"enabled"}))})))}class wg extends c.Z{constructor(){super(...arguments),this.couponEntryInput=null,this.storeTypes={store:jm,billingHistoryRequestStore:lo.Z},this.renderBillingIntervalModal=()=>{const{temporaryBillingInterval:e}=this.stores.store.state,{customerData:t}=this.props;if(!t.isSubscribed)return null;const i=e||t.interval,{monthlyPlanAmount:n,yearlyPlanAmount:o}=t,s=1-o/(12*n);return a()(Mg,{theme:this.theme,title:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingInterval.title",defaultMessage:"Change billing interval"}),helpButton:a()(br.Z,{title:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingInterval.helpButton.label",defaultMessage:"Learn about how this change will impact what you pay."}),href:(0,W.UY)("guides.changeBillingInterval"),analyticsFrom:"billing_interval_settings"}),acceptAction:"update",onAccept:this.handleBillingIntervalAccept,onClose:this.handleModalClose},void 0,a()("div",{style:{marginTop:12,marginBottom:16}},void 0,K.Rj({environment:this.environment,productId:t.productId,yearlyPlanAmount:o,monthlyPlanAmount:n,yearlySavingsPercent:s,currentBillingInterval:i,handleMonthlyBillingClick:this.handleMonthlyBillingClick,handleYearlyBillingClick:this.handleYearlyBillingClick})))},this.renderApplyCreditModal=()=>{const{subscriptionData:e,intl:t,upcomingInvoiceData:i}=this.props,{availableCredit:n}=e,o=this.getCurrentFormCreditAmount(),s=Math.max(0,((null==i?void 0:i.amountRemaining)||0)-o);return a()("div",{style:wg.getModalStyle(this.theme)},void 0,a()("div",{style:wg.modalTitleStyle},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.title",defaultMessage:"Use Notion credit - {creditInDollars} available",values:{creditInDollars:(0,Dd.Dx)({amount:n,currency:"dollar",intl:t})}})),a()("div",{style:{fontSize:14,display:"flex",alignItems:"center",marginBottom:16}},void 0,a()("div",{style:{width:"100%",marginRight:20,color:this.theme.mediumTextColor}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.amountOfCreditQuestion",defaultMessage:"How much credit would you like to apply to your next invoice?"})),a()(Xm,{availableCredit:n,focus:!0,selectAll:!0,onChange:this.handleApplyCreditAmountInputChange}),a()("div",{style:{whiteSpace:"nowrap",marginLeft:8}},void 0,"/"," ",(0,Dd.Dx)({amount:n,currency:"dollar",intl:t}))),a()("div",{style:{borderTop:`1px solid ${this.theme.regularDividerColor}`,paddingTop:16}},void 0,a()("div",{style:{paddingBottom:18,fontSize:12,color:this.theme.mediumTextColor}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.warning",defaultMessage:"Applying credit to your account <bold>cannot be undone</bold>.",values:{bold:e=>a()("b",{},void 0,e)}})),a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{fontSize:36,lineHeight:1}},void 0,(0,Dd.Dx)({amount:s,currency:"dollar",intl:t})),a()("div",{style:{marginLeft:8,fontSize:12,color:this.theme.mediumTextColor,alignSelf:"flex-end"}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.nextInvoiceAmount",defaultMessage:"next invoice total",description:"Text that appears next to the amount, in dollars, that the user's next invoice will be after applying their Notion credits to their bill."})),a()(Ae.Z,{isLarge:!0,style:{marginLeft:"auto"},onClick:this.handleModalClose},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.cancelButton.label",defaultMessage:"Cancel"})),a()(je.Z,{isLarge:!0,style:{marginLeft:12},disabled:o<=0,onClick:this.handleApplyCreditAccept},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.applyCreditButton.label",defaultMessage:"Apply credit"})))))},this.renderSingleTextFieldModal=(e,t,i,n,o)=>a()(Mg,{theme:this.theme,title:t,acceptAction:o,onAccept:n,onClose:this.handleModalClose},void 0,a()(Li.Z,{focus:!0,selectAll:!0,value:e,onChange:i,onSubmit:n,style:wg.modalInputStyle})),this.renderBillingEmailModal=()=>{const{customerData:e}=this.props,{temporaryBillingEmail:t}=this.stores.store.state,i=void 0!==t?t:e.billingEmail||"",n=e.billingEmail?"update":"add";return this.renderSingleTextFieldModal(i,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingEmailModal.title",defaultMessage:"Change billing email"}),this.handleBillingEmailChange,this.handleBillingEmailAccept,n)},this.renderVatIdModal=()=>{const{customerData:e}=this.props,{temporaryVatId:t}=this.stores.store.state,i=void 0!==t?t:e.vatId||"",n=e.vatId?"update":"add";return a()(Mg,{theme:this.theme,title:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.changeVATIDModal.title",defaultMessage:"Change VAT/GST number"}),acceptAction:n,onAccept:this.handleVatIdAccept,onClose:this.handleModalClose},void 0,a()(Li.Z,{focus:!0,selectAll:!0,value:i,onChange:this.handleVatIdChange,onSubmit:this.handleVatIdAccept,style:wg.modalInputStyle}),a()("div",{style:{color:this.theme.mediumTextColor,fontSize:h.Z.fontSize.UISmall.desktop,marginTop:-10}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.changeVATIDModal.subtitle",defaultMessage:"Please include your country code"})))},this.renderApplyCouponModal=()=>this.props.customerData.isSubscribed?a()(Mg,{theme:this.theme,title:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.applyCouponModal.title",defaultMessage:"Apply coupon"}),acceptAction:"apply",onAccept:()=>{this.couponEntryInput&&this.couponEntryInput.checkCouponCode()},onClose:this.handleModalClose},void 0,d.createElement(lg,{ref:e=>this.couponEntryInput=e,hideApply:!0,plan:this.props.customerData.plan,handlePromo:async e=>{this.handleModalClose();await k.Mg({environment:this.environment,spaceStore:this.props.spaceStore,coupon:e&&"coupon"===e.source?e.code:void 0,promoCodeId:e&&"promo_code"===e.source?e.code:void 0,from:"space_settings-billing_tab"})&&S.showMessage({message:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.applyCouponModal.successMessage",defaultMessage:"Coupon applied!"})})}})):null,this.handleChangePlanClick=()=>{be.Z.setState({open:!0,currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0})},this.handlePaymentMethodChangeClick=()=>{this.stores.store.setState({...this.stores.store.state,paymentMethodModalOpen:!0})},this.handleBillingIntervalChangeClick=()=>{const{customerData:e}=this.props;if((0,q.mq)()&&z.yw()){const t="interval"in e?e.interval:"year";zm.af({environment:this.environment,from:"billing_page",view:"billing_interval",temporaryBillingInterval:t,billingInterval:t})}else this.stores.store.setState({...this.stores.store.state,billingIntervalModalOpen:!0})},this.handleBillingEmailChangeClick=()=>{this.stores.store.setState({...this.stores.store.state,billingEmailModalOpen:!0})},this.handleAddressChangeClick=()=>{this.stores.store.setState({...this.stores.store.state,addressModalOpen:!0})},this.handleVatIdChangeClick=e=>{var t;const i=null===(t=e.address)||void 0===t?void 0:t.country;if(!i)return void S.showErrorMessage(a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.vatId.missingCountry",defaultMessage:"To update your VAT/GST number, please update your billing address."}));Vm(i)?this.stores.store.setState({...this.stores.store.state,vatIdModalOpen:!0}):S.showErrorMessage(a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.vatId.vatNotRequired",defaultMessage:"A VAT/GST number is not required for your tax jurisdiction."}))},this.handleModalClose=()=>{this.stores.store.reset()},this.handleBillingEmailChange=e=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingEmail:e.target.value})},this.handleBillingEmailAccept=async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryBillingEmail:i}=this.stores.store.state;i!==t.billingEmail&&await k.Mg({environment:this.environment,spaceStore:e,billingEmail:i,from:"space_settings-billing_tab"}),this.handleModalClose()},this.handleVatIdChange=e=>{this.stores.store.setState({...this.stores.store.state,temporaryVatId:e.target.value})},this.handleVatIdAccept=async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryVatId:i}=this.stores.store.state;i!==t.vatId&&await k.Mg({environment:this.environment,spaceStore:e,vatId:i,from:"space_settings-billing_tab"}),this.handleModalClose()},this.handleAddressAccept=async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryAddress:i}=this.stores.store.state,n=vg({customerData:t,temporaryAddress:i});if(n&&(0,Om.A)(n))try{await k.y3({environment:this.environment,spaceStore:e,address:n}),this.handleModalClose()}catch(a){}else this.stores.store.setState({...this.stores.store.state,addressErrorMessage:this.props.intl.formatMessage({id:"spaceSubscriptionBilling.address.invalidError",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})})},this.handleMonthlyBillingClick=()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingInterval:"month"})},this.handleYearlyBillingClick=()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingInterval:"year"})},this.handleBillingIntervalAccept=async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryBillingInterval:i}=this.stores.store.state,n="interval"in t?t.interval:"month";if(i&&i!==n){const t=this.getPlanForOppositeBillingInterval();t&&await k.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-billing_tab"})}this.handleModalClose()},this.handleApplyCreditClick=()=>{this.stores.store.setState({...this.stores.store.state,applyCreditModalOpen:!0})},this.handleApplyCreditAccept=async()=>{const e=this.getCurrentFormCreditAmount(),{spaceStore:t}=this.props;e>0&&await k.Mg({environment:this.environment,spaceStore:t,creditAmount:e,from:"space_settings-billing_tab"}),this.handleModalClose(),b.MFb(this.environment,{amount:e})},this.handleApplyCreditAmountInputChange=e=>{this.stores.store.setState({...this.stores.store.state,temporaryApplyCreditCents:e})},this.handleRestartSubscriptionClick=async()=>{const{spaceStore:e}=this.props,{customerData:t}=this.props;await k.Mg({environment:this.environment,spaceStore:e,plan:"plan"in t?t.plan:void 0,from:"space_settings-billing_tab"}),this.handleModalClose()}}willMount(){k.bi(this.environment),k.px(this.environment)}renderComponent(){return Ie.Z.state.online?this.renderBilling():wg.renderOfflineMessage()}static renderOfflineMessage(){return a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,fg.offline))}renderBilling(){const{customerData:e,subscriptionData:t,upcomingInvoiceData:i}=this.props,{paymentMethodModalOpen:n,billingIntervalModalOpen:o,billingEmailModalOpen:r,addressModalOpen:l,applyCreditModalOpen:c,vatIdModalOpen:u,applyCouponModalOpen:p}=this.stores.store.state;return a()("div",{style:wg.wrapStyle},void 0,a()(ig.Z,{style:wg.scrollerStyle,type:Hm.Z.Y},void 0,this.renderHeader(e),this.renderSummary(t,i),this.renderAddOnHeader(e),this.renderAddOnSummary(e,t),this.renderPaymentMethod(e),this.renderSeparator(),this.renderBillingInterval(e),this.renderSeparator(),this.renderBillingEmail(e),this.renderSeparator(),this.renderAddress(e),this.renderSeparator(),this.renderVatId(e),this.renderSeparator(),this.renderCredit(e),this.renderSeparator(),this.renderCoupon(),this.renderDiscount(),d.createElement(tg,s()({},this.props,{data:t})),a()($o.Z,{open:n,render:()=>a()(Sg,{customerData:this.props.customerData,spaceStore:this.props.spaceStore,onAccept:this.handleModalClose,onClose:this.handleModalClose}),onDismiss:this.handleModalClose,innerStyle:{borderRadius:12}}),a()($o.Z,{open:o,render:this.renderBillingIntervalModal,onDismiss:this.handleModalClose,innerStyle:{borderRadius:12}}),a()($o.Z,{open:c,render:this.renderApplyCreditModal,onDismiss:this.handleModalClose,innerStyle:{borderRadius:12}}),a()($o.Z,{open:r,render:this.renderBillingEmailModal,onDismiss:this.handleModalClose,innerStyle:{borderRadius:12}}),a()($o.Z,{open:l,render:()=>a()(bg,{customerData:this.props.customerData,billingStore:this.stores.store,handleModalClose:this.handleModalClose,handleAddressAccept:this.handleAddressAccept}),onDismiss:this.handleModalClose,innerStyle:{borderRadius:12}}),a()($o.Z,{open:u,render:this.renderVatIdModal,onDismiss:this.handleModalClose,innerStyle:{borderRadius:12}}),a()($o.Z,{open:p,render:this.renderApplyCouponModal,onDismiss:this.handleModalClose,innerStyle:{borderRadius:12}})))}renderAddOnHeader(e){return(0,g.E3)(e.addOns)?a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"addOn.additionalFeatures.title",defaultMessage:"Additional features",description:"Shown across the app to describe the add on features section in our billings tab."})):null}renderAddOnSummary(e,t){var i;const n=[],o=e.isSubscribed?e.interval:"month",s="month"===o,r=e.isSubscribed?e.quantity:(0,K.qX)(),l=(0,K.GJ)(t),d=(0,g.ls)(null===(i=Se.default.state.data)||void 0===i?void 0:i.addOns);for(const c of e.addOns)switch(c.feature){case"ai":n.push(a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.addOnSummary.description",defaultMessage:"This workspace's <bold>Notion AI</bold> add on is enabled and set to <bold>{amount} per {showMonthlyPrice, select, true{month} other {year}}.</bold> {showCancellation, select, true{This subscription was cancelled and will <bold>expire on {cancellationDate}</bold>.} other {}}",description:"Shown in our billing tab to describe the workspace add on subscription information.",values:{amount:(0,K.v3)({addOnFeature:c.feature,billingInterval:o,quantity:r,getMonthlyPrice:s,intl:V.default.intl}).formattedAmount,showMonthlyPrice:s,showCancellation:Boolean(d),cancellationDate:d?(0,Vn.Yx)(d,"medium",ra.SP):void 0,bold:e=>a()("b",{},void 0,e)}}));break;default:(0,T.t1)(c.feature)}return a()("div",{},void 0,n.map(((t,i)=>a()("div",{style:wg.summaryStyle},`addOnSummary-${i}`,a()("div",{style:wg.summaryMessageStyle},void 0,t),l&&a()(Ae.Z,{isLarge:!0,onClick:async()=>{if(d){const t=e.customerId?await Wm.y(this.environment,{offerType:"add_on_upgrade_flow",customerId:e.customerId}):void 0;return Um.k2(),void Um.Cl(t)}Um.Kj()}},void 0,a()(f.FormattedMessage,d?{id:"SpaceSubscriptionBilling.subscriptionSettingsSection.resubscribe.label",defaultMessage:"Resubscribe",description:"Shown to cancel an add on from plans page."}:{id:"SpaceSubscriptionBilling.subscriptionSettingsSection.removeFromPlan.label",defaultMessage:"Remove from plan",description:"Shown to cancel an add on from plans page."}))))))}renderHeader(e){let t=a()(f.FormattedMessage,{id:"legacyPlan.title",defaultMessage:"Legacy Plan",description:"Shown across the app to describe the legacy plan type."});if(!e.isSubscribed)return a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"freePlan.title",defaultMessage:"Free Plan",description:"Shown across the app to describe the free plan type."}));switch(e.productId){case Qe.Z.pricing.personal.productId:const e=Se.default.state.data;t=K.wY(e)?a()(f.FormattedMessage,{id:"personalPlan.title",defaultMessage:"Personal Pro Plan",description:"Shown across the app to describe the personal pro plan type."}):a()(f.FormattedMessage,{id:"singlePlayerPlusPlan.title",defaultMessage:"Plus Plan with a 1-member limit",description:"Shown across the app to describe which plan you have."});break;case Qe.Z.pricing.student.productId:t=a()(f.FormattedMessage,{id:"plusEducationPlan.title",defaultMessage:"Education Plan",description:"Shown in settings and the sidebar to describe which plan you have."});break;case Qe.Z.pricing.team.productId:t=K.eV;break;case Qe.Z.pricing.business.productId:t=a()(f.FormattedMessage,{id:"businessPlan.title",defaultMessage:"Business Plan",description:"Shown across the app to describe the business plan type."});break;case Qe.Z.pricing.enterprise.productId:t=a()(f.FormattedMessage,{id:"enterprisePlan.title",defaultMessage:"Enterprise Plan",description:"Shown across the app to describe the enterprise plan type."})}return a()(Pe.Z,{large:!0,divider:"full"},void 0,t)}renderSummary(e,t){const{spaceStore:i}=this.props,n=K.D0(this.environment,i,e,t),o=K.DH(e),s="subscribed_admin"===e.type;return a()("div",{style:wg.summaryStyle},void 0,a()("div",{style:wg.summaryMessageStyle},void 0,n),o&&a()(je.Z,{isLarge:!0,onClick:this.handleRestartSubscriptionClick,style:{marginRight:8}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.restartSubscriptionButton.label",defaultMessage:"Restart subscription"})),s&&a()(Ae.Z,{isLarge:!0,onClick:this.handleChangePlanClick},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.changePlanButton.label",defaultMessage:"Change plan"})))}renderSeparator(){return a()("div",{style:{flex:"none",height:1,marginTop:10,marginBottom:10,background:this.theme.regularDividerColor}})}renderPaymentMethod(e){const t=e.isSubscribed?e.billing:"charge_automatically";return a()(gg,{title:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.title",defaultMessage:"Payment method"}),caption:a()(d.Fragment,{},void 0,"send_invoice"===t&&a()("div",{},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"})),"charge_automatically"===t&&("link"===e.paymentMethodType?a()("div",{},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.link",defaultMessage:"Link",description:"Displayed when the user who are using Stripe Link as their payment method"})):e.last4&&e.brand?a()("div",{},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.creditCard",defaultMessage:"{creditCardBrand} ending in {lastFourDigits}",values:{creditCardBrand:(0,Nm.Z)(e.brand),lastFourDigits:e.last4}})):a()("div",{},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None",description:"The payment method setting we display for users who haven't set up a payment method yet"})))),buttonArgs:{showButton:!0,buttonPurpose:"update",onClick:this.handlePaymentMethodChangeClick}})}renderBillingInterval(e){return a()(gg,{title:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.title",defaultMessage:"Billing interval"}),caption:a()("div",{},void 0,e.isSubscribed?"month"===e.interval?a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"}):a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.value.yearly",defaultMessage:"Yearly"}):a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"})),buttonArgs:{showButton:Boolean(this.getPlanForOppositeBillingInterval()),buttonPurpose:"update",onClick:this.handleBillingIntervalChangeClick}})}renderBillingEmail(e){return a()(gg,{title:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingEmail.title",defaultMessage:"Billing email"}),caption:a()("div",{},void 0,e.billingEmail||""),buttonArgs:{showButton:!0,buttonPurpose:Boolean(e.billingEmail)?"update":"add",onClick:this.handleBillingEmailChangeClick}})}renderVatId(e){return a()(gg,{title:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.VATID.title",defaultMessage:"VAT/GST number",description:"Title for the section where users can update their VAT (value added tax) identification number"}),caption:a()("div",{},void 0,e.vatId||""),buttonArgs:{showButton:!0,buttonPurpose:Boolean(e.vatId)?"update":"add",onClick:()=>this.handleVatIdChangeClick(e)}})}renderAddress(e){return a()(gg,{title:a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.yourAddress.title",defaultMessage:"Your address"}),caption:a()("div",{style:{textAlign:"right",width:"80%",float:"right"}},void 0,this.renderAddressString(e.address)||""),buttonArgs:{showButton:!0,buttonPurpose:e.address&&!l().isEmpty(e.address)?"update":"add",onClick:this.handleAddressChangeClick}})}renderCredit(e){const t=-Math.min(0,e.accountBalance),{intl:i}=this.props;return a()(gg,{title:qm.workspaceBalance,caption:a()("div",{},void 0,(0,Dd.Dx)({amount:t,currency:"dollar",intl:i})),buttonArgs:{showButton:!0,buttonPurpose:"apply_credit",onClick:this.handleApplyCreditClick}})}renderCoupon(){const e=(0,q.zt)();return e&&K.Fu(e)?a()("div",{style:{display:"flex",alignItems:"center",fontSize:14,justifyContent:"end"}},void 0,a()("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"}},void 0,a()(ug.X,{tier:e}))):null}renderDiscount(){var e;const{customerData:t}=this.props;return null!==(e=t.promo)&&void 0!==e&&e.percent_off?a()(gg,{title:qm.discount,caption:a()("div",{},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.discount.percentOff",defaultMessage:"{percentOff}% off",values:{percentOff:t.promo.percent_off}})),buttonArgs:{showButton:!1,buttonPurpose:"add",onClick:()=>{}}}):null}renderAddressString(e){return e?this.props.intl.formatList([e.name,e.businessName,e.addressLine1,e.country].filter(Boolean),{type:"conjunction",style:"narrow"}):""}getCurrentFormCreditAmount(){const{subscriptionData:e}=this.props,{store:t}=this.stores,{temporaryApplyCreditCents:i}=t.state;return void 0!==i?i:e.availableCredit}getPlanForOppositeBillingInterval(){const{customerData:e}=this.props;if(!e.isSubscribed)return null;const t=nd.KK.find((t=>t.indexOf(e.plan)>=0));if(t){const i=t.indexOf(e.plan);return t[0===i?1:0]}}static getModalStyle(e){return{width:500,background:e.popoverBackground,padding:24,borderRadius:12}}}function Mg(e){window.__c={n:"SpaceSubscriptionBillingModal"};const t=yg(),i=d.createElement(f.FormattedMessage,pg[e.acceptAction]);return a()("div",{style:t.modalBody},void 0,a()("div",{style:t.modalTitle},void 0,e.title),e.children,a()("div",{style:{marginBottom:20}},void 0,e.helpButton),a()("div",{style:{display:"flex",justifyContent:"flex-end"}},void 0,a()(Ae.Z,{isLarge:!0,onClick:e.onClose,style:{marginRight:12}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.cancelButton.label",defaultMessage:"Cancel"})),a()(je.Z,{isLarge:!0,onClick:e.onAccept},void 0,i)))}wg.displayName="SpaceSubscriptionBilling",wg.modalTitleStyle={fontSize:18,marginBottom:16,fontWeight:h.Z.fontWeight.medium},wg.wrapStyle={display:"flex",flexDirection:"column",height:"100%"},wg.scrollerStyle={height:"100%",padding:"36px 60px"},wg.summaryStyle={display:"flex",alignItems:"flex-start",fontSize:14,marginBottom:36},wg.summaryMessageStyle={marginRight:"auto",paddingRight:32},wg.modalInputStyle={marginTop:12,marginBottom:20};const Cg=(0,f.injectIntl)(wg);class kg extends c.Z{constructor(){super(...arguments),this.storeTypes={store:jm,billingHistoryRequestStore:lo.Z}}willMount(){k.bi(this.environment)}renderComponent(){const{data:e}=this.props;return Ie.Z.state.online?a()("div",{style:kg.wrapStyle},void 0,a()(ig.Z,{style:kg.scrollerStyle,type:Hm.Z.Y},void 0,a()(Pe.Z,{large:!0,divider:"full"},void 0,d.createElement(f.FormattedMessage,Am.billingTab)),this.renderCredit(e),this.renderSeparator(),d.createElement(tg,this.props))):kg.renderOfflineMessage()}static renderOfflineMessage(){return a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,fg.offline))}renderCredit(e){const t=-Math.min(0,e.accountBalance),{intl:i}=this.props;return a()(gg,{title:qm.workspaceBalance,caption:a()("div",{},void 0,(0,Dd.Dx)({amount:t,currency:"dollar",intl:i})),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:l().noop}})}renderSeparator(){return a()("div",{style:{flex:"none",marginTop:30}})}}kg.displayName="SpaceSubscriptionBillingUnsubscribed",kg.wrapStyle={display:"flex",flexDirection:"column",height:"100%"},kg.scrollerStyle={height:"100%",padding:"36px 60px"};const Tg=(0,f.injectIntl)(kg);var _g=i(17126),Ig=i(7036);class xg extends Z.Z{getInitialState(){return{termType:"yearly"}}}const Zg=new xg;var Pg=i(91754),Fg=i(24684);const Ag=function(e){return!!e.device.isMobile||e.WindowSizeStore.state.width<960};var Bg=i(73796);class Eg extends c.Z{renderComponent(){const e="yearly"===Zg.state.termType?"monthly":"yearly";return a()("div",{style:Eg.getTermToggleStyle(this.theme),onClick:()=>{b.iw$(this.environment,{from:"pricing_grid_top",toggle_to:e}),Zg.setState({...Zg.state,termType:e})}},void 0,a()("div",{style:{marginRight:8}},void 0,a()(f.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payAnnually.label",defaultMessage:"Pay annually"})),a()(hr.Z,{on:"monthly"===Zg.state.termType}),a()("div",{style:{marginLeft:8}},void 0,a()(f.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payMonthly.label",defaultMessage:"Monthly"})))}static getTermToggleStyle(e){return{cursor:"pointer",fontSize:14,color:e.mediumTextColor,display:"flex",alignItems:"center",marginBottom:8}}}Eg.displayName="PricingTermToggle";const Dg=Eg,Rg=["free",bl.$M,"business","enterprise"];class Lg extends c.Z{willMount(e){const t=K.XX(e.data);t&&e.data&&Zg.setState({termType:"year"===t.interval?"yearly":"monthly"})}renderComponent(){const e=(0,Fg.Sl)();return a()("div",{},void 0,a()("table",{style:Lg.getTableStyle()},void 0,this.renderHeader(),a()("tbody",{},void 0,e.map(((e,t)=>this.renderSection(e,t))))))}renderCheck(){return Ge.Z.thinCheck({display:"inline",height:12,width:12,color:this.theme.regularTextColor})}upgradeLink(e,t){const{planState:i}=this.props;if(i)return a()(Ao.Z,{onClick:i.plans[e].onClick,style:{fontSize:12,fontWeight:500,textDecoration:"none",color:this.theme.mediumTextColor,lineHeight:1.2}},void 0,t||a()(f.FormattedMessage,{id:"pricingGrid.planAttribute.button.upgrade",defaultMessage:"Upgrade"}))}renderPlanContent(e){const{label:t,upgradeCta:i,upgradeCTALabel:n}=e;return t&&i?a()(d.Fragment,{},void 0,t,a()("br",{}),this.upgradeLink(i,n)):t||(i?a()(d.Fragment,{},void 0,a()(f.FormattedMessage,{id:"pricingGrid.planAttribute.notInTrial",defaultMessage:"Not in trial"}),a()("br",{}),this.upgradeLink(i,n)):this.renderCheck())}renderPlan(e,t,i){return a()("td",{style:{...Lg.getRowStyle(this.theme),...Lg.getValueStyle(),...Lg.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)}},void 0,i.hasFeature&&a()(Oe.Z,{delayThreshold:0,placement:Oe.Z.Placement.Right,renderTooltip:()=>(0,Fg.O_)(t),textWrap:!0,render:e=>d.createElement("div",s()({style:{cursor:"help",lineHeight:1.3,padding:"6px 0"}},e),this.renderPlanContent(i))}))}renderItem(e,t){const i="auto",n=this.props.planState&&this.props.planState.isTeamTrial;return a()("tr",{},`table-row-${t}`,a()("td",{style:{...Lg.getRowStyle(this.theme),...Lg.getRowLabelStyle(this.theme),width:i,maxWidth:i,minWidth:i}},void 0,a()(Oe.Z,{delayThreshold:0,placement:Oe.Z.Placement.Right,renderTooltip:()=>(0,Fg.O_)(e.tooltip),textWrap:!0,render:t=>d.createElement("span",s()({},t,{style:Lg.getTooltipInnerStyle()}),e.label,e.isComingSoon&&this.renderBadge("comingSoon"),e.isBeta&&this.renderBadge("beta"))})),Rg.map((t=>{const i="team"!==t&&"plus"!==t||!n?t:"teamTrial";return this.renderPlan(t,e.tooltip,e.plans[i])})))}renderEmptyTableCell(e,t){return a()("td",{style:{...Lg.getSectionStyle(this.theme,t),...Lg.getValueStyle(),...Lg.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e),color:ho.ZP.lightTextColor,fontWeight:400}})}renderEmptyTableCells(e){return a()(d.Fragment,{},void 0,Rg.map((t=>this.renderEmptyTableCell(t,e))))}renderSection(e,t){const i="auto";return a()(d.Fragment,{},`table-section-${t}`,a()("tr",{},void 0,a()("td",{style:{...Lg.getSectionStyle(this.theme,t),width:i,maxWidth:i,minWidth:i}},void 0,e.label),this.renderEmptyTableCells(t)),e.items.map(((e,t)=>this.renderItem(e,t))))}renderButton(e,t){const i=t.plans[e],n=`notion-pricing-grid-upgrade-${e}`;let o;switch(i.buttonType){case"current":o=a()(f.FormattedMessage,{id:"pricingGrid.currentPlanButton.label",defaultMessage:"Current"});break;case"upgrade":o=a()(f.FormattedMessage,{id:"pricingGrid.upgradePlanButton.label",defaultMessage:"Upgrade"});break;case"downgrade":o=a()(f.FormattedMessage,{id:"pricingGrid.downgradePlanButton.label",defaultMessage:"Downgrade"});break;case"will-downgrade":o=a()(f.FormattedMessage,{id:"pricingGrid.willDowngradePlanButton.label",defaultMessage:"Future plan"});break;case"resubscribe":o=a()(f.FormattedMessage,{id:"pricingGrid.resubscribePlanButton.label",defaultMessage:"Resubscribe"});break;default:T.t1(i.buttonType)}if("current"===i.buttonType)return this.renderDisabledButtonWithTooltip({tooltip:a()(f.FormattedMessage,{id:"pricingGrid.currentPlan.tooltip",defaultMessage:"This is your current active plan"}),label:a()(f.FormattedMessage,{id:"pricingGrid.currentPlan.largeScreenLabel",defaultMessage:"Current plan"}),buttonClassName:n,wrapTooltip:!1});if(!t.canSwitchPlans){let e;return e=t.isInAppPurchase?a()(f.FormattedMessage,{id:"pricingGrid.switchPlanFromInAppPurchase.tooltip",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."}):a()(f.FormattedMessage,{id:"pricingGrid.switchPlanAsMember.tooltip",defaultMessage:"You need to be an administrator of this workspace to switch plans."}),this.renderDisabledButtonWithTooltip({tooltip:e,label:o,buttonClassName:n,wrapTooltip:!0})}return"will-downgrade"===i.buttonType?this.renderDisabledButtonWithTooltip({tooltip:a()(f.FormattedMessage,{id:"pricingGrid.willDowngradePlan.tooltip",defaultMessage:"This is the plan after your current plan expires"}),label:a()(f.FormattedMessage,{id:"pricingGrid.willDowngradePlan.largeScreenLabel",defaultMessage:"Future plan"}),buttonClassName:n,wrapTooltip:!1}):"downgrade"===i.buttonType?a()(Ae.Z,{isLarge:!0,style:{width:"100%"},onClick:()=>{b.rOZ(this.environment,{plan:e,from:"pricing_grid_top",button_text:i.buttonType}),i.onClick()},className:n},void 0,o):a()(je.Z,{isLarge:!0,style:{width:"100%"},onClick:()=>{b.rOZ(this.environment,{plan:e,from:"pricing_grid_top",button_text:i.buttonType}),i.onClick()},className:n},void 0,o)}renderDisabledButtonWithTooltip(e){const{tooltip:t,label:i,buttonClassName:n,wrapTooltip:o}=e;return a()(Oe.Z,{style:{width:o?320:"auto"},textWrap:o,renderTooltip:()=>t,render:e=>d.createElement(Ae.Z,s()({style:{width:"100%",opacity:.5},isLarge:!0,disabled:!0},e,{className:n}),i)})}renderSalesContactLink(e){const t=`setup_${e}_trial`;return a()(Ao.Z,{onClick:()=>{const{currentUserStore:e}=I.default.state,i=null!=e&&e.isDefined()?e.getModel():void 0;b.EUb(this.environment),Bg.Z.setState({open:!0,email:i&&i.getEmail(),name:null==i?void 0:i.getDisplayName(this.props.intl),question:t})}},void 0,a()("div",{style:Lg.getUpgradeButtonBelowLinkStyle()},void 0,a()(f.FormattedMessage,{id:"pricingGrid.requestATrial",defaultMessage:"or Request a Trial",description:"Shown below the upgrade button in case users want to do a trial of the subscription before purchasing."})))}getPlanName(e){const{intl:t}=this.props;switch(e){case"free":return t.formatMessage(K.MB.free);case"personal":return t.formatMessage(K.MB.personal);case"plus":case"team":return t.formatMessage(K.MB.plus);case"business":return t.formatMessage(K.MB.business);case"enterprise":return t.formatMessage(K.MB.enterprise);default:T.t1(e)}}renderHeaderTitle(e){const t=this.getPlanName(e.plan);return a()("td",{style:{...Lg.getHeaderStyle(),...Lg.getActiveStyle(this.theme,this.isPlanActive(e.plan)),...this.getBorderStyle(e.plan)}},void 0,a()("div",{style:this.getHeaderTitleStyle()},void 0,t),void 0!==e.price&&a()("div",{style:{display:Ag(this.environment)?"block":"flex"}},void 0,a()("div",{style:Lg.getHeaderPriceStyle()},void 0,e.price),void 0!==e.terms&&a()("div",{style:this.getHeaderTermsStyle(this.theme)},void 0,(0,Fg.X6)(this.props.intl,e.terms))))}renderHeaderTitles(){const e="monthly"===Zg.state.termType?"month":"year",t=(0,Fg.MZ)(Qe.Z,this.props.intl);return a()("tr",{},void 0,a()("td",{}),this.renderHeaderTitle({plan:"free",price:t.price[e].personal.formattedAmount,image:cd.Z.images.pricing.pricingFreeV2Png}),this.renderHeaderTitle({plan:bl.$M,price:t.price[e].team.formattedAmount,image:cd.Z.images.pricing.pricingTeamV2Png,terms:t.terms.team}),this.renderHeaderTitle({plan:"business",price:t.price[e].business.formattedAmount,image:cd.Z.images.pricing.pricingEnterpriseV2Png,terms:t.terms.business}),this.renderHeaderTitle({plan:"enterprise",price:t.price[e].enterprise.formattedAmount,image:cd.Z.images.pricing.pricingEnterpriseV2Png,terms:t.terms.enterprise}))}renderHeaderAction(e){const{planState:t}=this.props;if(t)return a()("td",{style:{...Lg.getHeaderStyle(),...Lg.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)}},void 0,this.renderButton(e,t),this.renderHeaderSubAction(e))}renderHeaderSubAction(e){if((0,bl.Rs)(e))return a()("div",{style:{marginTop:7}},void 0,this.renderSalesContactLink(e))}renderHeaderActions(){if(this.props.planState)return a()("tr",{},void 0,a()("td",{style:{width:"28%",verticalAlign:"top",paddingTop:16}},void 0,a()(Dg,{})),Rg.map((e=>this.renderHeaderAction(e))))}renderHeader(){return a()("thead",{},void 0,this.renderHeaderTitles(),this.renderHeaderActions())}renderBadge(e){return a()("div",{style:{background:this.theme.buttonHoveredBackground,fontSize:10,fontWeight:500,letterSpacing:"0.015em",color:this.theme.mediumTextColor,display:"inline",textTransform:"uppercase",padding:"2px 4px",marginLeft:6,borderRadius:3,whiteSpace:"nowrap",position:"relative",top:-1}},void 0,"comingSoon"===e&&a()(f.FormattedMessage,{id:"pricingGrid.comingSoonBadge",defaultMessage:"Coming soon"}),"beta"===e&&a()(f.FormattedMessage,{id:"pricingGrid.betaBadge",defaultMessage:"Beta"}))}isPlanActive(e){return Boolean(this.props.planState&&this.props.planState.plans[e].isActive)}static getTableStyle(){return{fontSize:14,width:"100%",tableLayout:"fixed",borderCollapse:"initial"}}static getSectionStyle(e,t){const i={borderBottom:`1px solid ${e.regularDividerColor}`,paddingBottom:7,paddingRight:15,fontWeight:500,verticalAlign:"bottom"};return 0===t?{...i,paddingTop:0}:{...i,paddingTop:20}}static getUpgradeButtonBelowLinkStyle(){return{fontSize:12}}static getRowStyle(e){return{borderBottom:`1px solid ${e.regularDividerColor}`}}static getRowLabelStyle(e){return{color:e.mediumTextColor,paddingRight:10,paddingTop:5,paddingBottom:6,verticalAlign:"top"}}static getValueStyle(){return{paddingLeft:10,paddingRight:10,textAlign:"left",overflow:"hidden",verticalAlign:"top"}}static getActiveStyle(e,t){const i=e.cardSidebarBackground;return{background:t?i:ho.ZP.transparent}}getBorderStyle(e){return{borderLeft:`1px solid ${this.theme.lightDividerColor}`,borderRight:["enterprise"].includes(e)?`1px solid ${this.theme.lightDividerColor}`:void 0}}getHeaderLabelStyle(e,t,i){let n="36%";return t&&(n=i?"54%":"18%"),{paddingLeft:10,paddingRight:10,verticalAlign:"top",width:n,paddingTop:10,fontWeight:700,fontSize:12,paddingBottom:10,borderBottom:e?`2px solid ${this.theme.regularTextColor}`:`1px solid ${this.theme.lightDividerColor}`,borderTop:`1px solid ${this.theme.lightDividerColor}`}}static getHeaderStyle(){return{paddingLeft:10,paddingRight:10,verticalAlign:"top",width:"18%",paddingTop:10}}getHeaderTitleStyle(){return{fontSize:16,fontWeight:Ag(this.environment)?500:700,lineHeight:1.3,marginBottom:2,paddingTop:40}}static getHeaderPriceStyle(){return{fontSize:20,marginRight:7}}static getTooltipInnerStyle(){return{cursor:"help",width:"100%",display:"inline-block"}}getHeaderTermsStyle(e){return{fontSize:10,lineHeight:1,color:e.mediumTextColor,width:70,paddingTop:Ag(this.environment)?0:3}}}Lg.displayName="PricingGrid";const Og=(0,f.injectIntl)(Lg);var Ng=i(32617),Vg=i(10644);class Ug extends c.Z{constructor(){super(...arguments),this.storeTypes={store:$u,downgradeModalStore:Ig.ZP,securitySettingsStore:se.Z},this.renderChurnSurveyModal=()=>{const e=this.stores.store.state,{data:t}=this.props,i=K.XX(t),n=q.zt();if(e.churnSurveyModalOpen&&n&&i)return a()(Qu.Z,{churnType:e.churnType,currentPlan:n,isWorkspaceDeletion:!1,periodEnd:i.periodEnd,hasAI:(0,g.de)(i.addOns),hasPendingChanges:Boolean(i.schedule||i.willCancelAt),customerId:i.customerId,onAccept:this.handleChurnSurveyModalAccept,onClose:this.handleChurnSurveyModalClose})},this.handleFreeClick=async()=>{const{data:e}=this.props;let t="no_confirmation_required";e&&"subscribed_admin"===e.type&&(t=await new Promise((e=>{const{store:t}=this.stores;t.setState({...t.state,churnType:"free",churnSurveyModalOpen:!0,onAccept:t=>e(t?"churn_immediately":"churn_by_end_of_billing_period"),onClose:()=>e("no_churn")})})),"no_churn"===t)||await k.EO({environment:this.environment,spaceStore:this.props.spaceStore,planType:"personal",from:"space_settings-plans_tab",cancelImmediately:"churn_immediately"===t})},this.handlePersonalClick=async()=>{const{spaceStore:e,data:t}=this.props,i=K.XX(t);if(this.shouldShowTeamWarningDuringDowngrade()){if(!(await new Promise((e=>{S.showDialog({showCancel:!0,keepFocus:!1,message:a()("div",{},void 0,a()("h4",{style:{margin:"8px 0 0"}},void 0,a()(f.FormattedMessage,{id:"subscriptSettings.personalPro.downgradeTitle",defaultMessage:"Downgrade to the Personal Pro Plan?",description:"Downgrade title shown in confirmation modal."})),a()("p",{},void 0,a()(f.FormattedMessage,{id:"subscriptionSettings.personalPro.downgradeMessage",defaultMessage:"Pages in the “Teamspaces” section will no longer be in your sidebar, but still be accessible via search and links.",description:"Downgrade message shown in confirmation modal."})),a()("p",{},void 0,a()("b",{},void 0,a()(f.FormattedMessage,{id:"subscriptionSettings.personalPro.downgradeMessageSuggestion",defaultMessage:"We suggest you move them to the “Private” section before downgrading.",description:"Downgrade message shown in confirmation modal."})))),items:[{label:a()(f.FormattedMessage,{id:"subscriptionSettings.personalPro.downgradeConfirmationButton",defaultMessage:"Downgrade to Personal Pro Plan",description:"Downgrade button shown in confirmation modal."}),color:"red",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}))))return}if(i&&K.jL(t)){const t=nd.HA.personal[i.interval],n=q.zt();if(n&&di.rC[n]<di.rC.personal||void 0!==i.canceledAt)await k.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-plans_tab"});else{const i=await new Promise((e=>{const{store:t}=this.stores;t.setState({...t.state,churnType:"personal",churnSurveyModalOpen:!0,onAccept:()=>e(!0),onClose:()=>e(!1)})}));if(!i)return;i&&await k.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-plans_tab"})}}else k.I0(this.environment,{subscriptionTier:"personal",from:"pricing_grid"})},this.handleEducationPlanClick=()=>{const{spaceStore:e}=this.props;k.r7({environment:this.environment,spaceStore:e})},this.handleTeamClick=async()=>{const{spaceStore:e,data:t}=this.props,i=K.XX(t),n=i&&void 0===i.canceledAt;let o;const s=q.zt(),r=s&&di.rC[s]<di.rC.team,l="unsubscribed_admin"===t.type||"unsubscribed_member"===t.type||i&&i.canceledAt||r;if(i&&n&&!q.Rs()){const e="yearly"===Zg.state.termType?"year":"month";if(l&&(0,z.yw)())return void zm.af({environment:this.environment,from:"plans_page",view:"plans",temporarySubscriptionTier:"team",billingInterval:e,pageSection:"all_plans_grid"});const t={price:K._B({subscriptionTier:bl.$M,intl:this.props.intl})[e],br:a()("br",{}),fromSinglePlayer:q.Aw()};o=a()(f.FormattedMessage,{id:"spaceSubscriptionPlans.plusPlan.confirmMessage",defaultMessage:"{fromSinglePlayer, select, true {You are about to subscribe to Notion's full Plus Plan with no member limit for {price} per member per month.{br}You will lose your current discounted price and will be charged a prorated amount, minus any account balance.} other {You are about to subscribe to Notion's Plus Plan for {price} per member per month.{br}You will be charged a prorated amount, minus any account balance.}}",description:"Shown when confirming a plan change to the full Plus (formerly Team) Plan. Includes options for whether the previous plan was a discounted and limited version of the Plus Plan.",values:t})}if(o){if(!(await S.confirmUserAction({message:o,acceptLabel:this.props.intl.formatMessage({id:"spaceSubscriptionPlans.teamPlan.confirmButtonLabel",defaultMessage:"{upgrading, select, true {Upgrade} other {Downgrade}} to Plus"},{upgrading:l})})))return}if(i&&K.jL(t)){const t=nd.HA.team[i.interval];if(l)await k.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-plans_tab"});else{const i=await new Promise((e=>{const{store:t}=this.stores;t.setState({...t.state,churnType:bl.$M,churnSurveyModalOpen:!0,onAccept:()=>e(!0),onClose:()=>e(!1)})}));if(!i)return;i&&await k.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-plans_tab"})}}else k.I0(this.environment,{subscriptionTier:bl.$M,from:"pricing_grid"})},this.handleTeamFreeClick=async()=>{const{data:e}=this.props;let t;if(e&&"subscribed_admin"===e.type){t=await new Promise((e=>{const{store:t}=this.stores;t.setState({...t.state,churnType:bl.$M,churnSurveyModalOpen:!0,onAccept:t=>e(t?"churn_immediately":"churn_by_end_of_billing_period"),onClose:()=>e("no_churn")})}));const e="no_churn"!==t;if(b.rrP(this.environment,{confirmed:e}),!e)return;await k.EO({environment:this.environment,spaceStore:this.props.spaceStore,planType:"team",from:"space_settings-plans_tab",cancelImmediately:"churn_immediately"===t})}else if(e&&("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type)){const e=await new Promise(((e,t)=>{S.showDialog({showCancel:!0,keepFocus:!1,message:a()("div",{},void 0,a()("h4",{style:{margin:"8px 0 0"}},void 0,a()(f.FormattedMessage,{id:"subscriptionSettings.freeTeam.upgradeTitle",defaultMessage:"Try the Team Plan for free"})),a()("p",{style:{margin:"8px 0"}},void 0,a()(f.FormattedMessage,{id:"subscriptionSettings.freeTeam.upgradeMessage",defaultMessage:"You'll get access to most features of a paid Team Plan, with a 1,000 block storage limit. Upgrade to go unlimited anytime."}))),items:[{label:a()(f.FormattedMessage,{id:"subscriptionSettings.startTeamTrialDialog.confirmationbutton",defaultMessage:"Start Team trial"}),color:"blue",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}));if(b.Ygf(this.environment,{confirmed:Boolean(e)}),!e)return;e&&await k.EO({environment:this.environment,spaceStore:this.props.spaceStore,planType:"team",from:"space_settings-plans_tab"})}},this.handleBusinessClick=async()=>{const{spaceStore:e,data:t}=this.props,i=K.XX(t),n=i&&void 0===i.canceledAt;if(i&&n&&!q.wP()){const e="yearly"===Zg.state.termType?"year":"month";if((0,z.yw)()&&!K.gG(i.plan))return void zm.af({environment:this.environment,from:"plans_page",view:"plans",temporarySubscriptionTier:"business",billingInterval:e,pageSection:"all_plans_grid"});const t={price:K._B({subscriptionTier:"business",intl:this.props.intl})[e],br:a()("br",{})},n=q.Aw()?a()(f.FormattedMessage,{id:"subscriptionSettings.upgradeToBusinessFromEducationDialog.message",defaultMessage:"You are about to subscribe to Notion's Business Plan for {price} per member per month.{br}You will lose your current discounted price on the Plus Plan and will be charged a prorated amount, minus any account balance.",description:"Shown when a user is going to upgrade to a business plan type.",values:t}):a()(f.FormattedMessage,{id:"subscriptionSettings.upgradeToBusinessDialog.message",defaultMessage:"You are about to subscribe to Notion's Business Plan for {price} per member per month.{br}You will be charged a prorated amount, minus any account balance.",description:"Shown when a user is going to upgrade to a business plan type.",values:t});if(!(await S.confirmUserAction({message:n,acceptLabel:K.gG(i.plan)?a()(f.FormattedMessage,{id:"subscriptionSettings.downgradeToBusinessDialog.confirmationButton",defaultMessage:"Downgrade to Business",description:"Shown when user is going to downgrade to a business plan type."}):a()(f.FormattedMessage,{id:"subscriptionSettings.upgradeToBusinessDialog.confirmationButton",defaultMessage:"Upgrade to Business",description:"Shown when a user is going to upgrade to a business plan type."})})))return}if(i&&K.jL(t)){if(q.wP()){if(!(await new Promise((e=>{const{store:t}=this.stores;t.setState({...t.state,churnType:"business",churnSurveyModalOpen:!0,onAccept:()=>e(!0),onClose:()=>e(!1)})}))))return}const t=nd.HA.business[i.interval];await k.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-plans_tab"})}else k.I0(this.environment,{subscriptionTier:"business",from:"pricing_grid"})},this.handleEnterpriseClick=async()=>{const{spaceStore:e,data:t}=this.props,i=K.XX(t),n=i&&void 0===i.canceledAt;if(i&&n){const e="yearly"===Zg.state.termType?"year":"month";if((0,z.yw)())return void zm.af({environment:this.environment,from:"plans_page",view:"plans",temporarySubscriptionTier:"enterprise",billingInterval:e,pageSection:"all_plans_grid"});const t={price:K._B({subscriptionTier:"enterprise",intl:this.props.intl})[e],br:a()("br",{})},i=q.Aw()?a()(f.FormattedMessage,{id:"subscriptionSettings.upgradeToEnterpriseFromSinglePlayerPlusDialog.message",defaultMessage:"You are about to subscribe to Notion's Enterprise Plan for {price} per member per month.{br}You will lose your current discounted price on the Plus Plan and will be charged a prorated amount, minus any account balance.",description:"Shown when confirming a plan change away from a discounted plan",values:t}):a()(f.FormattedMessage,{id:"subscriptionSettings.upgradeToEnterpriseDialog.message",defaultMessage:"You are about to subscribe to Notion's Enterprise Plan for {price} per member per month.{br}You will be charged a prorated amount, minus any account balance.",values:t});if(!(await S.confirmUserAction({message:i,acceptLabel:a()(f.FormattedMessage,{id:"subscriptionSettings.upgradeToEnterpriseDialog.confirmationbutton",defaultMessage:"Upgrade to Enterprise"})})))return}if(i&&K.jL(t)){const t=nd.HA.enterprise[i.interval];await k.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-plans_tab"})}else k.I0(this.environment,{subscriptionTier:"enterprise",from:"pricing_grid"})},this.handleChurnSurveyModalAccept=e=>{const{store:t}=this.stores;t.state.churnSurveyModalOpen&&t.state.onAccept(e),t.reset()},this.handleChurnSurveyModalClose=()=>{const{store:e}=this.stores;if(e.state.churnSurveyModalOpen&&e.state.onClose(),"grid"===e.state.page)return e.reset(),void e.setState({...e.state,page:"grid"});e.reset()}}willMount(){k.bi(this.environment),k.px(this.environment)}renderComponent(){if(Ie.Z.state.online){const e=(0,z.$r)(),{churnSurveyModalOpen:t,page:i}=this.stores.store.state,n="grid"===i,o=!e||n;return d.createElement(d.Fragment,null,this.renderBanner(K.wY(this.props.data),this.props.intl),this.renderTrialBanner(this.props.data),this.renderAllPlansButton(n),a()(ig.Z,{style:{height:"100%",padding:n?"0px 0px 100px 60px":"100px 0px 100px 60px"},type:Hm.Z.Y},void 0,a()(Ng.ZP,{data:this.props.data,spaceStore:this.props.spaceStore,spaceSubscriptionPlansStore:this.stores.store}),o?d.createElement(d.Fragment,null,a()(Fo.Z,{size:0}),this.renderPricingGrid(),this.allowEducationUpgrade()&&this.renderStudentUpgrade(),this.renderFAQ(),a()($o.Z,{innerStyle:{width:300,height:"auto",overflow:"scroll"},open:t,render:this.renderChurnSurveyModal,onDismiss:this.handleChurnSurveyModalClose})):null))}return a()(Vg.Z,{})}renderPlans(){const{churnSurveyModalOpen:e}=this.stores.store.state;return a()("div",{style:Ug.wrapStyle},void 0,a()(ig.Z,{style:Ug.scrollerStyle,type:Hm.Z.Y},void 0,this.renderSubscriptionInfo(),this.renderPricingGrid(),this.allowEducationUpgrade()&&this.renderStudentUpgrade(),this.renderFAQ(),a()($o.Z,{innerStyle:{width:300,height:"auto",overflow:"scroll"},open:e,render:this.renderChurnSurveyModal,onDismiss:this.handleChurnSurveyModalClose})))}renderSubscriptionInfo(){const{spaceStore:e}=this.props,{data:t,upcomingInvoiceData:i}=this.props;return i?"subscribed_admin"===t.type?a()("div",{style:this.subscriptionInfoStyle()},void 0,K.D0(this.environment,e,t,i)):"unsubscribed_admin"===t.type||"unsubscribed_member"===t.type?a()("div",{style:{...this.subscriptionInfoStyle(),display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,a()("div",{},void 0,K.D0(this.environment,e,t,i))):void 0:null}renderPricingGrid(){const e=this.getPlanState();return a()(Og,{planState:e,data:this.props.data})}renderStudentUpgrade(){return a()("div",{style:Ug.subsectionStyle},void 0,a()("div",{style:Ug.subsectionTitleStyle},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.title",defaultMessage:"Students & educators"})),a()("div",{style:{color:this.theme.mediumTextColor,marginBottom:15}},void 0,d.createElement(d.Fragment,null,a()(f.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.description",defaultMessage:"<p>Students and educators can get access to the Plus Plan features (with a 1-member limit) for free! Just sign up with your school email address, or change your existing email in the 'My account' tab.</p>",description:"Description shown at the bottom of our pricing plan grids to describe how to get the education plans.",values:{p:e=>a()("div",{style:{marginBottom:4}},void 0,e)}}),a()("div",{},void 0,a()(Ao.Z,{onClick:this.handleEducationPlanClick,style:{textDecoration:"underline"}},void 0,a()(f.FormattedMessage,{defaultMessage:"Get the Education Plan",id:"sidebarStudentPlanPrompt.eligible.getFreePromptPlus",description:"Shown to users who are eligible for a discounted plan"}))),a()("div",{},void 0,a()(Ao.Z,{external:!0,href:(0,W.UY)("guides.students")},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionPlans.studentSection.link",defaultMessage:"For more info, go to notion.com/students.",description:"Label for the link to the student faq website link."}))))))}renderFAQ(){return a()("div",{style:Ug.subsectionStyle},void 0,a()("div",{style:Ug.subsectionTitleStyle},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.title",defaultMessage:"FAQ"})),a()(Ao.Z,{external:!0,href:(0,W.UY)("guides.billingAndPaymentRevised")},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.link",defaultMessage:"Plans, Billing & Payment",description:"Label for the link to the billing and payment faq website link."})))}handlePlansBackButtonClick(){const{store:e}=this.stores;e.setState({...e.state,page:"default"})}renderBanner(e,t){const i=(0,q.zt)();if(!i)return null;if((0,Ng.lu)(e,i)){const n=(0,Ng.QH)(e,i);return a()(Pg.Z,{type:Pg.$.Beige,isMobile:!1},void 0,a()("div",{style:{color:this.theme.accentColors[500]}},void 0,n&&t.formatMessage(n)))}return null}renderTrialBanner(e){const t=K.XX(e);return t&&t.trialEnd?t.trialEnd<_g.ou.now().toSeconds()?null:a()(Pg.Z,{type:Pg.$.Beige,isMobile:!1},void 0,a()("div",{style:{color:this.theme.accentColors[500]}},void 0,a()(f.FormattedMessage,{id:"SpaceSubscriptionPlans.trials.bannerText",defaultMessage:"Your workspace is on a free trial until {trialEndDate}",description:"Banner on Plans page in Settings to tell a user they are on a timed trial",values:{trialEndDate:(0,Vn.Yx)(1e3*t.trialEnd,"long",ra.SP)}}))):null}renderAllPlansButton(e){return e?a()("div",{style:{padding:"30px 0px 0px 60px",display:"flex"}},void 0,a()(hd.Z,{style:{display:"inline-flex",padding:10},onClick:()=>this.handlePlansBackButtonClick()},void 0,Ge.Z.chevronLeft({width:16,height:16,marginTop:4})),a()(Pe.Z,{large:!0,style:{fontSize:16,fontWeight:h.Z.fontWeight.medium,marginBottom:0,padding:10}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionPlans.allPlans.title",defaultMessage:"All plans",description:"Shown as a button message for users to go back to the first plans page in settings."}))):null}getMemberCount(){return K.su(this.props.data)}canSwitchPlans(){const e=K.wY(this.props.data);return this.props.spaceStore.canAdmin()&&!e}calculateButtonState(e){const{data:t}=this.props,i=K.DH(t);return(0,bl.QM)(e)?{free:"current",personal:"upgrade",team:"upgrade",plus:"upgrade",business:"upgrade",enterprise:"upgrade"}:(0,bl.Aw)(e)?{free:i?"current":"downgrade",personal:i?"resubscribe":"current",team:"upgrade",plus:"upgrade",business:"upgrade",enterprise:"upgrade"}:(0,bl.eR)(e)?{free:"downgrade",personal:"downgrade",team:i?"resubscribe":"current",plus:i?"resubscribe":"current",business:"upgrade",enterprise:"upgrade"}:"business"===e?{free:"downgrade",personal:"downgrade",team:"downgrade",plus:"downgrade",business:i?"resubscribe":"current",enterprise:"upgrade"}:"enterprise"===e?{free:"downgrade",personal:"downgrade",team:"downgrade",plus:"downgrade",business:"downgrade",enterprise:i?"resubscribe":"current"}:void(0,T.t1)(e)}isButtonStateActive(e){return["current","resubscribe"].includes(e)}getPlanState(){const e=q.zt();if(!e)return;const t=K.wY(this.props.data),i=this.calculateButtonState(e);return{plans:{free:{buttonType:i.free,isActive:this.isButtonStateActive(i.free),onClick:this.handleFreeClick},personal:{buttonType:i.personal,isActive:this.isButtonStateActive(i.personal),onClick:()=>this.handlePersonalClick()},team:{buttonType:i.team,isActive:this.isButtonStateActive(i.team),onClick:()=>this.handleTeamClick(),onClickTeamFree:this.handleTeamFreeClick},plus:{buttonType:i.plus,isActive:this.isButtonStateActive(i.plus),onClick:()=>this.handleTeamClick()},business:{buttonType:i.business,isActive:this.isButtonStateActive(i.business),onClick:this.handleBusinessClick},enterprise:{buttonType:i.enterprise,isActive:this.isButtonStateActive(i.enterprise),onClick:this.handleEnterpriseClick}},isTeamTrial:!1,isInAppPurchase:t,canSwitchPlans:this.canSwitchPlans(),memberCount:this.getMemberCount()}}allowEducationUpgrade(){const{data:e}=this.props,t=this.getPlanState();return t&&t.canSwitchPlans&&!K.wl(e)&&1===t.memberCount&&(t.plans.free.isActive||t.plans.personal.isActive)}shouldShowTeamWarningDuringDowngrade(){const{spaceStore:e}=this.props,t=null==e?void 0:e.getPlanType();return!!t&&((0,_.bq)()&&(0,zt.u2)(t))}subscriptionInfoStyle(){return{textAlign:"left",fontSize:14,paddingBottom:16}}getTitleStyle(){return{fontSize:14,marginRight:8,flexGrow:1}}}Ug.displayName="SpaceSubscriptionPlans",Ug.wrapStyle={display:"flex",flexDirection:"column",height:"100%"},Ug.scrollerStyle={transform:"translateZ(0px)",flexGrow:1,padding:30},Ug.subscriptionInfoCtaButtonStyle={marginLeft:16,paddingLeft:10},Ug.priceDisclaimerStyle={fontSize:14,marginTop:20,marginBottom:40},Ug.subsectionStyle={fontSize:14,marginTop:40},Ug.subsectionTitleStyle={fontSize:20,fontWeight:h.Z.fontWeight.bold,marginBottom:12};const Wg=(0,f.injectIntl)(Ug);var zg=i(94191);function Kg(){return(0,_e.yK)((e=>({button:{width:"100%",height:40,marginTop:24},cancellationButton:{marginRight:12,border:void 0},section:{display:"flex",alignItems:"center",fontSize:14,paddingTop:16,paddingBottom:16,background:"var(--core-gray-50, #F7F7F5)",borderRadius:4,margin:"12px 0",borderWidth:.5,borderStyle:"solid",borderColor:"#E3E2E0"},textSection:{marginRight:"auto",paddingRight:32},allChanges:{color:e.mediumTextColor,fontSize:12,paddingLeft:8,paddingRight:8}})),[])}function qg(){return window.__c={n:"CancellationButtonText"},a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.scheduledChanges.cancel.label",defaultMessage:"<bold>Cancel changes</bold>",description:"Cancels a workspace's pending midterm subscription changes they had scheduled.",values:{bold:e=>a()("b",{},void 0,e)}})}function Hg(e){window.__c={n:"AllChangesText"};const t=Kg(),i=(0,f.useIntl)().formatList(e.scheduledChanges.filter(Boolean),{type:"conjunction",style:"narrow"});return a()("div",{style:t.allChanges},void 0,i)}function Gg(e){window.__c={n:"PendingChangesText"};const{periodEndDate:t,scheduledChanges:i}=e,n=(0,Vn.Yx)(t,"medium",ra.SP),o=(0,_e.yK)((e=>({leftSection:{display:"flex",paddingLeft:12},title:{fontWeight:h.Z.fontWeight.medium,paddingLeft:8,paddingRight:8},icon:{width:14,height:14,marginTop:4}})),[]);return a()("div",{style:o.leftSection},void 0,Ge.Z.alarmClock(o.icon),a()("div",{},void 0,a()("div",{style:o.title},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.scheduledChanges.pendingChanges.title",defaultMessage:"Pending changes scheduled for {date}",description:"The title for the pending changes section in the billings tab in settings.",values:{date:n}})),a()(Hg,{scheduledChanges:i})))}function jg(e){window.__c={n:"CancelPendingCancellationChanges"};const{customerData:t}=e,i=Kg(),n=(0,ke.O7)();return a()(Ae.Z,{isLarge:!0,onClick:()=>zm.LZ({environment:n,customerData:t}),style:i.cancellationButton},void 0,a()(qg,{}))}function $g(e){window.__c={n:"CancelPendingChanges"};const{customerData:t}=e,i=Kg(),n=(0,ke.O7)();return a()(Ae.Z,{isLarge:!0,onClick:()=>zm.y5({environment:n,customerData:t}),style:i.cancellationButton},void 0,a()(qg,{}))}function Yg(e){window.__c={n:"ScheduledChangesBillingSection"};const{stripeCustomerData:t}=e,i=Kg(),{scheduledChanges:n,periodEndDate:o}=(0,Te.VK)((()=>(0,zg.Tg)(t)),[t]),{cancelledChanges:s}=(0,Te.VK)((()=>(0,zg.n8)(t)),[t]);if(t.isSubscribed&&t.willCancelAt)return a()("div",{style:i.section},void 0,a()("div",{style:i.textSection},void 0,a()(Gg,{scheduledChanges:s,periodEndDate:t.willCancelAt})),a()(jg,{customerData:e.stripeCustomerData}));const r=(0,zg.dY)(t);return(0,zg.dA)(t)||r&&(0,zg.bM)(t)?a()("div",{style:i.section},void 0,a()("div",{style:i.textSection},void 0,a()(Gg,{scheduledChanges:n,periodEndDate:o})),a()($g,{customerData:e.stripeCustomerData})):null}const Qg={offline:a()(f.FormattedMessage,{defaultMessage:"Please go online to manage billing.",description:"Offline message for billing settings.",id:"spaceSubscriptionBillingV2.offline.message"})};function Xg(e){window.__c={n:"BillingRow"};const{mainLabel:t,valueLabel:i,metadataLabel:n,button:o}=e,s=(0,_e.yK)((e=>({row:{display:"flex",alignItems:"center",gap:40,padding:"11px 0",borderBottom:`1px solid ${e.regularDividerColor}`},labelArea:{flex:1,display:"flex",flexDirection:"column",gap:6},mainLabel:{fontWeight:400,fontSize:14,lineHeight:"17px",letterSpacing:"-0.154px"},valueLabel:{fontWeight:400,fontSize:12,lineHeight:"14px",color:e.mediumTextColor},metadataLabel:{fontSize:12,lineHeight:"14px",textAlign:"right",color:e.mediumTextColor},buttonArea:{},button:{minWidth:144}})),[]);return a()("div",{style:s.row},void 0,a()("div",{style:s.labelArea},void 0,a()("div",{style:s.mainLabel},void 0,t),a()("div",{style:s.valueLabel},void 0,i)),n?a()("div",{style:s.metadataLabel},void 0,n):null,o?a()("div",{style:s.buttonArea},void 0,a()(Ae.Z,{isLarge:!0,onClick:o.onClick,style:s.button},void 0,o.label)):null)}function Jg(e){var t;window.__c={n:"BillingHistoryV2"};const{spaceStore:i,upcomingInvoiceData:n}=e,o=(0,ke.O7)(),s=(0,f.useIntl)(),r=(0,_e.yK)((e=>({emptyList:{color:e.mediumTextColor,fontSize:14}})),[]),[{status:l,value:d}]=(0,is.r5)((async()=>await ge.getBillingHistory(o,{spaceId:i.id,limit:50})),[o,i]);if("resolved"!==l||!d||"failed"===d.type||null===(t=d.data)||void 0===t||!t.events)return null;const c=i.id,u=d.data.events??[],p=n?`/invoice/upcoming?spaceId=${c}`:void 0,m=0===u.length&&!p;return a()("div",{style:{marginTop:40}},void 0,a()(Pe.Z,{large:!0,divider:"full",style:th.settingHeaderStyle},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.invoices",defaultMessage:"Invoices",description:"Header for the invoices section"})),m?a()("div",{style:r.emptyList},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.noInvoicesMessage",defaultMessage:"This workspace has no payments yet."})):null,p?a()(Xg,{mainLabel:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.upcomingInvoice",description:"Label for the upcoming invoice row",defaultMessage:"Upcoming invoice"}),button:{label:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.viewInvoice",description:"Label for the view invoice button",defaultMessage:"View invoice"}),onClick:()=>{window.open(p,"_blank")}}}):null,u.map((e=>{const t=(0,Vn.Yx)(e.timestamp,"long",ra.SP);let i;i="paid"===e.status?e.total<0?a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.credited",defaultMessage:"Credited"}):a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.paid",defaultMessage:"Paid"}):e.attempted?a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.failed",defaultMessage:"Failed"}):a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.due",defaultMessage:"Due",description:"Label for the amount that the user owes on a given invoice"});const n=(0,Dd.Dx)({amount:e.total,currency:"dollar",intl:s});return a()(Xg,{mainLabel:t,valueLabel:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.invoiceSummary",description:"Invoice status and amount",defaultMessage:"{invoiceStatus} · {formattedAmount}",values:{invoiceStatus:i,formattedAmount:n}}),button:{label:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.viewInvoice",description:"Label for the view invoice button",defaultMessage:"View invoice"}),onClick:()=>{const t=`/invoice/${e.id}`;window.open(t,"_blank")}}},e.id)})))}function eh(e){window.__c={n:"AddressModal"};const{addressErrorMessage:t,customerData:i,getUpdatedAddress:n,handleAddressAccept:o,handleModalClose:s,temporaryAddress:r,updateAddress:l}=e,d=(0,cg.y0)(),{updatedAddress:c,shouldShowBusinessName:u}=(0,Te.VK)((()=>({updatedAddress:n(),shouldShowBusinessName:(0,q.mq)()})),[n]),p=(0,_e.yK)((e=>({modal:{width:500,background:e.popoverBackground,padding:24,borderRadius:3},footer:{display:"flex",justifyContent:"flex-end",padding:"16px 24px",background:e.cardContentBackground}})),[]);return a()("div",{style:{display:"flex",flexDirection:"column",maxHeight:"75vh"}},void 0,a()("div",{style:p.modal},void 0,a()("div",{style:th.modalTitleStyle},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeYourAddressModal.title",description:"Title for the change your address modal",defaultMessage:"Change your address"})),a()(dg.J,{address:r||{name:i.customerName||"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},availableCountries:d,updateAddress:l,shouldShowBusinessName:u}),a()("div",{style:{color:ho.ZP.red,marginTop:10}},void 0,t)),a()("div",{style:p.footer},void 0,a()(Ae.Z,{isLarge:!0,onClick:s},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingAddressModal.cancelButton.label",description:"Label for the cancel button in the change billing address modal",defaultMessage:"Cancel"})),a()(je.Z,{style:{marginLeft:12},isLarge:!0,disabled:void 0===c,onClick:o},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingAddressModal.updateButton.label",description:"Label for the update button in the change billing address modal",defaultMessage:"Update"}))))}class th extends c.Z{constructor(){super(...arguments),this.couponEntryInput=null,this.storeTypes={store:jm,billingHistoryRequestStore:lo.Z},this.renderPlanTypeName=e=>{switch(e){case"personal":return a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.personal",description:"Personal plan type",defaultMessage:"Personal"});case"plus":case"team":return a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.plus",description:"Plus plan type",defaultMessage:"Plus"});case"business":return a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.business",description:"Business plan type",defaultMessage:"Business"});case"enterprise":return a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.enterprise",description:"Enterprise plan type",defaultMessage:"Enterprise"});default:return null}},this.renderPaymentMethodModal=()=>{const{customerData:e,spaceStore:t}=this.props;return a()(kt.LazySpaceSubscriptionUpdatePaymentMethodModal,{customerData:e,spaceStore:t,onComplete:this.handleModalClose})},this.renderBillingIntervalModal=()=>{const{temporaryBillingInterval:e}=this.stores.store.state,{customerData:t}=this.props;if(!t.isSubscribed)return null;const i=e||t.interval,{monthlyPlanAmount:n,yearlyPlanAmount:o}=t,s=1-o/(12*n);return a()(ih,{theme:this.theme,title:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingInterval.title",description:"Title for the modal that allows users to change their billing interval",defaultMessage:"Change billing interval"}),helpButton:a()(br.Z,{title:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingInterval.helpButton.label",description:"Label for the help button that appears in the change billing interval modal",defaultMessage:"Learn about how this change will impact what you pay."}),href:(0,W.UY)("guides.changeBillingInterval"),analyticsFrom:"billing_interval_settings"}),acceptAction:"update",onAccept:this.handleBillingIntervalAccept,onClose:this.handleModalClose},void 0,a()("div",{style:{marginTop:12,marginBottom:16}},void 0,K.Rj({environment:this.environment,productId:t.productId,yearlyPlanAmount:o,monthlyPlanAmount:n,yearlySavingsPercent:s,currentBillingInterval:i,handleMonthlyBillingClick:this.handleMonthlyBillingClick,handleYearlyBillingClick:this.handleYearlyBillingClick})))},this.renderApplyCreditModal=()=>{const{subscriptionData:e,intl:t,upcomingInvoiceData:i}=this.props,{availableCredit:n}=e,o=this.getCurrentFormCreditAmount(),s=Math.max(0,((null==i?void 0:i.amountRemaining)||0)-o);return a()("div",{style:th.getModalStyle(this.theme)},void 0,a()("div",{style:th.modalTitleStyle},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.useCreditModal.title",description:"Title for the modal that allows users to apply credit to their next invoice",defaultMessage:"Use Notion credit - {creditInDollars} available",values:{creditInDollars:(0,Dd.Dx)({amount:n,currency:"dollar",intl:t})}})),a()("div",{style:{fontSize:14,display:"flex",alignItems:"center",marginBottom:16}},void 0,a()("div",{style:{width:"100%",marginRight:20,color:this.theme.mediumTextColor}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.useCreditModal.amountOfCreditQuestion",description:"Question asking the user how much credit they would like to apply to their next invoice",defaultMessage:"How much credit would you like to apply to your next invoice?"})),a()(Xm,{availableCredit:n,focus:!0,selectAll:!0,onChange:this.handleApplyCreditAmountInputChange}),a()("div",{style:{whiteSpace:"nowrap",marginLeft:8}},void 0,"/"," ",(0,Dd.Dx)({amount:n,currency:"dollar",intl:t}))),a()("div",{style:{borderTop:`1px solid ${this.theme.regularDividerColor}`,paddingTop:16}},void 0,a()("div",{style:{paddingBottom:18,fontSize:12,color:this.theme.mediumTextColor}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.useCreditModal.warning",description:"Warning text that appears in the use credit modal",defaultMessage:"Applying credit to your account <bold>cannot be undone</bold>.",values:{bold:e=>a()("b",{},void 0,e)}})),a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{fontSize:36,lineHeight:1}},void 0,(0,Dd.Dx)({amount:s,currency:"dollar",intl:t})),a()("div",{style:{marginLeft:8,fontSize:12,color:this.theme.mediumTextColor,alignSelf:"flex-end"}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.useCreditModal.nextInvoiceAmount",defaultMessage:"next invoice total",description:"Text that appears next to the amount, in dollars, that the user's next invoice will be after applying their Notion credits to their bill."})),a()(Ae.Z,{isLarge:!0,style:{marginLeft:"auto"},onClick:this.handleModalClose},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.useCreditModal.cancelButton.label",description:"Label for the cancel button in the use credit modal",defaultMessage:"Cancel"})),a()(je.Z,{isLarge:!0,style:{marginLeft:12},disabled:o<=0,onClick:this.handleApplyCreditAccept},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.useCreditModal.applyCreditButton.label",description:"Label for the apply credit button in the use credit modal",defaultMessage:"Apply credit"})))))},this.renderSingleTextFieldModal=(e,t,i,n,o)=>a()(ih,{theme:this.theme,title:t,acceptAction:o,onAccept:n,onClose:this.handleModalClose},void 0,a()(Li.Z,{focus:!0,selectAll:!0,value:e,onChange:i,onSubmit:n,style:th.modalInputStyle})),this.renderBillingEmailModal=()=>{const{customerData:e}=this.props,{temporaryBillingEmail:t}=this.stores.store.state,i=void 0!==t?t:e.billingEmail||"",n=e.billingEmail?"update":"add";return this.renderSingleTextFieldModal(i,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingEmailModal.title",description:"Title for the modal that allows the user to change their billing email",defaultMessage:"Change billing email"}),this.handleBillingEmailChange,this.handleBillingEmailAccept,n)},this.renderVatIdModal=()=>{const{customerData:e}=this.props,{temporaryVatId:t}=this.stores.store.state,i=void 0!==t?t:e.vatId||"",n=e.vatId?"update":"add";return a()(ih,{theme:this.theme,title:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.title",description:"Title for the modal that allows the user to change their VAT/GST number",defaultMessage:"Change VAT/GST number"}),acceptAction:n,onAccept:this.handleVatIdAccept,onClose:this.handleModalClose},void 0,a()(Li.Z,{focus:!0,selectAll:!0,value:i,onChange:this.handleVatIdChange,onSubmit:this.handleVatIdAccept,style:th.modalInputStyle}),a()("div",{style:{color:this.theme.mediumTextColor,fontSize:h.Z.fontSize.UISmall.desktop,marginTop:-10}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.subtitle",description:"Subtitle for the modal that allows the user to change their VAT/GST number",defaultMessage:"Please include your country code"})))},this.renderApplyCouponModal=()=>this.props.customerData.isSubscribed?a()(ih,{theme:this.theme,title:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.applyCouponModal.title",description:"Title for the modal that allows the user to apply a coupon to their subscription",defaultMessage:"Apply coupon"}),acceptAction:"apply",onAccept:()=>{this.couponEntryInput&&this.couponEntryInput.checkCouponCode()},onClose:this.handleModalClose},void 0,d.createElement(lg,{ref:e=>this.couponEntryInput=e,hideApply:!0,plan:this.props.customerData.plan,handlePromo:async e=>{this.handleModalClose();await k.Mg({environment:this.environment,spaceStore:this.props.spaceStore,coupon:e&&"coupon"===e.source?e.code:void 0,promoCodeId:e&&"promo_code"===e.source?e.code:void 0,from:"space_settings-billing_tab"})&&S.showMessage({message:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.applyCouponModal.successMessage",description:"Message shown when a coupon is successfully applied to a subscription.",defaultMessage:"Coupon applied!"})})}})):null,this.handleChangePlanClick=()=>{be.Z.setState({open:!0,currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0})},this.handlePaymentMethodChangeClick=()=>{this.stores.store.setState({...this.stores.store.state,paymentMethodModalOpen:!0})},this.handleBillingIntervalChangeClick=()=>{const{customerData:e}=this.props;if((0,z.yw)()){const t="interval"in e?e.interval:"year",i="year"===t?"month":"year";zm.af({environment:this.environment,from:"billing_page",view:"billing_interval",temporaryBillingInterval:i,billingInterval:t})}else this.stores.store.setState({...this.stores.store.state,billingIntervalModalOpen:!0})},this.handleAddressChangeClick=()=>{this.stores.store.setState({...this.stores.store.state,addressModalOpen:!0})},this.handleVatIdChangeClick=()=>{var e;const{customerData:t}=this.props,i=null===(e=t.address)||void 0===e?void 0:e.country;if(!i)return void S.showErrorMessage(a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatId.missingCountry",description:"Message shown when a user tries to update their VAT/GST number, but their country is missing.",defaultMessage:"To update your VAT/GST number, please update your billing address."}));Vm(i)?this.stores.store.setState({...this.stores.store.state,vatIdModalOpen:!0}):S.showErrorMessage(a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatId.vatNotRequired",description:"Message shown when a user tries to update their VAT/GST number, but their country does not require it.",defaultMessage:"A VAT/GST number is not required for your tax jurisdiction."}))},this.handleModalClose=()=>{this.stores.store.reset()},this.handleBillingEmailChange=e=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingEmail:e.target.value})},this.handleBillingEmailAccept=async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryBillingEmail:i}=this.stores.store.state;i!==t.billingEmail&&await k.Mg({environment:this.environment,spaceStore:e,billingEmail:i,from:"space_settings-billing_tab"}),this.handleModalClose()},this.handleVatIdChange=e=>{this.stores.store.setState({...this.stores.store.state,temporaryVatId:e.target.value})},this.handleVatIdAccept=async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryVatId:i}=this.stores.store.state;i!==t.vatId&&await k.Mg({environment:this.environment,spaceStore:e,vatId:i,from:"space_settings-billing_tab"}),this.handleModalClose()},this.handleAddressAccept=async()=>{const{spaceStore:e}=this.props,t=this.getUpdatedAddress();if(t&&(0,Om.A)(t))try{await k.y3({environment:this.environment,spaceStore:e,address:t}),this.handleModalClose()}catch(i){}else this.stores.store.setState({...this.stores.store.state,addressErrorMessage:this.props.intl.formatMessage({id:"spaceSubscriptionBillingV2.address.invalidError",description:"Error message when the user tries to update their address to an invalid address",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})})},this.getUpdatedAddress=()=>{const{customerData:e}=this.props,{temporaryAddress:t}=this.stores.store.state;if(t&&t!==e.address)return t},this.handleMonthlyBillingClick=()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingInterval:"month"})},this.handleYearlyBillingClick=()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingInterval:"year"})},this.handleBillingIntervalAccept=async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryBillingInterval:i}=this.stores.store.state,n="interval"in t?t.interval:"month";if(i&&i!==n){const t=this.getPlanForOppositeBillingInterval();t&&await k.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-billing_tab"})}this.handleModalClose()},this.handleApplyCreditAccept=async()=>{const e=this.getCurrentFormCreditAmount(),{spaceStore:t}=this.props;e>0&&await k.Mg({environment:this.environment,spaceStore:t,creditAmount:e,from:"space_settings-billing_tab"}),this.handleModalClose(),b.MFb(this.environment,{amount:e})},this.handleApplyCreditAmountInputChange=e=>{this.stores.store.setState({...this.stores.store.state,temporaryApplyCreditCents:e})},this.handleRestartSubscriptionClick=async()=>{const{spaceStore:e}=this.props,{customerData:t}=this.props;await k.Mg({environment:this.environment,spaceStore:e,plan:"plan"in t?t.plan:void 0,from:"space_settings-billing_tab"}),this.handleModalClose()}}willMount(){k.bi(this.environment),k.px(this.environment)}renderComponent(){return Ie.Z.state.online?this.renderBilling():th.renderOfflineMessage()}static renderOfflineMessage(){return a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,Qg.offline))}renderPlanRow(){const{subscriptionData:e,customerData:t}=this.props;let i,n;const o=K.XX(e);o&&(i=(0,Dd.Dx)({amount:o.planAmount*o.quantity,currency:"dollar",intl:V.default.getIntl()}),n=(0,Vn.Yx)(o.periodEnd,"medium",ra.SP));const s=t.willCancelAt,r=a()(f.FormattedMessage,s?{id:"spaceSubscriptionBillingV2.cancels",description:"Shown in plans page to show their plan cancellation date.",defaultMessage:"Cancels"}:{id:"spaceSubscriptionBillingV2.renews",description:"Shown in plans page to show their plan renewal date.",defaultMessage:"Renews"});return a()(Xg,{mainLabel:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.plan",description:"Label for the Plan row",defaultMessage:"Plan"}),metadataLabel:o?a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate",description:"Plan price and next renewal date",defaultMessage:"{planCharge} per {interval} · {renewalOrCancellationMessage} {renewalDate}",values:{planCharge:i,interval:o.interval,renewalDate:n,renewalOrCancellationMessage:r}}):void 0,valueLabel:o?this.renderPlanTypeName(K.NW(o.productId)):"Free",button:{label:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changePlan",description:"Label for the change plan button",defaultMessage:"Change plan"}),onClick:this.handleChangePlanClick}})}renderAdditionalFeaturesRow(e){const{customerData:t}=this.props,i=t.isSubscribed?t.interval:"month",n="month"===i,o=t.isSubscribed?t.quantity:(0,K.qX)(),s=(0,K.v3)({addOnFeature:e.feature,billingInterval:i,quantity:o,getMonthlyPrice:n,intl:V.default.intl}).formattedAmount,r=t.periodEnd,l=zg.A0(t);let d,c;var u;l&&(c=(0,g.ls)(null===(u=Se.default.state.data)||void 0===u?void 0:u.addOns)??t.periodEnd);d=a()(f.FormattedMessage,c?{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.cancels",description:"Plan price and cancellation date",defaultMessage:"{planCharge} per {interval} · Cancels {date}",values:{planCharge:s,interval:i,date:(0,Vn.Yx)(c,"medium",ra.SP)}}:r?{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.renews",description:"Plan price and next renewal date",defaultMessage:"{planCharge} per {interval} · Renews {date}",values:{planCharge:s,interval:i,date:(0,Vn.Yx)(r,"medium",ra.SP)}}:{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.priceOnly",description:"Plan price and interval",defaultMessage:"{planCharge} per {interval}",values:{planCharge:s,interval:i}});const p={label:a()(f.FormattedMessage,l?{id:"spaceSubscriptionBillingV2.resubscribe",description:"Label for the resubscribe subscription changes button",defaultMessage:"Resubscribe"}:{id:"spaceSubscriptionBillingV2.removeFromPlan",description:"Label for the remove from plan button",defaultMessage:"Remove from plan"}),onClick:async()=>{if(c){if(t.willCancelAt){const e=t.customerId?await Wm.y(this.environment,{offerType:"add_on_upgrade_flow",customerId:t.customerId}):void 0;return Um.k2(),void Um.Cl(e)}await zm.y5({environment:this.environment,customerData:t})}else Um.Kj()}};return a()(Xg,{mainLabel:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.additionalFeatures",description:"Label for the Additional features row",defaultMessage:"Additional features"}),metadataLabel:d,valueLabel:"Notion AI",button:p})}renderAdditionalFeaturesRows(){const{customerData:e}=this.props;return e.addOns.map((e=>a()(d.Fragment,{},e.feature,this.renderAdditionalFeaturesRow(e))))}renderBillingPeriodRow(){return a()(Xg,{mainLabel:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.billingPeriod",description:"Label for the billing period row",defaultMessage:"Billing period"}),valueLabel:this.renderBillingInterval(),button:{label:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.editPeriod",description:"Label for the edit period button",defaultMessage:"Edit period"}),onClick:this.handleBillingIntervalChangeClick}})}renderPaymentMethodRow(){return a()(Xg,{mainLabel:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethod",description:"Label for the payment method row",defaultMessage:"Payment method"}),valueLabel:this.renderPaymentMethodType(),metadataLabel:this.renderPaymentMethodSummary(),button:{label:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.editMethod",description:"Label for the edit method button",defaultMessage:"Edit method"}),onClick:this.handlePaymentMethodChangeClick}})}renderAddressRow(){const{customerData:e}=this.props;return a()(Xg,{mainLabel:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.billedTo",description:"Label for the billed to row",defaultMessage:"Billed to"}),valueLabel:this.renderAddressString(e.address),button:{label:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.editInformation",description:"Label for the edit information button",defaultMessage:"Edit information"}),onClick:this.handleAddressChangeClick}})}renderVATRow(){const{customerData:e}=this.props;return a()(Xg,{mainLabel:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatGst",description:"Label for the VAT/GST row",defaultMessage:"VAT/GST number"}),valueLabel:a()("div",{},void 0,e.vatId||"-"),button:{label:a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.editNumber",description:"Label for the edit number button",defaultMessage:"Edit number"}),onClick:this.handleVatIdChangeClick}})}renderBilling(){const{paymentMethodModalOpen:e,billingIntervalModalOpen:t,billingEmailModalOpen:i,addressModalOpen:n,applyCreditModalOpen:o,vatIdModalOpen:s,applyCouponModalOpen:r}=this.stores.store.state;return a()("div",{style:th.wrapStyle},void 0,a()(ig.Z,{style:th.scrollerStyle,type:Hm.Z.Y},void 0,a()(Pe.Z,{large:!0,divider:"full",style:th.settingHeaderStyle},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.billing",defaultMessage:"Billing",description:"Header for the Billing page"})),a()(Yg,{stripeCustomerData:this.props.customerData}),this.renderPlanRow(),this.renderAdditionalFeaturesRows(),this.renderBillingPeriodRow(),a()("div",{style:{height:40}}),a()(Pe.Z,{large:!0,divider:"full",style:th.settingHeaderStyle},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentDetails",defaultMessage:"Payment details",description:"Header for the payment details section"})),this.renderPaymentMethodRow(),this.renderAddressRow(),this.renderVATRow(),a()(Jg,{spaceStore:this.props.spaceStore,upcomingInvoiceData:this.props.upcomingInvoiceData}),a()($o.Z,{open:e,render:this.renderPaymentMethodModal,onDismiss:this.handleModalClose}),a()($o.Z,{open:t,render:this.renderBillingIntervalModal,onDismiss:this.handleModalClose}),a()($o.Z,{open:o,render:this.renderApplyCreditModal,onDismiss:this.handleModalClose}),a()($o.Z,{open:i,render:this.renderBillingEmailModal,onDismiss:this.handleModalClose}),a()($o.Z,{open:n,render:()=>a()(eh,{addressErrorMessage:this.stores.store.state.addressErrorMessage,customerData:this.props.customerData,getUpdatedAddress:this.getUpdatedAddress,handleAddressAccept:this.handleAddressAccept,handleModalClose:this.handleModalClose,temporaryAddress:this.stores.store.state.temporaryAddress,updateAddress:e=>{this.stores.store.setAddressField(e)}}),onDismiss:this.handleModalClose}),a()($o.Z,{open:s,render:this.renderVatIdModal,onDismiss:this.handleModalClose}),a()($o.Z,{open:r,render:this.renderApplyCouponModal,onDismiss:this.handleModalClose})))}renderPaymentMethodType(){const{customerData:e}=this.props,t=e.isSubscribed?e.billing:"charge_automatically";return"send_invoice"===t?a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"}):"charge_automatically"===t&&e.last4&&e.brand?a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.creditCard",description:"The payment method type we display for credit cards",defaultMessage:"Credit card"}):a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None",description:"The payment method setting we display for users who haven't set up a payment method yet"})}renderPaymentMethodSummary(){const{customerData:e}=this.props,t=e.isSubscribed?e.billing:"charge_automatically";return"send_invoice"===t?a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"}):"charge_automatically"===t&&e.last4&&e.brand?a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethod.creditCard",description:"The payment method setting we display for users who have set up a credit card",defaultMessage:"{creditCardBrand} ending in {lastFourDigits}",values:{creditCardBrand:(0,Nm.Z)(e.brand),lastFourDigits:e.last4}}):a()(f.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None",description:"The payment method setting we display for users who haven't set up a payment method yet"})}renderBillingInterval(){const{customerData:e}=this.props;return e.isSubscribed?"month"===e.interval?a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.monthly",description:"The billing interval setting we display for users who are subscribed to a monthly plan",defaultMessage:"Monthly"}):a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.yearly",description:"The billing interval setting we display for users who are subscribed to a yearly plan",defaultMessage:"Yearly"}):a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.monthly",description:"The billing interval setting we display for users who are subscribed to a monthly plan",defaultMessage:"Monthly"})}renderAddressString(e){return e?this.props.intl.formatList([e.name,e.businessName,e.addressLine1,e.country].filter(Boolean),{type:"conjunction",style:"narrow"}):""}getCurrentFormCreditAmount(){const{subscriptionData:e}=this.props,{store:t}=this.stores,{temporaryApplyCreditCents:i}=t.state;return void 0!==i?i:e.availableCredit}getPlanForOppositeBillingInterval(){const{customerData:e}=this.props;if(!e.isSubscribed)return null;const t=nd.KK.find((t=>t.indexOf(e.plan)>=0));if(t){const i=t.indexOf(e.plan);return t[0===i?1:0]}}static getModalStyle(e){return{width:500,background:e.popoverBackground,padding:24,borderRadius:3}}}function ih(e){window.__c={n:"SpaceSubscriptionBillingV2Modal"};const t=d.createElement(f.FormattedMessage,pg[e.acceptAction]);return a()("div",{style:th.getModalStyle(e.theme)},void 0,a()("div",{style:th.modalTitleStyle},void 0,e.title),e.children,a()("div",{style:{marginBottom:20}},void 0,e.helpButton),a()("div",{style:{display:"flex",justifyContent:"flex-end"}},void 0,a()(Ae.Z,{isLarge:!0,onClick:e.onClose,style:{marginRight:12}},void 0,a()(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.cancelButton.label",description:"Label for the cancel button in the space subscription billing modal",defaultMessage:"Cancel"})),a()(je.Z,{isLarge:!0,onClick:e.onAccept},void 0,t)))}th.displayName="SpaceSubscriptionBillingV2",th.modalTitleStyle={fontSize:18,marginBottom:16,fontWeight:h.Z.fontWeight.medium},th.wrapStyle={display:"flex",flexDirection:"column",height:"100%"},th.scrollerStyle={height:"100%",padding:"36px 60px"},th.modalInputStyle={marginTop:12,marginBottom:20},th.settingHeaderStyle={marginBottom:4};const nh=(0,f.injectIntl)(th);var ah=i(42982);const oh="teamColumn",sh="ownersColumn",rh="membersColumn",lh="AccessLevelColumn",dh="lastUpdatedColumn",ch="contextMenuColumn",uh=[oh,rh,lh,dh],ph="filterAccessAny",mh="filterAccessOnlyOpen",gh="filterAccessOnlyClosed",hh="filterAccessOnlyPrivate",fh="filterOwnerAny",vh="filterOwnerShowOrphaned",yh="filterOwnerById";class bh extends Z.Z{getInitialState(){return{searchQuery:"",sortColumn:dh,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:fh},filterAccess:ph,showTeamsWithSecurityOverrides:!1}}}const Sh=new bh;function wh(e){let{environment:t,teamIds:i}=e;const{currentSpaceStore:n,currentUserStore:a}=I.default.state;return n&&a?i.map((e=>{const i=ze.zX.createChildStore(n,{table:ht.e0,id:e,spaceId:n.id});if(i.canRead())return i;const a=n&&gd.Dv({environment:t,teamId:i.id,spaceStore:n,from:"manage_teams_table"});return null!=a&&a.canRead()?a:void 0})).filter(T.$K):[]}var Mh=i(51923);class Ch extends Z.Z{getInitialState(){return{tokenQuery:"",showAutoCompletePopup:!1,defaultTeams:{}}}addedAndCurrentTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"current-default"===t||"add-default"===t}))}addedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"add-default"===t}))}removedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"remove-default"===t}))}}const kh=new Ch;function Th(e){var t;let{team:i}=e;return null===(t=kh.state.defaultTeams[i.id])||void 0===t?void 0:t.state}function _h(e){let{team:t,persistedDefaultTeams:i}=e;if(i.includes(t))Ih({store:t,state:"current-default"});else{const e={...kh.state.defaultTeams};delete e[t.id],kh.setState({...kh.state,defaultTeams:e})}}function Ih(e){const t=kh.state;kh.setState({...t,defaultTeams:{...t.defaultTeams,[e.store.id]:e}})}var xh=i(75024),Zh=i(30676),Ph=i(47082);function Fh(e){let{}=e;const t=(0,ke.Fy)(),i=(0,f.useIntl)(),n=(0,ke.O7)(),{allTeams:o,loaded:r}=(0,Te.VK)((()=>{const e=F.state;return"loaded"!==e.loadingState?{allTeams:[],loaded:!1}:{allTeams:wh({environment:n,teamIds:e.unarchivedTeamIds}),loaded:!0}}),[n]),[c,u]=(0,d.useState)(!1),p=(0,Te.qz)(kh),m=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),{defaultTeams:g,tokenQuery:h}=(0,Te.VK)((()=>{const{defaultTeams:e,tokenQuery:t}=p.state;return{defaultTeams:e,tokenQuery:t}}),[p]),v=!h,{addedTeams:y,removedTeams:b,addedAndCurrentTeams:S}=(0,Te.VK)((()=>({addedAndCurrentTeams:p.addedAndCurrentTeams(),addedTeams:p.addedTeams(),removedTeams:p.removedTeams()})),[p]),w=(0,Te.VK)((()=>o.reduce(((e,t)=>(e[t.id]=t.getName(),e)),{})),[o]),M=(0,Te.VK)((()=>o.filter((e=>e.isDefault()))),[o]);(0,d.useEffect)((()=>function(e){let{persistedDefaultTeams:t}=e;const i=t.reduce(((e,t)=>(e[t.id]={state:"current-default",store:t},e)),{}),n=kh.state;kh.setState({...n,defaultTeams:i})}({persistedDefaultTeams:M})),[M]);const C=y.length>0||b.length>0,k=e=>function(e){let{team:t,persistedDefaultTeams:i}=e;"add-default"===Th({team:t})?_h({team:t,persistedDefaultTeams:i}):Ih({store:t,state:"remove-default"})}({team:e,persistedDefaultTeams:M}),T=e=>{!function(e){let{team:t,persistedDefaultTeams:i}=e;"remove-default"===Th({team:t})?_h({team:t,persistedDefaultTeams:i}):Ih({store:t,state:"add-default"})}({team:e,persistedDefaultTeams:M}),p.update((e=>({...e,showAutoCompletePopup:!1,tokenQuery:""})))},_=new Set(b.map((e=>e.store.id))),x=n.currentUser.id,Z=(0,Te.VK)((()=>x?o.filter((e=>{const t=e.getMembers(),i=e.getSettingsStore().getValue();return!!i&&((0,zt.pd)({membership:t},x)&&"open"===(0,zt.B5)(i))})):[]),[o,x]),P=function(e){let{query:t,addedAndCurrentTeams:i,eligibleDefaultTeams:n,teamIdsToNames:a}=e;const o=new Set;for(const s of i)o.add(s.store.id);return(0,lc.ZP)(t,n,(e=>a[e.id]??""))}({query:h,addedAndCurrentTeams:S,teamIdsToNames:w,eligibleDefaultTeams:Z}),A=[];P.length>0&&!v&&A.push({key:"default-teams-list",render:e=>d.createElement(rt.Z,s()({},e,{title:a()(f.FormattedMessage,{id:"defaultTeamsInput.defaultTeamList.title",description:"Title for the input menu to search for default teamspaces to add to the workspace",defaultMessage:"Teamspaces"}),loading:!1})),items:P.map((e=>({key:e.id,render:t=>d.createElement(Zh.F,s()({},t,{teamStore:e})),action:()=>T(e)})))});const B=(0,Te.VK)((()=>p.state.showAutoCompletePopup&&A.length>0),[p,A.length]),E=(0,_e.yK)((e=>({defaultTeamsHeader:{fontSize:14,marginBottom:2},inputAndButtonContainer:{paddingTop:12,display:"flex"},inputContainer:{flexGrow:1},tokenInputMenu:{borderRadius:B?Eh:Bh,margin:0},menuList:{maxHeight:300,border:`1px solid ${e.regularDividerColor}`,borderTop:0,borderRadius:Dh},updateButton:{marginLeft:10,height:35}})),[B]);return d.createElement(d.Fragment,null,a()("div",{style:E.defaultTeamsHeader},void 0,a()(f.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.title",defaultMessage:"Default teamspaces"})),a()(xe.Z,{isSmall:!0,isMultiline:!0},void 0,a()(f.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})),a()("div",{style:E.inputAndButtonContainer},void 0,a()("div",{style:E.inputContainer},void 0,a()(st.ZP,{popupType:st.ZP.PopupType.Popup,placementToOrigin:st.ZP.Placement.Bottom,sameWidthAsOrigin:!0,open:B,borderRadius:Dh,onDismiss:()=>p.update((e=>({...e,showAutoCompletePopup:!1}))),origin:a()(Ph.Z,{disabled:!r||c,style:E.tokenInputMenu,focusInitial:t.isMobile,focusAfterAnimation:!0,format:Ph.Z.Format.Share,inputDivStyle:{alignItems:"center"},value:h,onChange:e=>p.update((t=>({...t,tokenQuery:e.target.value,showAutoCompletePopup:!0}))),type:"default-teams",tokens:Object.values(g).filter((e=>!_.has(e.store.id))).map((e=>a()(Ah,{teamStore:e.store,onClickRemove:k},e.store.id))),placeholder:i.formatMessage({id:"teamsWorkspaceSettings.defaultTeams.inputPlaceholder",defaultMessage:"Select a default teamspace..."}),onRemoveLastToken:()=>{const e=S,t=l().last(e);t&&k(t.store)},onEmptySubmit:l().identity,showBorder:!0}),render:()=>a()(at.Z,{menuType:Je.og.Popup,tokenInputHeader:!0,disableHeaderBorder:!0},void 0,a()("div",{style:E.menuList},void 0,a()(ot.Z,{type:ot.i.Vertical,initialFocus:0,sections:A})))})),a()(je.Z,{style:E.updateButton,disabled:!C||c,isLarge:!0,onClick:async()=>{if(m){u(!0);try{await async function(e){let{addedTeams:t,removedTeams:i,environment:n,spaceStore:a}=e;if(!a.isDefined())return!1;const o=a.getPermissionItems();return await gd.lH({addedStores:t.map((e=>{let{store:t}=e;return t})),removedStores:i.map((e=>{let{store:t}=e;return t})),environment:n,spaceValue:{permissions:o},createNewTeamFlowId:void 0,from:"workspace_settings"})}({environment:n,addedTeams:y,removedTeams:b,spaceStore:m})}finally{u(!1)}}}},void 0,a()(f.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"}))))}function Ah(e){window.__c={n:"DefaultTeamsToken"};const t=(0,ke.Fy)(),{teamStore:i,onClickRemove:n}=e,{name:o}=(0,Te.VK)((()=>({name:i.getName()})),[i]);return a()(hi.Z,{showRemoveButton:!0,isSingle:!1,format:t.isMobile?ui.l.Large:ui.l.Medium,style:{marginLeft:6},onClickRemove:()=>n(i),value:a()("div",{style:{display:"flex"}},void 0,a()(bt.p,{disabled:!0,store:i,size:14,style:{marginRight:4}}),o)})}const Bh=3,Eh=(0,xh.wK)({topLeft:Bh,topRight:Bh,bottomLeft:0,bottomRight:0}),Dh=(0,xh.wK)({topLeft:0,topRight:0,bottomLeft:Bh,bottomRight:Bh});var Rh=i(17224);function Lh(e){let{selectItems:t,currentSelectedItem:i,onChange:n,icon:o}=e;return window.__c={n:"ManageTeamsFilter"},a()(Ci.Z,{items:t,getKey:e=>e.key,selectedItem:i,onSelect:n,renderItem:e=>d.createElement(it.Z,s()({title:e.value.name},e,{checkState:i.key===e.value.key})),renderOrigin:e=>d.createElement(tt.u,s()({},e,{title:i.originName??i.name,on:!i.showFilterAsOffWhenSelected,icon:o}))})}const Oh={[ph]:{key:ph,name:a()(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any",description:"Select option text to clear filter for access level on the teamspaces table."}),originName:a()(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access",description:"Placeholder option for the filter by access dropdown menu in the manage teamspaces settings"}),showFilterAsOffWhenSelected:!0},[mh]:{key:mh,name:a()(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open",description:"Select option text to filter for open teamspaces only in the manage teamspaces table in workspace settings."})},[gh]:{key:gh,name:a()(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed",description:"Select option text to filter for closed teamspaces only in the manage teamspaces table in workspace settings."})},[hh]:{key:hh,name:a()(f.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private",description:"Select option text to filter for private teamspaces only in the manage teamspaces table in workspace settings."})}},Nh=l().compact([Oh.filterAccessAny,Oh.filterAccessOnlyOpen,Oh.filterAccessOnlyClosed,Oh.filterAccessOnlyPrivate]);function Vh(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsAccessFilter"};const i=(0,ke.O7)(),n=(0,Te.VK)((()=>t.state.filterAccess),[t]),o=(0,_e.yK)((e=>({keyIcon:{width:18,height:18,...n!==ph?{fill:ho.ZP.blue}:{fill:e.mediumIconColor}}})),[n]),s=(0,d.useCallback)((e=>{t.update((t=>({...t,filterAccess:e.key}))),Rh.GZ(i,{filter:"access",value:e.key})}),[t,i]),r=Oh[n];return a()(Lh,{selectItems:Nh,currentSelectedItem:r,onChange:s,icon:Ge.Z.key(o.keyIcon)})}const Uh="showArchived",Wh="hideArchived",zh={[Wh]:{key:Wh,name:a()(f.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active",description:"Select option text to hide archived teamspaces in the manage teamspaces table."}),originName:a()(f.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Archived",description:"Placeholder option for the filter by archived dropdown menu in the manage teamspaces settings"}),showFilterAsOffWhenSelected:!0},[Uh]:{key:Uh,name:a()(f.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived",description:"Select option text to show only archived teamspaces in the manage teamspaces table."})}};function Kh(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsArchivedFilter"};const i=(0,ke.O7)(),n=(0,Te.VK)((()=>t.state.showOnlyArchivedTeams),[t]),o=(0,_e.yK)((e=>({archiveIcon:{width:16,height:16,marginRight:5,...n?{fill:ho.ZP.blue}:{fill:e.mediumIconColor}}})),[n]),s=[zh.hideArchived,zh.showArchived],r=(0,d.useCallback)((e=>{t.update((t=>({...t,showOnlyArchivedTeams:e.key===Uh}))),Rh.GZ(i,{filter:"archived",value:e.key})}),[t,i]),l=zh[n?Uh:Wh];return a()(Lh,{selectItems:s,currentSelectedItem:l,onChange:r,icon:Ge.Z.archiveFilled(o.archiveIcon)})}const qh="ShowTeamsWithNoOwnersId";function Hh(e){let{teamStores:t,manageTeamsStore:i}=e;window.__c={n:"ManageTeamsOwnerFilter"};const n=(0,ke.O7)(),o=(0,Te.VK)((()=>i.state.filterByOwner),[i]),r=function(e){switch(e.type){case fh:return;case yh:return e.id;case vh:return qh;default:(0,T.t1)(e)}}(o),c=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),u=(0,f.useIntl)(),p=(0,Te.VK)((()=>{const e=t.flatMap((e=>(0,zt.XO)({membership:e.getMembers()})));return l().uniq(e)}),[t]),m=(0,_e.yK)((e=>({icon:{marginRight:2,fill:e.mediumIconColor},blueFill:{fill:ho.ZP.blue}})),[]),g=(0,d.useCallback)((e=>{if(c)return zr({userId:e,currentSpaceStore:c}).getValue()}),[c]),h=(0,d.useCallback)((e=>{const t=e[e.length-1];let a;a=t===r||void 0===t?{type:fh}:t===qh?{type:vh}:{type:yh,id:t},i.update((e=>({...e,filterByOwner:a}))),Rh.GZ(n,{filter:"owner",value:a.type})}),[r,i,n]),v=(0,d.useCallback)((async e=>{let{query:t}=e;if(!c)return[];const i=(await yn.pz({query:t,currentSpaceStore:c,userIds:p})).map((e=>e.id));return""===t?[qh,...i]:i}),[c,p]),y=(0,d.useCallback)(((e,t)=>{if(!c)return null;if(e===qh)return d.createElement(it.Z,s()({},t,{title:a()(f.FormattedMessage,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",description:"Teamspaces owners filter option for the manage teamspaces table to filter the table to only show teamspaces that have no owners.",defaultMessage:"No owners"}),checkState:o.type===vh,className:"notranslate"}));const i=g(e);return i?d.createElement(An.Z,s()({},t,{key:e,actor:(0,Pn.m3)(i),checkState:r===e})):null}),[c,g,r,o.type]),b=(0,Te.VK)((()=>{if(o.type!==yh)return;const e=g(o.id);return e?(0,qt.Nz)(u,e):void 0}),[o,g,u]);let S;return S=o.type===vh?a()(f.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",description:"Title for the manage teamspaces filter pill when the filter is set to: Teamspaces without owners.",defaultMessage:"Owner: None"}):a()(f.FormattedMessage,b?{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",description:"Title for the manage teamspaces owner filter pill when an owner filter is specified.",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:b}}:{id:"manageTeamsOwnerFilter.filterTitle.unset",description:"Title for the manage teamspaces filter pill.",defaultMessage:"Owner"}),a()(Ki.Z,{mode:Ki.z.Pill,title:S,disabled:0===t.length,icon:Ge.Z.person,iconStyles:{...m.icon,...o.type!==fh&&m.blueFill},items:l().compact([r]),hasItemsSelected:(0,T.$K)(r),onChange:h,labelText:{title:S,tokenInputPlaceholder:u.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder",description:"The placeholder in the input for search an actor in manage teamspaces owner filter"}),resultSectionTitle:u.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle",description:"The text shown above the list of all selectable actors in manage teamspaces owner filter"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:v,renderResultMenuItem:y,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}const Gh="showAll",jh="showTeamsWithSecurityOverrides",$h={[Gh]:{key:Gh,name:a()(f.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllOption",defaultMessage:"Show all",description:"Select option text to show all teamspaces in the manage teamspaces table."}),originName:a()(f.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllPlaceholder",defaultMessage:"Security",description:"Placeholder option for the filter by security dropdown menu in the manage teamspaces settings"}),showFilterAsOffWhenSelected:!0},[jh]:{key:jh,name:a()(f.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showTeamsWithSecurityOverrides",defaultMessage:"Has overrides",description:"Select option text to show only teamspaces that override workspace settings in the manage teamspaces table."})}};function Yh(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsSecurityOverridesFilter"};const i=(0,ke.O7)(),n=(0,Te.VK)((()=>t.state.showTeamsWithSecurityOverrides),[t]),o=(0,_e.yK)((e=>({securityIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor},blueFill:{fill:ho.ZP.blue}})),[]),s=[$h.showAll,$h[jh]],r=(0,d.useCallback)((e=>{t.setState({...t.state,showTeamsWithSecurityOverrides:e.key===jh}),Rh.GZ(i,{filter:"securityOverrides",value:e.key})}),[t,i]),l=$h[n?jh:Gh];return a()(Lh,{selectItems:s,currentSelectedItem:l,onChange:r,icon:Ge.Z.integrationSecurity({...o.securityIcon,...n&&o.blueFill})})}function Qh(e){let{manageTeamsStore:t,teamStores:i}=e;window.__c={n:"ManageTeamsFilterRow"};const n=(0,_e.yK)((()=>({container:{display:"flex",alignItems:"center",marginTop:20},searchContainer:{maxWidth:250,marginRight:"auto"},archivedTeamsSwitch:{display:"flex",alignItems:"center",marginLeft:15,marginRight:15},archivedTeamsLabel:{marginLeft:10},dropdownContainer:{display:"flex",alignContent:"stretch",marginLeft:5}})),[]),o=(0,Te.VK)((()=>t.state.searchQuery),[t]),s=(0,d.useCallback)((e=>{t.update((t=>({...t,searchQuery:e})))}),[t]);return a()("div",{style:n.container},void 0,a()(Xh,{style:n.searchContainer,onChange:s,value:o}),a()("div",{style:n.dropdownContainer},void 0,a()(Kh,{manageTeamsStore:t}),a()(Hh,{teamStores:i,manageTeamsStore:t}),a()(Vh,{manageTeamsStore:t}),a()(Yh,{manageTeamsStore:t})))}function Xh(e){let{style:t,value:i,onChange:n}=e;window.__c={n:"Search"};const o=(0,f.useIntl)(),s=(0,_e.yK)((e=>({input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),r=(0,d.useCallback)((e=>n(e.target.value)),[n]);return a()(Li.Z,{placeholder:o.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder",description:"Placeholder text for manage teamspaces list search filter."}),style:{...s.input,...t},value:i,onChange:r,left:Ge.Z.searchThick(s.searchIcon),format:Li.Z.Format.Small,showClearButton:!0})}var Jh=i(12534),ef=i(48690),tf=i(92350),nf=i(11913),af=i(98742),of=i(45660),sf=i(4657),rf=i(13380);function lf(e){let{teamStore:t,accessLevel:i,isTeamOwner:n,onChangeAccessLevel:o,width:r}=e;window.__c={n:"ManageTeamsAccessCell"};const l=(0,ke.O7)(),c=(0,tf.vR)(t),u=(0,sf.U)({teamStore:t,onChange:o,isDefault:c}),p=c?"default":i,m=u.find((e=>e.key===p)),g=!n||Boolean(null==m?void 0:m.disableAllOptionsTooltip),v=(null==m?void 0:m.disableAllOptionsTooltip)||g&&!n&&a()(f.FormattedMessage,{id:"manageTeamsAccessCell.onlyTeamOwnersCanChangeAccessLevel",description:"Tooltip that shows on disabled teamspace access level button in the manage teams table that explains that only teamspace owners can change the access level.",defaultMessage:"Only teamspace owners can change teamspace access levels"}),y=(0,of.e)(),b=(0,_e.yK)((e=>{const t=e.lightTextColor;return{selectButton:{paddingLeft:8,marginLeft:-8,maxWidth:r},label:{...g&&{color:t},fontSize:h.Z.fontSize.UIRegular.desktop,fontWeight:h.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.mediumIconColor,...g&&{fill:t}},tooltip:{width:200}}}),[g,r]);if(!m)throw new Error(`Selected access level is not an option found in team access level option: ${p}`);return a()(Ci.Z,{items:u,getKey:e=>e.key,selectedItem:m,onSelect:e=>"private"===e.key&&y?nr.y(l,{from:"team_security_settings",for:"business"}):e.onSelect(),renderItem:e=>a()(Oe.Z,{textWrap:!0,style:b.tooltip,placement:la.u.Bottom,disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>d.createElement(it.Z,s()({title:e.value.title},(0,af.Z)(e,t)))}),disabled:g,renderOrigin:e=>a()(Oe.Z,{textWrap:!0,style:b.tooltip,disableTooltip:!v,renderTooltip:()=>v,alignment:la.v.Center,placement:la.u.Left,render:t=>d.createElement($e.Z,s()({style:b.selectButton,disabled:g},(0,af.Z)(e,t)),a()(rf.s,{style:b.label},void 0,m.level),Ge.Z.chevronDown(b.chevron))})})}function df(e){let{teamOwners:t,manageTeamsStore:i}=e;window.__c={n:"ManageTeamsOwnersCell"};const n=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),o=(0,f.useIntl)(),s=(0,Te.VK)((()=>{if(!n)return;const{filterByOwner:e}=i.state;let a=t[0];if(e.type===yh){const i=e.id;t.includes(i)&&(a=i)}return a?zr({userId:a,currentSpaceStore:n}):void 0}),[n,i,t]),r=(0,Te.VK)((()=>{if(null!=s&&s.isDefined())return(0,qt.Nz)(o,s.getModel())}),[s,o]),l=(0,_e.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:h.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},nMoreOwnersText:{paddingLeft:3,color:e.mediumTextColor},noOwners:{marginRight:8,color:e.lightTextColor},userName:{flexShrink:1}})),[]);return t.length<1?a()("div",{style:l.noOwners},void 0,a()(f.FormattedMessage,{id:"manageTeamsOwnersCell.noOwners",description:"Label that shows that a teamspace has no owners in the manage teamspaces table.",defaultMessage:"No owners"})):a()("div",{style:l.container},void 0,a()(Ht.Z,{style:l.userAvatar,avatarShouldShowShadow:!0,userStore:s,size:20}),a()(rf.s,{style:l.userName},void 0,r),t.length>1&&a()("div",{style:l.nMoreOwnersText},void 0,a()(f.FormattedMessage,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",description:"Label that shows in the owners cell in the manage teamspaces table. Ex: if there are 2 owners, James and Joe, the cell will show 'James +1'.",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:t.length-1}})))}const cf=[oh,sh,lh,dh,ch],uf={[lh]:{headerTitle:a()(f.FormattedMessage,{id:"manageTeamsTable.columnTitle.access",description:"Title of the access (private or open) column in the manage teamspaces table.",defaultMessage:"Access"}),renderCell:e=>{let{data:t,environment:i}=e;return a()(lf,{teamStore:t.store,accessLevel:t.accessLevel,isTeamOwner:t.isCurrentUserOwnerOfTeam,onChangeAccessLevel:(e,n)=>gd.Ju({environment:i,store:t.store,accessLevel:e,isDefault:n,teamName:t.name,from:"manage_teams_table"}),width:90})},colWidth:{width:90},hasClickableContents:!0},[oh]:{headerTitle:a()(f.FormattedMessage,{id:"manageTeamspacesTable.columnTitle.teamspace",description:"Title of the teamspace name column in the manage teamspaces table.",defaultMessage:"Teamspace"}),renderCell:e=>{let{data:t}=e;return a()(pf,{teamStore:t.store,isArchivedTeam:t.isArchivedTeam,name:t.name})},colWidth:{minWidth:30,widthPercent:35}},[sh]:{headerTitle:a()(f.FormattedMessage,{id:"manageTeamsTable.columnTitle.owners",description:"Title of the teamspace owners column in the manage teamspaces table.",defaultMessage:"Owners"}),renderCell:e=>{let{data:t,manageTeamsStore:i}=e;return a()(df,{teamOwners:t.owners,manageTeamsStore:i})},colWidth:{minWidth:60,widthPercent:25}},[rh]:{headerTitle:a()(f.FormattedMessage,{id:"manageTeamsTable.columnTitle.members",description:"Title of the teamspace members column in the manage teamspace table.",defaultMessage:"Members"}),renderCell:e=>{let{data:t}=e;return a()(rf.s,{},void 0,a()(f.FormattedMessage,{id:"manageTeamsTable.numMembersCell",description:"Text that shows in the members cell of each teamspace in the manage teamspaces table. The cell says the number of teamspace members.",defaultMessage:"{numTeamMembers, plural, one {# member} other {# members}}",values:{numTeamMembers:t.members.length}}))},colWidth:{minWidth:40,widthPercent:15}},[dh]:{headerTitle:a()(f.FormattedMessage,{id:"manageTeamsTable.columnTitle.updated",description:"Title of the last updated column in the manage teamspaces table.",defaultMessage:"Updated"}),renderCell:e=>{let{data:t}=e;return t.lastUpdated&&a()(mf,{lastUpdatedMillis:t.lastUpdated})},colWidth:{minWidth:50,widthPercent:15}},[ch]:{headerTitle:void 0,renderCell:e=>{let{data:t}=e;return a()(nf.o,{teamStore:t.store,from:"manage_teams_table"})},colWidth:{width:30},hasClickableContents:!0}};function pf(e){let{teamStore:t,name:i,isArchivedTeam:n}=e;window.__c={n:"TeamCell"};const o=(0,ke.O7)(),s=(0,f.useIntl)(),r=(0,tf.e4)(t),c=(0,_e.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginRight:12},nameAndMembersContainer:{display:"flex",flexDirection:"column",minWidth:0},nameAndArchivedPillContainer:{display:"flex"},nameText:{lineHeight:"18px",fontWeight:h.Z.fontWeight.regular},smallText:{fontSize:(0,xh.yv)(o,"UISmall"),color:e.mediumTextColor,fontWeight:h.Z.fontWeight.regular},archivedTag:{marginLeft:5}})),[o]),u=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),p=(0,Te.VK)((()=>{if(!u)return;const e=(0,_.tO)({teamStore:t,spaceStore:u}).length;return(0,Dd.uf)(e,"compact",s)}),[u,s,t]),m=a()(f.FormattedMessage,{id:"manageTeamsTableColumnData.numMembersLabel",description:"Label under a teamspace name in the manage teamspaces table that tells the user how many members are in the team. The number itself is shortened if it's very large. Ex: 10,000 is shorted to 10k. This shortening is already localized.",defaultMessage:"{numMembers, plural, one {1 member} other {{numMembers} members}}",values:{numMembers:p}}),g=r?d.createElement(d.Fragment,null," • ",a()(f.FormattedMessage,{id:"manageTeamsTableColumnData.joinedLabel",description:"Label that shows next to a teamspace name in the manage teamspaces table that tells the user that they are a member of the team.",defaultMessage:"Joined"})):void 0,v=l().compact([m,g]);return a()("div",{style:c.container},void 0,a()(bt.p,{style:c.teamIcon,size:28,store:t,disabled:!0}),a()("div",{style:c.nameAndMembersContainer},void 0,a()("div",{style:c.nameAndArchivedPillContainer},void 0,a()(rf.s,{style:c.nameText},void 0,i),n&&a()(Fn.Z,{desktopStyle:c.archivedTag,mobileStyle:c.archivedTag},void 0,a()(f.FormattedMessage,{id:"manageTeamsTable.archivedTag",description:"Tag pill placed next to team name to mark it as an archived team in the manage teams table",defaultMessage:"Archived"}))),a()(rf.s,{style:c.smallText},void 0,v)))}function mf(e){let{lastUpdatedMillis:t}=e;return window.__c={n:"LastUpdatedCell"},a()(rf.s,{},void 0,(0,Vn.Yx)(t,"very_short",ra.SP))}function gf(e){let{teamStores:t,manageTeamsStore:i}=e;const n=(0,ke.O7)(),o=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),s=(0,Te.VK)((()=>I.default.state.currentUserStore),[]),{sortAscending:r,sortColumn:c}=(0,Te.VK)((()=>{const{sortAscending:e,sortColumn:t}=i.state;return{sortAscending:e,sortColumn:t}}),[i]),u=(0,Te.VK)((()=>{const e=null==s?void 0:s.id;return e?l().compact(t.map((t=>{if(!t.canRead()||!t.isReady())return;const i=t.getMembers(),n=(0,zt.XO)({membership:i});return{store:t,name:t.getName()??"",owners:n,isCurrentUserOwnerOfTeam:n.includes(e),members:(0,_.tO)({teamStore:t,spaceStore:o}),hasSecurityOverrides:t.hasSecurityOverrides(),accessLevel:t.getTeamAccessLevel(),isArchivedTeam:(0,zt.m4)({archived_by:t.getArchivedBy()}),lastUpdated:t.getLastEditedTime()}}))):[]}),[o,null==s?void 0:s.id,t]),p=(0,Te.VK)((()=>{const{showOnlyArchivedTeams:e,filterByOwner:t,showTeamsWithSecurityOverrides:n,filterAccess:a}=i.state;return u.filter((t=>e?t.isArchivedTeam:!t.isArchivedTeam)).filter((e=>!n||e.hasSecurityOverrides)).filter((e=>{if(a===mh&&"open"!==e.accessLevel)return!1;if(a===gh&&"closed"!==e.accessLevel)return!1;if(a===hh&&"private"!==e.accessLevel)return!1;switch(t.type){case vh:return 0===e.owners.length;case yh:return e.owners.includes(t.id);case fh:return!0;default:(0,T.t1)(t)}}))}),[i,u]),m=(0,Te.VK)((()=>{const{sortAscending:e,sortColumn:t}=i.state;return function(e){let{data:t,sortColumn:i,sortAscending:n}=e;const a=[n?"asc":"desc"],o=[n?"desc":"asc"];switch(i){case oh:return l().orderBy(t,(e=>e.name),o);case rh:return l().orderBy(t,(e=>e.members.length),a);case lh:return l().orderBy(t,(e=>ht.bx.indexOf(e.accessLevel)),a);case dh:return l().orderBy(t,(e=>e.lastUpdated),a);default:(0,T.t1)(i)}}({data:p,sortAscending:e,sortColumn:t})}),[i,p]),g=(0,Te.VK)((()=>(0,lc.ZP)(i.state.searchQuery,m,(e=>e.name))),[i,m]),h=(0,d.useCallback)((e=>gd.RF({environment:n,teamId:e,tab:ef.a.Members,from:"manage_teams_table"})),[n]),f=(0,_e.yK)((e=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:cf.reduce(((e,t)=>e+Mf(uf[t].colWidth)+Sf),0)},tableHeaderRow:{borderTop:`1px solid ${e.tableDividerColor}`,borderBottom:`1px solid ${e.tableDividerColor}`},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),v=(0,d.useCallback)((e=>{const{sortColumn:t,sortAscending:a}=i.state,o=e===t&&!a;i.setState({...i.state,sortAscending:o,sortColumn:e}),Rh.dw(n,{sortBy:e,sortOrder:a?"ascending":"descending"})}),[i,n]),y=(0,d.useCallback)((()=>{i.reset()}),[i]);return d.createElement(d.Fragment,null,a()("table",{style:f.container},void 0,a()("tr",{style:f.tableHeaderRow},void 0,cf.map((e=>a()(ff,{column:e,onSortableColumnClick:v,sortAscending:r,sortColumn:c},`header_${e}`)))),a()("tr",{},void 0,cf.map((e=>a()("td",{},`padding_row_${e}`)))),g.map((e=>a()(hf,{onShowTeamSettings:h,teamData:e,manageTeamsStore:i},`${e.store.id}_row`)))),a()(yf,{style:f.noTeamsLabel,numItemsAfterFilter:g.length,numItemsBeforeFilter:t.length,onResetFilters:y}))}function hf(e){let{teamData:t,manageTeamsStore:i,onShowTeamSettings:n}=e;window.__c={n:"TeamRow"};const[o,s]=(0,d.useState)(!1),r=(0,d.useCallback)((()=>s(!0)),[]),l=(0,d.useCallback)((()=>s(!1)),[]),c=(0,d.useCallback)((e=>{bf(e,(()=>n(t.store.id)))}),[n,t.store.id]),u=(0,_e.yK)((e=>({teamRow:{cursor:"pointer",borderBottom:`1px solid ${e.tableDividerColor}`}})),[]);return a()("tr",{onMouseLeave:l,onMouseEnter:r,style:u.teamRow,onClick:c},void 0,cf.map((e=>a()(vf,{isRowHovered:o,teamData:t,columnData:uf[e],manageTeamsStore:i},`${t.store.id}_${e}`))))}function ff(e){let{column:t,onSortableColumnClick:i,sortColumn:n,sortAscending:o}=e;window.__c={n:"HeaderCell"};const s=uf[t],r=(0,_e.yK)((e=>({th:Cf(s),innerDiv:{display:"flex",alignItems:"center",minWidth:Mf(s.colWidth),height:32},text:{fontSize:h.Z.fontSize.UISmall.desktop,fontWeight:h.Z.fontWeight.regular,color:e.mediumTextColor},sortButton:{padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"},sortIcon:{fill:e.mediumTextColor,width:12,height:12,marginLeft:4}})),[s]),l=a()(rf.s,{style:r.text},void 0,s.headerTitle),d=(c=t,uh.includes(c)?a()($e.Z,{style:r.sortButton,onClick:()=>i(t)},void 0,l,(()=>{if(t===n)return Ge.Z.arrowDownSmall({...r.sortIcon,...o&&{transform:"rotate(180deg)"}})})()):l);var c;return a()("th",{style:r.th},void 0,a()("div",{style:r.innerDiv},void 0,d))}function vf(e){let{teamData:t,columnData:i,isRowHovered:n,manageTeamsStore:o}=e;window.__c={n:"Cell"};const s=(0,ke.O7)(),r=(0,_e.yK)((e=>({td:{...Cf(i),...n&&{background:e.buttonHoveredBackground}},innerDiv:{minWidth:Mf(i.colWidth),fontSize:h.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,height:56,display:"flex",alignItems:"center"}})),[i,n]),l=bf,d=Boolean(i.hasClickableContents);return a()("td",{style:r.td},void 0,a()("div",{style:r.innerDiv,onClick:d?l:void 0},void 0,i.renderCell({environment:s,data:t,manageTeamsStore:o})))}function yf(e){let{style:t,numItemsBeforeFilter:i,numItemsAfterFilter:n,onResetFilters:o}=e;window.__c={n:"NoTeamsMessage"};const s=0!==i;if(0!==n)return null;let r;return r=a()(f.FormattedMessage,s?{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",description:"Row that shows when the manage teamspaces table is empty because no teamspaces match the applied filters. The 'Reset your filters' link will clear the user's filters.",values:{linkbutton:e=>a()(Ao.Z,{onClick:o},void 0,e)}}:{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces.",description:"Row that shows when the manage teamspaces table is empty because no teamspaces have been created yet."}),a()(xe.Z,{isSmall:!0,style:t},void 0,r)}function bf(e,t){(0,Jh.ZP)({event:e,context:Jh.Af.ManageTeamsRowClick,callback:t})}const Sf=10,wf={paddingLeft:Sf/2,paddingRight:Sf/2};function Mf(e){return"minWidth"in e?e.minWidth:e.width}function Cf(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:`${e.colWidth.widthPercent}%`,minWidth:e.colWidth.minWidth},{...wf,...t}}function kf(e){let{}=e;window.__c={n:"ManageTeamsBrowser"};const{isMobile:t=!1}=(0,ke.Fy)(),i=(0,ke.O7)(),n=(0,Te.qz)(Sh),o=(0,_e.yK)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},subheader:{display:"flex",flexDirection:"column"}})),[]),{unarchivedTeamIds:s,archivedTeamIds:r,isLoading:l}=(0,Te.VK)((()=>{const e=F.state;return"loaded"!==e.loadingState?{unarchivedTeamIds:[],archivedTeamIds:[],isLoading:!0}:{unarchivedTeamIds:e.unarchivedTeamIds,archivedTeamIds:e.archivedTeamIds,isLoading:!1}}),[]),c=(0,Te.VK)((()=>l?[]:wh({environment:i,teamIds:[...s,...r]})),[r,i,l,s]),u=(0,d.useCallback)((()=>gd.lo("workspace_settings")),[]);return a()("div",{style:o.container},void 0,a()(Pe.Z,{large:!t,style:o.header,small:!0},void 0,a()("div",{style:o.subheader},void 0,a()(f.FormattedMessage,{id:"manageTeamsBrowser.title",description:"Title of the section in teamspace settings for the manage teamspaces browser. This section shows a list of all teamspaces in the workspace.",defaultMessage:"Manage teamspaces"}),a()(xe.Z,{isSmall:!0,style:{marginTop:3}},void 0,a()(f.FormattedMessage,{id:"manageTeamsBrowser.subtitle",description:"Descripton of the teamspace settings in manage teamspaces browser",defaultMessage:"Manage all teamspaces you have access here"}))),a()(je.Z,{onClick:u,isLarge:!0,className:L.myM},void 0,a()(f.FormattedMessage,{id:"manageTeamsBrowser.newTeamButton.text",description:"Button for creating a new teamspace.",defaultMessage:"New teamspace"}))),l?a()(Re.Z,{}):d.createElement(d.Fragment,null,a()(Qh,{teamStores:c,manageTeamsStore:n}),a()(gf,{teamStores:c,manageTeamsStore:n})))}var Tf=i(44615),_f=i(2688);function If(){const e=(0,ke.O7)(),{currentSpaceStore:t,currentUserStore:i}=(0,Te.VK)((()=>{const{currentSpaceStore:e,currentUserStore:t}=I.default.state;return{currentSpaceStore:e,currentUserStore:t}}),[]);return(0,d.useEffect)((()=>{if("loading"===F.state.loadingState||!t||!i)return;const n=_f.Z.addListener((0,Tf.pD)({userId:i.id,spaceId:t.id}),((t,i)=>{A({environment:e,messageStoreEmitValue:i})}),void 0,e);return function(){n&&_f.Z.removeListener(n,e)}}),[t,i,e]),null}const xf=d.memo(If);function Zf(e){let{title:t,description:i,disabled:n=!1,selected:o,onChange:s=(()=>{})}=e;return window.__c={n:"TeamSettingsSwitcher"},a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!n&&s(!o)},void 0,a()("div",{style:{fontSize:14,marginRight:8,flexGrow:1}},void 0,t,i&&a()(xe.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,i)),a()("div",{style:{marginTop:5}},void 0,a()(hr.Z,{on:o,disabled:n})))}function Pf(){window.__c={n:"Header"};const e=(0,ke.Fy)();return a()(Pe.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full"},void 0,a()(f.FormattedMessage,{id:"teamsWorkspaceSettings.title",description:"Title of the Teamspaces settings page inside workspace settings. This is where global settings for the teamspaces feature are set.",defaultMessage:"Teamspace settings"}))}function Ff(){const e=(0,ke.O7)(),t=(0,Te.VK)((()=>I.default.state.currentSpaceStore),[]),i=(0,Te.qz)(void 0,se.Z),n=(0,Te.VK)((()=>t&&i.getValueForSpace(t)),[t,i]),o=(0,Te.VK)((()=>(0,O.F$)()),[]),s=(null==n?void 0:n.disableTeamCreation)??!1,r=(null==n?void 0:n.disableTeamGuests)??!1,l=void 0===n,c=(0,d.useCallback)((()=>{t&&n&&async function(e){let{newSettingValue:t,environment:i,workspaceSecuritySettings:n,spaceStore:o}=e;const s=a()(f.FormattedMessage,"allowTeamCreation"===t?{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Are you sure you want allow all members of this workspace to create teams?",description:"Confirmation dialog title asking the user if they want to turn on the 'Limit teamspace creation' workspace setting."}:{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Are you sure you want to limit teamspace creation to only workspace owners?",description:"Confirmation dialog title asking the workspace owner if they want to turn on the 'Limit team creation' workspace setting."});!!(await S.confirmUserAction({message:s}))&&Sc.n(i,{securitySettingsState:{...n,disableTeamCreation:"disableTeamCreation"===t},spaceStore:o})}({newSettingValue:s?"allowTeamCreation":"disableTeamCreation",environment:e,spaceStore:t,workspaceSecuritySettings:n})}),[t,s,e,n]);return d.createElement(d.Fragment,null,a()(Fo.Z,{size:34}),a()(Zf,{disabled:l,onChange:c,title:a()(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",description:"Title for a setting that, when on, will only allow workspace owners to create new teamspaces.",defaultMessage:"Limit teamspace creation to only workspace owners"}),description:a()(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.caption",description:"Description for a setting that, when on, will only allow workspace owners to create new teamspaces.",defaultMessage:"Only allow workspace owners to create teamspaces"}),selected:s}),a()(Fo.Z,{size:34}),o&&d.createElement(d.Fragment,null,a()(Zf,{disabled:l,onChange:async function(){if(t&&n){if(!Boolean(n.disableTeamGuests)){if(!(await S.confirmUserAction({message:a()(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.message",defaultMessage:"Are you sure you want to disable teamspace guests?",description:"Message for confirmation dialog warning that disabling teamspace guests will remove all teamspace guests from the workspace."}),description:a()(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.description",defaultMessage:"This action will remove all teamspace guests from the workspace.",description:"Explains the effect of disabling the teamspace guests setting."}),acceptLabel:a()(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.acceptButton",defaultMessage:"Disable and remove teamspace guests",description:"Button label to confirm disabling teamspace guests will remove all teamspace guests from the workspace."})})))return}Sc.n(e,{securitySettingsState:{...n,disableTeamGuests:!n.disableTeamGuests},spaceStore:t})}},title:a()(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.title",defaultMessage:"Allow teamspace owners to add teamspace guests",description:"Title for a setting that, when on, will enable teamspace guests in the workspace.."}),description:a()(f.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.caption",defaultMessage:"This will allow teamspace owners with membership admin permissions to add teamspace guests. Disabling will remove all teamspace guests.",description:"Description for a setting that, when on, will enable teamspace guests in the workspace."}),selected:!r}),a()(Fo.Z,{size:34})))}function Af(e){let{}=e;window.__c={n:"TeamsWorkspaceSettings"};const t=(0,_e.yK)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]);return a()(Ze.Z,{},void 0,a()(Pf,{}),a()(Mh.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:t.learnMoreLinkContainer}),a()(Fh,{}),a()(Ff,{}),a()(kf,{}),a()(xf,{}))}var Bf=i(92222);class Ef extends Z.Z{getInitialState(){return{emailInputValue:"",showAllInviteCredits:!1}}}const Df=Ef;var Rf=i(47593);class Lf extends c.Z{constructor(){super(...arguments),this.handleImportActionClick=()=>{Rf.Z.setState({open:!0}),b.dDy(this.environment,{type:"import_evernote"})},this.handleWebActionClick=()=>{w.navigateToExternalURL({environment:this.environment,url:"/product"}),b.dDy(this.environment,{type:"web_login"})},this.handleDesktopActionClick=()=>{w.navigateToExternalURL({environment:this.environment,url:"/desktop"}),b.dDy(this.environment,{type:"desktop_login"})},this.handleMobileActionClick=()=>{w.navigateToExternalURL({environment:this.environment,url:"/mobile"}),b.dDy(this.environment,{type:"mobile_login"})},this.handleBrowserExtensionActionClick=()=>{w.navigateToExternalURL({environment:this.environment,url:"/web-clipper"}),b.dDy(this.environment,{type:"browser_extension"})},this.handleMobileShareSheetActionClick=()=>{w.navigateToExternalURL({environment:this.environment,url:"/mobile"}),b.dDy(this.environment,{type:"mobile_share_sheet"})}}renderComponent(){return a()("div",{style:this.getWrapperStyle()},void 0,a()("div",{style:{flex:0}},void 0,this.renderLeft()),a()("div",{style:this.getCenterStyle()},void 0,a()("div",{},void 0,this.renderTitle()),a()(xe.Z,{isSmall:!0,style:{marginBottom:2}},void 0,this.renderCaption())),a()("div",{style:{flex:0}},void 0,this.renderRight()))}renderTitle(){const{credit:e,intl:t}=this.props;if("invited_user"===e.type){const i=this.getUserStore(e.to_user_id).getModel();return a()(d.Fragment,{},void 0,null==i?void 0:i.getDisplayName(t)," ",!e.activated&&i&&!i.getOnboardingCompleted()&&a()("span",{style:{color:this.theme.mediumTextColor}},void 0,a()(f.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.userHasNotSignedUpNote",defaultMessage:"(has not signed up)",description:"Annotation that appears next to a referred user's name if the user hasn't signed up for Notion yet"})),!e.activated&&i&&i.getOnboardingCompleted()&&a()("span",{style:{color:this.theme.mediumTextColor}},void 0,a()(f.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.userHasAlreadySignedUpNote",defaultMessage:"(has already signed up)",description:"Annotation that appears next to a referred user's name if the user has signed up for Notion already"})))}if("invited_by_user"===e.type){const i=this.getUserStore(e.from_user_id).getModel();return a()(d.Fragment,{},void 0,null==i?void 0:i.getDisplayName(t),a()("span",{style:{color:this.theme.mediumTextColor}},void 0,a()(f.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.sourceOfReferralNote",defaultMessage:"(invited you)",description:"Annotation that appears next to the name of the user who invited this user to Notion"})))}return"import_evernote"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.evernoteImport.title",defaultMessage:"Import from Evernote",description:"Title for the Evernote import credit"}):"web_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webApp.title",defaultMessage:"Log in on the web",description:"Title for the web app credit"}):"desktop_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.desktopApp.title",defaultMessage:"Log in on the desktop app",description:"Title for the desktop app credit"}):"mobile_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileApp.title",defaultMessage:"Log in on the mobile app",description:"Title for the mobile app credit"}):"browser_extension"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webClipper.title",defaultMessage:"Use the Web Clipper",description:"Title for the web clipper credit"}):"mobile_share_sheet"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileShare.title",defaultMessage:"Use the iOS or Android system share menu",description:"Title for the mobile share sheet credit"}):"guest_collaboration"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.guestCollaboration.title",defaultMessage:"Collaborate with a guest on a page",description:"Title for the guest collaboration credit"}):"create_teamspace"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.createTeamspace.title",defaultMessage:"Create a teamspace",description:"Title for the create teamspace credit"}):"add_template"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.addTemplate.title",defaultMessage:"Use a Notion built template",description:"Title for the add template credit"}):void 0}renderCaption(){const{credit:e,intl:t}=this.props;if("invited_user"===e.type){return this.getUserStore(e.to_user_id).getEmail()}if("invited_by_user"===e.type){return this.getUserStore(e.from_user_id).getEmail()}return"import_evernote"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.evernoteImport.description",defaultMessage:"Import your notes and notebooks",description:"Description of the Evernote import credit"}):"web_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webApp.description",defaultMessage:"Sign in to Notion from any web browser",description:"Description of the web app credit"}):"desktop_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.desktopApp.description",defaultMessage:"Download the desktop app and sign in",description:"Description of the desktop app credit"}):"mobile_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileApp.description",defaultMessage:"Download the mobile app and sign in",description:"Description of the mobile app credit"}):"browser_extension"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webClipper.description",defaultMessage:"Download the Chrome extension and save a link"}):"mobile_share_sheet"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileShare.description",defaultMessage:"Use the share menu to save a link into Notion",description:"Description of the mobile share credit"}):"guest_collaboration"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.guestCollaboration.description",defaultMessage:"Use the share menu to work with a guest outside of your team",description:"Description of the guest collaboration credit"}):"create_teamspace"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.createTeamspace.description",defaultMessage:"Teamspaces manage permissions, members, and content for your team",description:"Description of the teamspace credit"}):"add_template"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.addTemplate.description",defaultMessage:"Templates are a quick way to get started with common workflows on Notion",description:"Description of the template credit"}):void 0}renderLeft(){const{credit:e}=this.props;if("invited_user"===e.type){const t=this.getUserStore(e.to_user_id);return a()(Ht.Z,{userStore:t,style:{marginRight:8},size:24,hasTooltip:!0})}if("invited_by_user"===e.type){const t=this.getUserStore(e.from_user_id);return a()(Ht.Z,{userStore:t,style:{marginRight:8},size:24,hasTooltip:!0})}return"import_evernote"===e.type?Ge.Z.evernoteLogo(this.getIconStyle()):"web_login"===e.type?Ge.Z.logInWeb(this.getIconStyle()):"desktop_login"===e.type?Ge.Z.deviceDesktop(this.getIconStyle()):"mobile_login"===e.type?Ge.Z.deviceMobile(this.getIconStyle()):"browser_extension"===e.type?Ge.Z.googleChrome(this.getIconStyle()):"mobile_share_sheet"===e.type?Ge.Z.deviceMobileShareSheet(this.getIconStyle()):"guest_collaboration"===e.type?Ge.Z.typesPerson(this.getIconStyle()):"create_teamspace"===e.type?Ge.Z.openTeam(this.getIconStyle()):"add_template"===e.type?Ge.Z.templates(this.getIconStyle()):void 0}renderRight(){const{credit:e,intl:t}=this.props;let i;return"import_evernote"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.evernoteImport.actionLink",defaultMessage:"Connect",description:"Action link for the Evernote import credit"}),onClick:this.handleImportActionClick}:"web_login"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webApp.actionLink",defaultMessage:"Visit",description:"Action link for the web app credit"}),onClick:this.handleWebActionClick}:"desktop_login"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.desktopApp.actionLink",defaultMessage:"Download",description:"Action link for the desktop app credit"}),onClick:this.handleDesktopActionClick}:"mobile_login"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileApp.actionLink",defaultMessage:"Download",description:"Action link for the mobile app credit"}),onClick:this.handleMobileActionClick}:"browser_extension"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webClipper.actionLink",defaultMessage:"Install",description:"Action link for the browser extension credit"}),onClick:this.handleBrowserExtensionActionClick}:"mobile_share_sheet"===e.type&&(i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileShare.actionLink",defaultMessage:"Download",description:"Action link for the mobile share sheet credit"}),onClick:this.handleMobileShareSheetActionClick}),a()("div",{style:{display:"flex",alignItems:"center"}},void 0,i&&!e.activated&&a()($e.Z,{isBlue:!0,isSmall:!0,onClick:i.onClick},void 0,i.text),a()("div",{style:{minWidth:32,marginLeft:8,marginRight:8,textAlign:"right",fontWeight:h.Z.fontWeight.semibold,...!e.activated&&{color:this.theme.lightTextColor}}},void 0,(0,Dd.Dx)({amount:e.amount,currency:"dollar",intl:this.props.intl})),a()("div",{style:this.getTickStyles(e.activated)},void 0,Ge.Z.check({fill:ho.ZP.white,width:12,height:12,opacity:e.activated?1:0})))}getUserStore(e){const{currentSpaceStore:t}=I.default.state;if(!t)throw new Error("No current space.");return ze.U6.createChildStore(t,{table:Kt.KJ,id:e})}getWrapperStyle(){const e=`1px solid ${this.theme.regularDividerColor}`;return{display:"flex",alignItems:"center",borderTop:this.props.isFirst?e:void 0,borderBottom:e,paddingTop:8,paddingBottom:8}}getCenterStyle(){return{flex:1,fontSize:14,marginLeft:4}}getIconStyle(){return{width:24,height:24,fill:this.theme.mediumIconColor,marginRight:8}}getTickStyles(e){const t=e?void 0:`inset 0 0 0 2px ${this.theme.regularDividerColor}`;return{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:20,background:e?ho.ZP.blue:void 0,boxShadow:t}}}Lf.displayName="UserCreditSettingsRow";const Of=(0,f.injectIntl)(Lf);class Nf extends c.Z{constructor(){super(...arguments),this.storeTypes={store:Df},this.renderCredit=(e,t)=>a()(Of,{credit:e,isFirst:0===t},e.id),this.handleInviteCreditsToggleShowMoreClick=()=>{const{store:e}=this.stores;e.setState({...e.state,showAllInviteCredits:!e.state.showAllInviteCredits})},this.handleApplyCreditClick=()=>{const{data:e}=this.props;be.Z.setState({open:!0,currentTab:"subscribed_admin"===e.type?"billing":"plans",defaultSubtab:void 0,highlightedSetting:void 0}),b.UxC(this.environment,{creditType:"user"})}}willMount(){k.bi(this.environment)}renderComponent(){if(Ie.Z.state.online){const{credits:e}=this.props.data;return this.renderSettings(e)}return this.renderOfflineMessage()}renderOfflineMessage(){return a()(Ze.Z,{},void 0,a()(xe.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(f.FormattedMessage,{id:"userCreditSettings.offline.message",defaultMessage:"Please go online to manage your account credit.",description:"Message shown when the user is offline and tries to access the credit settings."})))}renderOtherCreditWays(e){const t=this.getActionCredits(e);return t.length>0&&a()(d.Fragment,{},void 0,a()(Pe.Z,{large:!0},void 0,a()(f.FormattedMessage,{id:"userCreditSettings.otherWaysToEarnCreditSectionAlt.title",defaultMessage:"Ways to earn credit",description:"Title for the section that shows other ways to earn credit."})),a()("div",{},void 0,t.map(this.renderCredit)))}renderReferralSection(e){const{store:t}=this.stores,{showAllInviteCredits:i}=t.state,n=this.getInviteCredits(e),o=i?n:n.slice(0,Nf.showInviteCreditCount);return n.length>0&&a()(d.Fragment,{},void 0,a()("div",{style:this.getHeaderContainerStyles()},void 0,a()("div",{style:this.getHeaderStyles()},void 0,a()(f.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.title",defaultMessage:"Invite friends and earn credit",description:"Title for the section that shows how to invite friends and earn credit."}))),a()("div",{style:this.getInviteCreditStyles()},void 0,o.map((e=>this.renderCredit(e,1))),n.length>Nf.showInviteCreditCount&&a()(Kr.Z,{style:{marginTop:8},onClick:this.handleInviteCreditsToggleShowMoreClick},void 0,a()(f.FormattedMessage,i?{id:"userCreditSettings.inviteFriendsSection.showLessReferredUsers.link",defaultMessage:"Show {numberOfReferredUsers} less",description:"Link to show less referred users.",values:{numberOfReferredUsers:n.length-Nf.showInviteCreditCount}}:{id:"userCreditSettings.inviteFriendsSection.showMoreReferredUsers.link",defaultMessage:"Show {numberOfReferredUsers} more",description:"Link to show more referred users.",values:{numberOfReferredUsers:n.length-Nf.showInviteCreditCount}}))))}renderTotalCreditEarned(e){const{intl:t}=this.props,i=e.reduce(((e,t)=>e+(t.activated?t.amount:0)),0);return i>0&&a()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"}},void 0,a()(br.Z,{title:t.formatMessage({id:"userCreditSettings.helpButton.caption",defaultMessage:"Learn how to earn and apply credits",description:"Caption for the help button in the user credit settings."}),href:(0,W.UY)("guides.referralsAndCredit"),analyticsFrom:"credit_settings"}),a()("div",{style:{display:"flex",alignItems:"center",paddingRight:28,marginTop:16}},void 0,a()("div",{style:{marginLeft:"auto",fontSize:14,color:this.theme.mediumTextColor,paddingRight:6}},void 0,a()(f.FormattedMessage,{id:"userCreditSettings.otherWaysToEarnCreditSection.totalCreditSummaryText",defaultMessage:"Total credit earned",description:"Text that shows the total credit earned."})),a()("div",{style:{minWidth:32,marginLeft:8,fontWeight:h.Z.fontWeight.semibold,textAlign:"right"}},void 0,(0,Dd.Dx)({amount:i,currency:"dollar",intl:t}))))}renderSettings(e){return a()(Ze.Z,{},void 0,this.renderCreditBalance(),this.renderReferralSection(e),this.renderOtherCreditWays(e),this.renderTotalCreditEarned(e))}renderCreditBalance(){const{data:e,intl:t}=this.props,{availableCredit:i,totalCredit:n}=e,o=Se.default.state.data;if(!o)return;const s=K.YK(o),r=Qe.Z.pricing.team.monthlyPricePerMember,l=Math.floor(i/r),c=n>=id.cw;return a()(d.Fragment,{},void 0,a()(Pe.Z,{large:!0,divider:"full"},void 0,a()(f.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.title",defaultMessage:"Credit balance",description:"Title for the credit balance section."})),a()("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:40,fontSize:14}},void 0,a()("div",{},void 0,a()(f.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.creditBalanceMessage",defaultMessage:"Your current credit balance is {creditBalance}.",description:"Message that shows the current credit balance.",values:{creditBalance:a()("b",{style:{color:this.theme.regularTextColor}},void 0,(0,Dd.Dx)({amount:i,currency:"dollar",intl:t}))}})," ",l>0&&!c&&a()(f.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.freePlusMonthMessage",description:"Message in sidebar letting user know how many months of free Notion they can get with their credits",defaultMessage:"{numberOfMonths, plural, one {That's equivalent to {numberOfMonths} month of the Plus Plan.} other {That's equivalent to {numberOfMonths} months of the Plus Plan.}}",values:{numberOfMonths:l}}),c&&a()(f.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.maximumCreditBalanceExceeded",description:"Message in sidebar letting user know they've exceeded the maximum credit balance",defaultMessage:"You've exceeded the maximum amount of credit per account, {maximumCreditBalance}. Any additional credit you earn will not increase your balance.",values:{maximumCreditBalance:(0,Dd.Dx)({amount:id.cw,currency:"dollar",intl:t})}})),i>0&&a()(Ae.Z,{isLarge:!0,onClick:this.handleApplyCreditClick},void 0,s?Ge.Z.settingsBilling(Nf.applyCreditButtonIconStyle):Ge.Z.settingsUpgrade(Nf.applyCreditButtonIconStyle),s?t.formatMessage({id:"userCreditSettings.creditBalanceSection.applyCreditButton.label",defaultMessage:"Apply your credit",description:"Button label for applying credit to a subscription."}):t.formatMessage({id:"userCreditSettings.creditBalanceSection.upgradeForFreeButton.label",defaultMessage:"Apply to an upgrade",description:"Button to apply credit to an upgrade"}))))}getActionCredits(e){const{id:t}=this.environment.currentUser,{currentUserSettingsStore:i}=I.default.state;if(!t||!i)return[];const n=[];if(i.canActivateLoginCredit()){const i={id:"web_login_default",version:0,amount:id.lk.web_login,activated:!1,created_timestamp:Date.now(),type:"web_login",user_id:t};n.push(e.find((e=>"web_login"===e.type))||i);const a={id:"desktop_login_default",version:0,amount:id.lk.desktop_login,activated:!1,created_timestamp:Date.now(),type:"desktop_login",user_id:t};n.push(e.find((e=>"desktop_login"===e.type))||a);const o={id:"mobile_login_default",version:0,amount:id.lk.mobile_login,activated:!1,created_timestamp:Date.now(),type:"mobile_login",user_id:t};n.push(e.find((e=>"mobile_login"===e.type))||o)}const a={id:"import_evernote_default",version:0,amount:id.lk.import_evernote,activated:!1,created_timestamp:Date.now(),type:"import_evernote",user_id:t};n.push(e.find((e=>"import_evernote"===e.type))||a);const o={id:"browser_extension_default",version:0,amount:id.lk.browser_extension,activated:!1,created_timestamp:Date.now(),type:"browser_extension",user_id:t};n.push(e.find((e=>"browser_extension"===e.type))||o);const s={id:"mobile_share_sheet_default",version:0,amount:id.lk.mobile_share_sheet,activated:!1,created_timestamp:Date.now(),type:"mobile_share_sheet",user_id:t};return n.push(e.find((e=>"mobile_share_sheet"===e.type))||s),n}getInviteCredits(e){const t=e.find((e=>"invited_by_user"===e.type)),i=e.filter((e=>"invited_user"===e.type&&!e.activated)),n=e.filter((e=>"invited_user"===e.type&&e.activated));return l().compact([t,...l().sortBy(i,(e=>-e.created_timestamp)),...l().sortBy(n,(e=>-e.created_timestamp))])}getHeaderContainerStyles(){return{borderBottom:`1px solid ${this.theme.regularDividerColor}`,paddingBottom:4,marginBottom:12}}getHeaderStyles(){return{fontWeight:h.Z.fontWeight.medium,fontSize:18}}getInviteCreditStyles(){return{marginBottom:44}}}Nf.displayName="UserCreditSettings",Nf.showInviteCreditCount=3,Nf.applyCreditButtonIconStyle={width:20,height:20,marginRight:6};const Vf=(0,f.injectIntl)(Nf);class Uf extends c.Z{constructor(){super(...arguments),this.lastSpaceSettingsStoreState=void 0,this.lastSpaceSettingsModalStoreOpen=!1,this.storeTypes={spaceBasicSettingsStore:me,spaceProfileSettingsStore:ye,securitySettingsStore:se.Z,samlSettingsStore:oe,spaceDomainSettingsStore:fe},this.renderContent=()=>{const e={profile:this.renderProfile,notifications_and_settings:this.renderNotificationsAndSettings,credit:this.renderCredit,language_and_region:this.renderLanguageAndRegion,connected_apps:this.renderConnectedApps,debug_zone:this.renderDebugZone,settings:this.renderSettings,teams:this.renderTeamsSettings,members:this.renderMembers,analytics:this.renderAnalytics,plans:this.renderPlans,billing:this.renderBilling,subscription:this.renderSubscription,security:this.renderSecurity,identity_provisioning:this.renderIdentityProvisioning,admin_content_search:this.renderAdminContentSearch,integrations:this.renderIntegrations,experiments:this.renderExperiments,audit_log:this.renderAuditLog,imports:this.renderImports};return a()(Go.Z,{capture:!0,allowEsc:!0,render:t=>a()(jo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>d.createElement(_c,s()({sidebar:this.renderSidebar()},t),e[be.Z.state.currentTab]())})})},this.renderTabDot=e=>{const{currentSpaceStore:t}=I.default.state;return"members"===e&&this.environment.device.isDesktop&&null!=t&&t.canEditMembership()&&(0,O.p1)()&&we.Z.state.count>0?a()(fd.z,{color:this.theme.redBadgeBackground}):null},this.renderProfile=()=>a()(km,{isEducationPlan:K.wl(Se.default.state.data),spaceProfileSettingsStore:this.stores.spaceProfileSettingsStore}),this.renderNotificationsAndSettings=()=>a()(bc.Z,{isMobile:!1}),this.renderLanguageAndRegion=()=>a()(yc,{}),this.renderSettings=()=>a()(Cp,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,securitySettingsStore:this.stores.securitySettingsStore}),this.renderTeamsSettings=()=>a()(Af,{}),this.renderMembers=()=>a()(kp.Z,{store:this.props.spaceStore,unreadAccessRequests:we.Z.state.count}),this.shouldRenderAnalyticsTab=()=>{var e;const{device:t}=this.environment;return!t.isMobile&&"enterprise"===(null===(e=this.props.spaceStore)||void 0===e?void 0:e.getSubscriptionTier())},this.shouldRenderAdminContentSearchTab=()=>{const{device:e,currentUser:t}=this.environment,{spaceStore:i}=this.props,n=i.getModel();return N.default.checkGate("admin_content_search_tab")&&!e.isMobile&&t.id&&n&&(0,u.H)({spaceModel:n,userId:t.id})},this.renderAnalytics=()=>{const{spaceStore:e}=this.props;return this.shouldRenderAnalyticsTab()?a()(Ku,{spaceStore:e}):null},this.renderPlans=()=>{const{data:e}=Se.default.state,{data:t}=Me.Z.state;if(e)return a()(Wg,{spaceStore:this.props.spaceStore,upcomingInvoiceData:t,securitySettingsStore:this.stores.securitySettingsStore,data:e})},this.renderBilling=()=>{const{data:e}=Se.default.state,{data:t}=Me.Z.state;if(!e)return null;const i="unsubscribed_admin"===e.type&&e.customerData&&(0,g.E3)(e.customerData.stripe.addOns);if("subscribed_admin"===e.type||i){var n;const i=null===(n=e.customerData)||void 0===n?void 0:n.stripe;return i?z.yw()?a()(nh,{spaceStore:this.props.spaceStore,subscriptionData:e,upcomingInvoiceData:t,customerData:i}):a()(Cg,{spaceStore:this.props.spaceStore,subscriptionData:e,upcomingInvoiceData:t,customerData:i}):null}return e&&"unsubscribed_admin"===e.type?a()(Tg,{spaceStore:this.props.spaceStore,data:e}):void 0},this.renderExperiments=()=>a()(Ze.Z,{},void 0,a()(Xo.Ub,{})),this.shouldRenderMembersPrompt=()=>{var e,t;const{currentSpaceViewStore:i,currentSpaceStore:n,currentUserStore:a}=I.default.state;if(null==a||!a.id)return!1;if(null==n||!n.isDefined())return!1;if(!(0,q.wP)()||!(0,m.wv)({permissions:n.getPermissionItems()},a.id)||!(0,U.U7)())return!1;const o=null==i?void 0:i.getSettings();return"dismissed"!==(null==o||null===(e=o.enterprise_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==o||null===(t=o.enterprise_settings_prompt)||void 0===t?void 0:t.status)&&(C.W7(this.environment),!0)},this.shouldRenderDomainClaimPrompt=()=>{var e,t;const{currentSpaceViewStore:i,currentSpaceStore:n,currentUserStore:a}=I.default.state;if(null==a||!a.id)return!1;if(null==n||!n.isDefined())return!1;if(!(0,q.wP)()||!(0,m.wv)({permissions:n.getPermissionItems()},a.id))return!1;const o=null==i?void 0:i.getSettings();return"dismissed"!==(null==o||null===(e=o.domain_claim_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==o||null===(t=o.domain_claim_settings_prompt)||void 0===t?void 0:t.status)&&(C.cm(this.environment),!0)},this.shouldRenderAnalyticsPrompt=()=>{var e,t;const{currentSpaceViewStore:i,currentSpaceStore:n,currentUserStore:a}=I.default.state;if(!this.shouldRenderAnalyticsTab())return!1;if(null==a||!a.id)return!1;if(null==n||!n.isDefined())return!1;const o=null==i?void 0:i.getSettings();return"dismissed"!==(null==o||null===(e=o.space_analytics_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==o||null===(t=o.space_analytics_settings_prompt)||void 0===t?void 0:t.status)&&(C.lo(this.environment),!0)},this.shouldRenderAuditLog=()=>{const{device:e}=this.environment;return!e.isMobile&&(0,q.wP)()&&this.props.spaceStore.canAdmin()},this.renderAuditLog=()=>this.shouldRenderAuditLog()?d.createElement(d.Fragment,null,a()(Ze.Z,{},void 0,a()(ao,{spaceStore:this.props.spaceStore}))):null,this.renderSubscription=()=>a()(Ze.Z,{},void 0,a()(ah.Z,{})),this.renderCredit=()=>{const{data:e}=Se.default.state;if(e)return a()(Vf,{data:e})},this.renderImports=()=>a()(Ze.Z,{},void 0,a()(kd,{})),this.renderConnectedApps=()=>a()(Bf.Z,{location:"settings-page"}),this.renderDebugZone=()=>a()(Pm,{store:this.props.spaceStore}),this.renderSecurity=()=>a()(kc,{spaceStore:this.props.spaceStore,securitySettingsStore:this.stores.securitySettingsStore,userStore:this.props.userStore}),this.renderIdentityProvisioning=()=>a()(Ql,{spaceStore:this.props.spaceStore,samlConfigStore:this.stores.samlSettingsStore,domainSettingsStore:this.stores.spaceDomainSettingsStore,userStore:this.props.userStore}),this.renderAdminContentSearch=()=>a()(fn,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),this.renderIntegrations=()=>a()(Ho,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),this.renderNewFeaturePrompt=()=>{if(this.shouldRenderAnalyticsPrompt()){const{currentSpaceStore:e}=I.default.state,t=null!=e&&e.canAdmin()?a()(f.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.workspaceOwner",defaultMessage:"Explore how members & guests are engaging with this workspace, common searches that are made, and content engagement metrics with workspace analytics.",description:"Caption message for the workspace analytics prompt for workspace owners."}):a()(f.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.member",defaultMessage:"See how your content is performing by reviewing metrics like number of views or unique visitors using workspace analytics.",description:"Caption message for the workspace analytics prompt for members."});return a()(Qo,{onDismiss:()=>C.TY(this.environment),onClick:()=>{this.attemptCloseCurrentTab((()=>{be.Z.setState({...be.Z.state,currentTab:"analytics",defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),b.XI1(this.environment,{tab:"analytics"})}))},onClickLearnMore:()=>{const e=(0,W.UY)("guides.workspaceAnalytics");w.navigateToExternalURL({environment:this.environment,url:e})},onView:C.pE,descriptionMessage:t,title:a()(f.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.title",defaultMessage:"New workspace analytics",description:"Title message that shows for enterprise plans describing workspace analytics"}),buttonText:a()(f.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics",description:"Text on button CTA that redirects to the settings analytics tab when clicked"})})}},this.handleModalOpen=()=>{k.bi(this.environment),this.resetAuditLogSetting(),v.kj({environment:this.environment,spaceId:this.props.spaceStore.id,canAdmin:this.props.spaceStore.canAdmin()})},this.handleModalDismiss=()=>this.attemptCloseCurrentTab((()=>{be.Z.setState({...be.Z.state,open:!1}),le.reset(),this.stores.spaceDomainSettingsStore.reset(),this.resetAuditLogSetting(),we.Z.reset()}))}willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{securitySettingsStore:i}=this.stores,n=i.getValueForSpace(t);n&&i.setState(n)}willMountOrUpdate(e){super.willMountOrUpdate(e);const{open:t}=be.Z.state,i=be.Z.state;this.lastSpaceSettingsModalStoreOpen===t&&l().isEqual(this.lastSpaceSettingsStoreState,i)||t&&b.SUq(this.environment,{tab:i.currentTab}),this.lastSpaceSettingsModalStoreOpen=t,this.lastSpaceSettingsStoreState=l().clone(i)}renderComponent(){const{open:e}=be.Z.state;return a()($o.Z,{open:e,innerStyle:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:715},onOpen:this.handleModalOpen,onDismiss:this.handleModalDismiss,render:this.renderContent,className:L.zYS})}renderSidebar(){const{spaceStore:e}=this.props,{data:t}=Se.default.state,i=K.wY(t),n=(0,Xo.mS)(),o=xm().length>0,s=e.canAdmin();return a()("div",{style:Uf.sidebarStyle},void 0,a()("div",{style:Uf.sidebarTabsStyle},void 0,a()("div",{},void 0,a()("div",{style:this.getSidebarHeader()},void 0,a()(f.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Account"})),this.renderUserDetails(),this.renderTabButton("profile"),this.renderTabButton("notifications_and_settings"),this.renderTabButton("connected_apps"),this.renderTabButton("language_and_region"),t&&t.creditEnabled&&!e.canAdmin()&&!N.default.checkGate("goodbye_credits")&&this.renderTabButton("credit"),o&&this.renderTabButton("debug_zone"),a()(Fo.Z,{size:18,isHidden:!0}),a()("div",{style:this.getSidebarHeader()},void 0,a()(f.FormattedMessage,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})),this.renderTabButton("settings"),e.canAdmin()&&(0,_.bq)()&&this.renderTabButton("teams"),e.canRead()&&this.renderTabButton("members"),this.shouldRenderAnalyticsTab()&&this.renderTabButton("analytics"),e.canRead()&&this.renderTabButton("plans"),e.canAdmin()&&t&&("subscribed_admin"===t.type||"unsubscribed_admin"===t.type)&&!i&&this.renderTabButton("billing"),i&&this.renderTabButton("subscription"),e.canAdmin()&&this.renderTabButton("security"),e.canAdmin()&&this.renderTabButton("identity_provisioning"),this.shouldRenderAdminContentSearchTab()&&this.renderTabButton("admin_content_search"),s&&this.renderTabButton("integrations"),(0,R.c)()&&!this.environment.device.isMobile&&a()("span",{onClick:()=>{const e=(0,p.ZP)();ne.Z.setState({flowId:e}),b.Syn(this.environment,{from:"settings",flowId:e})}},void 0,this.renderTabButton("imports")),this.shouldRenderAuditLog()&&this.renderTabButton("audit_log"),n&&this.renderTabButton("experiments"),e.canRead()&&a()(oo.Z,{source:"settings"}),e.canRead()&&!(0,g.E3)(null==t?void 0:t.addOns)&&a()(Ce.Z,{source:"settings"}))),this.renderNewFeaturePrompt())}renderUserDetails(){const e=(0,D.B7)(this.environment),t={size:20,hasTooltip:!0,avatarShouldShowShadow:!0,userStore:e};return a()("div",{style:{display:"flex",alignItems:"center",height:44,paddingLeft:12,paddingRight:12}},void 0,a()("div",{style:this.getIconWrapStyle()},void 0,d.createElement(Ht.Z,t)),e?a()("div",{},void 0,this.renderUserName(e),e.getEmail()&&a()(xe.Z,{isSmall:!0},void 0,e.getEmail())):a()(f.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.userDetails.title",defaultMessage:"Me",description:"Title for current user detail in the personal setting sidebar"}))}renderUserName(e){const t=V.default.getIntl(),i=e.getFullName(t);return i&&a()(xe.Z,{style:{fontWeight:h.Z.fontWeight.medium}},void 0,i)}renderTabButton(e){const t=be.Z.state.currentTab===e,i=Em[e](this.environment),n=Dm[e](),o=Rm[e]();return a()(Mi.Z,{hovered:t,style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:12,paddingRight:12,borderRadius:3,marginTop:1,marginBottom:1,minHeight:27},onClick:i=>{t||this.attemptCloseCurrentTab((()=>{be.Z.setState({...be.Z.state,currentTab:e,defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),b.XI1(this.environment,{tab:e})}))}},void 0,a()("div",{style:{display:"flex",alignItems:"center",...t&&{fontWeight:h.Z.fontWeight.semibold}}},void 0,a()("div",{style:this.getIconWrapStyle()},void 0,i),a()(xe.Z,{isMultiline:!0},void 0,n),o),this.renderTabDot(e))}async attemptCloseCurrentTab(e){const{spaceStore:t}=this.props,{spaceProfileSettingsStore:i}=this.stores,{currentUserStore:n,currentUserSettingsStore:o}=I.default.state;if(!n||!o)throw new Error("No user or settings store.");const s=a()(f.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),r=a()(f.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes",description:"Label for button that appears below the question, 'Your changes have not been saved. Save changes?' to confirm that the user would like to save their changes."}),d=a()(f.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No",description:"Label for button that appears below the question, 'Your changes have not been saved. Save changes?' to not save changes and return to settings menu."}),{currentTab:c}=be.Z.state;if("profile"===c){if(!l().isEqual(i.state,i.getValueForUser(n,o,V.default.getIntl()))){const{profilePhoto:t,name:n,startDayOfWeek:r}=i.state;return n?S.showDialog({message:s,showCancel:!0,keepFocus:!0,items:[{label:a()(f.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{B.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{const{currentUserStore:i}=I.default.state;if(i&&y.A({userStore:i,data:{name:n,profilePhoto:t},transaction:e}),o){const t=o.getSettings();(null==t?void 0:t.start_day_of_week)!==r&&E.d2({userSettingsStore:o,data:{start_day_of_week:r},transaction:e})}}}),e()}}],handleCancel:()=>{e()}}):S.showErrorMessage(a()(f.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}e()}else if("settings"===c&&t.canEdit()){const{spaceBasicSettingsStore:i}=this.stores,{securitySettingsStore:n}=this.stores,a=!l().isEqual(n.state,n.getValueForSpace(t)),o=!l().isEqual(i.state,i.getValueForSpace(t));if(a||o){if(await S.confirmUserAction({message:s,acceptLabel:r,cancelLabel:d})){if(!(await M.Y5({environment:this.environment,spaceId:t.id,spaceBasicSettingsStore:i})))return!1;o&&M.OF({environment:this.environment,spaceStore:this.props.spaceStore,spaceBasicSettingsStore:i}),a&&this.updateSecuritySettingsStore(n),e()}else e();return!0}e()}else if("audit_log"===c)this.resetAuditLogSetting(),e();else if("analytics"===c)ue.reset(),e();else if("plans"===c&&t.canAdmin()){const{securitySettingsStore:i}=this.stores,n=i.getValueForSpace(t);!l().isEqual(i.state,i.getValueForSpace(t))&&n&&(i.setState(n),this.updateSecuritySettingsStore(i)),e()}else"teams"===c?(x.Z.reset(),F.reset(),e()):e();return!1}resetAuditLogSetting(){J.reset(),ie.reset()}updateSecuritySettingsStore(e){const{disablePublicAccess:t,disableGuests:i,disableMoveToSpace:n,disableExport:a,disableSpacePageEdits:o,disablePublicAccessRequests:s,disableTeamCreation:r,disableMembershipRequests:l,disableGuestMembershipRequests:d,enableAiFeature:c,disableTeamGuests:u}=e.state;B.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{M.Xr({environment:this.environment,disablePublicAccess:t,disableGuests:i,disableMoveToSpace:n,disableExport:a,disableSpacePageEdits:o,disablePublicAccessRequests:s,transaction:e,spaceStore:this.props.spaceStore,disableTeamCreation:r,disableMembershipRequests:l,disableGuestMembershipRequests:d,enableAiFeature:Boolean(c),disableTeamGuests:u})}})}getSidebarHeader(){return{fontSize:12,lineHeight:1,marginBottom:1,color:this.theme.mediumTextColor,fontWeight:h.Z.fontWeight.semibold,alignItems:"center",display:"flex",height:24,paddingLeft:12,paddingRight:11,textOverflow:"ellipsis",overflow:"hidden"}}getIconWrapStyle(){return{width:20,height:20,marginRight:8,color:this.theme.regularIconColor,fill:this.theme.regularIconColor}}}Uf.displayName="SpaceSettings",Uf.theme=void 0,Uf.sidebarStyle={display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingTop:10,paddingLeft:4,paddingRight:4},Uf.sidebarTabsStyle={overflow:"auto",paddingBottom:12};const Wf=Uf},1063:(e,t,i)=>{i.d(t,{X:()=>u});var n=i(77094),a=i.n(n),o=(i(67294),i(480)),s=i(24405),r=i(5366),l=i(50906),d=i(8323),c=i(42402);function u(e){window.__c={n:"StartupCouponInlineTextLink"};const t=(0,o.O7)(),i=(0,s.yK)((()=>({couponLink:{fontSize:12}})),[]);return a()(c.Z,{href:"https://notionup.typeform.com/to/qYXezfBW",external:!0,style:i.couponLink,onClick:()=>{const i=(0,d.zt)();l.sS1(t,{tier:e.tier,currentTier:i})}},void 0,a()("div",{},void 0,a()(r.FormattedMessage,{id:"startupCouponInlineLink.text",defaultMessage:"Are you a startup?",description:"Shown in our billing/upgrade settings to ask if a user's workspace belongs to a startup."})))}},13787:(e,t,i)=>{i.r(t),i.d(t,{default:()=>C});var n=i(77094),a=i.n(n),o=i(67294),s=i(83355),r=i(8848),l=i(3779),d=i(89101),c=i(82990),u=i(5366),p=i(54642),m=i(28020),g=i(33846),h=i(92083),f=i(9209),v=i(12318),y=i(42922),b=i(74194),S=i(22346),w=i(42402);class M extends s.Z{constructor(){super(...arguments),this.storeTypes={promoCodeStore:g.Z,promoError:v.default.of(void 0)},this.handleModalDismiss=()=>{f.Z.setState({open:!1})},this.handleChangeEmail=()=>{this.handleModalDismiss(),h.Z.setState({open:!0,currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})},this.handleInputChange=e=>{this.stores.promoCodeStore.setState({...this.stores.promoCodeStore.state,inputValue:e.target.value.toUpperCase()}),this.stores.promoError.set(void 0)},this.handleSubmitPromoCode=async()=>{const e=this.stores.promoCodeStore.state.inputValue;if(e){const t=await p.getPromoCode(this.environment,{code:e});"failed"!==t.type&&t.data.promo?f.Z.state.open&&(await f.Z.state.handlePromoCode(this.stores.promoCodeStore.state.inputValue),this.handleModalDismiss()):this.stores.promoError.set(this.props.intl.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:e}))}}}renderComponent(){const{open:e}=f.Z.state;return a()(S.Z,{open:e,innerStyle:M.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>this.renderModalContents(),onDismiss:this.handleModalDismiss})}renderModalContents(){return a()("div",{style:{fontSize:14}},void 0,a()("div",{},void 0,a()(u.FormattedMessage,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:a()("br",{}),p:e=>a()("p",{style:{marginTop:0,marginBottom:8}},void 0,1===e.length?e[0]:o.Children.toArray(e)),pricinglink:e=>a()(w.Z,{external:!0,href:d.AR.pricing},void 0,e)}})),this.renderSchoolEmailCodePrompt(),this.renderPromoCode(),this.renderContactUs())}renderSchoolEmailCodePrompt(){const e=(0,m.B7)(this.environment);return a()("div",{style:{display:"flex",marginTop:16}},void 0,a()("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor}},void 0,a()(u.FormattedMessage,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})),a()("div",{style:{flexGrow:1}},void 0,a()("div",{style:{color:this.theme.mediumTextColor}},void 0,a()(u.FormattedMessage,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})),a()("div",{style:{fontWeight:c.Z.fontWeight.medium,marginTop:0}},void 0,e&&e.getEmail()),a()("div",{style:{color:this.theme.mediumTextColor,marginTop:4}},void 0,a()(u.FormattedMessage,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})),a()(y.Z,{style:{marginTop:12},onClick:this.handleChangeEmail,isLarge:!0},void 0,a()(u.FormattedMessage,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"}))))}renderPromoCode(){const e=this.stores.promoError.get(),t=this.props.intl.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder",description:"Placeholder text to enter the promotion code for a student plan."});return a()("div",{style:{display:"flex",marginTop:16}},void 0,a()("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor}},void 0,a()(u.FormattedMessage,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})),a()("div",{style:{flexGrow:1}},void 0,a()("div",{style:{color:this.theme.mediumTextColor}},void 0,a()(u.FormattedMessage,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})),a()("div",{style:{display:"flex",marginTop:12}},void 0,a()(b.Z,{style:{marginRight:8,height:32},value:this.stores.promoCodeStore.state.inputValue,onChange:this.handleInputChange,onSubmit:this.handleSubmitPromoCode,placeholder:t}),a()(y.Z,{onClick:this.handleSubmitPromoCode,disabled:!this.stores.promoCodeStore.state.inputValue,isLarge:!0},void 0,a()(u.FormattedMessage,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"}))),a()("div",{style:{color:r.ZP.red,fontSize:12,marginTop:4,marginLeft:8,height:20}},void 0,e)))}renderContactUs(){return a()("div",{style:{display:"flex",alignItems:"center",color:this.theme.lightTextColor,borderTop:`1px solid ${this.theme.regularDividerColor}`,paddingTop:14}},void 0,l.Z.help({width:14,marginTop:1,marginRight:6,fill:this.theme.lightIconColor})," ",a()("div",{},void 0,a()(u.FormattedMessage,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>a()(w.Z,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0},void 0,e)}})))}}M.displayName="StudentNotEligibleModal",M.wrapStyle={padding:"24px 36px 24px",minWidth:300,maxWidth:400};const C=(0,u.injectIntl)(M)},6202:(e,t,i)=>{i.d(t,{Z:()=>p});var n=i(77094),a=i.n(n),o=(i(67294),i(83355)),s=i(8848),r=i(60709),l=i(42922),d=i(64921),c=i(28992);class u extends o.Z{renderComponent(){return a()(c.Z,{title:this.renderButton()})}renderButton(){const{isMobile:e}=this.environment.device;return e?a()(d.Z,{onClick:this.props.onClick,mobileFeedback:!0,disabled:this.props.disabled,style:u.buttonMobileStyle},void 0,this.props.title):a()(l.Z,{onClick:this.props.onClick,disabled:this.props.disabled,style:{width:"100%",maxWidth:300,display:"flex",margin:"auto"}},void 0,this.props.title)}}u.displayName="SubmitButtonMenuItem",u.contextTypes={...r.mw,...o.w},u.buttonMobileStyle={width:"100%",color:s.ZP.blue};const p=u},30676:(e,t,i)=>{i.d(t,{F:()=>u});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(81954),d=i(52275),c=i(93686);function u(e){window.__c={n:"TeamMenuItem"};const{teamStore:t}=e,{name:i}=(0,l.VK)((()=>({name:t.getName()})),[t]);return r.createElement(d.Z,a()({},e,{icon:s()(c.p,{size:14,store:t,disabled:!0}),title:i}))}},25112:(e,t,i)=>{i.r(t),i.d(t,{default:()=>g});var n=i(77094),a=i.n(n),o=(i(67294),i(480)),s=i(81954),r=i(51127),l=i(11302),d=i(19109),c=i(42330),u=i(44532),p=i(52358);function m(){window.__c={n:"MoveToMenuModal"};const e=(0,o.O7)(),t=(0,s.VK)((()=>{const e=c.ZP.state;if(e.isOpen)return{autocompleteQuery:e.autocompleteQuery,targets:e.targets,isAddTo:e.isAddTo,isOpen:e.isOpen}}),[]);if(void 0===t||!t.isOpen)return null;const i=()=>{l.xv(e)},{autocompleteQuery:n,targets:u,isAddTo:m}=t,g=e.device.isMobile;return a()(p.Z,{captureSelection:!0,restoreSelection:!g,autocompleteQuery:n,targets:u,onAutocompleteQueryChange:e=>{c.ZP.state.isOpen&&c.ZP.setState({...c.ZP.state,autocompleteQuery:e})},onAccept:async t=>{const n=c.ZP.state.isOpen&&c.ZP.state.targets||[],a=await(0,d.ed)({environment:e,blocks:n,from:"moveTo",moveToArgs:{moveToValue:t,destination:(0,d.uw)(t)}});if(!a.confirmed)return void i();for(const s of n){const t=await r.SC({environment:e,block:s,action:"move"});"user_canceled"===t?i():t.length>1&&c.ZP.state.isOpen&&c.ZP.setState({...c.ZP.state,targets:t})}const{shouldClearPagePermissions:o}=a;(async t=>{let{value:i,shouldClearPagePermissions:n}=t;await l.pB({environment:e,value:i,useSudoMode:c.ZP.state.isOpen&&c.ZP.state.useSudoMode,shouldClearPagePermissions:n})})({value:t,shouldClearPagePermissions:o})},onCancel:i,desktopWidth:330,isAddTo:m,isCreateIn:!1})}function g(){window.__c={n:"MoveToMenuRenderer"};const e=(0,o.O7)(),t=e.device.isMobile,i=(0,s.VK)((()=>{const e=c.ZP.state;if(e.isOpen)return{renderType:e.renderType,isOpen:e.isOpen,rect:e.rect}}),[]);return a()(u.ZP,{popupType:t?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,alignmentToOrigin:u.ZP.Alignment.Start,open:void 0!==i&&"mobileNative"!==i.renderType&&i.isOpen,render:()=>a()(m,{}),originRect:null==i?void 0:i.rect,onDismiss:()=>l.xv(e)})}g.displayName="MoveToMenuRenderer"},14072:(e,t,i)=>{i.r(t),i.d(t,{SearchStaticContext:()=>oa,SearchStoresContext:()=>sa,default:()=>la});var n=i(77094),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(83355),d=i(18466),c=i(15145),u=i(12174),p=i(4615),m=i(70203),g=i(63143),h=i(50906),f=i(5978),v=i(87531),y=i(74647),b=i(95477),S=i(73744),w=i(69988),M=i(22889),C=i(98165),k=i(65598),T=i(80084),_=i(23537),I=i(27832),x=i(10161),Z=i(32470),P=i(55320),F=i(49085),A=i(92338),B=i(62965),E=i(29026);class D extends F.Z{getInitialState(){return{localResults:void 0,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,serverResultsAllLoaded:!1,errorState:R,selectedQueryResultQuery:void 0}}setState(e){const t={...this.instanceState};if(!(0,B.Z)(this.instanceState,t))return;const i=function(e){const{newState:t,priorState:i}=e,{localResults:n,serverError:a,serverResultsLoading:o,serverResults:s}=t,r=Boolean(n),l=o?void 0:a;if(!r&&o)return!i.errorState.isLoading&&i.errorState.showMajorError?i.errorState:{isLoading:o};if(r)return{hasLocalResults:r,serverError:l,isLoading:!1,showMajorError:!1};if(l)return{hasLocalResults:r,serverError:l,isLoading:!1,showMajorError:!0};if(0===(null==s?void 0:s.results.length))return{hasLocalResults:r,serverError:A.Ix.NoResults,isLoading:!1,showMajorError:!0};return{hasLocalResults:r,serverError:l,isLoading:!1,showMajorError:!1}}({newState:e,priorState:t});super.setState({...e,errorState:i})}getResultCount(){const{serverResults:e,localResults:t}=this.state,i=(null==e?void 0:e.total)??(null==t?void 0:t.total)??0,n=Boolean(e&&i>=100);return{count:i,isLowerBound:Boolean(e&&t&&i<E.Xv)||n}}}const R={showMajorError:!1,isLoading:!1,hasLocalResults:!1,serverError:void 0};const L=D;var O=i(30857),N=i(87956),V=i(12318),U=i(9019),W=i(97464),z=i.n(W),K=i(480),q=i(81954),H=i(24405),G=i(29477),j=i(43250),$=i(60709),Y=i(59488),Q=i(59054),X=i(92994),J=i(21202),ee=i(97880),te=i(74487);const ie=Symbol("JSON Schema"),ne=Symbol("JSON Schema Components"),ae=Symbol("No JSON Schema"),oe={isNull:()=>({type:"null",[ne]:{}}),boolean:()=>({type:"boolean",[ne]:{}}),number:()=>({type:"number",[ne]:{}}),integer:()=>({type:"integer",[ne]:{}}),string:()=>({type:"string",[ne]:{}}),dateString:()=>({type:"string",format:"date",[ne]:{}}),literal:e=>({enum:[e],[ne]:{}}),literals:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return{enum:t,[ne]:{}}},uuid:()=>({type:"string",format:"uuid",[ne]:{}}),uuidWithoutDashes:()=>({type:"string",format:"uuid",[ne]:{}}),any:()=>re,array:e=>({type:"array",items:e[ie],[ne]:e[ie][ne]}),tuple:e=>({type:"tuple",items:!1,prefixItems:e.map((e=>e[ie])).filter((e=>e!==ae)),[ne]:Object.assign({},...e.map((e=>e[ie][ne])))}),record:(e,t)=>({type:"object",additionalProperties:t[ie],[ne]:t[ie][ne]}),object:e=>{let{required:t,optional:i,exact:n}=e;return{type:"object",properties:(0,g.m8)(Object.entries({...t,...i}).filter((e=>{let[t,i]=e;return i[ie]!==ae})).map((e=>{let[t,i]=e;return[t,i[ie]]}))),...n&&{additionalProperties:!1},...Object.keys(t).length>0&&{required:Object.keys(t)},[ne]:Object.assign({},...Object.values({...t,...i}).map((e=>e[ie][ne])))}},union:e=>({anyOf:e.map((e=>e[ie])).filter((e=>e!==ae)),[ne]:Object.assign({},...e.map((e=>e[ie][ne])))}),gte:(e,t)=>{const i=e[ie];return i!==ae?{...i,minimum:t}:i},lte:(e,t)=>{const i=e[ie];return i!==ae?{...i,maximum:t}:i},maxLength:(e,t)=>{const i=e[ie];if(i===ae)return i;if("type"in i){if("string"===i.type)return{...i,maxLength:t};if("array"===i.type)return{...i,maxItems:t}}throw new Error("Unknown type for max length.")},minLength:(e,t)=>{const i=e[ie];if(i===ae)return i;if("type"in i){if("string"===i.type)return{...i,minLength:t};if("array"===i.type)return{...i,minItems:t}}throw new Error("Unknown type for min length.")},nonEmpty:e=>{const t=e[ie];if(t===ae)return t;if("type"in t){if("string"===t.type)return{...t,minLength:1};if("object"===t.type)return{...t,minProperties:1};if("array"===t.type)return{...t,minItems:1}}throw new Error("Unknown non-emptyable type.")},nullable:e=>{const t=e[ie];if(t===ae)return t;if("type"in t)if(Array.isArray(t.type)){if("null"===t.type[1])return t;(0,ee.t1)(t.type[1])}else{if("string"===t.type)return{...t,type:[t.type,"null"]};if("object"===t.type)return{...t,type:[t.type,"null"]};if("array"===t.type)return{...t,type:[t.type,"null"]};if("tuple"===t.type)return{...t,type:[t.type,"null"]};if("boolean"===t.type)return{...t,type:[t.type,"null"]};if("integer"===t.type)return{...t,type:[t.type,"null"]};if("number"===t.type)return{...t,type:[t.type,"null"]};if("null"===t.type)return t;(0,ee.t1)(t.type)}else{if("const"in t)return{...t,enum:[t.const,null]};if("enum"in t)return{...t,enum:[...t.enum,null]};if("anyOf"in t)return{...t,anyOf:t.anyOf.map((e=>oe.nullable({[ie]:e})))};if("$ref"in t)return{anyOf:[t,{type:"null"}],[ne]:t[ne]};if(le(t))return t;(0,ee.t1)(t)}}},se=(0,g.m8)(Object.entries(oe).map((e=>{let[t,i]=e;return[t,function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return 1===n.length&&(0,ee.Kn)(n[0])&&("id"in n[0]||"description"in n[0])?function(){const{description:e,examples:a,id:o}=n[0];let s={description:e,...a&&{examples:a},...i(...arguments)};return o&&(s={$ref:`#/components/schemas/${o}`,[ne]:{...s[ne],[o]:s}}),{[ie]:s,...te[t](...arguments)}}:{[ie]:i(...n),...te[t](...n)}}]}))),re=(Symbol("Exact empty object ({})"),se.object({id:"emptyObject"})({required:{},optional:{},exact:!0}),{});function le(e){return(0,ee.Kn)(e)&&0===Object.keys(e).length}var de=i(68890),ce=i(88632),ue=i(85057);function pe(e){let{dependencies:t,debugColumnStore:i,localDebounce:n=25,serverDebounce:a=275,searchResultStore:o,localSearchCache:l,permanentFilterOverride:d,enabled:c}=e;const u=(0,K.O7)(),p=(0,q.VK)((()=>function(e){const{isOnline:t,debugColumnStore:i}=e,n=i.state.searchExperimentOverrides;function a(e){return(null==n?void 0:n[e])??x.default.getGroup(e,{disableExposureLogging:!0})}const o=t&&"log-nolocalrerank-norescore"!==a("search-ml-ranking")&&"log-nolocalrerank-rescore"!==a("search-ml-ranking")&&"on-log-signals"!==a("search-use-qwak");return{shouldSearchLocal:"on"!==a("search-no-local-blending")&&o,forcedClusterPattern:i.state.forcedClusterPattern,searchExperimentOverrides:i.state.searchExperimentOverrides,forcedBlockIds:i.state.forcedBlockIds}}({isOnline:t.isOnline,debugColumnStore:i})),[t.isOnline,i]),m=(0,r.useMemo)((()=>s().debounce(me,a)),[a]);(0,Q.r5)((()=>c?async function(e){const{query:t,openAsPage:i,store:n,fetchServerResultsFn:a}=e;if(i&&s().isEqual(t,n.state.selectedQueryResultQuery))return;const o="quick_find_scroll"!==E.ZP.state.source;n.update((e=>({...e,localResults:o?void 0:e.localResults}))),function(e){const{shouldSearchLocal:t,parentStore:i,environment:n,query:a,debug:o,limit:r,hasPublicAccessPermission:l,isOnline:d,localSearchCache:c,store:u,permanentFilterOverride:p,searchMode:m}=e;let g;const h={...a,filters:{...a.filters,...p}};if(t){var f;g=T.b9(function(e){const{parentStore:t,requestInput:i,isOnline:n,environment:a,hasPublicAccessPermission:o,localSearchCache:s,searchMode:r}=e,{query:l}=i;if(!s)return;if(!l.text.trim())return;if(o)return;const d=de.default.mark("rum.local_quick_search_query"),c="nav-local-only"===r?Number.MAX_VALUE:"nav-local-n-title"===r?5:void 0,u=T.Y_({query:i,localCachedPages:s,parentStore:t,environment:a,isOnline:n,shouldLimitLocalResultsWhenOnline:!0,applyScoreThresholdWhenOnline:!0,maxLocalResultsOverride:c});return de.default.measure(d,{environment:a}),u}({parentStore:i,environment:n,requestInput:{query:h,debug:o,limit:r},hasPublicAccessPermission:l,isOnline:d,localSearchCache:c,searchMode:m})),O.default.update((e=>({...e,numLocalRequests:e.numLocalRequests+1}))),s().isEmpty(null===(f=g)||void 0===f?void 0:f.results)&&function(e){const t=Boolean(e.localResults),i=Boolean(e.serverResults)&&!e.serverResultsLoading;return t||i||!1}(u.state)&&u.state.serverResultsLoading?u.update((e=>({...e,clearLocalResultsOnServerResponse:!0}))):u.update((e=>({...e,clearLocalResultsOnServerResponse:!1,localResults:g})))}}(e),await a(e)}({...t,...p,store:o,fetchServerResultsFn:m,environment:u,localSearchCache:l,permanentFilterOverride:d}):Promise.resolve()),[t,p,o,m,u,l,d,c],{debounce:n})}async function me(e){let{parentStore:t,environment:i,query:n,debug:a,isOnline:o,publicAccessPermissionAncestorBlockId:r,currentSpaceStore:l,searchSessionId:d,searchExperimentOverrides:c,forcedClusterPattern:u,recentPagesForBoosting:p,store:m,forcedBlockIds:h,limit:f,permanentFilterOverride:v}=e;const y={query:{...n,filters:{...n.filters,...v}},debug:a,limit:f};m.update((e=>({...e,serverResultsLoading:!0}))),O.default.update((e=>({...e,numServerRequests:e.numServerRequests+1})));const b=m.state.serverResults,S=E.ZP.state.source,w=await async function(e){const{parentStore:t,requestInput:i,isOnline:n,environment:a,publicAccessPermissionAncestorBlockId:o,searchSessionId:s,searchSessionFlowNumber:r,source:l,spaceId:d,searchExperimentOverrides:c,forcedClusterPattern:u,recentPagesForBoosting:p,forcedBlockIds:m}=e,{query:h}=i;if(!h.text.trim()&&!T.FN(h.filters))return;if(!n)return{error:A.Ix.Offline};const f=de.default.mark("rum.server_quick_search_query"),v=await T.MS({environment:a,input:i,spaceId:d,publicAccessPermissionAncestorBlockId:o,searchSessionId:s,searchSessionFlowNumber:r,source:l,searchExperimentOverrides:c,forcedClusterPattern:u,recentPagesForBoosting:"on"===(null==c?void 0:c["search-debug-only-no-recent-boosting"])?[]:p,forcedBlockIds:m});if(!v)return;if("failed"===v.type)return v.offline?{error:A.Ix.Offline}:{error:A.Ix.RequestFailed};const y=v.data.trackEventProperties,b=le(y)?{}:(0,g.m8)((0,ee.Yd)(y).map((e=>[`server-${e}`,y[e]]))),S=v.data.results.map(((e,i)=>({...e,originalPosition:i,store:ue.G.createChildStore(t,{table:J.iU,id:e.id})})));return de.default.measure(f,{environment:a}),{value:{results:S,total:v.data.total,debugInfo:v.data.debug,serverEventProperties:b,clusterInfo:v.data.clusterInfo}}}({parentStore:t,environment:i,requestInput:y,spaceId:null==l?void 0:l.id,searchSessionId:d,searchSessionFlowNumber:O.default.state.numServerRequests,publicAccessPermissionAncestorBlockId:r,isOnline:o,source:S,searchExperimentOverrides:c,forcedClusterPattern:u,recentPagesForBoosting:p,forcedBlockIds:h}),M={query:{...E.ZP.state.query,filters:{...E.ZP.state.query.filters,...v}},limit:E.ZP.state.limit,debug:Z.ZP.getDebugLevel()};if(!s().isEqual(y,M))return;const C=T.b9(w),k="quick_find_scroll"===S?T.Nu({existingResults:b,newPageResults:C}):C;if(w&&!w.error){const e=w.value.results;m.update((t=>({...t,serverError:null==w?void 0:w.error,serverResultsLoading:!1,serverResults:k,serverResultsAllLoaded:e.length<f,serverEventProperties:w.value.serverEventProperties,localResults:t.clearLocalResultsOnServerResponse?void 0:t.localResults,clearLocalResultsOnServerResponse:!1})))}else m.update((e=>({...e,serverError:null==w?void 0:w.error,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,localResults:e.clearLocalResultsOnServerResponse?void 0:e.localResults,clearLocalResultsOnServerResponse:!1})))}const ge={taskDB:{ancestors:["e02ed201-e893-4279-8bac-6b872dabf955"]},projectsDB:{ancestors:["37cedb80-b4aa-4674-b0b3-1e8c67f0be86"]},docsDB:{ancestors:["e6dce471-f27c-43fb-b28e-40d293f86f8c"]},searchTeam:{ancestors:["a02dd678-839d-4a63-9b74-a37f11df723f"]}};function he(){const e=(0,K.O7)(),t=(0,K.Fy)(),{searchResultStore:i,secondarySearchResultStore:n,searchCreatedByMeResultStore:a,searchTaskDBResultStore:o,searchProjectsResultStore:s,searchDocsResultStore:l,searchSearchTeamResultStore:d}=(0,r.useContext)(oa),{parentStore:c}=(0,r.useContext)(sa),u=(0,X.a)("search-two-step-ui"),p="development"===b.Z.env&&"control"!==u,m=function(e){const t=(0,K.O7)();return(0,q.VK)((()=>{const{hasPublicAccessPermission:i,publicAccessPermissionAncestorBlockId:n}=T.bC(t);return{isOnline:Boolean(ce.Z.state.online),limit:E.ZP.state.limit,parentStore:e,hasPublicAccessPermission:i,publicAccessPermissionAncestorBlockId:n,currentSpaceStore:I.default.state.currentSpaceStore,debug:Z.ZP.getDebugLevel(),openAsPage:P.default.state.openAsPage,recentPagesForBoosting:E.ZP.state.recentPagesForBoosting,searchSessionId:P.default.state.sessionId,searchMode:P.default.state.searchMode,currentSpaceViewStore:I.default.state.currentSpaceViewStore,query:E.ZP.state.query}}),[t,e])}(c),g=(0,q.VK)((()=>Boolean((0,Z.gq)({device:t})&&Z.BJ.state.visible)),[t]),[{value:h}]=(0,Q.r5)((()=>m.hasPublicAccessPermission?Promise.resolve(void 0):m.currentSpaceStore?T.hb({environment:e,currentSpaceStore:m.currentSpaceStore,currentSpaceViewStore:m.currentSpaceViewStore,excludeCurrentPage:!0}):Promise.resolve(void 0)),[e,m.currentSpaceStore,m.currentSpaceViewStore,m.hasPublicAccessPermission]);pe({dependencies:m,searchResultStore:i,localSearchCache:h,debugColumnStore:Z.v_,enabled:!0}),pe({dependencies:m,searchResultStore:n,localSearchCache:h,debugColumnStore:Z.BJ,enabled:g});const f=(0,q.VK)((()=>{var e;const t=null===(e=I.default.state.currentUserRootStore)||void 0===e?void 0:e.id;return{createdBy:t?[t]:[]}}),[]);pe({dependencies:m,searchResultStore:a,localSearchCache:h,debugColumnStore:Z.v_,permanentFilterOverride:f,enabled:p}),pe({dependencies:m,searchResultStore:o,localSearchCache:h,debugColumnStore:Z.v_,permanentFilterOverride:ge.taskDB,enabled:p}),pe({dependencies:m,searchResultStore:s,localSearchCache:h,debugColumnStore:Z.v_,permanentFilterOverride:ge.projectsDB,enabled:p}),pe({dependencies:m,searchResultStore:l,localSearchCache:h,debugColumnStore:Z.v_,permanentFilterOverride:ge.docsDB,enabled:p}),pe({dependencies:m,searchResultStore:d,localSearchCache:h,debugColumnStore:Z.v_,permanentFilterOverride:ge.searchTeam,enabled:p})}var fe=i(69454),ve=i(36488),ye=i(56940),be=i(78140),Se=i(40721),we=i(37770),Me=i(22715),Ce=i(3779),ke=i(53772),Te=i(82990),_e=i(5366),Ie=i(61766),xe=i(23063),Ze=i(64921),Pe=i(52275),Fe=i(31945),Ae=i(12508),Be=i(89728),Ee=i(72495),De=i(93481),Re=i(84619),Le=i(49044),Oe=i(33929),Ne=i(15447),Ve=i(31278),Ue=i(11470),We=i(76798),ze=i(255),Ke=i(85567),qe=i(98707);const He=(0,_e.defineMessages)({searchPages:{defaultMessage:"Search pages",id:"searchPageFilter.searchTokenFilter.tokenInput.placeholder"},selectAPage:{defaultMessage:"Select a page",id:"searchPageFilter.searchTokenFilter.resultSection.title"}});class Ge extends l.Z{constructor(){super(...arguments),this.renderFilterListItem=(e,t)=>{let{disabled:i,onRemove:n,onClick:o}=t;const s=this.styles,r=this.createBlockStore(e),l=a()(ze.Z,{disabled:i,onClick:n});return a()(Ue.Z,{disabled:i,focused:!1,store:r,right:l,style:s.menuItem,desktopTitleStyle:s.menuItemTitle,onClick:o})},this.renderItemForSummary=e=>a()(We.ZP,{store:this.createBlockStore(e),shouldWrap:!0,maxLength:50}),this.renderToken=(e,t)=>{const{blockIds:i}=this.props,n=this.tokenStyles,o=1===i.length,s=this.createBlockStore(e),r=a()("div",{style:n.token},void 0,a()(Ve.Z,{disabled:!0,icon:s.getIcon(),isEmptyPage:!1,size:20,style:n.icon}),a()(We.ZP,{store:s}));return a()(Ke.Z,{format:this.environment.device.isMobile?Re.l.Large:Re.l.Small,value:r,showRemoveButton:!0,onClickRemove:t.onRemove,isSingle:o,shouldShrink:!0,backgroundColor:"transparent",shouldWrap:!1},e)},this.renderResultMenuItem=(e,t)=>{const i=this.createBlockStore(e);return r.createElement(Ue.Z,z()({},t,{key:e,store:i}))},this.performRequest=async e=>{let{query:t,current:i}=e;const{currentSpaceStore:n}=I.default.state;if(!n)return[];const a=t?(await Le.nJ({environment:this.environment,query:t,limit:20,spaceId:n.id,requireEditPermissions:!1,excludeTemplates:!1,source:"ancestor_filter_page_search",boostRecentlyViewedPages:!0})).results:Ne.X4.state.map((e=>e.pageId)),o=new Set(i);return a.filter((e=>!o.has(e)))},this.createBlockStore=e=>{const{parentStore:t}=this.props;return ue.G.createChildStore(t,{table:J.iU,id:e})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{fill:"currentColor"}},this.tokenStyles={token:{display:"flex",alignItems:"center"},icon:{marginRight:4}}}renderComponent(){const{mode:e,title:t,blockIds:i,onChange:n,disabled:o,focused:s,onMenuDismiss:r}=this.props;return a()(qe.Z,{mode:e,hasItemsSelected:(null==i?void 0:i.length)>0,title:t,icon:Ce.Z.searchInPage,iconStyles:this.styles.recordIcon,items:i,onChange:n,focused:s,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:a()(_e.FormattedMessage,{defaultMessage:"Add another page",id:"searchPageFilter.searchTokenFilter.addAPage.button"}),labelText:{title:t,tokenInputPlaceholder:Oe.default.formatMessage(He.searchPages),componentDebugName:"SearchPageFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,disabled:o,onMenuDismiss:r})}}Ge.displayName="SearchPageFilter";const je=Ge;var $e=i(83890),Ye=i(29369),Qe=i(93044),Xe=i(30676);class Je extends l.Z{constructor(){super(...arguments),this.renderFilterListItem=(e,t)=>{let{disabled:i,onRemove:n,onClick:o}=t;const s=this.styles,r=this.createTeamStore(e),l=a()(ze.Z,{disabled:i,onClick:n});return a()(Xe.F,{disabled:i,focused:!1,teamStore:r,right:l,style:s.menuItem,desktopTitleStyle:s.menuItemTitle,onClick:o},e)},this.renderItemForSummary=e=>this.createTeamStore(e).getName(),this.renderAvatarFactory=e=>{const t=e.getIcon();return e=>a()(Ve.Z,{disabled:!0,icon:t,isEmptyPage:!1,size:e})},this.renderToken=(e,t)=>{const{teamIds:i}=this.props,n=1===(null==i?void 0:i.length),o=this.createTeamStore(e);if(!o)return;const s=o.getName();return a()(Qe.ZP,{format:this.environment.device.isMobile?Qe.lP.Large:Qe.lP.Small,showRemoveButton:!0,isSingle:n,onClickRemove:t.onRemove,renderAvatar:this.renderAvatarFactory(o),title:s,style:{background:"transparent"}},e)},this.renderResultMenuItem=(e,t)=>{const i=this.createTeamStore(e);return r.createElement(Xe.F,z()({},t,{key:e,teamStore:i}))},this.performRequest=async e=>{var t;let{query:i,current:n}=e;const a=new Set(n),o=I.default.state.currentSpaceViewStore,s=I.default.state.currentSpaceStore,r=null===(t=I.default.state.currentUserStore)||void 0===t?void 0:t.id;if(!o||!s||!r)return[];const l=await(0,_.qX)({environment:this.environment,spaceStore:s,currentUserId:r});return(await Le.zf({query:i,spaceViewStore:o,teamStores:l})).filter((e=>!a.has(e.id))).slice(0,20).map((e=>e.id))},this.createTeamStore=e=>{const{parentStore:t}=this.props;return ue.zX.createChildStore(t,{table:Ye.e0,id:e})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:6,fill:"currentColor"}}}renderComponent(){const{mode:e,title:t,teamIds:i,onChange:n,disabled:o,focused:s,onMenuDismiss:r,intl:l}=this.props;return a()(qe.Z,{mode:e,title:t,icon:Ce.Z.openTeamSearch,iconStyles:this.styles.recordIcon,items:i||[],onChange:n,disabled:o,focused:s,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:a()(_e.FormattedMessage,{defaultMessage:"Add a teamspace",id:"search.filterMenu.addATeamButton.label",description:"In-line help message in the search filter UI when one teamspace is selected for filtering search results and the user wants to add another teamspace (filter)"}),labelText:{title:t,tokenInputPlaceholder:l.formatMessage({defaultMessage:"Search teamspaces",id:"search.filterMenu.searchTeams.placeholder",description:"Placeholder text for a search box for teamspace names in search filters"}),componentDebugName:"SearchTeamFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,onMenuDismiss:r,hasItemsSelected:Boolean(i&&(null==i?void 0:i.length)>0)})}}Je.displayName="SearchTeamFilter";const et=(0,_e.injectIntl)(Je);var tt=i(55811),it=i(86825),nt=i(75689),at=i(91642);class ot extends l.Z{constructor(){super(...arguments),this.handleToggle=()=>{const{value:e,onChange:t}=this.props;t(!e)},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},sectionMenuItem:{display:"flex"}}}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){return a()(at.Z,{marginAfter:!1,style:this.styles.sectionMenuItem},void 0,this.renderSwitcherMenuItem(e))}renderMobile(e){const{title:t,value:i,disabled:n}=this.props;return e===qe.z.Button?this.renderSwitcherMenuItem(e):a()(nt.Z,{disabled:n,onClick:this.handleToggle,label:t,isToggle:!0,isToggleActive:i})}renderSwitcherMenuItem(e){const{title:t,icon:i,value:n,style:o,...s}=this.props,l=this.styles,d=this.getThemeColors(),c={...l.menuItem,...d.menuItem,...o};return e===qe.z.Pill?a()(tt.u,{on:n,hideChevron:!0,title:a()("span",{},void 0,t),onClick:this.handleToggle,icon:i(l.pillIcon)}):r.createElement(it.Z,z()({title:t,icon:i(l.icon),on:n,onClick:this.handleToggle,style:c},s))}getThemeColors(){return{menuItem:{color:this.theme.mediumTextColor}}}}ot.displayName="SearchToggleFilter",ot.Mode=qe.z;const st=ot;var rt=i(8848),lt=i(9342);function dt(e){window.__c={n:"SearchExperimentFilterPopupButton"};const t=(0,K.Fy)();return a()(Fe.Z,{popupType:t.isMobile?Fe.Z.PopupType.SlideUp:Fe.Z.PopupType.Popup,renderOrigin:t=>r.createElement(ut,z()({events:t},e)),render:t=>r.createElement(ct,z()({parent:t},e))})}function ct(e){let{parent:t,experiment:i,searchExperimentOverrides:n,onChange:o}=e;window.__c={n:"SearchExperimentFilterMenu"};const s=(0,K.Fy)(),l=(0,H.yK)((()=>({menuOptionStyle:{color:rt.ZP.mediumTextColor}})),[]);let d;d=s.isMobile?{menuType:$.og.Modal,title:i.experimentId,right:a()(_e.FormattedMessage,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:t.close}:{menuType:$.og.Popup,width:250};const c=i.groups.map((e=>({key:e,action:n=>{o({experimentId:i.experimentId,group:e}),t.close()},render:(t,i)=>r.createElement(Pe.Z,z()({},t,{title:e,style:l.menuOptionStyle}))})));return r.createElement(be.Z,d,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:[{key:i.experimentId,render:e=>r.createElement(Ee.Z,e),items:c}]}))}function ut(e){let{experiment:t,events:i,searchExperimentOverrides:n}=e;window.__c={n:"SearchExperimentFilterMenuButton"};const o=(0,H.yK)((e=>({experimentGroupButtonChevronStyle:{width:10,fill:e.lightIconColor},experimentGroupButtonStyle:{overflowX:"hidden",justifyContent:"left",overflow:"hidden",marginLeft:6,color:e.mediumTextColor},rowContainer:{display:"flex",overflow:"hidden",flexDirection:"row"},groupCell:{overflow:"hidden",marginRight:4}})),[]);return r.createElement(Be.Z,z()({},i,{isSmall:!0,key:t.experimentId,style:o.experimentGroupButtonStyle}),a()("div",{style:o.rowContainer},void 0,a()("div",{style:o.groupCell},void 0,n[t.experimentId]||t.group),a()("div",{},void 0,Ce.Z.chevronDown(o.experimentGroupButtonChevronStyle))))}const pt=e=>({fontSize:14,lineHeight:1.2,color:e.mediumTextColor,marginRight:4,display:"flex",alignItems:"center",whiteSpace:"nowrap"}),mt=function(e){const{experiment:t}=e,{leftOverrides:i,rightOverrides:n,experimentDiffers:o,experimentAgreesButNondefault:s}=(0,q.VK)((()=>{const e=Z.v_.state.searchExperimentOverrides,i=Z.BJ.state.searchExperimentOverrides,n=(e[t.experimentId]??t.group)!==(i[t.experimentId]??t.group);return{leftOverrides:e,rightOverrides:i,experimentDiffers:n,experimentAgreesButNondefault:!n&&void 0!==i[t.experimentId]&&e[t.experimentId]!==t.group}}),[t]),l=(0,H.yK)((e=>({rowContainer:{backgroundColor:o?e.equationErrorPlaceholderBackground:s?e.accentColors.yellow[100]:void 0},titleCell:{...pt(e),maxWidth:180,textOverflow:"ellipsis",overflow:"hidden"}})),[s,o]),d=(0,r.useCallback)((e=>{const{experimentId:t,group:i,store:n}=e;n.setState({...n.state,searchExperimentOverrides:{...n.state.searchExperimentOverrides,[t]:i}})}),[]);return r.createElement(r.Fragment,null,a()("div",{style:{...l.titleCell,...l.rowContainer}},void 0,t.experimentId.replace("search-","")),a()("div",{style:l.rowContainer},void 0,a()(dt,{experiment:t,searchExperimentOverrides:i,onChange:e=>{d({...e,store:Z.v_})}})),a()("div",{style:l.rowContainer},void 0,a()(dt,{experiment:t,searchExperimentOverrides:n,onChange:e=>{d({...e,store:Z.BJ})}})))};var gt=i(42875),ht=i(89837);let ft;!function(e){e[e.Button=0]="Button",e[e.MenuItem=1]="MenuItem"}(ft||(ft={}));class vt extends l.Z{constructor(){super(...arguments),this.handleFilterClick=e=>{const{onMenuDismiss:t}=this.props;this.applyFilter(e),this.openSidebar(),t&&t()},this.applyFilter=e=>{E.ZP.updateFilters(e)},this.openSidebar=()=>{E.ZP.isSidebarOpen()||E.ZP.setState({...E.ZP.state,isSidebarOpen:!0})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},buttonFilter:{padding:"4px 8px",display:"flex",alignItems:"center",overflow:"hidden"},buttonText:{...Te.Z.textOverflowStyle},icon:{display:"inline-block",height:14,width:14,fill:"currentColor"},buttonIcon:{marginRight:6}}}renderComponent(){const{mode:e}=this.props;return e===ft.Button?this.renderAsButton():e===ft.MenuItem?this.renderAsMenuItem():void(0,ee.t1)(e)}renderAsButton(){const{icon:e,title:t,filter:i}=this.props,n=this.styles,o=this.getThemeColors();return a()(Ze.Z,{style:{...n.buttonFilter,...o.buttonFilter},onClick:()=>this.handleFilterClick(i)},void 0,e&&e({...n.icon,...n.buttonIcon}),a()("span",{style:n.buttonText},void 0,t))}renderAsMenuItem(){const{icon:e,title:t,filter:i,focused:n}=this.props,o=this.styles,s=this.getThemeColors(),r={...o.menuItem,...s.menuItem};return a()(Pe.Z,{icon:e&&e(o.icon),focused:n,title:t,onClick:()=>this.handleFilterClick(i),style:r})}getThemeColors(){const{device:e}=this.environment;return{menuItem:{color:e.isDesktop?this.theme.mediumTextColor:void 0,...this.props.isLastInSection&&{boxShadow:void 0}},buttonFilter:{color:this.theme.mediumTextColor}}}}vt.displayName="SearchFilterPreset",vt.Mode=ft;class yt extends l.Z{renderComponent(){const e=yt.getCurrentPageFilter();if(e)return r.createElement(vt,z()({icon:Ce.Z.searchInPage,title:a()(_e.FormattedMessage,{id:"search.filterMenu.quickFilters.inCurrentPage",defaultMessage:"In current page"}),filter:e},this.props))}static isActive(e){const t=yt.getCurrentPageFilter();if(!t)return!1;if(!t.ancestors)return!1;const i=t.ancestors[0];return-1!==e.ancestors.indexOf(i)}}yt.displayName="InCurrentPagePreset",yt.getCurrentPageFilter=()=>{const{mainEditorCurrentBlockStore:e}=I.default.state;if(e&&e.id)return{ancestors:[e.id]}};class bt extends l.Z{renderComponent(){const e=bt.getCurrentUserFilter(this.environment);if(e)return r.createElement(vt,z()({icon:Ce.Z.person,title:a()(_e.FormattedMessage,{id:"search.filterMenu.quickFilters.createdByMe",defaultMessage:"Created by me"}),filter:e},this.props))}static isActive(e,t){const i=bt.getCurrentUserFilter(e);if(!i)return!1;if(!i.createdBy)return!1;const n=i.createdBy[0];return-1!==t.createdBy.indexOf(n)}}bt.displayName="CreatedByMePreset",bt.getCurrentUserFilter=e=>{const{id:t}=e.currentUser;if(t)return{createdBy:[t]}};class St extends l.Z{renderComponent(){const e=St.getPastWeekFilter();if(e)return r.createElement(vt,z()({icon:Ce.Z.calendar,title:a()(_e.FormattedMessage,{id:"search.filterMenu.quickFilters.editedLastWeek",defaultMessage:"Edited last week"}),filter:e},this.props))}static isActive(e){const{lastEditedTime:t}=St.getPastWeekFilter();return s().isEqual(t,e.lastEditedTime)}}St.displayName="EditedLastWeekPreset",St.getPastWeekFilter=()=>({lastEditedTime:{starting:ht.Oo((0,gt.r)()),ending:ht.Lg((0,gt.r)())}});var wt=i(1743),Mt=i(74194);function Ct(e){const{leftValue:t,rightValue:i,setLeftValue:n,setRightValue:o,placeholder:s,label:l}=e,{titleCell:d,rightTitleCell:c,leftTitleCell:u}=(0,H.yK)((e=>{const n=pt(e);return{titleCell:n,rightTitleCell:{...n,color:i?n.color:e.lightTextColor,width:"95%"},leftTitleCell:{...n,color:t?n.color:e.lightTextColor,width:"95%"}}}),[t,i]),[p,m]=(0,r.useState)(i),[g,h]=(0,r.useState)(t);(0,r.useEffect)((()=>{void 0===i&&m(void 0),void 0===t&&h(void 0)}),[i,t]);const f=(0,r.useCallback)((()=>{o(p)}),[o,p]),v=(0,r.useCallback)((()=>{n(g)}),[n,g]),y=(0,r.useCallback)((e=>{m(e.target.value)}),[]),b=(0,r.useCallback)((e=>{h(e.target.value)}),[]);return r.createElement(r.Fragment,null,a()("div",{style:d},void 0,l),a()(wt.Z,{capture:!0,allowMenuList:!1},void 0,a()(Mt.Z,{style:u,onBlur:v,value:g,onChange:b,placeholder:s}),a()(Mt.Z,{style:c,onBlur:f,value:p,onChange:y,placeholder:s})))}let kt;!function(e){e.Button="Button",e.Section="Section"}(kt||(kt={}));class Tt extends l.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:Ie.Z},this.renderAddFilterOrigin=e=>{const t=this.styles;return r.createElement(Be.Z,z()({},e,{style:t.addFilterButtonMobile,icon:Ce.Z.filterCircled,isBlue:!0}),a()(_e.FormattedMessage,{defaultMessage:"Add filter",id:"search.addFilter.button.label"}))},this.renderAddFilterMenu=()=>a()(be.Z,{menuType:$.og.ActionSheet},void 0,this.renderSuggestedFilters(),a()(at.Z,{title:this.renderMoreFiltersTitle()},void 0,this.renderCreatedByFilter(qe.Z.Mode.Button),this.renderCreatedTimeFilter(qe.Z.Mode.Button),this.renderLastEditedTimeFilter(qe.Z.Mode.Button),this.renderAncestorFilter(qe.Z.Mode.Button),this.renderInTeamFilter(qe.Z.Mode.Button))),this.searchExperimentsToToggle=this.createComputedStore((()=>Object.entries(u.g6).map((e=>{let[t,i]=e;return{experimentId:t,experimentVersion:1,group:x.default.getGroup(t),groups:["control",...i]}})))),this.closeAddFilterMenu=()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})},this.callTitleFilterUpdateFns=e=>{E.ZP.updateFilters({navigableBlockContentOnly:e})},this.closeSidebar=()=>E.ZP.setState({...E.ZP.state,isSidebarOpen:!1}),this.styles={sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 440px",minHeight:400},sidebarHidden:{display:"none"},addFilterButtonMobile:{fontSize:this.props.isMobile?Te.Z.fontSize.UISmall.mobile:Te.Z.fontSize.UISmall.desktop,fontWeight:Te.Z.fontWeight.medium,marginRight:-8}}}renderComponent(){return this.props.isMobile?this.props.mode===kt.Button?this.renderAddButtonMobile():this.props.mode===kt.Section?this.renderActiveFiltersMobile():void(0,ee.t1)(this.props.mode):this.renderSidebar()}renderActiveFiltersMobile(){const{state:e}=E.ZP,t=T.De(e.query.filters);return a()(Ee.Z,{disableMobilePadding:!0,disableMobileBorders:!0},void 0,this.renderTitlesOnlyFilter(qe.z.Section),this.renderDeletedOnlyFilter(qe.z.Section),this.renderActiveFilters(t,qe.Z.Mode.Section))}renderAddButtonMobile(){const{buttonPopupStore:e}=this.stores;return a()(Fe.Z,{popupType:Fe.Z.PopupType.SlideUp,buttonPopupStore:e,renderOrigin:this.renderAddFilterOrigin,render:this.renderAddFilterMenu})}renderActiveFilters(e,t){return a()(r.Fragment,{},void 0,e.createdBy&&this.renderCreatedByFilter(t),e.createdTime&&this.renderCreatedTimeFilter(t),e.lastEditedTime&&this.renderLastEditedTimeFilter(t),e.ancestors&&this.renderAncestorFilter(t),e.inTeams&&this.renderInTeamFilter(t))}renderSuggestedFilters(){const{filters:e}=E.ZP.state.query,t=bt.isActive(this.environment,e),i=St.isActive(e),n=yt.isActive(e);if(!(t&&i&&n))return a()(at.Z,{title:a()(_e.FormattedMessage,{id:"search.filterMenu.quickFiltersSection.title",defaultMessage:"Quick filters"}),marginAfter:!0},void 0,!t&&a()(bt,{mode:ft.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!i&&a()(St,{mode:ft.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!n&&a()(yt,{mode:ft.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu,isLastInSection:!0}))}renderSidebar(){const e=this.styles,t=this.getThemeColors(),i={...e.sidebar,...t.sidebar,...!E.ZP.isSidebarOpen()&&e.sidebarHidden,flex:"0 0 360px"};return a()("aside",{style:i},void 0,a()(Ze.Z,{onClick:this.closeSidebar,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16,position:"absolute",top:10,right:10}},void 0,Ce.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})),this.renderDevToolsSection())}renderForcedClusterPatternInput(){return null}renderShowDebugInfoToggle(){return a()(st,{mode:qe.z.Button,focused:!1,title:"Show debug info",icon:Ce.Z.bot,value:Z.ZP.state.showDebugInfo,onChange:e=>{Z.ZP.setState({...Z.ZP.state,showDebugInfo:Boolean(e)})}})}renderShowDebugSearchToggle(){return a()(st,{mode:qe.z.Button,focused:!1,title:"Profile query",icon:Ce.Z.bot,value:"everything"===Z.ZP.state.debug,onChange:e=>{Z.ZP.setState({...Z.ZP.state,debug:e?"everything":void 0})}})}renderDevToolsSection(){if((0,ke.x)(b.Z))return a()(at.Z,{title:"Dev Tools"},void 0,a()(xe.Z,{isVisible:!0,animationStyle:{height:"100%"},render:()=>a()("div",{style:{overflow:"scroll"}},void 0,this.renderShowDebugInfoToggle(),this.renderShowDebugSearchToggle(),this.renderForcedClusterPatternInput(),a()(at.Z,{style:{marginTop:16},title:"Quick Switch"},void 0,a()(It,{title:"No local at all",searchExperimentOverrides:{"search-no-local-blending":"on","search-debug-only-no-recent-boosting":"on"}}),a()(It,{title:"No local results",searchExperimentOverrides:{"search-no-local-blending":"on"}}),a()(It,{title:"No local boosting",searchExperimentOverrides:{"search-debug-only-no-recent-boosting":"on"}}),a()(It,{title:"Vector only",searchExperimentOverrides:{"search-vectors":"on"}})),a()(at.Z,{style:{marginTop:16},title:"Dev Experiments",right:(0,Z.gq)({device:this.environment.device})&&a()(Be.Z,{onClick:()=>{Z.v_.reset(),Z.BJ.reset()},style:{paddingLeft:0,paddingRight:0,height:"unset"}},void 0,Ce.Z.sync({width:12}))},void 0,a()("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr 1fr",minWidth:"100%",maxWidth:"100%",paddingLeft:14}},void 0,a()("div",{}),a()("div",{}),a()(_t,{columnStore:Z.BJ}),this.searchExperimentsToToggle.state.map((e=>a()(mt,{experiment:e},e.experimentId))),a()(Ct,{leftValue:Z.v_.state.forcedClusterPattern,rightValue:Z.BJ.state.forcedClusterPattern,setLeftValue:Z.v_.updateForcedClusterPattern,setRightValue:Z.BJ.updateForcedClusterPattern,placeholder:"cluster-pattern",label:"forced cluster pattern"}),a()(Ct,{leftValue:Z.v_.state.forcedBlockIds,rightValue:Z.BJ.state.forcedBlockIds,setLeftValue:Z.v_.updateForcedBlockIds,setRightValue:Z.BJ.updateForcedBlockIds,placeholder:"block ids",label:"forced block ids"}))))}))}renderTitlesOnlyFilter(e){const{filters:t}=E.ZP.state.query;return a()(st,{mode:e,focused:!1,title:a()(_e.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only",description:"Label for only search titles toggle in search modal"}),icon:Ce.Z.typesTitle,value:t.navigableBlockContentOnly||!1,onChange:this.callTitleFilterUpdateFns})}renderDeletedOnlyFilter(e){const{filters:t}=E.ZP.state.query;return a()(st,{mode:e,focused:!1,title:a()(_e.FormattedMessage,{id:"search.filterMenu.deletedOnlyToggle.label",defaultMessage:"Deleted only",description:"Label for only match deleted content toggle in search modal"}),icon:Ce.Z.trash,value:t.isDeletedOnly||!1,onChange:this.createUpdateFunction("isDeletedOnly")})}renderMoreFiltersTitle(){return a()(_e.FormattedMessage,{id:"search.filterMenu.moreFiltersSection.title",defaultMessage:"More filters"})}renderAncestorFilter(e){const{filters:t}=E.ZP.state.query;return a()(sa.Consumer,{},void 0,(i=>{let{parentStore:n}=i;return a()(je,{mode:e,focused:!1,title:a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In",description:"Label for button that opens a modal to choose specific pages to search within"}),parentStore:n,blockIds:t.ancestors,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("ancestors")})}))}renderCreatedByFilter(e){const{filters:t}=E.ZP.state.query;return a()(sa.Consumer,{},void 0,(i=>{let{parentStore:n}=i;return a()($e.Z,{mode:e,focused:!1,title:a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.createdBy",defaultMessage:"Created by"}),parentStore:n,userIds:t.createdBy,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdBy")})}))}renderCreatedTimeFilter(e){const{filters:t}=E.ZP.state.query;return a()(De.Z,{mode:e,focused:!1,title:a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"}),icon:Ce.Z.calendar,value:t.createdTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdTime")})}renderLastEditedTimeFilter(e){const{filters:t}=E.ZP.state.query;return a()(De.Z,{mode:e,focused:!1,title:a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),icon:Ce.Z.calendar,value:t.lastEditedTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("lastEditedTime")})}renderInTeamFilter(e){if(!(0,_.bq)())return;const{filters:t}=E.ZP.state.query;return a()(sa.Consumer,{},void 0,(i=>{let{parentStore:n}=i;return a()(et,{mode:e,focused:!1,title:a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace",description:"Label for button that opens a teamspace picker to add teamspace restricts (filters) to search results"}),parentStore:n,teamIds:t.inTeams,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("inTeams")})}))}createUpdateFunction(e){return t=>E.ZP.updateFilters({[e]:t})}getThemeColors(){return{sidebar:{backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:`1px solid ${this.theme.regularDividerColor}`}}}}function _t(e){let{columnStore:t}=e;window.__c={n:"ExperimentColumnShowHeader"};const i=(0,q.VK)((()=>t.state.visible),[t]);return a()(Pe.Z,{icon:a()(Ae.Z,{checked:i,size:14,onClick:()=>t.update((e=>({...e,visible:!e.visible})))}),focused:!1,title:"Show",onClick:()=>t.update((e=>({...e,visible:!e.visible})))})}function It(e){let{title:t,searchExperimentOverrides:i}=e;return window.__c={n:"QuickSwitchSingleColumnButton"},a()(Pe.Z,{focused:!1,title:t,onClick:()=>{Z.BJ.update((e=>({...e,visible:!1}))),Z.v_.update((e=>({...e,searchExperimentOverrides:i})))}})}Tt.displayName="SearchFilterMenu";const xt=Tt;var Zt=i(15157),Pt=i(34859),Ft=i(79131),At=i(18647),Bt=i(76725),Et=i(19889),Dt=i(7928);function Rt(e){window.__c={n:"SearchFilterBarTitle"};const{filterUIName:t}=e,{parentStore:i}=(0,r.useContext)(sa),n=(0,q.VK)((()=>E.ZP.state.query.filters),[]),o=(0,H.yK)((e=>({title:{maxWidth:220,...Te.Z.textOverflowStyle}})),[]),l=(0,q.VK)((()=>{switch(t){case"personFilter":return function(e,t){const i=e.createdBy,n=Oe.default.getIntl(),a=s().compact(i.map((e=>{const i=ue.U6.createChildStore(t,{table:Et.KJ,id:e});return(0,Dt.Nz)(n,i.getModel())})));return(0,Bt.Z)(a,Vt)}(n,i);case"teamsFilter":case"dev_notInTeamFilter":return function(e,t){const i=e.inTeams;if(!i)return[];const n=s().compact(i.map((e=>ue.zX.createChildStore(t,{table:Ye.e0,id:e}).getName())));return(0,Bt.Z)(n,Vt)}(n,i);case"pageFilter":return Ut(n,i);case"dateFilter":return function(e){const t=Oe.default.getIntl(),i=Ot(e);if("createdTime"===i)return T._Q(e.createdTime,t);if("lastEditedTime"===i)return T._Q(e.lastEditedTime,t);return""}(n);case"pageFilter":case"dev_notInPageFilter":return Ut(n,i);case"titleToggle":return[];default:(0,ee.t1)(t)}}),[i,t,n]);return a()("div",{style:o.title},void 0,a()(_e.FormattedMessage,{defaultMessage:"{filterName}{colon} {filterOperator} {filterValues}",id:"search.filterBarFilter.title",values:{filterName:Lt(t),filterOperator:0===l.length?void 0:Nt(t,n),filterValues:l,colon:0===l.length?void 0:":"},description:"Filter bar pill titles, potentially containing a filter value preview."}))}function Lt(e){switch(e){case"personFilter":return a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.person",defaultMessage:"Created by",description:"Search filter by people who created the page"});case"teamsFilter":return a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace",description:"Label for button that opens a teamspace picker to add teamspace restricts (filters) to search results"});case"pageFilter":return a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In",description:"Label for button that opens a modal to choose specific pages to search within"});case"dateFilter":return a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.date",defaultMessage:"Date",description:"Search filter by some date"});case"titleToggle":return a()(_e.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only",description:"Label for only search titles toggle in search modal"});case"dev_notInPageFilter":return a()(_e.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInPageFilter.label",defaultMessage:"[dev] Not in page",description:"Exclude pages with the specified parents from search."});case"dev_notInTeamFilter":return a()(_e.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInTeamFilter.label",defaultMessage:"[dev] Not in teamspace",description:"Exclude pages in the specified teams from search."})}(0,ee.t1)(e)}function Ot(e){const t=T.VD.createdTime(e.createdTime),i=T.VD.lastEditedTime(e.lastEditedTime);return t?"createdTime":i?"lastEditedTime":void 0}function Nt(e,t){switch(e){case"personFilter":case"teamsFilter":case"pageFilter":case"dev_notInPageFilter":case"dev_notInTeamFilter":case"dateFilter":case"titleToggle":return}(0,ee.t1)(e)}const Vt=e=>", ";function Ut(e,t){const i=e.ancestors,n=s().compact(i.map((e=>{const i=ue.G.createChildStore(t,{table:J.iU,id:e});return i.isDefined()?i.getModel().getRenderTitle({getRecordModel:i.getRecordModel,userTimeZone:(0,gt.r)(),intl:Oe.default.getIntl()}):""})));return(0,Bt.Z)(n,Vt)}var Wt=i(41558),zt=i(3386),Kt=i(44532),qt=i(14871),Ht=i(83264);const Gt={today:a()(_e.FormattedMessage,{defaultMessage:"Today",id:"searchDateFilter.quickActions.today.label",description:"Filter search query results for documents edited or created today"}),pastWeek:a()(_e.FormattedMessage,{defaultMessage:"Last 7 days",id:"searchDateFilter.quickActions.last7Days.label",description:"Filter search query results for documents edited or created in the last 7 days"}),pastMonth:a()(_e.FormattedMessage,{defaultMessage:"Last 30 days",id:"searchDateFilter.quickActions.last30Days.label",description:"Filter search query results for documents edited or created in the last 30 days"})};function jt(e){let{date:t,onClick:i,onDismiss:n}=e;window.__c={n:"SearchQuickDateFilter"};const o=(0,gt.r)(),s=ht.Lg(o),r=s;let l;const d=Gt[t];"today"===t?l=s:"pastWeek"===t?l=ht.Oo(o):"pastMonth"===t?l=ht.dj(o):(0,ee.t1)(t);return a()(Pe.Z,{focused:!1,icon:Ce.Z.calendar({height:18,width:18}),title:d,onClick:e=>{i({value:{starting:{type:"date",start_date:l.start_date},ending:{type:"date",start_date:r.start_date}}}),n(e)}})}class $t extends l.Z{constructor(){super(...arguments),this.storeTypes={store:Wt.Z},this.renderPillButtonOrigin=()=>{const{icon:e,title:t}=this.props,{store:i}=this.stores,n=this.styles,{dateFilterType:o}=i.state,s=E.ZP.state.query.filters[o].starting;return a()(tt.u,{on:Boolean(s),icon:e(n.pillIcon),title:a()("span",{},void 0,t),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e}=this.props,{store:t}=this.stores;return r.createElement(r.Fragment,null,a()("div",{style:this.styles.dateFilterHeader},void 0,this.renderOperatorSelect(),a()(Ze.Z,{style:this.styles.clearButton,onClick:this.handleClear},void 0,a()(_e.FormattedMessage,{defaultMessage:"Clear",id:"searchDateFilter.clearButton.label",description:"Button to remove the current date range our search results are being filtered by"}))),a()("div",{style:this.styles.quickDatesWrapper},void 0,a()(jt,{date:"today",onClick:this.updateTemporary,onDismiss:this.handleMenuClose}),a()(jt,{date:"pastWeek",onClick:this.updateTemporary,onDismiss:this.handleMenuClose}),a()(jt,{date:"pastMonth",onClick:this.updateTemporary,onDismiss:this.handleMenuClose})),a()(Ht.Z,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:t,onDismiss:this.handleMenuClose,hideDateInputMenuItems:!0}))},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t}=this.stores;e||t.setState({...t.state,isOpen:!0,focus:"starting"})},this.handleMenuClose=e=>{const{onMenuDismiss:t}=this.props,{store:i}=this.stores,{temporaryDateRange:n,dateFilterType:a}=i.state;T.zD(e)||(this.updateFilter(a,n),i.setState({...i.state,isOpen:!1}),t&&t())},this.handleClear=()=>{const{store:e}=this.stores,{dateFilterType:t}=e.state;this.updateFilter(t,{starting:void 0,ending:void 0}),e.clearTemporaryDateRange()},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t}=this.stores;if(e.error)return;t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}});const{dateFilterType:i,temporaryDateRange:n}=t.state,{starting:a,ending:o}=n;a&&o&&this.updateFilter(i,{starting:a,ending:o})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},sectionMenuItem:{display:"flex"},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"},quickDatesWrapper:{marginTop:12,boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,paddingBottom:15,marginBottom:15},clearButton:{color:this.theme.mediumTextColor,fill:this.theme.lightIconColor,fontWeight:500,fontSize:13,paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:3,flexShrink:0},dateFilterHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginLeft:12,marginRight:12}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{store:t}=this.stores,i=this.styles;return a()(at.Z,{style:i.sectionMenuItem},void 0,a()(zt.Z,{capture:t.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey},void 0,a()(Kt.ZP,{popupType:this.getPopupType(),open:t.state.isOpen,origin:this.renderPillButtonOrigin(),render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:Kt.ZP.Placement.Bottom,alignmentToOrigin:Kt.ZP.Alignment.Start,keepFocus:!0,style:i.popup})))}updateFilter(e,t){E.ZP.updateFilters({[e]:t})}getHumanReadableDateFilterType(e){return{lastEditedTime:a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),createdTime:a()(_e.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"})}[e]}updateFilterFromToggle(e){const{value:t}=this.props,{store:i}=this.stores,{dateFilterType:n}=i.state;this.updateFilter(e,t),e!==n&&(this.updateFilter(n,{starting:void 0,ending:void 0}),i.setState({...i.state,dateFilterType:e}))}renderOperatorSelect(){const{device:e}=this.environment,{store:t}=this.stores,{dateFilterType:i}=t.state,n={width:190,items:["createdTime","lastEditedTime"],selectedItem:i,getKey:e=>e,onSelect:e=>this.updateFilterFromToggle(e),renderItem:e=>r.createElement(Pe.Z,z()({title:this.getHumanReadableDateFilterType(e.value)},e)),renderOrigin:t=>r.createElement(Ze.Z,z()({},t,{style:{paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:3,flexShrink:0}}),a()("div",{style:{display:"flex",alignItems:"center",...!e.isMobile&&{color:this.theme.mediumTextColor,fill:this.theme.lightIconColor,fontWeight:500,fontSize:13}}},void 0,a()("span",{style:{marginRight:4}},void 0,this.getHumanReadableDateFilterType(i)),this.renderOperatorChevron()))};return r.createElement(qt.Z,z()({},n,{mobileActionSheet:!0}))}renderOperatorChevron(){const{device:e}=this.environment;return Ce.Z.chevronDown({width:10,height:10,...e.isMobile&&{marginTop:2}})}renderMobile(e){const{store:t}=this.stores,i=e===qe.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return a()(Kt.ZP,{popupType:Kt.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:i,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:i}=this.props,n=this.styles;return a()(Pe.Z,{disabled:i,focused:!1,icon:e(n.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,dateFormat:i,disabled:n,intl:o}=this.props,s=this.styles,r=a()("div",{style:s.summary},void 0,Ce.Z.calendar(s.iconActiveMobile),T._Q(t,o,i));return a()(nt.Z,{disabled:n,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:r})}getCurrentValue(){const{store:e}=this.stores,{dateFilterType:t,temporaryDateRange:i}=e.state;return{...E.ZP.state.query.filters[t],...i}}getPopupType(){const{device:e}=this.environment;return e.isMobile?Fe.Z.PopupType.SlideUp:Fe.Z.PopupType.Popup}}$t.displayName="SearchGenericDateFilter";const Yt=(0,_e.injectIntl)($t);var Qt=i(28992),Xt=i(25464),Jt=i(54368);const ei=function(e){window.__c={n:"SearchSortMenu"};const t=r.useRef(),i=(0,K.Fy)(),{isMobile:n}=i,{activeOption:o,items:s}=r.useMemo((()=>function(e){const{currentSortBy:t,setSortBy:i,sortOptions:n,selectButton:a}=e;let o=n[0];const s=n.map((e=>{const n=t.field,s=`${n}.${"relevance"===n?"":t.direction}`,l=e.key===s;return l&&(o=e),{key:e.key,action:()=>{i(e.sort),a&&a.current&&a.current.closeMenu()},render:t=>r.createElement(Pe.Z,z()({},t,{title:e.formattedName,right:l&&Ce.Z.thinCheck({fill:rt.ZP.regularIconColor,width:14,height:14})}))}}));return{activeOption:o,items:s}}({...e,selectButton:t})),[e,t]),l=(0,H.yK)((e=>({selectedTitle:{color:e.mediumTextColor},label:{marginRight:2,fontSize:n?Te.Z.fontSize.UISmall.mobile:Te.Z.fontSize.UISmall.desktop,transform:"translateY(0.5px)"},innerButton:{color:e.mediumTextColor,fontWeight:Te.Z.fontWeight.semibold,fontSize:n?Te.Z.fontSize.UISmall.mobile:Te.Z.fontSize.UISmall.desktop,height:20,padding:"2px 4px",marginRight:1,transform:"translateY(0.5px)"},menu:{minWidth:200}})),[n]),d=n?a()(_e.FormattedMessage,{id:"search.sort.sortMenuTitle",defaultMessage:"Sort By"}):void 0;return r.createElement(Jt.Z,{ref:e=>{e&&(t.current=e)},alignmentToOrigin:Xt.v.Start,selectedTitle:a()("div",{style:l.selectedTitle},void 0,o.formattedName),label:void 0,renderMenuSections:()=>[{key:"searchSortOrder",render:e=>r.createElement(at.Z,z()({},e,{title:d,desktopStyle:l.menu,disableDesktopPadding:!1})),items:s}],labelStyle:l.label,innerButtonStyle:l.innerButton})};class ti extends l.Z{constructor(){super(...arguments),this.styles={menuItemMobile:{paddingBottom:0},titleWrapper:{flex:void 0,marginTop:-3,marginBottom:-1},showSidebarButton:()=>{const{device:e}=this.environment;return{padding:"0 4px",fontSize:e.isMobile?Te.Z.fontSize.UISmall.mobile:Te.Z.fontSize.UISmall.desktop,fontWeight:Te.Z.fontWeight.medium,borderRadius:3,height:20,lineHeight:"20px"}}}}renderComponent(){const{device:e}=this.environment,t=this.styles,i={...e.isMobile&&t.menuItemMobile},n=this.shouldAllowFilters()&&this.renderAddFilterButton();return a()(Qt.Z,{title:this.renderSortMenu(),right:n,textWrapperStyle:t.titleWrapper,style:i})}renderSortMenu(){const e=E.ZP.state.query.sort;if("string"!=typeof e)return a()(ei,{currentSortBy:e,setSortBy:e=>{E.ZP.setState({...E.ZP.state,query:{...E.ZP.state.query,sort:e}})},sortOptions:ii})}renderAddFilterButton(){const{device:e}=this.environment;if(e.isMobile)return a()(xt,{isMobile:!0,mode:kt.Button})}shouldAllowFilters(){const{isPublicPageSearch:e}=this.props;return!e}}ti.displayName="SearchHeader";const ii=[{key:"relevance.",formattedName:a()(_e.FormattedMessage,{id:"search.sort.sortOrder.bestMatches",defaultMessage:"Best matches"}),sort:{field:"relevance"}},{key:"lastEdited.desc",formattedName:a()(_e.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.newestFirst",defaultMessage:"Last edited: Newest first"}),sort:{field:"lastEdited",direction:"desc"}},{key:"lastEdited.asc",formattedName:a()(_e.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.oldestFirst",defaultMessage:"Last edited: Oldest first"}),sort:{field:"lastEdited",direction:"asc"}},{key:"created.desc",formattedName:a()(_e.FormattedMessage,{id:"search.sort.sortOrder.created.newestFirst",defaultMessage:"Created: Newest first"}),sort:{field:"created",direction:"desc"}},{key:"created.asc",formattedName:a()(_e.FormattedMessage,{id:"search.sort.sortOrder.created.oldestFirst",defaultMessage:"Created: Oldest first"}),sort:{field:"created",direction:"asc"}}],ni=ti;function ai(e){window.__c={n:"renderOrigin"};const t=E.ZP.state.query.sort,i=ii.find((e=>s().isEqual(e.sort,t)))??ii[0],n="relevance"===i.sort.field?a()(_e.FormattedMessage,{id:"search.sort.sortOrder.bestMatches.title",defaultMessage:"Sort",description:"Sort button title when search results are sorted on relevance"}):i.formattedName;return a()(tt.u,{disabled:!1,title:n,onClick:e.onClick,icon:Ce.Z.sort({width:16,marginRight:6,fill:"currentColor"})})}function oi(){window.__c={n:"renderSortOptions"};const e=E.ZP.state.query.sort,t=ii.findIndex((t=>s().isEqual(t.sort,e))),i=[];for(const n of ii)i.push({key:n.key,render:e=>r.createElement(Pe.Z,z()({},e,{title:n.formattedName})),action:()=>{E.ZP.setState({...E.ZP.state,query:{...E.ZP.state.query,sort:n.sort}})}});return a()(be.Z,{menuType:$.og.Popup},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:t<0?0:t,sections:[{key:"sortOptions",items:i,render:e=>r.createElement(Ee.Z,z()({},e,{disableDesktopPadding:!0}))}]}))}const si=function(){window.__c={n:"SearchSortButton"};const e=(0,H.yK)((()=>({popup:{paddingTop:12,paddingBottom:8}})),[]);return a()(Fe.Z,{popupType:Fe.Z.PopupType.Popup,renderOrigin:ai,render:oi,disabled:!1,placementToOrigin:Kt.ZP.Placement.Bottom,alignmentToOrigin:Kt.ZP.Alignment.Start,style:e.popup})},ri="SearchFilterSettings";function li(e){window.__c={n:"SearchFilterBar"};const t=(0,q.qz)(void 0,Ie.Z),{isMobile:i}=e,{parentStore:n}=(0,r.useContext)(sa),o=(0,K.O7)(),s=(0,q.VK)((()=>o.currentUser.id),[o]),l=(0,q.VK)((()=>E.ZP),[]),d=(0,q.Kw)(l),c=d.query.filters,u=(0,q.VK)((()=>(0,_.bq)()&&x.default.checkGate("enable_search_team_filter")),[]),p=(0,q.VK)((()=>P.default.state.searchMode),[]),m=("local"===b.Z.env||"development"===b.Z.env)&&"default"!==p,g=["default","full-content"].includes(p),h=(0,H.yK)((e=>({scroller:{display:"flex",alignItems:"center",paddingLeft:5,paddingRight:5,paddingTop:12,paddingBottom:10},barContainer:{display:"flex",alignItems:"center"},scrollerContainer:{position:"relative",flexGrow:0,overflow:"hidden"},draggableList:{display:"flex",flexShrink:0,marginLeft:6},divider:{boxShadow:e.buttonDivider,display:"flex"}})),[]),f=(0,r.useCallback)((e=>t=>l.updateFilters({[e]:t})),[l]),v=(0,r.useCallback)((()=>{t.setState({...t.state,open:!1})}),[t]),y=(0,r.useCallback)((()=>a()($e.Z,{mode:qe.z.Pill,focused:!1,title:a()(Rt,{filterUIName:"personFilter"}),parentStore:n,userIds:c.createdBy,onMenuDismiss:v,onChange:f("createdBy")})),[n,c.createdBy,v,f]),S=(0,r.useCallback)((()=>u&&a()(et,{mode:qe.z.Pill,focused:!1,title:a()(Rt,{filterUIName:"teamsFilter"}),parentStore:n,teamIds:c.inTeams,onMenuDismiss:v,onChange:f("inTeams")})),[n,c.inTeams,v,f,u]),w=(0,r.useCallback)((()=>a()(je,{mode:qe.z.Pill,focused:!1,title:a()(Rt,{filterUIName:"pageFilter"}),parentStore:n,blockIds:c.ancestors,onMenuDismiss:v,onChange:f("ancestors")})),[n,c.ancestors,v,f]),M=(0,r.useCallback)((()=>m?a()(je,{mode:qe.z.Pill,focused:!1,title:a()(Rt,{filterUIName:"dev_notInPageFilter"}),parentStore:n,blockIds:c.dev_excludedPages||[],onMenuDismiss:v,onChange:f("dev_excludedPages")}):null),[n,c.dev_excludedPages,v,f,m]),C=(0,r.useCallback)((()=>m?a()(et,{mode:qe.z.Pill,focused:!1,title:a()(Rt,{filterUIName:"dev_notInTeamFilter"}),parentStore:n,teamIds:c.dev_excludedTeams||[],onMenuDismiss:v,onChange:f("dev_excludedTeams")}):null),[n,c.dev_excludedTeams,v,f,m]),k=(0,r.useCallback)((()=>a()(Yt,{mode:qe.z.Pill,focused:!1,title:a()(Rt,{filterUIName:"dateFilter"}),icon:Ce.Z.calendar,value:c.lastEditedTime,onMenuDismiss:v})),[c.lastEditedTime,v]),T=(0,r.useCallback)((()=>g&&!i&&a()(st,{mode:qe.z.Pill,focused:!1,title:a()(Rt,{filterUIName:"titleToggle"}),icon:Ce.Z.title,value:c.navigableBlockContentOnly||!1,onChange:f("navigableBlockContentOnly")})),[g,c.navigableBlockContentOnly,f,i]);(0,r.useEffect)((()=>{const e=Zt.Z.get({userId:s,key:ri});e&&e.filterOrder&&l.updateFilterState(e)}),[s,l]);const I={titleToggle:T(),personFilter:y(),teamsFilter:S(),pageFilter:w(),dateFilter:k(),dev_notInPageFilter:M(),dev_notInTeamFilter:C()};const Z=(0,r.useCallback)((()=>a()("div",{style:h.divider},void 0,a()(si,{}))),[h.divider]);return a()("div",{style:h.barContainer},void 0,a()("div",{style:h.scrollerContainer},void 0,a()(At.Z,{type:Pt.Z.X,style:h.scroller,showLeftRightOverlay:!1},void 0,r.createElement(r.Fragment,null,Z()),r.createElement(r.Fragment,null,a()(Ft.ZP,{direction:"horizontal",keys:d.filterState.filterOrder,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,renderKey:e=>I[e],style:h.draggableList,onDrop:e=>function(e){const t={...d.filterState,filterOrder:e};Zt.Z.set({userId:s,key:ri,value:t}),l.updateFilterState(t)}(e)})))))}var di=i(99417),ci=i(29798),ui=i(75024),pi=i(77907),mi=i(68785),gi=i(22346),hi=i(63296),fi=i(33411);class vi extends F.Z{getInitialState(){return{open:!1}}}const yi=new vi;var bi=i(1800),Si=i(54642),wi=i(47307),Mi=i(64964),Ci=i(31194),ki=i(1310),Ti=i(16354),_i=i(43765),Ii=i(92660);const xi=(0,_e.defineMessages)({additionalInformationPlaceholder:{id:"SearchBadResultsForm.additionalInformation.placeholder",defaultMessage:"Any additional comments or context (e.g. ...)",description:"Text box for any freeform feedback describing why the search results are poor quality"},urlPlaceholder:{id:"SearchBadResultsForm.url.placeholder",defaultMessage:"Link to page you were looking for",description:"Hyperlink to the the search page the user was looking for"}}),Zi=e=>{window.__c={n:"SearchResultPicker"};const t=(0,H.Fg)(),i=(0,q.qz)(void 0,Ie.Z);return a()(Fe.Z,{popupType:Fe.Z.PopupType.Popup,buttonPopupStore:i,renderOrigin:e=>r.createElement(r.Fragment,null,r.createElement(Be.Z,z()({style:{width:"100%"}},e),a()(_i.Z,{title:"Select Result"}),Ce.Z.chevronDown({width:10,marginLeft:4,fill:t.lightIconColor}))),placementToOrigin:Ci.Iw.Bottom,alignmentToOrigin:Ci.lU.Start,render:t=>{var i;const n=[{key:"results",render:e=>r.createElement(Ee.Z,z()({},e,{topBorder:0!==e.index})),items:(null===(i=e.results)||void 0===i?void 0:i.map((i=>({key:i.id,render:e=>r.createElement(Ue.Z,z()({store:i.store,checkState:!1,hidePath:!0},e)),action:()=>{e.onSelect(i),t.close()}}))))||[]}],o={menuType:$.og.Popup,width:240};return r.createElement(be.Z,o,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:n}))}})};function Pi(){yi.reset()}const Fi=e=>{var t;let{searchStoreState:i,currentSpaceStore:n,serverResults:o,localResults:s,environment:r,experiments:l}=e;const d=yi.getState(),c=T.AX(o),u=T.AX(s),p={query:i.query,limit:i.limit,debug:"everything"},{publicAccessPermissionAncestorBlockId:m}=T.bC(r),g=T.gC({input:p,spaceId:null==n?void 0:n.id,publicAccessPermissionAncestorBlockId:m,source:"report_bad_search"});if(!g)return;const h=null===(t=document.getElementsByClassName("search-results-list")[0])||void 0===t?void 0:t.outerHTML,f="on"===(null==l?void 0:l["vector-search-vanilla-ltr"])||c.some((e=>e.sources.includes(A.vp.VectorDB)));f&&c.splice(0,-20);const v={queryText:i.query.text.trim(),apiRequest:g,serverResults:JSON.stringify(c,null,2),localResults:JSON.stringify(u,null,2),desiredUrl:d.desiredUrl,additionalInformation:d.additionalInformation,renderedHtml:h,experiments:JSON.stringify(l??{},null,2),isVectorSearchEnabled:f};Si.reportBadSearch(r,v).then((e=>{if("failed"===e.type)wi.showErrorMessage(a()("h1",{},void 0,"Failed to submit report"));else{const{url:t}=e.data;Mi.oV({label:a()("div",{},void 0,a()(Ti.Z,{href:t},void 0,"Your report has been submitted, thanks!")),durationMs:ki.JY})}})),yi.reset()},Ai=function(e){window.__c={n:"ReportBadSearchForm"};const{serverResults:t,localResults:i,combinedResults:n,experiments:o}=e,s=(0,H.yK)((e=>({textArea:{width:"100%",background:e.popoverBackground,display:"block",marginTop:17,marginBottom:17},urlArea:{width:"100%",height:"50%",background:e.popoverBackground,display:"block",marginTop:17,marginBottom:17},modalWrap:{width:360,padding:24,fontSize:14},modalTitle:{fontSize:16,marginBottom:12,fontWeight:Te.Z.fontWeight.medium},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18},outlineButton:{marginRight:12}})),[]),[l]=(0,r.useState)(E.ZP),d=(0,q.VK)((()=>I.default.state.currentSpaceStore),[]),[c,u]=(0,q.AF)(yi),p=(0,K.O7)(),m=(0,r.useCallback)((e=>{u({...c,desiredUrl:e?(0,bi.Z)({pageId:e.store.id,pageModel:e.store.getModel(),baseUrl:b.Z.domainBaseUrl}):void 0})}),[c,u]),g=(0,r.useCallback)((()=>{Fi({searchStoreState:l.state,currentSpaceStore:d,serverResults:t,localResults:i,experiments:o,environment:p})}),[l,d,t,i,o,p]);return a()(Ii.Z,{onDismiss:Pi,render:()=>a()(ve.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:e=>r.createElement("div",z()({style:s.modalWrap},e),a()("div",{style:s.modalTitle},void 0,a()(_e.FormattedMessage,{id:"SearchBadResultsForm.title",defaultMessage:"Report Bad Search",description:"Title for the poor search quality report form."})),a()(Mt.Z,{textarea:!0,style:s.textArea,placeholder:Oe.default.formatMessage(xi.additionalInformationPlaceholder),value:c.additionalInformation,onChange:e=>{u({...c,additionalInformation:e.target.value})},focusInitial:!0}),a()(Zi,{results:n,onSelect:m}),a()(Mt.Z,{textarea:!0,style:s.urlArea,placeholder:Oe.default.formatMessage(xi.urlPlaceholder),value:c.desiredUrl,onChange:e=>{u({...c,desiredUrl:e.target.value})}}),a()("div",{style:s.buttonArea},void 0,a()(hi.Z,{isLarge:!0,onClick:Pi,style:s.outlineButton},void 0,a()(_e.FormattedMessage,{id:"SearchBadResultsForm.cancelButton.label",defaultMessage:"Cancel",description:"Exit the modal"})),a()(hi.Z,{isRed:!0,isLarge:!0,onClick:g,disabledFeedback:!0},void 0,a()(_e.FormattedMessage,{id:"SearchBadResultsForm.reportButton.label",defaultMessage:"Submit",description:"Submit the form"}))))}),requireOnline:!0,modalStore:yi})};class Bi extends l.Z{constructor(){super(...arguments),this.openSidebar=()=>E.ZP.setState({...E.ZP.state,isSidebarOpen:!0}),this.styles={footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?Te.Z.fontSize.UIRegular.mobile:Te.Z.fontSize.UIRegular.desktop}},footerWrapper:{flexShrink:0},footerText:{color:this.theme.lightTextColor,fontSize:ui.yv(this.environment,"UISmall"),...Te.Z.textOverflowStyle},footerDebugButton:{...Ei(this.theme),marginRight:6}}}renderComponent(){const e=this.styles;return a()("footer",{style:e.footerWrapper},void 0,a()(Ee.Z,{topBorder:!0,style:e.footer(),disableDesktopPadding:!0},void 0,r.createElement(Qt.Z,z()({},this.props,{style:e.footerText})),(0,ke.x)(b.Z)&&!E.ZP.state.isSidebarOpen&&a()(hi.Z,{onClick:this.openSidebar,style:e.footerDebugButton},void 0,"Open Debug Sidebar")))}}Bi.displayName="SearchFooterContainer";const Ei=e=>({fontSize:12,color:e.lightTextColor,marginLeft:6,paddingRight:4,paddingLeft:4,height:24}),Di=Bi;function Ri(e){window.__c={n:"ReportBadSearchButton"};const[t,i]=(0,q.AF)(yi),n=(0,H.yK)((e=>({button:{...Ei(e)}})),[]);return a()(hi.Z,{style:n.button,onClick:()=>{i({...t,open:!0})}},void 0,a()(_e.FormattedMessage,{defaultMessage:"Report bad search",id:"search.header.badSearch.button.label",description:"Button that takes user to the poor search result page"}),r.createElement(Ai,e))}var Li=i(62134);function Oi(){window.__c={n:"SearchFooterNavigationHints"};const e=(0,K.O7)(),t=(0,_e.useIntl)(),i=(0,H.yK)((t=>({upDownIcon:{marginRight:4,marginBottom:-2,display:"inline",width:12,height:12,fill:t.mediumIconColor},enterIcon:{marginRight:4,marginBottom:-2,display:"inline",width:11,height:11,fill:t.mediumIconColor},commandGlyph:{fontSize:.75*ui.yv(e,"UIRegular"),paddingRight:1,color:t.lightTextColor},footerText:{fontSize:ui.yv(e,"UISmall"),color:t.lightTextColor,...Te.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16}})),[e]),n={...ui.mK,...i.footerText},{command:o}=Li.fg(e);return a()("ul",{style:n},void 0,a()("li",{style:i.inlineHint},void 0,Ce.Z.arrowsUpDownThick(i.upDownIcon),t.formatMessage({id:"searchFooter.helpText.selectHint",defaultMessage:"Select"})),a()("li",{style:i.inlineHint},void 0,Ce.Z.enter(i.enterIcon),t.formatMessage({id:"searchFooter.helpText.openHint",defaultMessage:"Open"})),a()("li",{style:i.inlineHint},void 0,a()("span",{style:i.commandGlyph},void 0,o),Ce.Z.enter(i.enterIcon),e.device.isElectron?t.formatMessage({id:"searchFooter.helpText.openNewWindow",defaultMessage:"Open in a new window"}):t.formatMessage({id:"searchFooter.helpText.openNewTab",defaultMessage:"Open in a new tab"})))}class Ni extends l.Z{constructor(){super(...arguments),this.storeTypes={requestModalOpen:V.default.of(!1),responseModalOpen:V.default.of(!1)},this.styles={footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?Te.Z.fontSize.UIRegular.mobile:Te.Z.fontSize.UIRegular.desktop}},footerText:{fontSize:ui.yv(this.environment,"UISmall"),...Te.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},resultCountWrapper:{display:"flex",alignItems:"center",...Te.Z.textOverflowStyle},resultCount:{fontWeight:Te.Z.fontWeight.medium},resultText:{verticalAlign:"middle",marginRight:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginRight:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*ui.yv(this.environment,"UISmall")},commandGlyph:{fontSize:.75*ui.yv(this.environment,"UIRegular")},footerDebugButton:Ei(this.theme),debugModalStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},navigationHints:{marginLeft:15}}}renderComponent(){var e;const{localResults:t,serverResults:i}=this.props.searchResultStore.state,{shouldShow:n}=this.props,o="production"!==b.Z.env&&"staging"!==b.Z.env;if(!o&&!n)return;const s=this.styles,l=this.getThemeColors(),d={...s.resultCount,...l.resultCount},{count:c,isLowerBound:u}=this.props.searchResultStore.getResultCount(),p=a()("span",{style:s.resultText},void 0,u?this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCountApproximate",description:"Approximate number of results displayed in footer of search modal.",defaultMessage:"{resultCount, plural, other {<resultwrapper>{resultCount}+</resultwrapper> results}}"},{resultCount:c,resultwrapper:e=>a()("span",{style:d},void 0,e)}):this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCount",description:"Exact number of results displayed in footer of search modal.",defaultMessage:"{resultCount, plural, one {<resultwrapper>{resultCount}</resultwrapper> result} other {<resultwrapper>{resultCount}</resultwrapper> results}}"},{resultCount:c,resultwrapper:e=>a()("span",{style:d},void 0,e)})),m=a()("div",{style:s.resultCountWrapper},void 0,p,this.renderSpinner(this.props.showSpinner),a()("div",{style:s.navigationHints},void 0,a()(Oi,{})));return a()(Di,{title:m,right:r.createElement(r.Fragment,null,o&&a()(Ri,{experiments:null==i||null===(e=i.serverEventProperties)||void 0===e?void 0:e["server-searchExperiments"],localResults:null==t?void 0:t.results,serverResults:null==i?void 0:i.results,combinedResults:this.props.combinedResults}),this.renderSearchDebugButtons())})}renderSpinner(e){const t=this.styles;return a()(fi.Z,{show:e,showDelay:500,showHold:200,render:e=>e&&a()(mi.Z,{style:t.spinner})})}renderSearchDebugButtons(){var e,t;if(!Z.ZP.state.debug&&!Z.ZP.state.showDebugInfo)return;const{rawRequest:i,rawResponse:n}=(null===(e=this.props.searchResultStore.state.serverResults)||void 0===e||null===(t=e.debugInfo)||void 0===t?void 0:t.requests[0])||{};return r.createElement(r.Fragment,null,i&&r.createElement(r.Fragment,null,a()(gi.Z,{open:this.stores.requestModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.requestModalOpen.setState(!1)},render:()=>a()(pi.LazyAdminReactJson,{showCopyButton:"large",defaultCollapsed:!1,data:i})}),a()(hi.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.requestModalOpen.setState(!0)},void 0,"Open Request")),n&&r.createElement(r.Fragment,null,a()(gi.Z,{open:this.stores.responseModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.responseModalOpen.setState(!1)},render:()=>a()(pi.LazyAdminReactJson,{showCopyButton:"large",data:n,defaultCollapsed:!1})}),a()(hi.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.responseModalOpen.setState(!0)},void 0,"Open Response")))}getThemeColors(){return{footerText:{color:this.theme.lightTextColor},resultCount:{color:this.theme.mediumTextColor},keyboardShortcut:{color:this.theme.mediumTextColor}}}}Ni.displayName="SearchResultsFooter";const Vi=(0,_e.injectIntl)(Ni);var Ui=i(62518),Wi=i(11689),zi=i(43339),Ki=i(43145),qi=i(94184),Hi=i.n(qi),Gi=i(64369);function ji(e,t){window.__c={n:"SearchActionMenuItem"};const{inline:i,title:n,icon:a,focused:o,isBeforeFocused:s,className:l}=e,d=(0,H.yK)((e=>({hoveredStyle:{background:e.buttonHoveredBackground}})),[]),c=(0,H.yK)((e=>({style:{minHeight:36,paddingTop:8,paddingBottom:8,...!i&&!s&&!o&&{boxShadow:`0 1px 0 ${e.lightDividerColor}`}},textWrapper:{marginLeft:10,alignItems:void 0,flex:void 0,width:"100%",display:"block",textOverflow:"ellipsis",...i&&{alignItems:"baseline"}},icon:{display:"block",flexShrink:0,height:18,width:18,color:e.mediumTextColor},enterIcon:{height:14,width:14,fill:e.mediumIconColor},iconContainer:{marginTop:1}})),[o,i,s]),u={title:n,icon:$i(a,c.icon,c.iconContainer),style:c.style,textWrapperStyle:c.textWrapper,right:Yi(o,c.enterIcon),className:Hi()("notranslate",l),buttonStyle:{paddingLeft:2},hoveredStyle:d.hoveredStyle};return r.createElement(Pe.Z,z()({ref:t},e,u,{disableTransition:!0,ignoreLocalHoverState:!0}))}function $i(e,t,i){return window.__c={n:"renderIcon"},a()(Gi.Z,{style:i},void 0,e(t))}function Yi(e,t){window.__c={n:"renderEnterIcon"};const i={...t,opacity:e?1:0};return a()("div",{style:{display:"flex"}},void 0,Ce.Z.enter(i))}const Qi=r.forwardRef(ji);var Xi=i(39634);class Ji extends l.Z{constructor(){super(...arguments),this.styles={menuItem:{minHeight:void 0,...this.environment.device.isMobile&&{background:void 0,boxShadow:void 0},paddingTop:32,paddingBottom:32},text:{textAlign:"center"},title:{margin:0,fontWeight:Te.Z.fontWeight.medium,fontSize:ui.yv(this.environment,"UIRegular"),lineHeight:ui.Dp(this.environment,"UIRegular")},caption:{fontSize:ui.yv(this.environment,"UIRegular")}}}renderComponent(){const{style:e,captionStyle:t,...i}=this.props,n={...this.styles.menuItem,...e},a={...this.styles.caption,...t};return r.createElement(Qt.Z,z()({},i,{title:this.renderTitle(),caption:this.renderCaption(a),textWrapperStyle:this.styles.text,style:n,captionStyle:a}))}renderTitle(){const{title:e}=this.props;if(!e)return;const t=this.styles,i=this.getThemeColors(),n={...t.title,...i.title};return a()("h4",{role:"alert",style:n},void 0,e)}renderCaption(e){const{caption:t}=this.props;if(!t)return;const i={...e,...this.getThemeColors().caption};return a()("div",{style:i},void 0,t)}getThemeColors(){return{title:{color:this.theme.mediumTextColor},caption:{color:this.theme.lightTextColor}}}}Ji.displayName="ErrorMenuItem",Ji.contextTypes={...$.mw,...l.w};const en=Ji;class tn extends l.Z{constructor(){super(...arguments),this.handleSendMessageClick=()=>{Xi.j({environment:this.environment,from:"quick_find"})},this.styles={menuItem:{marginTop:"auto",marginBottom:"auto"},caption:{marginTop:"auto"},reportProblemButton:{display:"inline"},searchDeletedButton:{display:"inline",lineHeight:"25px"}}}renderComponent(){return r.createElement(en,z()({},this.getErrorMessage(),{style:this.styles.menuItem,captionStyle:this.styles.caption,shouldWrapCaption:!0}))}renderNoResults(){return{title:tn.noResultsTitle,caption:this.renderNoResultsMessage()}}renderNoResultsMessage(){const e=E.ZP.state.query.filters,t=T.FN(e),i=T.VD.isDeletedOnly(e.isDeletedOnly);if(["nav-local-only","nav-local-n-title"].includes(P.default.state.searchMode))return a()(_e.FormattedMessage,{defaultMessage:"Try searching with full content",id:"searchErrorMenuItem.errorPrompt.searchFullContent",description:"Message prompted to users when their search return no results in quick search mode and suggest them to click the action to search with all content"});if(!i){const e=this.styles,t=this.getThemeColors(),i={...e.searchDeletedButton,...t.searchDeletedButton};return a()(_e.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.searchDeleted",defaultMessage:"Some results may be in your deleted pages.{br}<searchdeleted>Search deleted pages</searchdeleted>",description:"Message prompted to users when their Search return no results to suggest them search in deleted pages",values:{searchdeleted:e=>a()(Ti.Z,{onClick:this.props.handleSearchDeletedOnly,style:i},void 0,e),br:a()("br",{})}})}return a()(_e.FormattedMessage,t?{defaultMessage:"Try different search terms or filters",id:"searchErrorMenuItem.errorPrompt.searchTermsAndFilters"}:{defaultMessage:"Try different search terms",id:"searchErrorMenuItem.errorPrompt.searchTerms"})}renderOffline(){return{title:tn.noResultsTitle,caption:a()(_e.FormattedMessage,{defaultMessage:"Go online for more results.",id:"searchErrorMenuItem.errorPrompt.goOnline"})}}renderRequestFailed(){const e=this.styles,t=this.getThemeColors(),i={...e.reportProblemButton,...t.reportProblemButton};return{title:a()(_e.FormattedMessage,{id:"searchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:a()(_e.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:e=>a()(Ti.Z,{onClick:this.handleSendMessageClick,style:i},void 0,e)}})}}getErrorMessage(){const{error:e}=this.props;switch(e.type){case A.Ix.NoResults.type:return this.renderNoResults();case A.Ix.Offline.type:return this.renderOffline();case A.Ix.RequestFailed.type:return this.renderRequestFailed();default:(0,ee.t1)(e)}}getThemeColors(){return{reportProblemButton:{color:this.theme.blueColor},searchDeletedButton:{color:this.theme.blueColor}}}}tn.displayName="SearchErrorMenuItem",tn.contextTypes={...$.mw,...l.w},tn.noResultsTitle=a()(_e.FormattedMessage,{defaultMessage:"No results",id:"searchErrorMenuItem.error.noResults"});const nn=tn;var an=i(98742),on=i(8323),sn=i(16402),rn=i(24039),ln=i(90403),dn=i(64133),cn=i(86176),un=i(58032),pn=i(73299),mn=i(40793),gn=i(99208),hn=i(96525);function fn(e){window.__c={n:"SearchBreadcrumbFilterPopup"};const{parent:t,store:i,onClick:n}=e,o=(0,K.O7)(),{device:s}=o;let l;l=s.isMobile?{menuType:$.og.Modal,title:a()(_e.FormattedMessage,{defaultMessage:"Breadcrumb",id:"breadcrumb.mobileBreadcrumbMenu.title"}),right:a()(Se.DoneMenuText,{}),onClickRight:t.close}:{menuType:$.og.Popup,width:240};const d=(0,r.useCallback)((()=>{null==n||n({store:i,action:"include"})}),[n,i]),c=(0,r.useCallback)((()=>{null==n||n({store:i,action:"exclude"})}),[n,i]),u=i instanceof ue.zX?"teamspace":"parent page",p={key:"results",render:e=>r.createElement(Ee.Z,e),items:[{key:"include-filter",render:e=>r.createElement(Pe.Z,z()({},e,{title:`Add ${u} to filter`})),action:d},{key:"exclude-filter",render:e=>r.createElement(Pe.Z,z()({},e,{title:`Exclude ${u} from results`})),action:c}]};return r.createElement(be.Z,l,a()(lt.Z,{type:lt.i.Vertical,onAccept:t.close,initialFocus:void 0,sections:[p]}))}class vn extends l.Z{constructor(){super(...arguments),this.getFilterPopupRenderer=e=>t=>a()(fn,{parent:t,store:e,onClick:this.props.onClick}),this.getBreadcrumbCommonProps=e=>({maxWidth:this.props.ancestorMaxWidth,popupRenderer:this.getFilterPopupRenderer(e),iconSize:this.props.iconSize,titleStyle:this.getTitleStyle(),iconStyle:vn.iconStyle,highlighter:this.props.highlighter})}renderComponent(){const{store:e}=this.props,t=e.getTitleStore();if(t&&t.isReady())return a()("div",{style:this.getStyle(),className:"notranslate"},void 0,this.renderAncestors())}renderAncestors(){const{store:e,maxAncestorCount:t}=this.props,i=C.uJ(e),n=e.isNavigableBlock()?i.slice(1):[...i];if(n.reverse(),i.reverse(),n.length>t){const[e,a,o]=[n[0],n.slice(1,n.length-t+1),n.slice(n.length-t+1)];if((0,_.bq)()){const t=o.length;return[this.renderButtonForStore({store:e,showDivider:!this.props.isMobile}),this.renderBlocksAsPopup(this.props.isMobile?i:a),...o.map(((e,i)=>{const n=!this.props.hideCurrentPage||i!==t-1;return e instanceof ue.zX?r.createElement(gn.Z,z()({store:e,showDivider:n},this.getBreadcrumbCommonProps(e))):r.createElement(mn.Z,z()({store:e,showDivider:n},this.getBreadcrumbCommonProps(e)))}))]}{const e=n.filter((e=>e instanceof ue.G)),i=n.filter((e=>e instanceof ue.G)),a=e.length;return[r.createElement(mn.Z,z()({key:e[0].id,store:e[0],showDivider:!this.props.isMobile},this.getBreadcrumbCommonProps(e[0]))),this.renderBlocksAsPopup(this.props.isMobile?i:e.slice(1,e.length-t+1)),...e.slice(e.length-t+1).map(((e,t)=>r.createElement(mn.Z,z()({key:e.id,store:e,showDivider:!this.props.hideCurrentPage||t!==a-1},this.getBreadcrumbCommonProps(e)))))]}}{const e=n.length;return n.map(((t,i)=>this.renderButtonForStore({store:t,showDivider:!this.props.hideCurrentPage||i!==e-1})))}}renderButtonForStore(e){const{store:t,showDivider:i}=e;return t instanceof ue.zX?r.createElement(gn.Z,z()({store:t,showDivider:i},this.getBreadcrumbCommonProps(t))):r.createElement(mn.Z,z()({store:t,showDivider:i},this.getBreadcrumbCommonProps(t)))}getMenuListSections(e){const t=this.props.isMobile?Fe.Z.PopupType.SlideUp:Fe.Z.PopupType.Popup;return[{key:"results",render:e=>r.createElement(Ee.Z,e),items:e.map(((e,i)=>({key:e.id,render:n=>r.createElement(hn.Z,z()({},n,{stopClickPropagation:!0,popupType:t,renderOrigin:t=>r.createElement(Ue.Z,z()({},t,{isSubpage:0!==i,store:e,hidePath:!0,focused:!1})),render:t=>a()(fn,{parent:t,store:e,onClick:this.props.onClick})})),action:()=>{}})))}]}renderBlocksAsPopup(e){return a()(Fe.Z,{popupType:this.props.isMobile?Fe.Z.PopupType.SlideUp:Fe.Z.PopupType.Popup,renderOrigin:e=>{var t;return this.props.isMobile?r.createElement(Ze.Z,z()({style:{...vn.dividerWrapStyle},mobileFeedback:!0},e),a()(pn.f,{}),a()("div",{style:yn},void 0,"..."),a()(pn.f,{})):a()("div",{style:vn.dividerWrapStyle},void 0,r.createElement(Be.Z,z()({isSmall:!0},e,{style:{paddingLeft:2,paddingRight:2,fontSize:null===(t=this.props.style)||void 0===t?void 0:t.fontSize}}),"..."),a()(pn.f,{}))},render:t=>{let i;return i=this.props.isMobile?{menuType:$.og.Modal,title:a()(_e.FormattedMessage,{defaultMessage:"Breadcrumb",id:"breadcrumb.mobileBreadcrumbMenu.title"}),right:a()(Se.DoneMenuText,{}),onClickRight:t.close}:{menuType:$.og.Popup,width:240},r.createElement(be.Z,i,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:this.getMenuListSections(e)}))}},"pages-popup")}getStyle(){return{display:"flex",alignItems:"center",lineHeight:1.2,fontSize:this.props.isMobile?Te.Z.fontSize.UIRegular.mobile:Te.Z.fontSize.UIRegular.desktop,color:this.theme.lightTextColor,filter:"grayscale(70%)",...this.props.style}}getTitleStyle(){return{lineHeight:1.2,fontSize:this.props.isMobile?Te.Z.fontSize.UISmall.mobile:Te.Z.fontSize.UISmall.desktop,color:this.theme.lightTextColor}}}vn.displayName="SearchPathBreadcrumb",vn.iconStyle={marginRight:3},vn.dividerWrapStyle={display:"flex",alignItems:"center",flexShrink:0};const yn={marginLeft:3,marginRight:3},bn=vn;class Sn extends l.Z{constructor(){super(...arguments),this.storeTypes={explanationModalOpen:V.default.of(!1)},this.handleSearchPathBreadcrumbClick=e=>{let{store:t,action:i}=e;"block"===t.table?"include"===i?E.ZP.updateFilters({ancestors:s().uniq(E.ZP.state.query.filters.ancestors.concat(t.id))}):E.ZP.updateFilters({dev_excludedPages:s().uniq((E.ZP.state.query.filters.dev_excludedPages||[]).concat(t.id))}):"team"===t.table&&("include"===i?E.ZP.updateFilters({inTeams:s().uniq((E.ZP.state.query.filters.inTeams||[]).concat(t.id))}):E.ZP.updateFilters({dev_excludedTeams:s().uniq((E.ZP.state.query.filters.dev_excludedTeams||[]).concat(t.id))}))},this.styles={title:{fontWeight:Te.Z.fontWeight.medium,lineHeight:"20px"},jumpToTitle:{fontWeight:Te.Z.fontWeight.medium,fontSize:15,lineHeight:"20px"},menuItem:{minHeight:36,paddingTop:this.environment.device.isMobile?12:8,paddingBottom:this.environment.device.isMobile?12:8},textWrapper:{marginLeft:10,alignItems:void 0,flex:void 0,width:"100%"},inlineTextWrapper:{alignItems:"baseline"},highlight:{fontWeight:Te.Z.fontWeight.medium},vectorHighlight:{fontWeight:Te.Z.fontWeight.medium,whiteSpace:"pre-wrap"},enterIcon:{height:14,width:14},uniqueIDBadgeWrapper:{display:"flex",gap:8,marginRight:8,alignItems:"center"},caption:{marginTop:1},debugArea:{fontFamily:"monospace"},timestamp:{fontSize:Te.Z.fontSize.UISmall.desktop,fontWeight:Te.Z.fontWeight.regular},toolTip:{maxWidth:300},toolTipTitle:{fontWeight:Te.Z.fontWeight.medium,fontSize:Te.Z.fontSize.UISmall.desktop},toolTipText:{fontWeight:Te.Z.fontWeight.medium,fontSize:Te.Z.fontSize.UISmall.desktop,marginLeft:0,paddingRight:20},toolTipValue:{fontSize:Te.Z.fontSize.UISmall.desktop,fontWeight:Te.Z.fontWeight.regular},toolTipMenuItem:{minHeight:20}},this.debugHitCustomRenderer=e=>{let{data:t,keyPath:i}=e;if(2===i.length&&"_explanation"===i[0])return{element:r.createElement(r.Fragment,null,a()("button",{onClick:e=>{this.stores.explanationModalOpen.setState(!0),e.stopPropagation()}},void 0,"show simplified explanation")),expanded:!1};const n=t._ltrlog;if(n)return function(e){const t=Object.keys(e[0])[0],i=e[0][t].map(((e,t)=>{const i=t%2==0?Tn:kn;return a()("tr",{},e.name,a()("td",{style:i},void 0,`${t}`),a()("td",{style:i},void 0,`${e.name}`),a()("td",{style:i},void 0,`${e.value}`))}));return{element:r.createElement(r.Fragment,null,a()("div",{},void 0,a()("b",{},void 0,`Featureset: ${t}`)),a()("div",{style:{maxHeight:200,overflowY:"scroll"}},void 0,a()("table",{style:{border:"1px solid black"}},void 0,i))),expanded:!1}}(n);if(!["_score","matched_queries"].every((e=>t[e])))return null;const{_score:o,matched_queries:s}=t;return{element:r.createElement(r.Fragment,null,`score ${o}, ${(s??[]).length} matched query clauses`),expanded:!1}}}renderComponent(){const{focused:e,isLastInSection:t,isBeforeFocused:i,inline:n,className:o}=this.props,s=this.styles,l=this.getThemeColors(),d={...s.menuItem,...!n&&!t&&!i&&!e&&l.menuItemBorder},c={...s.caption,...l.caption},u={...s.timestamp,...l.timestamp},p={...s.textWrapper,...this.props.inline&&s.inlineTextWrapper},m={title:this.renderTitle(),icon:this.renderIcon(),caption:this.renderCaption(),body:this.renderPreview(),right:this.renderRight(e),rightStyle:e?void 0:u,dontShrinkRight:!0,captionStyle:c,style:d,spacerStyle:this.hasPath()?void 0:xn,textWrapperStyle:p,className:Hi()("notranslate",o),buttonStyle:{paddingLeft:2},hoveredStyle:{background:this.theme.buttonHoveredBackground}};return(0,on.Mk)()?a()(un.Z,{delayThreshold:50,placement:un.Z.Placement.Right,originGap:18,renderTooltip:()=>this.renderTooltip(),style:s.toolTip,render:e=>r.createElement(Pe.Z,z()({},this.props,m,{disableTransition:!0,ignoreLocalHoverState:!0},(0,an.Z)(e,this.props)))}):r.createElement(Pe.Z,z()({},this.props,m,{disableTransition:!0,ignoreLocalHoverState:!0}))}renderTooltip(){return a()(rn.Z,{store:this.props.store})}renderTitle(){var e;const{store:t,result:i,placeholder:n,index:o}=this.props,s=this.styles,r=this.getThemeColors(),l={...(null==i?void 0:i.sources.includes(A.vp.Local))&&0===o?s.jumpToTitle:s.title,...this.hasAnyHighlight()&&r.highlightedTitle},d=[];if(i&&i.highlight)if(d.push(...(0,w.fe)(i.highlight.pathText)),this.usesFullPageIndexingHighlight())d.push(...(0,w.fe)(i.highlight.title));else{ue.G.createChildStore(this.props.store,{table:J.iU,id:i.id,spaceId:i.spaceId}).isNavigableBlock()&&d.push(...(0,w.fe)(i.highlight.text))}const c="development"===b.Z.env&&(null==i?void 0:i.sources.includes(A.vp.VectorDB)),u=this.getWordHighlighter({words:d}),p=null===(e=(0,C.VP)(t))||void 0===e?void 0:e.isArchived(),m=function(e){if(e)return e.sources.includes(A.vp.ElasticsearchUniqueID)}(i);return a()("div",{style:{display:"flex",justifyContent:"space-between",...l}},void 0,a()("div",{style:{display:"flex"}},void 0,Z.ZP.state.showDebugInfo&&void 0!==o&&`${o+1}. `,m&&this.renderUniqueIdHighlight(i),a()(We.ZP,{style:l,store:t,placeholder:n,highlighter:u}),c&&a()(ln.Z,{content:"Vector Search",style:{background:this.theme.invoiceGreen,color:this.theme.contentBackground}}),p&&a()(ln.Z,{content:a()(_e.FormattedMessage,{id:"search.result.archived.badge.text",defaultMessage:"Archived",description:"Badge text for search results that belong to an archived teamspace"}),style:In})),Z.ZP.state.showDebugInfo&&this.renderDebugIcons())}renderUniqueIdHighlight(e){var t;const{focused:i}=this.props,n=null==e||null===(t=e.highlight)||void 0===t?void 0:t.uniqueId;if(!n)return;const o="dark"===this.environment.ThemeStore.state.mode,s=this.styles,r=this.getWordHighlighter({words:[n]}),l=i?o?rt.FN.dark.translucentGray[300]:rt.se.light.darkgray.alpha(.09):o?rt.FN.dark.translucentGray[200]:rt.se.light.darkgray.alpha(.06);return a()("div",{style:s.uniqueIDBadgeWrapper},void 0,a()("div",{},void 0,a()(dn.Z,{text:n,highlighter:r})),a()("div",{style:{borderRight:`1.5px solid ${l}`,height:14,borderRadius:1}}))}renderRight(e){const{result:t}=this.props,i=Boolean(t);return a()("div",{style:{display:"flex",width:i?this.styles.enterIcon.width:void 0}},void 0,e?this.renderEnterIcon():this.renderTimestamp())}renderTimestamp(){const{result:e,lastViewed:t}=this.props;if(!e&&t)return(0,sn.IS)(t,{useCompactFormat:!0})}renderDebugIcons(){var e;const{result:t,index:i,originalPosition:n}=this.props,o=null===(e=(null==t?void 0:t.sources)??[])||void 0===e?void 0:e.flatMap((e=>e===A.vp.Local?["💻"]:e===A.vp.ElasticSearch?["🌐"]:e===A.vp.Postgres?["🐘"]:e===A.vp.VectorDB?["🔭"]:e===A.vp.ElasticsearchRandom?["🎲"]:e===A.vp.ElasticsearchUniqueID?["🆔"]:void(0,ee.t1)(e))),s=[...void 0===i||void 0===n?[" "]:i>n?["⬇️"]:i<n?["⬆️"]:[],...o].join("").trim();return s&&a()("span",{},void 0,s)}renderIcon(){const{store:e}=this.props;return r.createElement(r.Fragment,null,a()(Ve.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:20,largeIcon:!0}))}renderCaption(){const{store:e,inline:t,result:i,debugLocal:n,debugHit:o,debugUrl:s}=this.props,l=this.getWordHighlighter({words:(0,w.fe)(i&&i.highlight&&i.highlight.pathText),removeDuplicate:!0}),{device:d}=this.environment,c=t||d.isMobile?0:2,u=("local"===b.Z.env||"development"===b.Z.env)&&"full-content"===P.default.state.searchMode&&!t,p=null==o?void 0:o._explanation;return r.createElement(r.Fragment,null,u?a()(bn,{store:e,style:_n,maxAncestorCount:5,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!1,hideCurrentPage:!0,isMobile:!1,iconSize:11,onClick:this.handleSearchPathBreadcrumbClick,highlighter:l}):a()(cn.Z,{store:e,extraLength:c,showFullPathInTooltip:!0,highlighter:l}),r.createElement("div",{ref:this.props.debugAreaRef},n&&a()("div",{style:this.styles.debugArea},void 0,a()(pi.LazyAdminReactJson,{data:{debugLocal:n},defaultCollapsed:!0,customCollapsedRenderers:[Mn],showCopyButton:!1,showModalButton:!1})),o&&a()("div",{style:this.styles.debugArea},void 0,a()(pi.LazyAdminReactJson,{data:{debugHit:o},defaultCollapsed:!0,customCollapsedRenderers:[this.debugHitCustomRenderer],showCopyButton:"small",showModalButton:!0})),o&&(null==i?void 0:i.rankingSignals)&&a()("div",{style:this.styles.debugArea},void 0,a()(pi.LazyAdminReactJson,{data:{rankingSignals:i.rankingSignals},defaultCollapsed:!0,showCopyButton:"small",showModalButton:!1})),s&&a()("div",{style:this.styles.debugArea},void 0,a()(pi.LazyAdminReactJson,{data:{debugUrl:s},defaultCollapsed:!0,customCollapsedRenderers:[Cn],showCopyButton:"small",showModalButton:!0,maxLinkValueLength:40})),p&&a()(gi.Z,{open:this.stores.explanationModalOpen.state,innerStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},onDismiss:()=>{this.stores.explanationModalOpen.setState(!1)},render:()=>a()("pre",{},void 0,function(e){var t;let{explanation:i,simple:n=!1,filterZeros:a=!1}=e;return function e(t,i){if(!t)return[];const{value:o,description:s,details:r}=t;if(0===o&&a)return[];const l=(0===o?"0":o.toFixed(4)).padStart(8);function d(e){return`${"  ".repeat(i+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0))}${e}`}const c=`[${l}] ${s}`;if(s.startsWith("match on required clause"))return[d(`[${l}] match on required clause ${null==r?void 0:r[1].description}`)];if(["max of:","sum of:","min of:"].includes(s)&&1===(null==r?void 0:r.length))return e(r[0],i);if(s.startsWith("tf")||s.startsWith("idf")){var u;const e=s.split(",")[0],t=null===(u=s.split(" computed as ")[1])||void 0===u?void 0:u.replace(" from:","");return[d(`[${l}] ${e}: [${(r??[]).map((e=>`${e.description.split(",")[0]}=${e.value}`)).join(" ")}] --\x3e ${t}`)]}if(s.startsWith("ConstantScore(_id:"))return[d(`[${l}] ids query`)];const p=n&&0!==i&&(s.startsWith("weight")||s.startsWith("Function"));return[d(c.replace(", result of:","").replace(" from:","").replace(" [PerFieldSimilarity]","").replace(/:$/,"").trim()),...(p?[]:r??[]).flatMap((t=>e(t,i+1)))]}(null==i||null===(t=i.details)||void 0===t?void 0:t[0],0)}({explanation:p}).join("\n"))})))}renderPreview(){var e;const{result:t}=this.props;if(!t)return;if(!t.highlight)return;if(ue.G.createChildStore(this.props.store,{table:J.iU,id:t.id,spaceId:t.spaceId}).isNavigableBlock()&&!this.usesFullPageIndexingHighlight())return;if(!t.highlight.text)return;const i=t.highlight.text,n=(0,w.ZP)(i);if(this.usesFullPageIndexingHighlight()){const e=e=>e.filter(w.il).map((e=>e[0].toLowerCase())),i=t=>void 0===t?[]:e((0,w.ZP)(t)),a=[...new Set([...i(t.highlight.title),...i(t.highlight.pathText)])],o=e=>a.some((t=>t.includes(e)));if(e(n).every((e=>o(e))))return}const o=this.styles,s=null!==(e=t.sources)&&void 0!==e&&e.includes(A.vp.VectorDB)?o.vectorHighlight:o.highlight,l=this.getThemeColors();return r.createElement(r.Fragment,null,a()(dn.Z,{text:i,highlighter:{tokenize:e=>(0,w.Vu)(n),style:{...s,...l.highlight}}}))}usesFullPageIndexingHighlight(){const{result:e}=this.props;return e&&!e.sources.includes(A.vp.Local)}getWordHighlighter(e){const{words:t,removeDuplicate:i}=e;if(0===t.length)return;const n={...this.styles.highlight,...this.getThemeColors().highlight},a=i?new Set:void 0;return{tokenize:e=>(0,w.XT)({text:e,patterns:t,uniqueTokenHighlighterContext:a}),style:n}}renderEnterIcon(){const{device:e}=this.environment,{focused:t}=this.props,i=this.styles,n=this.getThemeColors();if(e.isMobile)return;const a={...i.enterIcon,...n.enterIcon,opacity:t?1:0};return Ce.Z.enter(a)}hasPath(){const{hidePath:e,store:t}=this.props;return!e&&(0,cn.L)(t)}hasAnyHighlight(){const{result:e}=this.props;return!!e&&(0,w._m)(e.highlight)}getThemeColors(){return{highlightedTitle:{color:this.theme.mediumTextColor},menuItemBorder:{boxShadow:`0 1px 0 ${this.theme.lightDividerColor}`},highlight:{color:this.theme.regularTextColor},enterIcon:{fill:this.theme.mediumIconColor},caption:{color:this.theme.mediumTextColor},timestamp:{color:this.theme.lightTextColor},toolTipTitle:{color:this.theme.mediumTextColor},toolTipText:{color:this.theme.regularTextColor},toolTipValue:{color:this.theme.lightTextColor}}}}Sn.displayName="SearchResultMenuItem",Sn.contextTypes={...$.mw,...l.w};const wn=Sn,Mn=e=>{let{data:t}=e;const i=t;if(!i)return null;const{localSource:n,score:a,frecencyScore:o,personalizationBoost:s}=i;let l=n;return l||(l=new Set("unknown")),{element:r.createElement(r.Fragment,null,`from ${[...l].join(",")} [s ${a} | f ${o} | b ${s}]`),expanded:!1}},Cn=e=>{let{data:t}=e;const i=t;if(!i)return null;const{clusterName:n}=i;return{element:r.createElement(r.Fragment,null,n),expanded:!1}},kn={paddingLeft:5,paddingRight:20,paddingTop:2,paddingBottom:2,border:"1px solid black",color:rt.FN.dark.green[900]},Tn={...kn,color:rt.FN.dark.gray[30]},_n={height:"100%",flexGrow:0,marginRight:8,fontSize:10,minWidth:0};const In={fontWeight:Te.Z.fontWeight.regular},xn={visibility:"hidden"};function Zn(e,t){if(e){switch(e){case"local":return a()(_e.FormattedMessage,{id:"search.searchResultBuckets.recent.text",defaultMessage:"Jump back in",description:"Section title for navigating to recently viewed pages"});case"server":return a()(_e.FormattedMessage,t?{id:"search.searchResultBuckets.titleOnlyServer.text",defaultMessage:"Title matches",description:"Section title for search results where the titles match the query"}:{id:"search.searchResultBuckets.server.text",defaultMessage:"More results",description:"Section title for showing more search results"});case"actions":return a()(_e.FormattedMessage,{id:"search.searchActions.actions.text",defaultMessage:"Actions",description:"Section title for possible search actions"});case"unique_id":return a()(_e.FormattedMessage,{id:"search.searchResultBuckets.uniqueID.text",defaultMessage:"ID matches",description:"Section title for showing unique ID matches"});case"main":return a()(_e.FormattedMessage,{id:"search.searchResultBuckets.bestMatches.text",defaultMessage:"Best Matches",description:"Section title for showing main search results"})}(0,ee.t1)(e)}}function Pn(e,t){return window.__c={n:"renderDebugMessage"},a()(Ee.Z,{disableMobilePadding:!0,disableMobileBorders:!0,topBorder:!1,style:{marginTop:0,paddingTop:0}},void 0,a()(Qt.Z,{body:e,bodyStyle:t}))}function Fn(e,t,i,n,a){var o,s,l,d,c;const{store:u}=e,p=u.isNavigableBlock()?u:u.getNavigableBlockStore();if(!p)return;const m=r.createRef(),g=Boolean(Z.ZP.getDebugLevel()),h=g&&e.sources.includes(A.vp.Local)?{score:e.score,frecencyScore:e.frecencyScore,localSource:e.localSource,personalizationBoost:e.personalizationBoost}:void 0,f=g&&e.sources.includes(A.vp.ElasticSearch)?null===(o=a.debugInfo)||void 0===o||null===(s=o.requests[0])||void 0===s||null===(l=s.rawResponse)||void 0===l?void 0:l.hits.hits.find((e=>e._id===u.id)):void 0,v=g&&e.sources.includes(A.vp.ElasticSearch)?null===(d=a.debugInfo)||void 0===d||null===(c=d.requests[0])||void 0===c?void 0:c.debugUrl:void 0,y=a.clusterInfo;return{key:`${u.id}:${t}`,action:t=>{const{event:n}=t;m.current&&function(e){const t=Ui.findDOMNode(e.current);return Boolean(t&&"target"in n&&n.target&&(t===n.target||t.contains(n.target)))}(m)||a.handleSelectResult({store:u,action:t,selectedResult:e,allSearchResults:i})},render:i=>r.createElement(wn,z()({},i,{index:t,originalPosition:e.originalPosition,isFirstInSection:0===t,store:p,hidePath:!1,result:e,className:j.ulv,debugLocal:h,debugHit:f,debugUrl:v,debugAreaRef:m,clusterInfo:y,inline:n&&!g}))}}const An=(0,_e.injectIntl)((function(e){var t,i,n,o,l,d,c,u,p,m,g;window.__c={n:"SearchResultsMenuList"};const[h,f]=(0,r.useState)(!1),y=(0,K.Fy)().isMobile,b=(0,H.yK)((e=>({results:{flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%"},messageMenuItem:{...y&&{background:void 0,boxShadow:void 0}},debugMessageMenuItemTextStyle:{whiteSpace:"pre-wrap",fontFamily:"monospace",marginTop:0},actionMenuItemTitle:{fontWeight:Te.Z.fontWeight.medium,lineHeight:"20px",fontSize:15,color:e.mediumTextColor,textOverflow:"ellipsis",overflow:"hidden",display:"block"},menuListContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:y?13:void 0}})),[y]),{results:S,resultListStore:w,searchExperimentOverrides:M,intl:C,showActions:k}=e,T=(0,q.VK)((()=>"nav-local-only"===P.default.state.searchMode),[])&&0===(S??[]).length?{showMajorError:!0,isLoading:!1,hasLocalResults:!1,serverError:A.Ix.NoResults}:e.errorState,_=(0,q.VK)((()=>["nav-local-only","nav-local-n-title"].includes(P.default.state.searchMode)),[]),I=(0,q.VK)((()=>E.ZP.state.query.text),[]),x=k.length>0?{key:"actions",render:e=>r.createElement(Ee.Z,z()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:Zn("actions")})),items:s().compact(k.map((e=>function(e){const{type:t,title:i,icon:n,action:a}=e;return{key:`actionMenuItem.${t}`,action:a,render:e=>r.createElement(Qi,z()({},e,{title:i,icon:n}))}}({...e,title:e.renderTitle(I,C,b.actionMenuItemTitle)}))))}:void 0,Z=(0,q.VK)((()=>S?S.filter((e=>e.sources.includes(A.vp.ElasticsearchUniqueID))):[]),[S]),F=(0,r.useMemo)((()=>new Set(Z.map((e=>e.id)))),[Z]),B=(0,q.VK)((()=>Z.length>0?{key:"uniqueIdSearchResultSection",render:e=>r.createElement(Ee.Z,z()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:Zn("unique_id")})),items:s().compact(Z.map(((t,i)=>Fn(t,i,Z,_,e))))}:void 0),[Z,_,e]),D=s().findLastIndex(S,(e=>e.sources.includes(A.vp.Local)))+1,R=(0,q.VK)((()=>(S?_?S.slice(0,D):S:[]).filter((e=>!F.has(e.id)))),[_,D,S,F]),L=(0,q.VK)((()=>(S&&_?S.slice(D):[]).filter((e=>!F.has(e.id)))),[_,D,S,F]),O=(0,q.VK)((()=>{const t=(()=>{if(_||0!==F.size)return F.size>0?"main":_?"local":void 0})();return R.length>0?{key:"mainSearchResultSection",render:e=>r.createElement(Ee.Z,z()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:Zn(t,!1)})),items:s().compact(R.map(((t,i)=>Fn(t,i,R,_,e))))}:void 0}),[R,_,F.size,e]),N=(0,q.VK)((()=>L.length>0?{key:"serverOnlySearchResultSection",render:e=>r.createElement(Ee.Z,z()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:Zn("server","nav-local-n-title"===P.default.state.searchMode)})),items:s().compact(L.map(((t,i)=>Fn(t,i,L,_,e))))}:void 0),[L,_,e]),V=[x,B,O,N].filter(ee.$K),U=null===(t=e.debugInfo)||void 0===t||null===(i=t.requests[0])||void 0===i||null===(n=i.rawResponse)||void 0===n||null===(o=n.profile)||void 0===o||null===(l=o.shards[0])||void 0===l||null===(d=l.searches)||void 0===d||null===(c=d[0])||void 0===c?void 0:c.query,W=null===(u=e.debugInfo)||void 0===u||null===(p=u.requests[0])||void 0===p?void 0:p.detectedLanguages,G=null===(m=e.debugInfo)||void 0===m?void 0:m.traceLogs,j=(0,r.useCallback)(((t,i)=>{const{onMaybeLoadMoreResults:n}=e,a=t<=200;a&&!h&&n(),f(a),i.offsetFromTop&&E.ZP.update((e=>({...e,hasScrolled:!0})))}),[h,e]),$=O||N?(null==x||null===(g=x.items)||void 0===g?void 0:g.length)??0:0;return a()(oa.Consumer,{},void 0,(e=>{let{queryResultsSectionRef:t}=e;return r.createElement("section",{style:b.results,ref:t},!s().isEmpty(M)&&Pn(r.createElement(r.Fragment,null,a()(pi.LazyAdminReactJson,{data:{searchExperimentOverrides:M},showCopyButton:!1,showModalButton:!1,defaultCollapsed:!1})),b.debugMessageMenuItemTextStyle),U&&Pn(a()(pi.LazyAdminReactJson,{data:{parsedQuery:U},customCollapsedRenderers:[Rn],showCopyButton:"small",showModalButton:!0,defaultCollapsed:!0}),b.debugMessageMenuItemTextStyle),W&&Pn(a()(pi.LazyAdminReactJson,{data:{detectedLanguages:W},customCollapsedRenderers:[Dn]}),b.debugMessageMenuItemTextStyle),G&&Pn(a()(pi.LazyAdminReactJson,{data:{tracer:{traceLogs:G}},customCollapsedRenderers:[En],defaultCollapsed:!0}),b.debugMessageMenuItemTextStyle),V&&a()("div",{className:"search-results-list"},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:$,store:w,disableKeyboardArrowWrap:!0,sections:V,style:b.menuListContainer})),function(e,t){if(e.isLoading)return;if(e.showMajorError)return a()(nn,{error:e.serverError,handleSearchDeletedOnly:()=>{const e=E.ZP.state.query.text;v.IB(),Wi.Z.setState({...Wi.Z.state,open:!0}),zi.Z.setState({...zi.Z.state,currentTab:"all_pages",filter:e,limit:zi.Z.startLimit})}});if(e.serverError&&e.serverError!==A.Ix.NoResults)return function(e,t){return window.__c={n:"renderMessage"},a()(Ee.Z,{disableMobilePadding:!0,disableMobileBorders:!0},void 0,a()(_i.Z,{title:e,style:t}))}(e.serverError.message,t)}(T,b.messageMenuItem)||a()(Ki.Z,{onChange:j}))}))}));function Bn(e){window.__c={n:"shortenAndFormatLuceneQueryDescription"};const t=e.replaceAll(/\(MatchNoDocsQuery\("Matching no documents because no terms present"\)\)\^[0-9\.]/g,"").replaceAll(/MatchNoDocsQuery\("Matching no documents because no terms present"\)/g,"").replaceAll(/ConstantScore\(([^)]+):([^)]+)\)/g,"<i>$1</i>:<b>$2</b>").replace(/function score \(\((.*)\), functions:.*\)/,"$1").replaceAll("( ","(").replaceAll(" )",")").replaceAll("|","| <br/>").replaceAll(/([^( ]+):"([^"]+)"/g,'<i>$1</i>:<b>"$2"</b>').replaceAll(/([^( ]+):([^) ]+)/g,"<i>$1</i>:<b>$2</b>");return a()("span",{dangerouslySetInnerHTML:{__html:t}})}const En=e=>{let{data:t,keyPath:i}=e;if("traceLogs"===(null==i?void 0:i[0])&&s().isPlainObject(t)&&s().isArray(t.log)&&t.log.length>0){const{log:e,startTimeMs:i}=t;return{element:r.createElement(r.Fragment,null,a()("div",{},void 0,a()("b",{},void 0,`Trace started at ${i}`)),e.map(((e,t)=>a()("div",{},t,a()("span",{style:Ln},void 0,`[${e.timestamp-i}ms][${e.callerFileName.split(".")[0]}]`),a()("span",{},void 0,`${e.msg}`))))),expanded:!1}}return null},Dn=e=>{let{data:t,keyPath:i}=e;return"detectedLanguages"===i.join(".")&&s().isPlainObject(t)?{element:r.createElement(r.Fragment,null,Object.entries(t).filter((e=>{let[t,i]=e;return Boolean(i)})).map((e=>{let[t]=e;return t})).join(", ")||"None"),expanded:!1}:null},Rn=e=>{var t,i;let{data:n,keyPath:a}=e;var o;if(1===a.length)return{element:Bn(null===(o=n[0])||void 0===o?void 0:o.description),expanded:!1};if(!["type","description","time_in_nanos"].every((e=>n[e])))return null;let s=(null==n?void 0:n.description)||"";return null!==(t=s)&&void 0!==t&&t.includes("permissions.teamIds")&&(s="PermissionsQuery"),null!==(i=s)&&void 0!==i&&i.includes("(_id:[")&&(s="BoostRecentPageIds"),{element:Bn(s),expanded:!1}},Ln={color:"blue"};const On=(0,_e.defineMessages)({fullSearch:{id:"search.searchActionMenuItem.fullSearch.description",defaultMessage:'Search all page contents for "{query}"',description:"Description of a button that lets users navigate to a full content search experience"}});function Nn(e,t){return window.__c={n:"renderActionMenuTitle"},a()("div",{className:"notranslate",style:t},void 0,e)}const Vn=function(e){window.__c={n:"SearchResultsBody"};const{searchResultStore:t,sxsMode:i,searchDebugColumnStore:n}=e,o=(0,K.O7)(),s=(0,K.Fy)(),l=(0,H.yK)((e=>({container:{display:"flex",flexDirection:"column",width:i?"50%":"100%",flex:1,overflow:"hidden"},askAiLabel:{color:e.aiPurpleColor,fontWeight:Te.Z.fontWeight.semibold},askAiQuery:{fontWeight:Te.Z.fontWeight.regular},askAiIcon:{fill:e.aiPurpleColor}})),[i]),d=(0,q.qz)(void 0,ci.Z),c=(0,q.VK)((()=>d.state.focus.indexGlobal),[d]),{handleSelectResult:u,globalFocusedIndex:p}=(0,r.useContext)(oa),{localResults:m,serverResults:g,clusterInfo:h,debugInfo:f,serverResultsLoading:y,searchExperimentOverrides:b,hasPublicAccessPermission:S,errorState:w,serverResultsAllLoaded:M}=(0,q.VK)((()=>{var e,i;const{hasPublicAccessPermission:a}=T.bC(o);return{localResults:t.state.localResults,serverResults:t.state.serverResults,serverResultsLoading:t.state.serverResultsLoading,clusterInfo:null===(e=t.state.serverResults)||void 0===e?void 0:e.clusterInfo,debugInfo:null===(i=t.state.serverResults)||void 0===i?void 0:i.debugInfo,searchMode:P.default.state.searchMode,searchExperimentOverrides:n.state.searchExperimentOverrides,hasPublicAccessPermission:a,errorState:t.state.errorState,serverResultsAllLoaded:t.state.serverResultsAllLoaded}}),[t,n,o]),C=!1===w.isLoading&&w.showMajorError,k=Boolean(m||g),_=(0,r.useCallback)((()=>{!y&&!M&&void 0!==g&&E.ZP.update((e=>({...e,limit:e.limit+E.Xv,isScrolled:!0,source:"quick_find_scroll"})))}),[y,M,g]),I=(0,q.VK)((()=>T.oO({results:{local:null==m?void 0:m.results,server:null==g?void 0:g.results}})),[m,g]),x=(0,q.VK)((()=>[{type:"full_search",renderTitle:(e,t,i)=>Nn(t.formatMessage(On.fullSearch,{query:e}),i),icon:Ce.Z.searchThick,action:v.qm,shouldShow:()=>!1},{type:"assistant",renderTitle:(e,t,i)=>Nn(r.createElement(r.Fragment,null,a()("span",{},void 0,"Ask AI "),a()("span",{style:l.askAiQuery},void 0,e)),{...i,...l.askAiLabel}),icon:e=>Ce.Z.sparkles({...e,...l.askAiIcon}),action:()=>{v.Ky({environment:o})},shouldShow:()=>(0,di.jp)(o.device)&&E.ZP.state.query.text.split(" ").length-1>=2&&E.ZP.state.query.text.length>6}].filter((e=>e.shouldShow(o)))),[o,l],{useDeepEqual:!0}),Z=(0,r.useCallback)((()=>d.update((e=>e.focus.isInitialized&&0===e.focus.section&&0===e.focus.indexLocal&&0===e.focus.indexGlobal?e:{...e,focus:x.length>0?{section:1,indexLocal:0,indexGlobal:x.length}:{section:0,indexLocal:0,indexGlobal:0}}))),[d,x]);return(0,r.useEffect)((()=>{Z()}),[I,Z]),(0,r.useEffect)((()=>{p.set(c)}),[p,c]),a()("div",{style:l.container},void 0,a()(An,{errorState:w,handleSelectResult:u,onMaybeLoadMoreResults:_,resultListStore:d,results:I,debugInfo:f,clusterInfo:h,publicAccessPermission:S,searchExperimentOverrides:b,showActions:x}),a()(Vi,{searchResultStore:t,combinedResults:I,showSpinner:y,shouldShow:!C&&k&&!s.isMobile}))};function Un(e){window.__c={n:"SearchTabButton"};const{store:t,selected:i}=e,{resultsLoading:n,count:o,isLowerBound:s}=(0,q.VK)((()=>{const{count:e,isLowerBound:i}=t.getResultCount();return{resultsLoading:Boolean(E.ZP.state.query.text)&&t.state.serverResultsLoading,count:e,isLowerBound:i}}),[t]),[l,d]=(0,r.useState)(!1),c=(0,H.yK)((e=>({buttonHoveredStyle:{color:e.darkTextColor},pressedStyle:{color:e.darkTextColor},iconStyle:l?{fill:e.darkTextColor}:{},buttonStyle:{display:"flex",justifyContent:"space-between",width:"100%"}})),[l]),u=(0,r.useCallback)((()=>{d(!0)}),[]),p=(0,r.useCallback)((()=>{d(!1)}),[]);return a()(Be.Z,{isLarge:!0,icon:e.icon,isGray:!0,hoveredStyle:c.buttonHoveredStyle,iconStyle:c.iconStyle,onMouseEnter:u,onMouseLeave:p,onClick:e.onClick,pressed:i,isLoading:n,pressedStyle:c.pressedStyle},void 0,a()("div",{style:c.buttonStyle},void 0,a()("div",{},void 0,e.text),!n&&a()("div",{},void 0,s?`${o}+`:o)))}function Wn(e){window.__c={n:"SearchTabSection"};const{searchResultStore:t,searchCreatedByMeResultStore:i,searchTaskDBResultStore:n,searchProjectsResultStore:o,searchSearchTeamResultStore:s}=(0,r.useContext)(oa),l=(0,H.yK)((e=>({container:{display:"flex",flexDirection:"column",padding:"10px",width:"20%",boxShadow:e.buttonDivider},buttonHoveredStyle:{color:e.darkTextColor,fill:e.darkTextColor}})),[]);return a()("div",{style:l.container},void 0,a()(Un,{text:"All",icon:Ce.Z.browse,store:t,onClick:()=>e.onChangeTab("all"),selected:"all"===e.activeTab}),a()(Un,{text:"Created by me",icon:Ce.Z.person,store:i,onClick:()=>e.onChangeTab("createdByMe"),selected:"createdByMe"===e.activeTab}),a()(Un,{text:"Tasks",icon:Ce.Z.tasksDB,store:n,onClick:()=>e.onChangeTab("taskDB"),selected:"taskDB"===e.activeTab}),a()(Un,{text:"Projects",icon:Ce.Z.projectsDB,store:o,onClick:()=>e.onChangeTab("projectsDB"),selected:"projectsDB"===e.activeTab}),a()(Un,{text:"Docs",icon:Ce.Z.docsDB,store:o,onClick:()=>e.onChangeTab("docsDB"),selected:"docsDB"===e.activeTab}),a()(Un,{text:"Search Team",icon:Ce.Z.home,store:s,onClick:()=>e.onChangeTab("searchTeam"),selected:"searchTeam"===e.activeTab}))}function zn(){window.__c={n:"SearchFullContentSearchView"};const[e,t]=(0,r.useState)("all"),{searchResultStore:i,searchCreatedByMeResultStore:n,searchTaskDBResultStore:o,searchProjectsResultStore:s,searchDocsResultStore:l,searchSearchTeamResultStore:d}=(0,r.useContext)(oa);const c=function(){switch(e){case"all":return i;case"createdByMe":return n;case"taskDB":return o;case"projectsDB":return s;case"docsDB":return l;case"searchTeam":return d}}(),u=(0,K.Fy)(),{shouldShowSxSView:p}=(0,q.VK)((()=>({shouldShowSxSView:Boolean((0,Z.gq)({device:u})&&Z.BJ.state.visible),errorState:c.state.errorState,hideFilterBarForNavigationalSearch:"nav-local-only"===P.default.state.searchMode,hasQuery:Boolean(E.ZP.state.query.text.trim())||T.VA(E.ZP.state.query.filters)})),[c,u]),m=(0,H.yK)((()=>({container:{display:"flex",flexDirection:"row",flex:1,overflow:"hidden"},resultBody:{display:"flex",flexDirection:"column",width:"80%",paddingLeft:"5px",paddingRight:"5px"}})),[]),g={searchResultStore:c,searchDebugColumnStore:Z.v_,sxsMode:p};return a()("div",{style:m.container},void 0,a()(Wn,{onChangeTab:t,activeTab:e}),a()("div",{style:m.resultBody},void 0,a()(li,{isMobile:u.isMobile}),r.createElement(Vn,g)))}var Kn=i(38755);class qn extends l.Z{constructor(){super(...arguments),this.typingTimer=void 0,this.combined=this.createComputedStore((()=>{var e,t;return T.oO({results:{local:null===(e=this.props.searchResultStore.state.localResults)||void 0===e?void 0:e.results,server:null===(t=this.props.searchResultStore.state.serverResults)||void 0===t?void 0:t.results}})})),this.jumpToStore=this.createComputedStore((()=>{const e=this.combined.state,t=this.props.focusedIndexStore.state;if(!e||e.length<0||void 0===t)return;const i=e[t];return{jumpToText:m.Jc(null==i?void 0:i.store.getTitleValue()),jumpToIcon:null==i?void 0:i.store.getIcon()}})),this.renderLeft=e=>{var t,i;const{showSpinner:n}=this.props,{device:o}=this.environment,s=this.styles,r={...this.getThemeColors().searchIcon,...s.searchIcon()},l=Boolean(E.ZP.state.query.text.trim())&&!o.isMobile,d=null===(t=this.jumpToStore)||void 0===t||null===(i=t.state)||void 0===i?void 0:i.jumpToIcon,c=l?a()(Ve.Z,{disabled:!0,icon:d,isEmptyPage:Boolean(d),size:20,style:r}):Ce.Z.searchThick(r);return a()(fi.Z,{show:n,showDelay:500,showHold:200,render:e=>e?a()(mi.Z,{style:r}):c})},this.handleQueryChange=e=>{this.handleTyping();const t=String(e.target.value);this.props.onQueryChange(t)},this.handleClearButtonClick=()=>{E.ZP.resetQuery({resetFilters:!0}),E.ZP.update((e=>({...e,isSidebarOpen:!1,source:"quick_find"})))},this.handleFocus=()=>{const{onFocusChange:e}=this.props;e(!0)},this.handleBlur=()=>{const{onFocusChange:e}=this.props;e(!1)},this.styles={inputDesktop:{fontSize:18,height:qn.DESKTOP_INPUT_HEIGHT,paddingLeft:16,paddingRight:16,flexGrow:0,flexShrink:0,zIndex:1},inputMobile:{fontSize:16,border:"none",boxShadow:"none",borderRadius:7,lineHeight:"1.2",padding:"6px 8px"},searchIcon:()=>{const{device:e}=this.environment;return{width:e.isMobile?16:18,height:e.isMobile?16:18,marginRight:e.isMobile?12:10,flexGrow:0,flexShrink:0}},input:{minWidth:0,...Te.Z.textOverflowStyle},clearButton:{marginLeft:8}}}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){var e;const{device:t}=this.environment,{isOpen:i,searchResultStore:n}=this.props,o=this.styles,s=this.getThemeColors(),r=null===(e=this.jumpToStore.state)||void 0===e?void 0:e.jumpToText,l=E.ZP.state.query.text,d=(null==r?void 0:r.slice(0,l.length).toLocaleLowerCase())===l.toLocaleLowerCase()&&l&&l.length<20&&!t.isMobile?l+(null==r?void 0:r.substring(l.length)):"",c=t.isMobile?Mt.Z.Format.ExtraLarge:Mt.Z.Format.Transparent,u=t.isMobile?{...o.inputMobile,...s.inputMobile}:{...o.inputDesktop,...s.inputDesktop};return a()(Mt.Z,{format:c,placeholder:this.getPlaceholderText(),left:this.renderLeft(n),value:l,suggestedText:d,focus:t.isMobile?void 0:i&&!yi.state.open,focusInitial:!(0,Y.Y)("supportsNativeHome")&&t.isMobile,focusAfterAnimation:!0,showClearButton:!0,selectAll:!0,onChange:this.handleQueryChange,onClearButtonClick:this.handleClearButtonClick,onFocus:this.handleFocus,onBlur:this.handleBlur,style:u,inputStyle:o.input})}updateIfIsFirstKeyStroke(){void 0===O.default.state.firstKeyStrokeTimeMs&&O.default.update((e=>({...e,firstKeyStrokeTimeMs:Date.now()})))}handleTyping(){this.updateIfIsFirstKeyStroke();const{onTypingChange:e}=this.props;this.typingTimer&&window.clearTimeout(this.typingTimer),e(!0),this.typingTimer=window.setTimeout((()=>e(!1)),qn.TYPING_DEBOUNCE_MS)}getPlaceholderText(){const{currentSpaceStore:e,mainEditorCurrentBlockStore:t}=I.default.state,i=e&&(0,Kn.rn)(this.environment,e);if(i)return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedSpace",defaultMessage:"Search {spaceName}…"},{spaceName:i});if(t){const e=m.Jc(t.getTitleValue()).slice(0,qn.MAX_PLACEHOLDER_TITLE_LENGTH);return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedPage",defaultMessage:"Search in {pageTitle}…"},{pageTitle:e})}return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.unnamedPage",defaultMessage:"Search in page…"})}getThemeColors(){return{inputDesktop:{boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`},inputMobile:{background:this.theme.inputBackground},searchIcon:{fill:this.theme.mediumIconColor}}}}qn.displayName="SearchInputMenuItem",qn.TYPING_DEBOUNCE_MS=300,qn.DESKTOP_INPUT_HEIGHT=48,qn.MAX_PLACEHOLDER_TITLE_LENGTH=100;const Hn=(0,_e.injectIntl)(qn);var Gn=i(28020),jn=i(69327);class $n extends l.Z{constructor(){super(...arguments),this.storeTypes={isLoadingRecents:V.default.of(!1),endOfRecentsReached:V.default.of(!1)},this.renderComponent=()=>{if(!Ne.X4.state)return;const{device:e}=this.environment,t=this.defaultViewStyles,{currentSpaceStore:i}=I.default.state;if(!i)return;const n=(0,Gn.np)(),o=Ne.X4.state.filter((e=>e.pageId!==(null==n?void 0:n.id))),s={};o.forEach((e=>{let{pageId:t,visitedAt:i}=e;return s[t]=i}));const l=new Map;o.map(((t,i)=>{const n=Ne._5(t.visitedAt),a="Today"!==n&&"Yesterday"!==n,o={key:`${t.store.id}:${i}`,action:e=>this.props.onSelect({store:t.store,action:e}),render:i=>r.createElement(wn,z()({},i,{inline:!e.isMobile,store:t.store,hidePath:!1,lastViewed:a?s[t.store.id]:void 0,buttonStyle:{paddingLeft:1}}))};var d;l.has(n)?null===(d=l.get(n))||void 0===d||d.push(o):l.set(n,[o])}));const d=[];for(const[r,u]of l.entries()){const e=this.getMessageFromBucket(r),i={key:r,items:u,render:i=>a()(Ee.Z,{title:e,desktopTitleStyle:t.sectionHeader,disableDesktopPadding:!0,style:t.section},void 0,i.children)};d.push(i)}const c=!e.isMobile&&o.length>0;return r.createElement(r.Fragment,null,a()("div",{style:t.wrapper},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:0,disableKeyboardArrowWrap:!0,sections:d,unfocusOnScroll:!0}),a()(Ki.Z,{onChange:this.handleScrollOffsetChange})),c&&a()(Di,{title:a()(Oi,{})}))},this.handleScrollOffsetChange=e=>{this.getLastPageTimestamp()&&e<=200&&!this.stores.isLoadingRecents.get()&&!this.stores.endOfRecentsReached.get()&&this.loadMoreRecents()},this.loadMoreRecents=s().throttle((async()=>{const e=this.getLastPageTimestamp(),{currentSpaceStore:t}=I.default.state,i=this.environment.currentUser.id,n=null==t?void 0:t.id;if(!i||!n||!e)return;this.stores.isLoadingRecents.set(!0);const a=await Ne.Od(e,{environment:this.environment,userId:i,spaceId:n});this.stores.isLoadingRecents.set(!1),a||this.stores.endOfRecentsReached.set(!0)}),300),this.defaultViewStyles={wrapper:{width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},sectionHeader:{fontWeight:Te.Z.fontWeight.semibold,marginBottom:7,marginLeft:2},section:{marginBottom:18}}}getLastPageTimestamp(){const{currentSpaceStore:e}=I.default.state;if(!e)return;const t=jn.Z.getWithoutSubscribing(e.id),i=t[t.length-1];return null==i?void 0:i.visitedAt}getMessageFromBucket(e){switch(e){case"Today":return a()(_e.FormattedMessage,{id:"search.recentPagesTimeBuckets.today.text",defaultMessage:"Today",description:"Time buckets for the recent pages default view: Today"});case"Yesterday":return a()(_e.FormattedMessage,{id:"search.recentPagesTimeBuckets.yesterday.text",defaultMessage:"Yesterday",description:"Time buckets for the recent pages default view: Yesterday"});case"Past Week":return a()(_e.FormattedMessage,{id:"search.recentPagesTimeBuckets.pastWeek.text",defaultMessage:"Past Week",description:"Time buckets for the recent pages default view: Past 30 Days"});case"Past 30 Days":return a()(_e.FormattedMessage,{id:"search.recentPagesTimeBuckets.past30Days.text",defaultMessage:"Past 30 Days",description:"Time buckets for the recent pages default view: Past 30 Days"});case"Older":return a()(_e.FormattedMessage,{id:"search.recentPagesTimeBuckets.older.text",defaultMessage:"Older",description:"Time buckets for the recent pages default view: Older"})}(0,ee.t1)(e)}}$n.displayName="SearchDefaultBody";const Yn=$n;function Qn(){const{searchFilterMenuRef:e,handleRecentPageSelect:t,searchResultStore:i,secondarySearchResultStore:n}=(0,r.useContext)(oa),o=(0,K.Fy)(),{errorState:s,shouldShowSxSView:l,hideFilterBarForNavigationalSearch:d,hasQuery:c}=(0,q.VK)((()=>({shouldShowSxSView:Boolean((0,Z.gq)({device:o})&&Z.BJ.state.visible),errorState:i.state.errorState,hideFilterBarForNavigationalSearch:"nav-local-only"===P.default.state.searchMode,hasQuery:Boolean(E.ZP.state.query.text.trim())||T.VA(E.ZP.state.query.filters)})),[i,o]),u=(0,H.yK)((()=>({container:{display:"flex",flexDirection:"column",width:l?"50%":"100%"},sxsContainer:{display:"flex",flexDirection:"row",height:"100%",overflow:"hidden",maxWidth:"100%"}})),[l]),p=!1===s.isLoading&&s.showMajorError,m={searchResultStore:i,searchDebugColumnStore:Z.v_,sxsMode:l};return r.createElement(r.Fragment,null,!o.isMobile&&!d&&a()(li,{isMobile:o.isMobile}),c?r.createElement(r.Fragment,null,!p&&o.isMobile&&r.createElement(xt,{isMobile:!0,mode:kt.Section,ref:e}),a()("div",{style:u.sxsContainer},void 0,r.createElement(Vn,m),l&&r.createElement(Vn,z()({},m,{searchResultStore:n,searchDebugColumnStore:Z.BJ})))):a()(Yn,{onSelect:t}))}const Xn="80vh";function Jn(e){window.__c={n:"SearchContentPane"};const t=(0,K.Fy)();return he(),a()(ye.Z,{capture:!0,ignoreBlockSelection:!0,focusOffscreenInput:!1,restoreSelection:!t.isMobile,render:()=>a()(ve.Z,{capture:!0,allowMenuList:!0,render:t=>r.createElement(ea,z()({},e,{ignoreAreaEvents:t}))})})}function ea(e){window.__c={n:"SearchContentPaneInner"};const{ignoreAreaEvents:t,renderAsPage:i,onClose:n}=e,{handleQueryChange:o,searchFilterMenuRef:l,modalBodyMenuRef:d,searchResultStore:c,globalFocusedIndex:u}=(0,r.useContext)(oa),p=(0,H.yK)((e=>({body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},topbar:{height:void 0,marginTop:10,marginLeft:16,marginBottom:10,marginRight:16},topbarRightButtonWrapper:{flex:void 0,paddingLeft:16},topbarButton:{fontWeight:void 0,padding:0,color:e.mediumTextColor},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:i?"100vh":Xn},clearButton:{color:e.lightTextColor},sxsContainer:{display:"flex",flexDirection:"row",height:"100%",overflow:"hidden",maxWidth:"100%"}})),[i]),[m,g]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),v=(0,K.O7)(),y=(0,K.Fy)(),{isSearchMenuOpen:b,shouldShowFilterSidebar:S,hasPublicAccessPermission:w,hasQuery:M,shouldShowSpinner:C,searchMode:k}=(0,q.VK)((()=>{const e=Boolean(ce.Z.state.online),{hasPublicAccessPermission:t}=T.bC(v);return{isSearchMenuOpen:P.default.state.open,shouldShowSpinner:e&&Boolean(E.ZP.state.query.text)&&c.state.serverResultsLoading&&!m,shouldShowFilterSidebar:aa({device:y,isPublicAccessPermissionForPage:t}),hasPublicAccessPermission:t,hasQuery:Boolean(E.ZP.state.query.text.trim())||T.VA(E.ZP.state.query.filters),searchMode:P.default.state.searchMode}}),[m,c,y,v]),_=(0,r.useMemo)((()=>s().debounce((()=>{const{activeElement:e}=document;e instanceof HTMLInputElement&&e.blur()}),500,{leading:!0})),[]),I=(0,r.useCallback)((()=>{h&&_()}),[_,h]),x=(0,r.useCallback)((e=>{f(e),e||y.isMobileNative&&fe.Z.updateKeyboardPhase(v,fe.i.willHide,0)}),[y.isMobileNative,v]),Z=(0,r.useMemo)((()=>a()(Hn,{isOpen:Boolean(i||b),onTypingChange:g,onFocusChange:x,showSpinner:C,onQueryChange:o,searchResultStore:c,focusedIndexStore:u})),[i,b,x,C,o,c,u]),F=(0,r.useMemo)((()=>{if(y.isMobile){return{menuType:$.og.Modal,left:Z,shouldRenderLeftDirectly:!0,width:i?"100vw":void 0,...ia({isPhone:y.isPhone,renderAsPage:i,style:p.topbarRightButtonWrapper,onClick:n}),header:M&&a()(ni,{isPublicPageSearch:w}),disableHeaderShadow:!0,topbarStyle:p.topbar,leftRightButtonStyle:p.topbarButton,onScroll:na(y)?I:void 0,bodyScrollerClassName:j.GZn,...t}}const e={menuType:$.og.Popup,maxHeight:i?"100vh":Xn,minHeight:50,disableScroller:!0,scrollerStyle:p.scroller,...t};return i&&y.isDesktop&&(e.maxWidth="100%"),e}),[y,p,t,Z,i,n,M,w,I]),A="default"===k||"nav-local-only"===k||"nav-local-n-title"===k;return r.createElement(be.Z,z()({},F,{className:j.Oau,ref:d}),a()(ta,{enableLazyLoading:i},void 0,a()("div",{style:p.body},void 0,a()(Me.Z,{}),!y.isMobile&&Z,a()(A?Qn:zn,{})),S&&r.createElement(xt,{ref:l})))}function ta(e){window.__c={n:"SearchMenuContentsWrapper"};const{enableLazyLoading:t,children:i}=e,n=(0,K.O7)();return t?a()(we.Z,{fetch:async()=>{var e;await G.Vs(0),await I.default.waitUntil((()=>void 0!==I.default.state.currentSpaceStore)),null===(e=n.mobileNative)||void 0===e||e.markTransitionReady({type:"search"})},loading:()=>a()(r.Fragment,{}),render:()=>i}):a()(r.Fragment,{},void 0,i)}function ia(e){let{isPhone:t,style:i,renderAsPage:n,onClick:o}=e;return t&&(0,Y.Y)("supportsNativeHome")||n?{rightOuterStyle:{display:"none"}}:{right:a()(Se.CancelMenuText,{}),onClickRight:o,rightOuterStyle:i}}function na(e){return!!e.isMobile&&(!e.isIOS||e.isMobileNative)}function aa(e){let{device:t,isPublicAccessPermissionForPage:i}=e;if(!i&&!t.isMobile)return E.ZP.isSidebarOpen()}const oa=r.createContext(null),sa=r.createContext(null);class ra extends l.Z{constructor(){super(...arguments),this.inactiveTimer=void 0,this.spaceId=void 0,this.isOpen=!1,this.shouldClearServerResultsOnQueryChange=!1,this.queryResultsSectionRef=r.createRef(),this.searchFilterMenuRef=r.createRef(),this.modalBodyMenuRef=r.createRef(),this.searchResultStore=new L,this.secondarySearchResultStore=new L,this.searchCreatedByMeResultStore=new L,this.searchTaskDBResultStore=new L,this.searchProjectsResultStore=new L,this.searchDocsResultStore=new L,this.searchSearchTeamResultStore=new L,this.globalFocusedIndex=new V.default(0),this.getStaticContext=s().memoize((()=>({queryResultsSectionRef:this.queryResultsSectionRef,searchFilterMenuRef:this.searchFilterMenuRef,modalBodyMenuRef:this.modalBodyMenuRef,handleSelectResult:this.handleQueryResultSelect,handleRecentPageSelect:this.handleRecentPageSelect,handleQueryChange:this.handleQueryChange,searchResultStore:this.searchResultStore,secondarySearchResultStore:this.secondarySearchResultStore,searchCreatedByMeResultStore:this.searchCreatedByMeResultStore,searchTaskDBResultStore:this.searchTaskDBResultStore,searchProjectsResultStore:this.searchProjectsResultStore,searchDocsResultStore:this.searchDocsResultStore,searchSearchTeamResultStore:this.searchSearchTeamResultStore,globalFocusedIndex:this.globalFocusedIndex}))),this.getStoresContext=s().memoize((e=>({parentStore:e}))),this.renderContent=()=>a()(oa.Provider,{value:this.getStaticContext()},void 0,a()(sa.Provider,{value:this.getStoresContext(this.props.parentStore)},void 0,a()(Jn,{renderAsPage:this.props.renderAsPage,onClose:this.handleComponentClose}))),this.handleRecentPageSelect=e=>{this.handleSelectResult({...e,context:"recent_pages"})},this.handleQueryResultSelect=e=>{this.handleSelectResult({...e,context:"query_results"})},this.handleComponentOpenClose=()=>{this.isOpen!==P.default.state.open&&(this.isOpen=P.default.state.open,P.default.state.open&&(clearTimeout(this.inactiveTimer),E.ZP.update((e=>({...e,hasScrolled:!1})))))},this.handleComponentClose=()=>{const{device:e}=this.environment,{selectedQueryResult:t,numKeystrokes:i,numServerRequests:n,numLocalRequests:a,hadMetaClick:o}=O.default.state,{serverEventProperties:s}=this.searchResultStore.state,{query:r,hasScrolled:l}=E.ZP.state;if(i>0&&(n>0||a>0)&&!t&&!o&&(P.default.state.openAsPage||P.default.state.open)){const e=Date.now(),t=P.default.state.openedTimeMs,a=P.default.state.sessionId,o=O.default.state.firstKeyStrokeTimeMs;h.EH8(this.environment,{...s,timeToAbandonMs:e-t,timeFromFirstKeyStrokeToAbandonMs:o?e-o:void 0,numKeystrokes:i,numResultsAboveFold:this.getNumResultsAboveFold(),searchSessionId:a,searchSessionFlowNumber:n,hasScrolled:l,numLocalResults:this.getNumLocalResults()})}v.IB(),""===r.text.trim()?E.ZP.reset():T.FN(r.filters)||E.ZP.update((e=>({...e,isSidebarOpen:!1})));const d=x.default.getEligibleGroup({experimentId:"search-shorten-inactive-timer",defaultGroup:"control"});let c=120*g.C0;"control"!==d&&u.g6["search-shorten-inactive-timer"].includes(d)&&(c=parseInt(d,10)*g.C0),this.inactiveTimer&&clearTimeout(this.inactiveTimer),c>0?this.inactiveTimer=window.setTimeout(this.resetState,c):this.resetState(),!this.props.renderAsPage&&e.isMobile&&y.close(),O.default.reset()},this.handlePotentialWebSearchAbandon=e=>{this.props.renderAsPage&&this.handleComponentClose()},this.handleSelectResult=e=>{let{store:t,action:i,context:n,selectedResult:a,allSearchResults:o}=e;const{serverEventProperties:s}=this.searchResultStore.state,{numKeystrokes:r,hadMetaClick:l}=O.default.state;if(!P.default.state.open&&!P.default.state.openAsPage)return;const{event:d}=i,u=S.DJ(d);"query_results"===n&&(O.default.update((e=>({...e,selectedQueryResult:!0}))),this.searchResultStore.update((e=>({...e,selectedQueryResultQuery:E.ZP.state.query}))));const p=Date.now(),{openedTimeMs:m,sessionId:g}=P.default.state,{firstKeyStrokeTimeMs:v}=O.default.state,{numServerRequests:y}=O.default.state,{query:w}=E.ZP.state;h.nLf(this.environment,{...s,context:n,queryStringLength:w.text.trim().length,hasFilters:T.FN(w.filters),activeFilters:w.filters,selectedItemIndex:i.index,numKeystrokes:r,isMetaClick:Boolean(u),isSidebarOpen:E.ZP.isSidebarOpen(),timeToSelectMs:p-m,timeFromFirstKeyStrokeToSelectMs:v?p-v:p-m,sources:null==a?void 0:a.sources,localSources:null==a?void 0:a.localSource,indexInRecentPages:null==a?void 0:a.indexInRecentPages,timeSinceLastViewedMs:null==a?void 0:a.timeSinceLastViewedMs,hadMetaClick:l,numResultsAboveFold:this.getNumResultsAboveFold(),selectedSearchResultMetadata:this.getSearchResultMetadata(t,null==a?void 0:a.highlight),selectedSearchResultContent:"production"!==b.Z.env?this.getSearchResultContent(t,null==a?void 0:a.highlight):void 0,allSearchResultMetadata:null==o?void 0:o.slice(0,ra.MAX_RESULT_TO_TRACK).map((e=>this.getSearchResultMetadata(e.store,e.highlight))),totalSearchResultCount:null==o?void 0:o.length,searchSessionId:g,searchSessionFlowNumber:y,originalPosition:null==a?void 0:a.originalPosition,numLocalResults:this.getNumLocalResults()});const C=null==s?void 0:s["server-queryId"],k=this.jumpToBlock(a);void 0===k?f.navigateToPage({store:t,openInNew:u,environment:this.environment,queryId:C}):f.navigateToBlock({environment:this.environment,store:t,scrollToBlockId:k,openInNew:u,visitType:M.vu.Search,pageVisitSource:c.tY.Search,queryId:C}),N.Z.setState({queryId:C,pageId:t.id,timeEntered:new Date}),u?O.default.update((e=>({...e,hadMetaClick:!0}))):this.handleComponentClose()},this.handleQueryChange=e=>{this.shouldClearServerResultsOnQueryChange&&(this.searchResultStore.update((e=>({...e,serverResults:void 0}))),this.secondarySearchResultStore.update((e=>({...e,serverResults:void 0})))),""!==e?(O.default.update((e=>({...e,numKeystrokes:e.numKeystrokes+1}))),E.ZP.updateQueryText(e)):E.ZP.resetQuery({resetFilters:!1})},this.getNumResultsAboveFold=()=>T.MQ({environment:this.environment,searchResultsSection:this.queryResultsSectionRef.current,modalBodyMenu:this.modalBodyMenuRef.current,searchFilterMenu:this.searchFilterMenuRef.current}),this.getNumLocalResults=()=>{var e;return(null===(e=this.searchResultStore.state.localResults)||void 0===e?void 0:e.results.length)??0},this.jumpToBlock=e=>{var t;if(void 0!==(null==e?void 0:e.highlightBlockId)&&void 0===(null===(t=e.highlight)||void 0===t?void 0:t.title))return e.highlightBlockId},this.getSearchResultMetadata=(e,t)=>d.Z.withListenerIgnored((()=>{var i,n;return{blockId:e.id,blockType:e.getType(),lowestNavigableAncestorId:null===(i=e.getNavigableBlockStore())||void 0===i?void 0:i.id,depth:C.qA(e).length,matchesText:Boolean(null==t?void 0:t.text),matchesPathText:Boolean((null==t?void 0:t.pathText)||(null==t?void 0:t.title)),matchesTitle:Boolean(null==t?void 0:t.title),isNavigable:e.isNavigableBlock(),lastEditedTime:e.getLastEditedTime(),isTeamArchived:null===(n=(0,C.VP)(e))||void 0===n?void 0:n.isArchived()}})),this.getPathText=e=>{const t=[];return C.uJ(e).forEach((e=>{if(k.NZ(e)){var i;const n=(0,m.Q)(null===(i=e.getNavigableBlockStore())||void 0===i?void 0:i.getTitleValue());n&&t.push(n)}else if((0,_.bq)()&&k.Y(e)){const i=e.getName();i&&t.push(i)}})),t},this.handleSpaceChange=()=>{const e=I.default.state.currentSpaceStore&&I.default.state.currentSpaceStore.id;this.spaceId!==e&&(this.spaceId=e,this.resetState())},this.resetState=()=>{E.ZP.reset(),P.default.reset(),this.searchResultStore.reset(),this.secondarySearchResultStore.reset()}}willMount(){var e;this.spaceId=null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.id,this.shouldClearServerResultsOnQueryChange="on"===x.default.getGroup("search-clear-results-on-query-change"),(0,Z.lO)()}willMountOrUpdate(e){if(e.renderAsPage&&!P.default.state.sessionId){const e=(0,p.ZP)();P.default.update((t=>({...t,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:e}))),h.wFN(this.environment,{from:"nativeTab-search-direct-link",searchSessionId:e})}}didMount(){this.props.renderAsPage||P.default.addListener(this.handleComponentOpenClose),I.default.addListener(this.handleSpaceChange),f.potentialWebSearchAbandonEventEmitter.addListener(this.handlePotentialWebSearchAbandon)}willUnmount(){this.resetState(),this.props.renderAsPage||P.default.removeListener(this.handleComponentOpenClose),f.potentialWebSearchAbandonEventEmitter.removeListener(this.handlePotentialWebSearchAbandon),I.default.removeListener(this.handleSpaceChange),this.inactiveTimer&&(clearTimeout(this.inactiveTimer),this.inactiveTimer=void 0)}renderComponent(){if(this.props.renderAsPage)return this.renderContent();const{device:e,mobileNative:t}=this.environment,i=Boolean(P.default.state.open);return a()(U.Z,{open:i,onDismiss:this.handleComponentClose,modalStyle:this.getModalStyle(),disableAnimation:!e.isMobile||(null==t?void 0:t.supportsNativeHomeOnPhone())||!1,renderContent:this.renderContent})}getPublicAccessPermissionForPage(){return T.bC(this.environment)}getSearchResultContent(e,t){return d.Z.withListenerIgnored((()=>{var i;return{title:(0,m.Q)(null===(i=e.getNavigableBlockStore())||void 0===i?void 0:i.getTitleValue()),pathText:this.getPathText(e),highlight:{text:(0,w.fe)(null==t?void 0:t.text),pathText:(0,w.fe)(null==t?void 0:t.pathText)}}}))}getModalStyle(){const{renderAsPage:e}=this.props,t=(0,Z.gq)({device:this.environment.device}),i=aa({device:this.environment.device,isPublicAccessPermissionForPage:this.getPublicAccessPermissionForPage().hasPublicAccessPermission}),n="full-content"===P.default.state.searchMode;return{width:"75%",minHeight:ra.MIN_MENU_HEIGHT,maxHeight:e?"100vh":ra.MAX_MENU_HEIGHT,transform:"translate3d(0,0,0)",background:this.theme.popoverBackground,maxWidth:t||n?"90vw":i?900:660}}}ra.displayName="Search",ra.MAX_RESULT_TO_TRACK=50,ra.MIN_MENU_HEIGHT=50,ra.MAX_MENU_HEIGHT="80vh";const la=ra},32357:(e,t,i)=>{i.d(t,{Z:()=>x});var n=i(77094),a=i.n(n),o=i(67294),s=i(83355),r=i(3779),l=i(5366),d=i(97880),c=i(50906),u=i(57688),p=i(43250),m=i(79817),g=i(45094),h=i(38755),f=i(8323),v=i(23537),y=i(85834),b=i(12318),S=i(42922),w=i(64921),M=i(12508),C=i(63296),k=i(31278),T=i(64369),_=i(22193);class I extends s.Z{constructor(){super(...arguments),this.storeTypes={contextualInviteStore:y.ZP,isSpaceCardSelected:b.default.of(!1)},this.containerStyle={padding:12,display:"flex",flexDirection:"column",gap:16},this.iconStyle={width:20,height:20,fill:this.theme.lightIconColor}}didMount(){c.$24(this.environment,m.Oh(this.environment,this.stores.contextualInviteStore)),(0,v.$)(this.environment)&&this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:y.uq.page_guest})}renderComponent(){const{contextualInviteStore:e}=this.stores,t=e.getGuestEmails();if(!t.length)return null;const i=(0,v.$)(this.environment);return a()("div",{className:p.B8p,style:{...this.containerStyle,paddingTop:16,paddingBottom:16,paddingLeft:18,paddingRight:18}},void 0,a()("div",{},void 0,a()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},void 0,a()("div",{},void 0,e.state.inviteStage===y.TG.share_workspace?o.createElement(o.Fragment,null,a()(T.Z,{style:{fontWeight:600,marginBottom:4}},void 0,a()(l.FormattedMessage,{id:"contextualInvite.addToWorkspace.title",defaultMessage:"Add to workspace",description:"Title for the invitation modal asking if they also want to invite to workspace."})),a()(T.Z,{isMultiline:!0,isSmall:!0,style:{marginBottom:6}},void 0,a()(l.FormattedMessage,{id:"contextualInvite.addToWorkspace.subtitle",defaultMessage:"Do you want to add {emailCount, plural,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tone {this person}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tother {these people}\n\t\t\t\t\t\t\t\t\t\t\t\t\t} to the workspace in addition to the page? {isPaid, select,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttrue {This is a billable event.}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tother {}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}",description:"Explanation of the add to workspace action for the email tokens in the contextual invite in a zero teamspaces workspace.",values:{emailCount:t.length,isPaid:!(0,f.QM)()}})),a()(T.Z,{isMultiline:!0,isSmall:!0},void 0,a()(l.FormattedMessage,i?{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle.blockLimit",defaultMessage:"Adding them as a member will auto-create a teamspace{isFreeTier, select,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfree { and apply the 1,000 block limit to your workspace.}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tother {}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}",description:"Explanation of the add to workspace action for the email tokens in the contextual invite.",values:{isFreeTier:(0,f.QM)()?"free":"paid"}}:{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle",defaultMessage:"{isFreeTier, select,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfree {This action will apply the 1,000 block limit to your workspace.}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tother {}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}",description:"Explanation of the add to workspace action for the email tokens in the contextual invite in a zero teamspaces workspace.",values:{emailCount:t.length,isFreeTier:(0,f.QM)()?"free":"paid"}}))):o.createElement(o.Fragment,null,a()(T.Z,{style:{fontWeight:600,marginBottom:4}},void 0,a()(l.FormattedMessage,{id:"contextualInvite.requestToWorkspace.title",defaultMessage:"Request to add to workspace",description:"Title for the invitation modal asking what user wants to share with these emails."})),a()(T.Z,{isMultiline:!0,isSmall:!0},void 0,a()(l.FormattedMessage,{id:"contextualInvite.requestToWorkspace.subtitle",defaultMessage:"Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",description:"Explanation of the request to add to workspace action for the email tokens in the contextual invite.",values:{emailCount:t.length}}))),a()("div",{style:{display:"flex",flexWrap:"wrap",marginTop:16,marginBottom:16}},void 0,this.renderEmailTokensSubtitle(t)))),this.renderSpaceCard({showSpaceCardToggle:i}),a()("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18}},void 0,a()(C.Z,{isLarge:!0,style:{marginRight:10},onClick:()=>{this.selectPageGuestOption(),this.handleInviteClick()}},void 0,a()(l.FormattedMessage,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now",description:"Button title to skip adding or requesting email tokens in contextual invite."})),a()(S.Z,{isLarge:!0,disabled:i&&!this.stores.isSpaceCardSelected.state,onClick:()=>{e.state.inviteStage===y.TG.share_workspace&&this.selectWorkspaceMemberOption(),e.state.inviteStage===y.TG.request_workspace&&this.selectRequestWorkspaceMemberOption(),this.handleInviteClick()}},void 0,e.state.inviteStage===y.TG.share_workspace?a()(l.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button",defaultMessage:"Add to workspace",description:"Button title to add email tokens to the workspace."}):a()(l.FormattedMessage,{id:"ContextualInvite.sendRequest.button",defaultMessage:"Send request",description:"Button title to request email tokens to be added to the workspace."})))))}renderEmailTokensSubtitle(e){const{spaceStore:t}=this.props;return e.map((e=>a()(_.Z,{store:t,tokenType:"guest",showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e},spaceRole:"not_in_space"}},e)))}renderSpaceCard(e){let{showSpaceCardToggle:t}=e;const{spaceStore:i}=this.props,n=(0,h.Wd)(this.environment,i),o=this.getSpaceName(),s=i.getPublicSpaceData();let d;s&&(d=a()(l.FormattedMessage,{id:"contextualInvite.spaceCard.subtitle",description:"Label for the space card in the contextual invite indicating number of workspace members and workspace plan type.",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} · {planType}",values:{numberOfWorkspaceMembers:this.props.intl.formatNumber(s.memberCount),planType:this.props.intl.formatMessage((0,g.em)(s.subscriptionTier))}}));const c=n||o?a()(k.Z,{disabled:!0,icon:n,isEmptyPage:!1,title:o,size:30,style:{color:this.theme.regularTextColor,marginRight:12}}):r.Z.folder(this.iconStyle);return a()(w.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:this.theme.regularDividerColor,borderRadius:5,padding:12,justifyContent:"space-between",alignItems:"center"},disabled:!t,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state)},void 0,a()("div",{style:{display:"flex"}},void 0,c,a()("div",{},void 0,a()(T.Z,{},void 0,o),a()(T.Z,{isSmall:!0},void 0,d))),t&&a()(M.Z,{round:!0,checked:this.stores.isSpaceCardSelected.state,fill:this.theme.contentBackground,size:20,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state)}))}getSpaceName(){const{spaceStore:e}=this.props;return(0,h.rn)(this.environment,e)}selectWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:y.uq.workspace_member})}selectRequestWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:y.uq.request_workspace_member})}selectPageGuestOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:y.uq.page_guest})}async handleInviteClick(){const{contextualInviteStore:e}=this.stores,{spaceStore:t,blockStore:i,intl:n}=this.props;if(e.state.inviteStage===y.TG.closed||e.state.inviteStage===y.TG.share_page)return;const{selection:a}=e.state;switch(a){case y.uq.request_workspace_member:c.cir(this.environment,{...m.Oh(this.environment,e),from:"share_menu"}),await m.fC({environment:this.environment,spaceStore:t,originId:i.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:e,intl:n});break;case y.uq.workspace_member:if(c.E0y(this.environment,m.Oh(this.environment,e)),(0,v.$)(this.environment)){e.setState({...e.state,inviteStage:y.TG.closed});if(!(await u.HD({environment:this.environment,flowId:e.state.flowId??"",trackCreateTeamComplete:!1})))return}await m.j_({environment:this.environment,spaceStore:t,contextualInviteStore:e,from:"page_contextual_invite",intl:n});break;case y.uq.page_guest:e.reset();break;default:(0,d.t1)(a)}}}I.displayName="ContextualInvite";const x=(0,l.injectIntl)(I)},22193:(e,t,i)=>{i.d(t,{Z:()=>F});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(8848),p=i(84619),m=i(33728),g=i(3779),h=i(97880),f=i(82990),v=i(7928),y=i(5366),b=i(75472),S=i(16639),w=i(21115),M=i(53353),C=i(26781),k=i(25464),T=i(27832),_=i(55899),I=i(78291),x=i(58032),Z=i(45653),P=i(85567);const F=function(e){window.__c={n:"InviteTargetToken"};const{store:t,target:i}=e,n=(0,l.Fy)(),o=(0,y.useIntl)(),F=(0,c.yK)((()=>({verifiedDomain:{backgroundColor:"rgba(83, 168, 63, 0.1)"},disabled:{backgroundColor:"rgba(211, 79, 67, 0.1)",border:"dashed #D9655B 1px",paddingLeft:5},normal:{},guest:{backgroundColor:"rgba(218, 163, 64, 0.2)"},tokenContent:{display:"flex",alignItems:"center",maxWidth:"100%"},tokenSpan:{maxWidth:"100%"},tokenText:{marginLeft:4,...f.Z.textOverflowStyle}})),[]),A=(0,d.VK)((()=>{const{data:e}=I.default.state,t=e?w.CM(e):[],i={};return t.forEach((e=>{i[e.userId]=e})),i}),[]),B=(0,d.VK)((()=>{const e=T.default.state.currentSpaceStore;return new Set(null==e?void 0:e.getEmailDomains())}),[]),E=(0,M.Z)(t),D=(0,C.i)(t),R=(0,d.VK)((()=>{if(e.tokenType)return e.tokenType;if("group"===i.type)return"group";if("existingUser"===i.type&&!Boolean(i.spaceRole)){const e=A[i.value.id];i.spaceRole=e?e.role:"not_in_space"}if(!(0,b.OA)(i))return"member";const t=(0,m.Gd)(i.value.email);return t&&B.has(t)?"verifiedDomain":E.isStoreInTeam&&!E.teamAllowsGuests?"teamGuestDisabled":!E.isStoreInTeam&&!E.spaceAllowsGuests||E.isStoreInTeam&&!E.teamAllowsGuests&&!E.spaceAllowsGuests?"spaceGuestDisabled":"guest"}),[e.tokenType,i,A,B,E]),L=(0,d.VK)((()=>{switch(R){case"member":case"group":return F.normal;case"guest":return F.guest;case"verifiedDomain":return F.verifiedDomain;case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return F.disabled;default:(0,h.t1)(R)}}),[R,F]);function O(){const e=function(){const e=g.Z.help({height:16,width:16,color:"#D34F43"});switch(R){case"member":return(0,_.fZ)(i)?s()(Z.Z,{userValue:i.value,size:16}):(0,_.KU)(i)?s()(Z.Z,{size:16,avatar:i.value}):s()(Z.Z,{size:16});case"guest":return g.Z.globe2({height:16,width:16,color:"#DAA340"});case"verifiedDomain":return g.Z.circleCheck({height:16,width:16,color:"#53A83F"});case"group":return s()("div",{style:{height:16,width:16,backgroundColor:u.ZP.whiteWithAlpha(.8),borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"}},void 0,g.Z.typesPerson({height:12,width:12,color:u.ZP.mediumTextColor}));case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return e;default:(0,h.t1)(R)}}(),t=function(){switch(i.type){case"newUser":return i.value.email.trim();case"existingUser":return(0,v.Nz)(o,i.value);case"group":return(0,S.kF)({intl:o,group:i.value});default:(0,h.t1)(i)}}();return s()("div",{style:F.tokenContent},void 0,e,s()("div",{style:F.tokenText},void 0,t))}function N(t){var i;t.stopPropagation(),null===(i=e.onClickRemove)||void 0===i||i.call(e)}const V="newUser"===i.type?i.value.email:i.value.id,U="group"!==i.type?i.value.email:void 0;return s()(x.Z,{placement:k.u.Top,renderTooltip:()=>function(e){const{tokenType:t,target:i,email:n}=e;return"guest"===t?s()(y.FormattedMessage,{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip",description:"Tooltip for inviting a guest",values:{email:n}}):"spaceGuestDisabled"===t||"teamGuestDisabled"===t?D:"teamGroupOwner"===t&&"group"===i.type?s()(y.FormattedMessage,{defaultMessage:"Groups cannot be added as team owners.",id:"inviteTargetToken.groupTeamOwner.tooltip",description:"Tooltip describing groups cannot be added as owners to a team."}):"verifiedDomain"===t&&"group"!==i.type?r.createElement(r.Fragment,null,s()(y.FormattedMessage,{defaultMessage:"{email}{br}will automatically be added to the workspace{br}since @{domain} is a verified domain.",id:"inviteTargetToken.verifiedDomain.tooltip",description:"Tooltip describing this user will become a workspace member because it has a verified domain.",values:{email:i.value.email,br:s()("br",{}),domain:(0,m.Gd)(i.value.email)}})):"group"===i.type?i.value.name:n}({tokenType:R,email:U,target:i}),render:t=>r.createElement("span",a()({style:F.tokenSpan},t),s()(P.Z,{isSingle:!1,format:n.isMobile?p.l.Large:p.l.Medium,showRemoveButton:e.showRemoveButton,onClickRemove:N,disabledFeedback:!0,value:O(),style:L,shouldWrap:!1}))},V)}},20346:(e,t,i)=>{i.d(t,{Z:()=>h});var n=i(77094),a=i.n(n),o=(i(67294),i(83355)),s=i(3779),r=i(5366),l=i(50906),d=i(33665),c=i(23537),u=i(16354),p=i(89728),m=i(64369);class g extends o.Z{renderComponent(){const{device:e,WindowSizeStore:t}=this.environment;return a()(u.Z,{href:(0,d.UY)("guides.sharing"),onClick:()=>l.Fsx(this.environment,{from:"sharing"}),style:{width:e.isMobile?"100%":void 0},external:!0},void 0,a()(p.Z,{mobileFeedback:e.isMobile,isSmall:!0,style:{display:"flex",alignItems:"center",width:e.isMobile?"100%":void 0,height:e.isMobile?44:24,paddingTop:e.isMobile?12:4,paddingBottom:e.isMobile?12:4,paddingLeft:t.getSafePaddingLeftCSS(8),paddingRight:t.getSafePaddingRightCSS(12),...this.props.style},disabled:Boolean(this.props.disableHover)},void 0,a()("div",{style:{marginLeft:e.isMobile?2:0,marginRight:e.isMobile?8:6}},void 0,s.Z.help({width:e.isMobile?16:14,height:e.isMobile?16:14,fill:e.isMobile?this.theme.mediumIconColor:this.theme.lightIconColor})),a()(m.Z,{isSmall:!0,isMobile:e.isMobile,isSecondaryColor:!e.isMobile},void 0,(0,c.bq)()?a()(r.FormattedMessage,{defaultMessage:"Learn more",id:"blockPermissionsSettings.learnMore.prompt"}):a()(r.FormattedMessage,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"}))))}}g.displayName="LearnAboutSharingLink";const h=g},37432:(e,t,i)=>{i.d(t,{Z:()=>V});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(96486),l=i.n(r),d=i(67294),c=i(83355),u=i(8848),p=i(27006),m=i(21202),g=i(29369),h=i(97880),f=i(82990),v=i(5366),y=i(47307),b=i(48429),S=i(57688),w=i(84210),M=i(21115),C=i(23537),k=i(61766),T=i(85057),_=i(48690),I=i(78291),x=i(64921),Z=i(84076),P=i(31278),F=i(76798),A=i(58032),B=i(64369),E=i(7567),D=i(81954),R=i(24405);function L(e){window.__c={n:"NameAndIconWrap"};const{store:t}=e,i=(0,D.VK)((()=>t.getIcon()),[t]),n=(0,R.yK)((()=>({container:{whiteSpace:"nowrap",fontWeight:f.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]);return s()("span",{style:n.container},void 0,i&&s()(P.Z,{disabled:!0,icon:i,isEmptyPage:!1,size:12,style:n.recordIcon}),s()(F.ZP,{store:t,style:n.recordTitle}))}const O=function(e){window.__c={n:"InheritedPermissionTooltip"};const{store:t}=e;return s()(v.FormattedMessage,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:s()(L,{store:t})}})};class N extends c.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:k.Z},this.permissionItemStore=void 0,this.handleRoleSelect=async e=>{if(this.isDisplayOnlyPermissionItem(this.props.permissionItem))return;const t=this.props.permissionItem,i=l().clone(t);i.role=e;const n=this.props.currentBlockStore.isTopLevel();if(n&&p.ix(i)){const{data:e}=I.default.state,a=e?M.su(e):1;if(!(0,C.bq)()&&p.YX(t.role)&&!p.YX(i.role)&&a>1){if(!(await y.confirmUserAction({message:s()("span",{},void 0,s()(v.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <semibold>Only you will be able to access it.</semibold>",values:{semibold:e=>s()("span",{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,e)},id:"blockPermissionsSettings.confirmationDialog.private.message"})),acceptLabel:s()(v.FormattedMessage,{defaultMessage:"Move to Private",id:"blockPermissionsSettings.confirmationDialog.privateButton.label"})})))return}else if(!(0,C.bq)()&&n&&!p.YX(t.role)&&p.YX(i.role)){if(!(await y.confirmUserAction({message:s()("span",{},void 0,s()(v.FormattedMessage,{defaultMessage:"Are you sure you want to share this page with the workspace? <semibold>It will be accessible by all {memberCount} members.</semibold>",id:"blockPermissionsSettings.confirmationDialog.workspace.message",values:{semibold:e=>s()("span",{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,e),memberCount:a}})),acceptLabel:s()(v.FormattedMessage,{defaultMessage:"Move to workspace",id:"blockPermissionsSettings.confirmationDialog.workspaceButton.label"})})))return}}await b.iK({oldPermissionItem:t,newPermissionItem:i,wasInherited:this.isInherited(),environment:this.environment,store:this.props.currentBlockStore,sudoModeStore:this.props.sudoModeStore,location:this.props.location})},this.handleUserItemClick=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})},this.getPermissionItemStore=()=>{const{from:e,currentBlockStore:t}=this.props,i=e.table;return i===m.iU?T.G.createChildStore(t,{table:m.iU,id:e.blockId}):i===g.e0?T.zX.createChildStore(t,{table:g.e0,id:e.teamId}):void(0,h.t1)(i)}}willMountOrUpdate(){this.permissionItemStore=this.getPermissionItemStore()}renderComponent(){const{device:e}=this.environment,t=this.props.onClick?this.props.onClick:this.handleUserItemClick,i=this.isDisabled(),n=this.renderTooltip();return s()(A.Z,{delayThreshold:0,renderTooltip:()=>n,textWrap:!0,disableTooltip:!Boolean(n),style:{maxWidth:240},render:n=>d.createElement(x.Z,a()({disabled:i,mobileFeedback:e.isMobile,ignoreLocalHoverState:this.props.ignoreLocalHoverState,style:{...i?{cursor:"not-allowed"}:{}},onClick:t},n),this.renderMenuItem()),placement:A.Z.Placement.Left})}renderMenuItem(){const{device:e}=this.environment,{showInherited:t,permissionItem:i}=this.props,n=this.isUserItem(),a=this.isInherited();return s()("div",{className:"notranslate",style:this.getMenuItemStyle()},void 0,s()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,marginRight:e.isMobile?12:10,...this.props.iconStyle}},void 0,this.props.icon),s()("div",{style:{marginRight:"auto",minWidth:0}},void 0,s()("div",{style:{display:"flex",flexDirection:"row"}},void 0,s()(B.Z,{style:{...!n&&{fontWeight:400}}},void 0,this.props.title),this.props.tag&&s()("div",{style:{marginLeft:4}},void 0,this.props.tag)),this.props.subtitle&&s()(B.Z,{isSmall:!0},void 0,this.props.subtitle),t&&a&&this.renderInheritedRecordTitle()),s()("div",{style:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8}},void 0,this.props.permissionRoleSelect?this.props.permissionRoleSelect:!this.isDisplayOnlyPermissionItem(i)&&s()(E.Z,{role:this.role,table:m.iU,blockType:this.props.currentBlockStore.getType(),type:i.type,disabled:this.isDisabled(),isUserPermission:this.permissionItemIsUserItem(i),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:-6,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12},showPermissionOverrideWarning:a})))}renderTooltip(){return this.isInherited()?!this.isTeamOuterItem()&&this.permissionItemStore?s()(O,{store:this.permissionItemStore}):null:this.props.nonInheritedTooltip}renderInheritedRecordTitle(){const e=this.permissionItemStore||this.getPermissionItemStore(),t=e.table===m.iU?(0,w.ZP)({store:e,fullyQualified:!1}):void 0,i=e.table===g.e0?()=>{e.table===g.e0&&S.RF({environment:this.environment,teamId:e.id,tab:_.a.Members,from:"permission_item"})}:void 0,{device:n}=this.environment,a=e.getIcon(),o="team"!==e.table&&e.isEmptyPage();return s()(B.Z,{isSmall:!0,style:{lineHeight:1.4}},void 0,n.isMobile?s()(v.FormattedMessage,{defaultMessage:"Based on {linkBoxWithPageTitle}",description:"This text tells the user that this permission setting for the page is inherited from the parent page or team.",id:"pagePermissionItem.inheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:s()(Z.Z,{disabled:n.isMobile,underline:!n.isMobile,inline:!0,href:t,onClick:i},void 0,s()(F.ZP,{store:e,style:{display:"inline"}}))}}):s()(v.FormattedMessage,{defaultMessage:"From {linkBoxWithPageTitle}",description:"This text tells the user that this permission setting for the page is inherited from the parent page or team.",id:"pagePermissionItem.fromInheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:s()(Z.Z,{disabled:n.isMobile,underline:!1,inline:!0,href:t,onClick:i,innerStyle:{display:"inline-flex",alignItems:"center",borderBottom:`0.5px solid ${u.ZP.mediumTextColor}`}},void 0,s()(P.Z,{disabled:!0,style:{marginRight:4},icon:a,size:14,isEmptyPage:o}),s()(F.ZP,{store:e,style:{display:"inline",fontWeight:f.Z.fontWeight.semibold}}))}}))}permissionItemIsUserItem(e){const t=this.environment.currentUser.id;return"user_permission"===e.type&&e.user_id===t}isUserItem(){return"user_permission"===this.props.permissionItem.type}isTeamOuterItem(){return"team_overview_permission"===this.props.permissionItem.type}get role(){const{permissionItem:e,currentBlockStore:t}=this.props;if(this.isDisplayOnlyPermissionItem(e))return"none";if("content_only_editor"===e.role&&this.isInherited()){var i,n;const a=t.getParentCollectionStore(),o=null==a?void 0:a.getParentBlockStore();return o&&o.table===(null===(i=this.permissionItemStore)||void 0===i?void 0:i.table)&&o.id===(null===(n=this.permissionItemStore)||void 0===n?void 0:n.id)?e.role:"read_and_write"}return e.role}isDisabled(){return"hidden_permission"===this.props.permissionItem.type||!this.isTeamOuterItem()&&!this.props.currentBlockStore.canAdmin()}isInherited(){var e;return(null===(e=this.permissionItemStore)||void 0===e?void 0:e.id)!==this.props.currentBlockStore.id}isDisplayOnlyPermissionItem(e){return"team_overview_permission"===e.type||"hidden_permission"===e.type}getMenuItemStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",minHeight:this.props.isCompact?44:52,paddingTop:8,paddingBottom:8,paddingLeft:e.getSafePaddingLeftCSS(14),paddingRight:e.getSafePaddingRightCSS(14)}}}N.displayName="PermissionItem",N.iconSize=32;const V=N},76961:(e,t,i)=>{i.r(t),i.d(t,{OfflineMessage:()=>ca,default:()=>ua});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(5366),p=i(43250),m=i(60709),g=i(33665),h=i(96486),f=i.n(h),v=i(26825),y=i(27006),b=i(21202),S=i(90468),w=i(29369),M=i(28020),C=i(98165),k=i(67669),T=i(23537),_=i(27832),I=i(85057);function x(e){const{store:t}=e;if(t.getParentTable()===S.bx)return!1;const i=(0,C.Om)(t),n=i?(0,v.Wo)((0,C.fJ)(i)):[],a=t.getPermissionItems(),o={};for(const s of n)o[(0,v.OC)(s)]=s.role;for(const s of a){const e=s.role,t=o[(0,v.OC)(s)];if(t){if((0,y.iC)(e)&&(0,y.iC)(t)&&(0,v.xO)(e,t))return!0}else if((0,y.ix)(s)||(0,y.ZQ)(s)||(0,y.RI)(s))return!0}return!1}function Z(e){const{store:t}=e,i=(0,C.uJ)(t)[1];return{parentStore:i,canAccessParent:i&&i.canRead()}}function P(e){const{store:t}=e,i=(0,C.VP)(t),n=_.default.state.currentSpaceStore;return Boolean((null==n?void 0:n.getDisableGuests())||(null==i?void 0:i.getDisableGuests()))}function F(e){const{mostPermissivePermissions:t,store:i,teamId:n,type:a}=e;if(!n)return;const o=t.find((e=>{let{permissionItem:t}=e;return t.type===a}));if(o)return o;const s=t.find((e=>{let{permissionItem:t}=e;return y.Le(t)}));return"explicit_team_guest_permission"!==a||s?{permissionItem:{type:a,role:"none",team_id:n},from:(null==s?void 0:s.from)??{table:b.iU,blockId:i.id}}:void 0}function A(e){const{environment:t,spaceStore:i,store:n}=e,a=(0,k.YO)(n);let o=[];i&&(o=i.getPermissionGroups());const s=C.VP(n),r=function(e){let{mostPermissivePermissions:t,store:i}=e;return t.find((e=>{let{permissionItem:t}=e;return y.$D(t)}))||{permissionItem:{type:"public_permission",role:"none"},from:{table:b.iU,blockId:i.id}}}({mostPermissivePermissions:a,store:n}),l=function(e){let{mostPermissivePermissions:t,store:i,teamStore:n}=e;const a=t.find((e=>{let{permissionItem:t}=e;return y.ix(t)}));if(a)return a;const o=t.find((e=>y.Le(e.permissionItem)));return{permissionItem:{type:"space_permission",role:"none"},from:null!=o&&o.from||!n||"none"!==n.getSpacePermissionRole()?(null==o?void 0:o.from)??{table:b.iU,blockId:i.id}:{table:w.e0,teamId:n.id}}}({mostPermissivePermissions:a,store:n,teamStore:s}),d=F({mostPermissivePermissions:a,store:n,teamId:null==s?void 0:s.id,type:"explicit_team_guest_permission"}),c=F({mostPermissivePermissions:a,store:n,teamId:null==s?void 0:s.id,type:"explicit_team_permission"}),u=F({mostPermissivePermissions:a,store:n,teamId:null==s?void 0:s.id,type:"explicit_team_owner_permission"});let p=a.filter((e=>{let{permissionItem:t}=e;return y.hV(t)}));p=f().sortBy(p,(e=>{if(i){return i.getPermissionGroups().findIndex((t=>t.id===e.permissionItem.group_id))}return e.permissionItem.group_id}));let m=a.filter((e=>{let{permissionItem:t}=e;return(y.zU(t)||y.LW(t))&&t.team_id!==(null==s?void 0:s.id)}));const g=new Map;m.forEach(((e,t)=>{let{permissionItem:i}=e;g.has(i.team_id)||g.set(i.team_id,t)})),m=f().sortBy(m,[e=>{let{permissionItem:t}=e;return g.get(t.team_id)||0},e=>{let{permissionItem:t}=e;return"explicit_team_owner_permission"===t.type?0:1}]);const h=a.filter((e=>{let{permissionItem:t}=e;return y.jg(t)})),v=(0,M.k_)(t).state,S=Boolean(null==s?void 0:s.isDefined());let _=v&&v.showWorkspaceSection||i&&"team"===i.getPlanType()||"none"!==l.permissionItem.role;(0,T.bq)()&&(_=i&&"team"===i.getPlanType()||"none"!==l.permissionItem.role);const I=_||S||h.length>1||h.length&&!y.zz(h[0].permissionItem.role)||p.length||y.YX(l.permissionItem.role);return{showRestrictedPermissionBanner:a.some((e=>y.Le(e.permissionItem)&&e.from.table===b.iU&&e.from.blockId===n.id)),showTeamPermission:S,showSpacePermission:_,mostPermissivePublicItem:r,mostPermissiveTeamOwnerItem:u,mostPermissiveTeamMemberItem:c,mostPermissiveTeamGuestItem:d,mostPermissiveSpaceItem:l,pagePermissionUIModel:{showUserPermissions:I,mostPermissiveGroupPermissions:p,mostPermissiveTeamPermissions:m,mostPermissiveUserPermissions:h,spacePermissionGroups:o},permissionItemsCount:(I?h.length:0)+m.length+p.length+(_?1:0)+(S?1:0)}}var B=i(92994),E=i(88632),D=i(85834),R=i(52878),L=i(1743),O=i(56940),N=i(78140),V=i(40721),U=i(64369),W=i(46247),z=i(32357),K=i(75472),q=i(21115),H=i(77907),G=i(78291),j=i(64921),$=i(94044),Y=i(82990),Q=i(42922),X=i(83355),J=i(8848);class ee extends X.Z{renderComponent(){return s()(j.Z,{hovered:this.props.hovered,onClick:this.props.onClick,disabled:this.props.disabled,disabledFeedback:!0,style:{...this.getButtonStyle(),...this.props.isLarge&&{height:32},...this.props.style},hoveredStyle:{background:this.theme.buttonHoveredBackground},pressedStyle:{background:this.theme.buttonPressedBackground},onFocus:this.props.onFocus,onBlur:this.props.onBlur,onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,className:this.props.className},void 0,this.props.children)}getButtonStyle(){return{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:3,boxShadow:this.theme.plainButtonBoxShadow,background:this.theme.inputBackground,color:this.theme.mediumTextColor,fill:J.ZP.white,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontSize:14}}}ee.displayName="InputButton";const te=ee;var ie=i(58032);const ne=function(e){window.__c={n:"PermissionsInviteEntry"};const{store:t}=e,{isMobile:i}=(0,l.Fy)(),n=(0,d.VK)((()=>t.canEditMembership()),[t]),o=(0,c.yK)((()=>({buttonContainer:{display:"flex",alignItems:"center",gap:$.p_},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden"},blueButton:{minWidth:$.UF}})),[]);return s()(ie.Z,{renderTooltip:()=>s()(u.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:n,render:t=>r.createElement("div",a()({style:o.buttonContainer},t),s()(te,{onClick:e.onClick,disabled:!n&&!0,style:o.inputButton},void 0,s()("div",{style:Y.Z.textOverflowStyle},void 0,s()(u.FormattedMessage,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots",description:"Placeholder text for the search input in the invite user modal"}))),!i&&s()(Q.Z,{isLarge:!0,onClick:e.onClick,disabled:!n&&!0,style:o.blueButton},void 0,s()(u.FormattedMessage,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})))})};const ae=function(e){window.__c={n:"InviteSection"};const{store:t,permissionsInviteStore:i,contextualInviteStore:n}=e,a=(0,d.VK)((()=>i.state.modalOpen),[i]),o=(0,l.O7)(),r=(0,d.VK)((()=>t.canAdmin()),[t]),u=(0,d.VK)((()=>{const{data:e}=G.default.state;return Boolean(e&&q.YK(e))}),[]),p=(0,d.VK)((()=>P({store:t})),[t]),{WindowSizeStore:m}=o,{paddingLeft:g,paddingRight:h}=(0,d.VK)((()=>({paddingLeft:m.getSafePaddingLeftCSS(14),paddingRight:m.getSafePaddingRightCSS(14)})),[m]),f=o.device.isMobile,v=(0,c.yK)((e=>({button:{display:"flex",alignItems:"center",minHeight:52,paddingTop:f?0:10,paddingBottom:f?0:10,paddingLeft:g,paddingRight:h,marginTop:f?-12:0},buttonInner:{width:"100%"},modalButton:{height:f?36:28}})),[f,g,h]);return s()(j.Z,{mobileFeedback:f,disabled:!0,style:v.button},void 0,s()("div",{style:v.buttonInner},void 0,a&&s()(H.LazyPermissionsInviteWithModal,{store:t,disabled:!r,membersOnly:p,isSubscribed:u,onUpgradeButtonClick:e.onUpgradeButtonClick,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:v.modalButton,permissionsInviteStore:i}),s()(ne,{store:t,onClick:()=>function(e){const{store:t,environment:i,isSubscribed:n,permissionsInviteStore:a,contextualInviteStore:o}=e,s={environment:i,permissionsInviteStore:a,store:t,isSubscribed:n};if(i.device.isMobile)return void(0,K.z5)({...s,renderInShareModal:!1});(0,K.z5)({...s,renderInShareModal:!0}),o.setState({...o.state,inviteStage:D.TG.share_page,flowId:a.state.flowId})}({store:t,environment:o,isSubscribed:u,permissionsInviteStore:i,contextualInviteStore:n})})))};var oe=i(19889),se=i(7928),re=i(64684);function le(){const{data:e}=G.default.state,t=e?q.CM(e):[],i=new Map;return t.forEach((e=>{i.set(e.userId,e)})),i}function de(e){const{spaceVisibleUserMap:t,blockStore:i,userId:n}=e,a=t.get(n);if(!a||"none"!==a.role)return;if(!a.isTeamGuest)return"guest";const o=C.VP(i);if(!o)return"guest";return(0,re.s8)({team:{membership:o.getRawMembership()},userId:n})?"team_level_guest":"guest"}var ce=i(65598),ue=i(16639),pe=i(34859),me=i(18647),ge=i(41892),he=i(12793),fe=i(31278),ve=i(25735),ye=i(60442),be=i(37432);function Se(e){window.__c={n:"GroupPermissionTooltip"};const{group:t}=e,i=(0,u.useIntl)(),n=(0,ue.kF)({intl:i,group:t});return s()(ve.Y,{group:t,limit:15,noMembersMessage:s()(ye.Z,{imageURL:ge.Z.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:s()(u.FormattedMessage,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:e=>s()("span",{style:{fontWeight:Y.Z.fontWeight.bold}},void 0,e),groupName:n},id:"blockPermissionsSettings.groupPermission.tooltip"})})})}const we=function(e){window.__c={n:"BlockGroupPermissionItem"};const{store:t,groupPermission:i,spaceId:n}=e,o=(0,u.useIntl)(),l=(0,d.VK)((()=>{const{currentSpaceStore:e}=_.default.state;if(!e)return!1;return e.getPermissionGroups().find((e=>e.id===i.permissionItem.group_id))}),[i.permissionItem.group_id]);if(!l)return null;const c=l.user_ids||[],m=(0,ue.kF)({intl:o,group:l}),g=l.icon&&s()(fe.Z,{disabled:!0,title:m,icon:l.icon?{pointer:{table:"space",id:n},icon:l.icon}:void 0,isEmptyPage:!1,size:18});return s()("div",{style:{fontWeight:400},className:p.gGc},l.id,r.createElement(be.Z,a()({currentBlockStore:t,permissionItem:i.permissionItem,from:i.from,icon:s()(he.Z,{size:be.Z.iconSize}),title:m,tag:g,ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:s()(Se,{group:l}),subtitle:s()("div",{},void 0,s()(u.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label",description:"Indicates a group of members"})," · ",s()(u.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:c.length}})),upgradeButtonName:"group_permission_item"},e.permissionItemArgs)))};var Me=i(88198),Ce=i(45653);function ke(e){window.__c={n:"Icon"};const{userValue:t}=e,i=(0,c.yK)((()=>({iconPlaceholder:{height:be.Z.iconSize,width:be.Z.iconSize,borderRadius:20}})),[]);return t?s()(Ce.Z,{userValue:t,size:be.Z.iconSize}):s()(Ie,{style:i.iconPlaceholder})}function Te(e){const{userValue:t,guestLabel:i}=e,n=(0,u.useIntl)(),a=(0,c.yK)((()=>({titlePlaceholder:{height:8,width:81,borderRadius:3}})),[]);if(!t)return s()(Ie,{style:a.titlePlaceholder});const o=(0,se.Nz)(n,t);return r.createElement(r.Fragment,null,o?s()("div",{style:{display:"flex",gap:4}},void 0,s()(U.Z,{className:"notranslate"},void 0,o),i&&s()(Me.b,{labelType:i})):s()(u.FormattedMessage,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"}))}function _e(e){window.__c={n:"Subtitle"};const{userValue:t}=e,i=(0,c.yK)((()=>({uiLabel:{display:"flex"},subtitlePlaceholder:{height:8,width:139,borderRadius:3,marginTop:10},dotSeparator:{marginLeft:2,marginRight:2}})),[]);return null!=t&&t.email?s()(U.Z,{isSmall:!0},void 0,t.email):s()(Ie,{style:i.subtitlePlaceholder})}function Ie(e){window.__c={n:"Placeholder"};const t=(0,c.yK)((t=>({placeholder:{...e.style,background:t.lightDividerColor}})),[e.style]);return s()("div",{style:t.placeholder})}const xe=function(e){window.__c={n:"BlockUserPermissionItem"};const{store:t,userPermission:i,spaceVisibleUserMap:n}=e,o=(0,d.VK)((()=>I.U6.createChildStore(t,{table:oe.KJ,id:i.permissionItem.user_id}).getValue()),[t,i.permissionItem.user_id]),l=(0,d.VK)((()=>{if(null!=o&&o.id)return de({spaceVisibleUserMap:n,userId:o.id,blockStore:t})}),[t,n,o]);return s()("div",{},i.permissionItem.user_id,r.createElement(be.Z,a()({currentBlockStore:t,permissionItem:i.permissionItem,from:i.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:s()(ke,{userValue:o}),title:s()(Te,{userValue:o,guestLabel:l}),subtitle:s()(_e,{userValue:o}),showInherited:e.showInherited,upgradeButtonName:"user_permission_item"},e.permissionItemArgs)))};var Ze=i(3779);function Pe(e){let{permissions:t}=e;const[i,n]=(0,r.useState)(!1),a=(0,c.yK)((e=>({button:{display:i?"none":"inline-flex",padding:10,width:"100%"},icon:{width:14,transform:"rotate(90deg)",marginLeft:14,marginRight:18,fill:e.lightIconColor},list:{display:i?"block":"none"}})),[i]);return r.createElement(r.Fragment,null,s()(j.Z,{onClick:()=>n(!0),style:a.button},void 0,s()("div",{},void 0,Ze.Z.dots(a.icon)),s()(U.Z,{isSmall:!0,isSecondaryColor:!0},void 0,s()(u.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.expandButton",defaultMessage:"{count} more people",description:"Text for button that communicates how many more people will be revealed when clicked. Always at least 3 people. ",values:{count:t.length}}))),s()("div",{style:a.list},void 0,t))}const Fe=function(e){window.__c={n:"MorePeoplePermissionItem"};const{store:t}=e,i=(0,c.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),n={table:b.iU,blockId:t.id};return s()(be.Z,{icon:Ze.Z.personBadgeQuestionMark(i.icon),iconStyle:i.iconContainer,title:s()(u.FormattedMessage,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess",description:"Warns that there may be additional users who have access to the page"}),nonInheritedTooltip:s()(u.FormattedMessage,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you don't have access to",description:"Explains why the 'More people may have access' warning is shown",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:r.createElement(r.Fragment,null),currentBlockStore:t,permissionItem:{type:"hidden_permission"},from:n,upgradeButtonName:"team_permission_item"})};var Ae=i(97880),Be=i(38755),Ee=i(93686),De=i(48429),Re=i(57688),Le=i(84210),Oe=i(25464),Ne=i(48690),Ve=i(84076),Ue=i(76798),We=i(62385);function ze(e){window.__c={n:"PermissionsRestoreBanner"};const{showRestoreButton:t,store:i,type:n,sudoModeStore:a}=e,{isMobile:o}=(0,l.Fy)(),r=(0,d.VK)((()=>C.uJ(i)[1]),[i]),u=(0,l.O7)(),p=(0,d.VK)((()=>({paddingLeft:u.WindowSizeStore.getSafePaddingLeftCSS(14),paddingRight:u.WindowSizeStore.getSafePaddingLeftCSS(14)})),[u]),m=(0,c.yK)((e=>({container:{display:"flex",minHeight:20,flexDirection:"row",alignItems:"center",paddingTop:8,paddingBottom:6,paddingLeft:p.paddingLeft,paddingRight:p.paddingRight},banner:{display:"flex",flexDirection:"row",width:"100%",fontSize:12},icon:{width:16,fill:e.mediumIconColor},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginRight:5},messageContainer:{display:"flex",flexDirection:"column"},label:{display:"inline",marginLeft:o?14:0,color:o?"#CF8807":e.mediumTextColor,fontWeight:o?Y.Z.fontWeight.regular:Y.Z.fontWeight.medium,marginRight:6,lineHeight:"20px"},buttonContainer:{marginLeft:-5},divider:{opacity:"75%"},mobileContainer:{borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:9,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"rgba(246, 192, 80, 0.26)"}})),[o,p]);return o?s()("div",{style:m.mobileContainer},void 0,s()(U.Z,{isMultiline:!0,isSmall:!0,style:m.label},void 0,s()(He,{type:n,navigableParentStore:r,showRestoreButton:t})),t&&s()(Ke,{store:i,type:n})):s()("div",{style:m.container},void 0,s()("div",{style:m.banner},void 0,s()("div",{style:m.iconContainer},void 0,Ge[n](m.icon)),s()("div",{},void 0,s()(U.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:m.label},void 0,s()(He,{type:n,navigableParentStore:r,showRestoreButton:t})),t&&s()("span",{style:m.buttonContainer},void 0,s()(Ke,{store:i,type:n,sudoModeStore:a})))))}function Ke(e){const{type:t,store:i,sudoModeStore:n}=e,{isMobile:a}=(0,l.Fy)(),o=(0,d.VK)((()=>!!n&&n.shouldSaveTransactionWithSudoMode(i)),[i,n]),p=(0,c.yK)((e=>({button:{color:a?"#CF8807":e.regularTextColor,fontWeight:Y.Z.fontWeight.medium},tooltip:{width:210,whiteSpace:"initial"}})),[a]),m=(0,l.O7)();if("restore-team"===t){const e=async()=>{await De.Kt({environment:m,useSudoMode:o,store:i})};return s()(ie.Z,{style:p.tooltip,placement:Oe.u.Bottom,renderTooltip:()=>s()(u.FormattedMessage,{defaultMessage:"Reset page permissions to match default teamspace permissions",id:"permissionsRestoreBanner.tooltip.teamPermissions",description:"Tooltip for a button explaining that page permissions will be cleared to match teamspace defaults."}),render:t=>r.createElement("span",t,s()(We.Z,{style:p.button,onClick:e},void 0,s()(u.FormattedMessage,{id:"permissionsRestoreBanner.button.teamPermissions",defaultMessage:"Reset",description:"Action for when user wants to restore permissions to a page."})))})}if("unrestrict"===t){const e=async()=>{const e=i.getPermissionItems(),t=C.Om(i),n=t?(0,v.Wo)(C.fJ(t)):[],a=(0,v.Xr)(e,n);await De.wx({environment:m,useSudoMode:o,store:i,permissionChanges:a})};return s()(We.Z,{style:p.button,onClick:e},void 0,s()(u.FormattedMessage,{id:"permissionsRestoreBanner.button.restrictedPermissions",defaultMessage:"Restore",description:"Action for when user wants to restore permissions to a page."}))}(0,Ae.t1)(t)}function qe(e){window.__c={n:"ClickableAttribution"};const{navigableParentStore:t,maxLength:i,showUnderline:n}=e,{isMobile:a}=(0,l.Fy)(),o=(0,l.O7)(),r=(0,c.yK)((e=>({linkBox:{color:e.mediumTextColor},title:{display:"inline"}})),[]),u=(0,d.VK)((()=>{if(t instanceof I.G)return(0,Le.ZP)({store:t,fullyQualified:!1})}),[t]);if(!t)return null;const p=a&&t.table===w.e0;return s()(Ve.Z,{disabled:p,style:p?void 0:r.linkBox,underline:n&&!p,inline:!0,onClick:t.table===w.e0?()=>{t.table===w.e0&&Re.RF({environment:o,teamId:t.id,tab:Ne.a.Members,from:"permission_item"})}:void 0,href:u},void 0,s()(Ue.ZP,{shouldWrap:!0,maxLength:i,store:t,style:r.title}))}function He(e){const{type:t,navigableParentStore:i,showRestoreButton:n}=e,{isMobile:a}=(0,l.Fy)(),o=s()(qe,{navigableParentStore:i,maxLength:a||!n?void 0:30,showUnderline:!0});switch(t){case"restore-team":return s()(u.FormattedMessage,{id:"pageShareMenu.restoreTeamPermissionsBanner.label",defaultMessage:"Page access is different from {linkBoxWithPageTitle}.",description:"This text tells the user that this permission setting for the page is not the same as the parent page permissions / teamspace defaults.",values:{linkBoxWithPageTitle:o}});case"unrestrict":return s()(u.FormattedMessage,a?{id:"pageShareMenu.restrictedAccessBanner.mobileLabel",defaultMessage:"Page access is restricted to people below.",description:"This text tells the user that the permission settings for the page is restricted to the list of permissions below.",values:{linkBoxWithPageTitle:o}}:{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",description:"This text tells the user that this permission setting for the page is NOT inherited from the parent page.",values:{linkBoxWithPageTitle:o}});default:(0,Ae.t1)(t)}}const Ge={unrestrict:Ze.Z.eyeHide,"restore-team":Ze.Z.info},je=(0,u.defineMessages)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}",description:"The user has full access on this page based on the permission item from attribution."},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}",description:"The user can edit the page based on the permission item from attribution."},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}",description:"The user can edit the content on the page based on the permission item from attribution."},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}",description:"The user can comment on the page based on the permission item from attribution."},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}",description:"The user can view the page based on the permission item from attribution."}});function $e(e){let{store:t}=e;window.__c={n:"PermissionLevelBanner"};const i=(0,l.O7)(),n=(0,d.VK)((()=>(0,M.B7)(i)),[i]),o=(0,d.VK)((()=>t.canEditContentOnly()),[t]),p=(0,c.yK)((e=>({container:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},banner:{fontSize:12,display:"inline-flex"},icon:{marginLeft:14,marginRight:8},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:5}})),[]),{role:m,attribution:g}=(0,d.VK)((()=>{if(!n)return{role:"none",attribution:null};const e=(0,k.Dt)({userId:n.id,store:t}),a=function(e){let{environment:t,calculatedPermission:i,store:n}=e;const a=(0,C.Pj)(n)||_.default.state.currentSpaceStore;if(!a)return null;if((0,y.hV)(i)){const e=(0,Be.TC)({spaceStore:a,groupId:i.group_id}),t=null==e?void 0:e.name;return t?r.createElement(r.Fragment,null,Ze.Z.group({width:18,marginRight:5}),t):null}if((0,y.fG)(i)){var o;const e=i.team_id||(null===(o=(0,C.VP)(n))||void 0===o?void 0:o.id);if(!e)return null;const t=I.zX.createChildStore(a,{table:w.e0,id:e,spaceId:a.id});return r.createElement(r.Fragment,null,s()(Ee.p,{disabled:!0,store:t,size:18,style:{marginRight:5}}),s()(qe,{navigableParentStore:t,showUnderline:!0}))}if((0,y.ix)(i))return r.createElement(r.Fragment,null,s()(Ee.p,{disabled:!0,store:a,size:18,style:{marginRight:5}}),(0,Be.rn)(t,a));return null}({environment:i,calculatedPermission:e,store:t});return{role:e.role,attribution:a}}),[n,t,i]);if(!(0,y.iC)(m))return null;const h=function(e){switch(e){case"editor":return je.fullAccess;case"read_and_write":return je.editor;case"content_only_editor":return je.contentEditor;case"comment_only":return je.commenter;case"reader":return je.reader;case"none":case"membership_admin":return null;default:(0,Ae.t1)(e)}}(m);return h?s()(ie.Z,{delayThreshold:0,renderTooltip:()=>s()(u.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!o,textWrap:!0,style:{maxWidth:180},render:e=>r.createElement("div",a()({style:p.container},e),s()(Ce.Z,{userStore:n,size:20,style:p.icon}),s()(U.Z,{style:p.banner},void 0,r.createElement(u.FormattedMessage,a()({},h,{values:{hasAttribution:Boolean(g),attribution:s()("span",{style:p.attribution},void 0,g)}})))),placement:ie.Z.Placement.Left}):null}function Ye(){return window.__c={n:"MorePeopleAttribution"},s()(Qe,{},void 0,s()(u.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.moreAttribution",defaultMessage:"More people with access",description:"Header for list of people/groups that were added to a page directly"}))}function Qe(e){window.__c={n:"AttributionWrapper"};const{children:t}=e,{WindowSizeStore:i}=(0,l.O7)(),{paddingLeft:n,paddingRight:a}=(0,d.VK)((()=>({paddingLeft:i.getSafePaddingLeftCSS(14),paddingRight:i.getSafePaddingRightCSS(14)})),[i]),o=(0,c.yK)((e=>({label:{color:e.mediumTextColor,fontWeight:Y.Z.fontWeight.medium,paddingLeft:n,paddingRight:a,paddingTop:8,paddingBottom:6}})),[n,a]);return s()(U.Z,{isSmall:!0,style:o.label},void 0,t)}const Xe=function(e){window.__c={n:"PermissionsAttributionHeader"};const{store:t}=e,{parentStore:i,canAccessParent:n}=(0,d.VK)((()=>Z({store:t})),[t]);return s()(Qe,{},void 0,s()(u.FormattedMessage,n?{id:"blockPermissionsSettings.permissionsList.attribution",defaultMessage:"From {attribution}",description:"Header for list of people/groups who have permission on a page, where the permission was inherited from a parent or the teamspace.",values:{attribution:s()(qe,{navigableParentStore:i})}}:{id:"blockPermissionsSettings.permissionsList.genericHeader",defaultMessage:"People with access",description:"Header for list of people/groups who have permissions on a page"}))};var Je=i(617);function et(e){window.__c={n:"RestrictedBanner"};const{store:t,parentStore:i}=e,n=(0,l.O7)(),a=(0,d.VK)((()=>function(e){const{store:t,parentStore:i,environment:n}=e;if(i instanceof I.zX)return i.hasFullAccess();return Je.or([Je.zz,Je.xD([Je.c2,Je.ff(Je.zz)])])({environment:n,blocks:[t],publicEditMode:void 0})}({store:t,parentStore:i,environment:n})),[t,i,n]);return s()(ze,{type:"unrestrict",showRestoreButton:a,store:t,sudoModeStore:e.sudoModeStore})}function tt(e){window.__c={n:"ElevatedBanner"};const{store:t}=e;return(0,d.VK)((()=>x({store:t})),[t])?s()(ze,{type:"restore-team",showRestoreButton:!1,store:t,sudoModeStore:e.sudoModeStore}):null}const it=function(e){window.__c={n:"PermissionsWarningBanner"};const{store:t,showRestrictedPermissionBanner:i}=e,{parentStore:n,canAccessParent:a}=(0,d.VK)((()=>Z({store:t})),[t]);return a?i?s()(et,{store:t,sudoModeStore:e.sudoModeStore,parentStore:n}):s()(tt,{store:t,sudoModeStore:e.sudoModeStore}):null};var nt=i(20346),at=i(31194),ot=i(52275),st=i(31945),rt=i(9342),lt=i(63296),dt=i(72495);const ct=[{key:"private",title:e=>s()(u.FormattedMessage,"variant1"===e?{id:"linkSharingPill.visibilityTitle.private",defaultMessage:"Private",description:"Descriptor for a page that is only visible to those it is directly shared with."}:{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only",description:"Descriptor for a page that is only visible to those it is directly shared with."}),caption:e=>s()(u.FormattedMessage,"variant1"===e?{id:"linkSharingPill.visibilityCaption.private",defaultMessage:"Only you and invited can see that this page exists",description:"Visibility caption for a private page that is only visible to those it is directly shared with."}:{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and invited can access",description:"Visibility caption for a private page that is only visible to those it is directly shared with."}),icon:Ze.Z.lockedFilled},{key:"unlisted",title:(e,t)=>s()(u.FormattedMessage,"variant1"===e?{id:"linkSharingPill.visibilityTitle.unlisted",defaultMessage:"Unlisted",description:"Descriptor for a page that is not visible in search but is accessible via link."}:{id:"linkSharingPill.visibilityTitle.anyoneWithLink",defaultMessage:"Anyone with link in {spaceName}",description:"Descriptor for a page that is not visible in search but is accessible via link.",values:{spaceName:t}}),caption:e=>s()(u.FormattedMessage,"variant1"===e?{id:"linkSharingPill.visibilityCaption.unlisted",defaultMessage:"Only members with link can access this page",description:"Visibility caption for an unlisted page that is not visible in search but is accessible via link."}:{id:"linkSharingPill.visibilityCaption.anyoneWithLink",defaultMessage:"Only invited and members with link can access",description:"Visibility caption for an unlisted page that is not visible in search but is accessible via link."}),icon:Ze.Z.link},{key:"open",title:(e,t)=>s()(u.FormattedMessage,"variant1"===e?{id:"linkSharingPill.visibilityTitle.open",defaultMessage:"Open",description:"Descriptor for a page that is visibile to everyone in the workspace."}:{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone in {spaceName}",description:"Descriptor for a page that is visibile to everyone in the workspace.",values:{spaceName:t}}),caption:e=>s()(u.FormattedMessage,"variant1"===e?{id:"linkSharingPill.visibilityCaption.open",defaultMessage:"All members can find and access this page",description:"Visibility caption for an open page that is visibile to everyone in the workspace."}:{id:"linkSharingPill.visibilityCaption.everyoneInWorkspace",defaultMessage:"All members can search and access",description:"Visibility caption for an open page that is visibile to everyone in the workspace."}),icon:Ze.Z.openPage}];function ut(e,t,i){return"private"===i?"none":"private"===t?"reader":e.role}const pt=function(e){window.__c={n:"LinkSharingPill"};const{store:t,spacePermission:i,sudoModeStore:n,location:o}=e,u=(0,l.O7)(),p=function(e){if("none"===e.role)return"private";if(e.unlisted_timestamp)return"unlisted";return"open"}(i.permissionItem),g=i.from,h=(g.table===b.iU?g.blockId:g.teamId)!==t.id,f=(0,d.VK)((()=>t.canAdmin()),[t]),v=(0,B.a)("link_sharing_pill"),y=(0,d.VK)((()=>{const e=_.default.state.currentSpaceStore;return e?(0,Be.rn)(u,e):""}),[u]),S=(0,c.yK)((e=>{const t={width:14,fill:e.mediumTextColor};return{chevron:{width:12,marginLeft:4,fill:e.mediumIconColor},popup:{overflow:"visible",width:"100%"},button:{justifyContent:"center",borderRadius:32,height:32,color:e.mediumTextColor,paddingLeft:12},icon:{fill:e.mediumTextColor,width:16},iconContainer:{alignSelf:"center",marginLeft:9},hiddencheckmark:{...t,visibility:"hidden"},selectedCheckmark:{...t,visibility:"visible"},checkmarkContainer:{marginLeft:12},selectedTitle:{fontWeight:Y.Z.fontWeight.semibold}}}),[]);return s()(st.Z,{popupType:st.Z.PopupType.Popup,popupWrapStyle:S.popup,renderOrigin:e=>{const t=ct.find((e=>e.key===p));return t?r.createElement(lt.Z,a()({},e,{style:S.button,icon:t.icon,iconStyle:S.icon,disabled:!f}),t.title(v,y),Ze.Z.chevronDown(S.chevron)):null},placementToOrigin:at.Iw.Bottom,alignmentToOrigin:at.lU.Start,sameWidthAsOrigin:!0,render:e=>s()(N.Z,{menuType:m.og.Popup},void 0,s()(rt.Z,{type:rt.i.Vertical,initialFocus:void 0,sections:[{key:"visibilityOptions",render:e=>r.createElement(dt.Z,e),items:ct.map((s=>{const l=s.key,d=p===l,c=d?S.selectedCheckmark:S.hiddencheckmark;return{key:l,render:e=>r.createElement(ot.Z,a()({title:s.title(v,y),caption:s.caption(v),icon:s.icon(S.icon),desktopIconStyle:S.iconContainer,titleStyle:d?S.selectedTitle:void 0,right:Ze.Z.thinCheck(c),rightStyle:S.checkmarkContainer},e)),action:()=>{if(d)return;const a=i.permissionItem,s={type:"space_permission",role:ut(a,p,l)};"unlisted"===l&&(s.unlisted_timestamp=Date.now());const r=function(e,t){switch(t){case"open":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,Ae.t1)(t)}}(p,l);De.iK({oldPermissionItem:a,newPermissionItem:s,wasInherited:h,environment:u,store:t,sudoModeStore:n,location:o,restrictingVisibility:r}),e.close()}}}))}]}))})};var mt=i(15145),gt=i(32739),ht=i(50906),ft=i(43132),vt=i(95477),yt=i(89728);function bt(e){window.__c={n:"MobilePageLinkButtonInner"};const{store:t,buttonPopupStore:i,events:n}=e,o=(0,l.O7)(),{device:d,mobileNative:p}=o,m=(0,c.yK)((e=>({button:{marginLeft:d.isMobile?0:12,flex:1,height:36,background:e.contentBackground}})),[d]);return r.createElement(lt.Z,a()({isLarge:!0,onClick:()=>{d.isMobileNative?function(e){const{store:t,mobileNative:i}=e,n=(0,gt.u5)({schemeUrl:(0,Le.pB)({store:t},{[mt.$X]:mt.tY.CopyLink}),baseUrl:vt.Z.domainBaseUrl});i&&i.share(n)}({store:t,mobileNative:p}):Mt({store:t,buttonPopupStore:i,environment:o}),ht.V5j(o)},style:m.button},n),d.isMobileNative?s()(u.FormattedMessage,{id:"pageShareMenu.sharePageLinkButton.label",defaultMessage:"Share page link"}):s()(u.FormattedMessage,{id:"pageShareMenu.copyPageLinkButton.label",defaultMessage:"Copy page link"}))}function St(e){window.__c={n:"PageLinkButtonInner"};const{store:t,buttonPopupStore:i,events:n}=e,o=(0,l.O7)(),d=(0,c.yK)((e=>({button:{height:24,paddingLeft:8,paddingRight:8,color:e.regularTextColor},icon:{width:14,height:14,fill:e.regularIconColor,marginLeft:0,marginRight:6},label:{color:e.regularTextColor}})),[]);return r.createElement(yt.Z,a()({isSmall:!0,onClick:()=>{Mt({store:t,buttonPopupStore:i,environment:o}),ht.V5j(o)},style:d.button},n),Ze.Z.link(d.icon),s()(U.Z,{isSmall:!0,style:d.label},void 0,s()(u.FormattedMessage,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})))}function wt(e){window.__c={n:"PageLinkInfoTooltip"};const{calculatedPermissions:t}=e,i=t.mostPermissivePublicItem.permissionItem;if((0,y.YX)(i.role))return s()(u.FormattedMessage,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const n=t.mostPermissiveSpaceItem.permissionItem;return(0,y.YX)(n.role)?s()(u.FormattedMessage,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):t.permissionItemsCount>1?s()(u.FormattedMessage,{defaultMessage:"Only you and other invited members and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip"}):s()(u.FormattedMessage,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function Mt(e){const{store:t,buttonPopupStore:i,environment:n}=e,a=(0,Le.pB)({store:t},{[mt.$X]:mt.tY.CopyLink});await ft.RD({environment:n,stringValue:a,copiedMessage:ft.tq.copiedLinkToClipboard}),i&&i.setState({open:!1})}const Ct=function(e){window.__c={n:"PageLinkButton"};const{store:t,buttonPopupStore:i,calculatedPermissions:n}=e,{device:a}=(0,l.O7)(),o=(0,c.yK)((()=>({tooltip:{width:280}})),[]);return s()(ie.Z,{delayThreshold:0,placement:ie.Z.Placement.Bottom,renderTooltip:()=>s()(wt,{calculatedPermissions:n}),textWrap:!0,style:o.tooltip,render:e=>a.isMobile?s()(bt,{store:t,buttonPopupStore:i,events:e}):s()(St,{store:t,buttonPopupStore:i,events:e})})};function kt(e){const{store:t}=e;return(0,d.VK)((()=>{const e=_.default.state.currentSpaceStore,i=(0,C.VP)(t);return i?{isPublicAccessDisabled:Boolean(i.getDisablePublicAccess()),disabledBy:"team"}:{isPublicAccessDisabled:Boolean(null==e?void 0:e.getDisablePublicAccess()),disabledBy:"space"}}),[t])}var Tt=i(91376),_t=i(81236);function It(e){window.__c={n:"LearnAboutAutogeneratedDomainsCTA"};const t=(0,l.O7)(),{WindowSizeStore:i}=t,{safePaddingLeftCSS:n,safePaddingRightCSS:o}=(0,d.VK)((()=>({safePaddingLeftCSS:i.getSafePaddingLeftCSS(8),safePaddingRightCSS:i.getSafePaddingRightCSS(8)})),[i]),{isMobile:p}=(0,l.Fy)(),{spaceStore:m,canChangeSettings:g,publicSpaceData:h}=(0,d.VK)((()=>{const e=_.default.state.currentSpaceStore;return e?{spaceStore:e,canChangeSettings:e.canAdmin(),publicSpaceData:_t.Z.getPublicSpaceData(t,e.id)}:{}}),[t]),f=(0,c.yK)((t=>({container:{boxShadow:`0 -1px 0 ${t.regularDividerColor}`,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",padding:"8px 8px",paddingLeft:n,paddingRight:o,color:t.mediumTextColor,backgroundColor:t.inputBackground,...e.style}})),[e.style,n,o]);if(!m)return null;if(p)return null;if(!h)return null;return h.domainIsAutogenerated&&g?s()("span",{style:f.container},void 0,s()("div",{style:{display:"flex"}},void 0,r.createElement(U.Z,a()({isSmall:!0,isMobile:!1,isSecondaryColor:!0,style:{paddingRight:"4px"}},e.labelStyle),s()(u.FormattedMessage,{defaultMessage:"Set a domain for your public links in",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.setDomainForPublicLinks"})),s()("span",{style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",color:J.ZP.inherit},onClick:()=>{Tt.r({currentTab:"settings"})}},void 0,r.createElement(U.Z,a()({isSmall:!0,isMobile:!1,isSecondaryColor:!1,style:{textDecoration:"underline"}},e.labelStyle),s()(u.FormattedMessage,{defaultMessage:"Settings",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.openSettingsCTA"}))))):null}var xt=i(98459),Zt=i(10161),Pt=i(74194),Ft=i(24006),At=i(42115),Bt=i(13991),Et=i(61784),Dt=i(63143),Rt=i(61766),Lt=i(93289),Ot=i(95030);function Nt(e){window.__c={n:"PublicPermissionItemLinkExpirationMenu"};const t=(0,l.Fy)(),[,,i]=(0,d.AF)(void 0,Rt.Z),n=(0,c.Fg)(),o=(0,l.O7)(),g=(0,d.VK)((()=>(0,q.y$)(o)),[o]),{buttonMenuItemStyle:h}=(0,c.yK)((()=>({buttonMenuItemStyle:{opacity:e.disabled?.6:1,cursor:e.disabled?"not-allowed":""}})),[e.disabled]);return r.createElement(st.Z,a()({},e.upsellEvents,{disablePopup:!g,disabled:e.disabled,popupType:t.isMobile?st.Z.PopupType.SlideUp:st.Z.PopupType.Popup,buttonPopupStore:i,renderOrigin:t=>r.createElement(ot.Z,a()({},t,{focused:!1,disabled:e.disabled,style:h,title:s()(U.Z,{},void 0,s()(u.FormattedMessage,{id:"publicPermissionItem.expirationTime.label",defaultMessage:"Link expires"})," ",e.upgradeLabel),right:r.createElement(yt.Z,a()({},t,{disabled:e.disabled,ignoreLocalHoverState:!0,style:{paddingLeft:0,paddingRight:0}}),s()(Vt,{permissionItem:e.permissionItem}),Ze.Z.chevronDown({width:10,marginLeft:4,fill:n.lightIconColor}))})),alignmentToOrigin:at.lU.End,placementToOrigin:at.Iw.Bottom,render:i=>{const n=[{key:"options",render:e=>r.createElement(dt.Z,e),items:Wt().map((t=>({key:t.type,action:()=>{Ut(e,o,t.time),i.close()},render:e=>r.createElement(ot.Z,a()({},e,{focused:e.focused,disabled:!1,title:t.title,caption:t.caption}))})))},{key:"custom",render:e=>r.createElement(dt.Z,a()({},e,{topBorder:!0})),items:[{key:"custom",action:()=>{i.close()},render:(t,n)=>r.createElement(Ot.Z,a()({},t,{renderOrigin:e=>r.createElement(ot.Z,a()({},e,{disabled:!1,title:s()(u.FormattedMessage,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"})})),onFocus:n.onFocus,disableDefaultClick:!0,renderExtension:(t,n)=>s()("div",{style:{padding:"18px 14px 14px"}},void 0,r.createElement(Lt.Z,a()({},t,{firstDayOfWeek:M.AK.state,value:e.permissionItem.expiration_timestamp||(new Date).getTime(),onChange:t=>{Ut(e,o,t),n.close(),i.close()},disabledDays:{before:new Date}})))}))}]}];let l;return l=t.isMobile?{menuType:m.og.Modal,title:s()(u.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.title",defaultMessage:"Expiration time"}),right:s()(u.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.label",defaultMessage:"Done"}),onClickRight:i.close}:{menuType:m.og.Popup,width:264},r.createElement(N.Z,a()({className:p.IpQ},l),s()(rt.Z,{type:rt.i.Vertical,initialFocus:void 0,sections:n}))}}))}function Vt(e){window.__c={n:"ExpirationCaption"};const{permissionItem:t}=e;return!t.expiration_timestamp||(0,y.o7)(t)?s()(u.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"}):s()(U.Z,{},void 0,e.permissionItem.expiration_timestamp&&(0,Et.tv)(e.permissionItem.expiration_timestamp,Bt.SP))}function Ut(e,t,i){const{permissionItem:n,onChange:a}=e;if("public_permission"!==n.type)return;if(void 0!==i&&i<=(new Date).getTime())return;const o=n,s=f().clone(o),r=i;s.expiration_timestamp=r,a(s),ht.n4j(t,{expiration_time:r})}function Wt(){const e=(new Date).getTime()+Dt.U6,t=(new Date).getTime()+Dt.A0,i=(new Date).getTime()+7*Dt.A0;return[{type:"never",time:void 0,title:s()(u.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"})},{type:"hour",time:e,title:s()(u.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.hour",defaultMessage:"In an hour"}),caption:new Intl.DateTimeFormat(Bt.SP,{hour:"numeric",minute:"numeric"}).format(e)},{type:"day",time:t,title:s()(u.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.day",defaultMessage:"In a day"}),caption:new Intl.DateTimeFormat(Bt.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)},{type:"week",time:i,title:s()(u.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.week",defaultMessage:"In a week"}),caption:new Intl.DateTimeFormat(Bt.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(i)}]}function zt(e){window.__c={n:"ShareMenuPublicPermission"};const{permissionItem:t,currentBlockStore:i,sudoModeStore:n,location:o,from:u,switcherRole:p,onUpgradeButtonClick:m}=e,g=u.table===b.iU?u.blockId:u.teamId,h="none"!==t.role,f=!h,[v,y]=r.useState(f),S=(0,l.Fy)().isMobile,w=(0,l.O7)(),M=(0,c.yK)((()=>({container:f?{maxHeight:0,transition:"max-height ease 200ms, padding-bottom ease 200ms",overflow:"hidden",paddingBottom:0}:{maxHeight:S?v?240:94:v?200:88,transition:"max-height ease 200ms, padding-bottom ease 200ms",overflow:"hidden",paddingBottom:v?12:8}})),[f,v,S]),C=(0,r.useCallback)((e=>{De.iK({oldPermissionItem:t,newPermissionItem:{...t,...e},wasInherited:g!==i.id,environment:w,store:i,sudoModeStore:n,location:o})}),[i,w,g,o,t,n]),k=(0,r.useCallback)((()=>{var e;const i=h?"none":p||"editor",n=!Boolean(null===(e=_.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace())&&t.allow_duplicate;C({role:i,allow_duplicate:n})}),[h,C,p,t.allow_duplicate]),T=(0,d.VK)((()=>s()(Ft.Z,{on:h,onClick:k,disabled:!i.canAdmin()})),[i,k,h]),I=(0,r.useCallback)((()=>y(!0)),[]);return s()(r.Fragment,{},void 0,r.createElement(be.Z,a()({},e,{permissionRoleSelect:T,onClick:k})),s()("div",{style:M.container},void 0,s()(Ht,{currentBlockStore:i}),v?s()(Kt,{permissionItem:t,currentBlockStore:i,onUpgradeButtonClick:m,onChange:C}):s()(qt,{onClick:I})))}function Kt(e){const{permissionItem:t,onUpgradeButtonClick:i,onChange:n,currentBlockStore:o}=e,p=(0,l.O7)(),m=(0,d.VK)((()=>!o.canAdmin()),[o]),g=(0,d.VK)((()=>{var e;return Boolean(null===(e=_.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace())}),[]),h=y.RF(t.role),f=!1!==t.allow_duplicate,v=y.J5(t.role),b=Boolean(t.allow_search_engine_indexing),S=(0,r.useCallback)((()=>{n({role:v?"comment_only":"read_and_write"})}),[v,n]),w=(0,r.useCallback)((()=>{n({role:h?"reader":"comment_only"})}),[h,n]),M=(0,r.useCallback)((()=>{const e=!b;n({allow_search_engine_indexing:e}),ht.g0v(p,{allow_search_engine_indexing:e})}),[p,n,b]),C=(0,r.useCallback)((()=>{const e=!f;n({allow_duplicate:e}),ht.l7z(p,{allow_duplicate:e})}),[f,p,n]),k=(0,d.VK)((()=>Zt.default.checkGate("expiring_public_links")),[]),T=(0,d.VK)((()=>!(0,q.y$)(p)&&(0,q.M9)(p)),[p]),I=(0,d.VK)((()=>!(0,q.f3)(p)&&(0,q.M9)(p)),[p]),x=(0,d.VK)((()=>Jt(p)),[p]),Z=(0,d.VK)((()=>m||g&&!f),[m,f,g]),P=(0,c.yK)((()=>({optionLabel:{marginRight:"auto",opacity:m?.6:1},optionButton:m?{...x,cursor:"not-allowed"}:x})),[m,x]);return r.createElement(r.Fragment,null,r.createElement(r.Fragment,null,k&&s()(At.Z,{alwaysAllowClick:Boolean(t.expiration_timestamp),onClick:()=>{},analyticsName:"public_permission_item_expiration",requireUpgradeToTier:T,tooltipPlacement:ie.Z.Placement.Left,renderTooltip:$t,renderUpgradeTooltip:Yt,onUpgradeClick:i,render:(e,i)=>s()(Nt,{upsellEvents:e,upgradeLabel:i,permissionItem:t,onChange:n,disabled:m})}),s()(ie.Z,{placement:ie.Z.Placement.Left,renderTooltip:Gt,render:e=>r.createElement(j.Z,a()({onClick:S,style:P.optionButton,disabled:m},e),s()(U.Z,{style:P.optionLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Allow editing",id:"pagePermissionItem.allowEdits.setting"})),s()(Ft.Z,{on:v,onClick:S,disabled:m}))}),s()(ie.Z,{placement:ie.Z.Placement.Left,renderTooltip:jt,render:e=>r.createElement(j.Z,a()({onClick:w,style:P.optionButton,disabled:m},e),s()(U.Z,{style:P.optionLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Allow comments",id:"pagePermissionItem.allowComments.setting"})),s()(Ft.Z,{on:h,onClick:w,disabled:m}))})),s()(ie.Z,{placement:ie.Z.Placement.Left,renderTooltip:g&&!f?Xt:Qt,render:e=>r.createElement(j.Z,a()({onClick:C,disabled:Z,style:P.optionButton},e),s()(U.Z,{style:P.optionLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Allow duplicate as template",id:"pagePermissionItem.allowDuplicateTemplate.setting"})),s()(Ft.Z,{on:f,onClick:C,disabled:Z}))}),s()(At.Z,{requireUpgradeToTier:I,alwaysAllowClick:t.allow_search_engine_indexing,analyticsName:"allow_search_engine_indexing",onClick:M,onUpgradeClick:i,tooltipPlacement:ie.Z.Placement.Left,renderTooltip:$t,renderUpgradeTooltip:Yt,render:(e,t)=>r.createElement(j.Z,a()({style:P.optionButton,disabled:m},e),s()(U.Z,{style:P.optionLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Search engine indexing",id:"pagePermissionItem.allowSearchEngines.setting"})," ",t),s()(Ft.Z,{on:b,onClick:M,disabled:m||Boolean(t)}))}))}function qt(e){let{onClick:t}=e;window.__c={n:"ShowOptionsDropdownButton"};const i=(0,l.O7)(),n=(0,d.VK)((()=>Jt(i)),[i]),a=(0,c.yK)((()=>({optionButton:n,chevronIcon:{width:9,height:9,marginLeft:4,display:"inline"}})),[n]);return s()(yt.Z,{onClick:t,style:a.optionButton},void 0,s()(U.Z,{isSmall:!0},void 0,s()(u.FormattedMessage,{defaultMessage:"Show link options",id:"pagePermissionItem.showLinkOptions.label"}),Ze.Z.chevronDown(a.chevronIcon)))}function Ht(e){window.__c={n:"PageLinkButton"};const[t,i]=r.useState(!1),[n,a]=r.useState(void 0),{currentBlockStore:o}=e,p=(0,l.O7)(),m=(0,d.VK)((()=>Jt(p)),[p]),g=(0,c.yK)((()=>({container:{...m,height:"auto"},flex:{flex:1},wrapper:{display:"flex",padding:"1px 0"},input:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:0},button:{height:28,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"}})),[m]),h=(0,d.VK)((()=>(0,Le.ZP)({store:o,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=_t.Z.getPublicSpaceData(p,(0,xt.CG)(o.getSpaceId())))||void 0===e?void 0:e.domain}})),[o,p]),f=(0,r.useCallback)((()=>{ft.RD({environment:p,stringValue:h,copiedMessage:ft.tq.copiedLinkToClipboard}),clearTimeout(n),i(!0),a(window.setTimeout((()=>{i(!1)}),1e3)),ht.c7L(p)}),[p,h,n]);return s()("div",{style:g.container},void 0,s()("div",{style:g.flex},void 0,s()("div",{style:g.wrapper},void 0,s()(Pt.Z,{value:h,disabled:!0,style:g.input}),s()(lt.Z,{onClick:f,style:g.button},void 0,s()(u.FormattedMessage,t?{id:"pageShareMenu.copiedLinkButton.label",defaultMessage:"✓ Copied"}:{id:"pageShareMenu.copyMaybePublicLinkButton.label.web",defaultMessage:"Copy web link",description:"Button text for copying public link of the page"})))))}function Gt(){return window.__c={n:"AllowEditsTooltip"},s()(ye.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"Any logged in Notion user can edit this page. Share the secret link with people you trust.",id:"pagePermissionItem.allowEdits.tooltip"}),imageHeight:120,imageWidth:240,imageURL:ge.Z.images.tooltips.share.allowEditingPng})}function jt(){return window.__c={n:"AllowCommentsTooltip"},s()(ye.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"Any logged in Notion user can comment on this page.",id:"pagePermissionItem.allowComments.tooltip"}),imageHeight:120,imageWidth:240,imageURL:ge.Z.images.tooltips.share.allowCommentsPng})}function $t(){return window.__c={n:"AllowSearchEngineTooltip"},s()(ye.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"If allowed, your public page may appear in search engines such as Google, but only if you or someone else links to it elsewhere on the web.",id:"pagePermissionItem.allowSearchEngine.tooltip"}),imageHeight:120,imageWidth:240,imageURL:ge.Z.images.tooltips.share.allowSearchEnginesPng})}function Yt(){return window.__c={n:"AllowSearchEngineUpgradeTooltip"},s()(ye.Z,{imageURL:ge.Z.images.tooltips.upsells.searchEngineIndexingPng,imageWidth:240,imageHeight:100,title:s()(u.FormattedMessage,{defaultMessage:"Upgrade for search engine indexing",id:"pagePermissionItem.searchEngineUpgradeTooltip.title"}),caption:s()(u.FormattedMessage,{defaultMessage:"Have your page appear in search engine results.",id:"pagePermissionItem.searchEngineUpgradeTooltip.caption"})})}function Qt(){return window.__c={n:"AllowDuplicateTooltip"},s()(ye.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"If allowed, this will allow other people to duplicate your public page to their workspace.",id:"pagePermissionItem.allowDuplicateTemplate.tooltip"}),imageHeight:120,imageWidth:240,imageURL:ge.Z.images.tooltips.share.allowDuplicatePng})}function Xt(){return window.__c={n:"DuplicateDisabledTooltip"},s()(ye.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"This workspace does not allow page duplication to other workspaces.",id:"pagePermissionItem.duplicateTemplateDisabled.tooltip",description:"This tooltip explains why the 'Allow duplicate as template' option is disabled."}),imageWidth:240})}function Jt(e){const t=e.WindowSizeStore;return{display:"flex",alignItems:"center",width:"100%",height:e.device.isMobile?36:30,paddingTop:5,paddingBottom:5,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}}const ei=r.memo(zt);function ti(){return window.__c={n:"Title"},s()(u.FormattedMessage,{defaultMessage:"Share to web",id:"blockPermissionsSettings.permissionItem.linkSharing"})}function ii(e){window.__c={n:"Subtitle"};const{role:t}=e;return y.J5(t)?s()(u.FormattedMessage,{defaultMessage:"Anyone with the link can edit and comment",id:"blockPermissionsSettings.publicPermission.canEdit"}):y.RF(t)?s()(u.FormattedMessage,{defaultMessage:"Anyone with the link can comment",id:"blockPermissionsSettings.publicPermission.canComment"}):y.YX(t)?s()(u.FormattedMessage,{defaultMessage:"Anyone with the link can view",id:"blockPermissionsSettings.publicPermission.canRead"}):s()(u.FormattedMessage,{defaultMessage:"Publish and share link with anyone",id:"blockPermissionsSettings.publicPermission.none"})}function ni(){return window.__c={n:"Tooltip"},s()(ye.Z,{imageURL:ge.Z.images.tooltips.share.publicPagePng,imageWidth:240,imageHeight:120,caption:s()(u.FormattedMessage,{defaultMessage:"Anybody with the link can access the page.",id:"blockPermissionsSettings.publicPermission.tooltip"})})}const ai=function(e){window.__c={n:"PublicPermissionItem"};const{store:t,publicPermission:i}=e,{isMobile:n}=(0,l.Fy)(),o=(0,c.yK)((e=>({container:{boxShadow:n?void 0:`0 -1px 0 ${e.regularDividerColor}`,borderTop:n?`1px solid ${e.lightDividerColor}`:void 0,borderBottom:n?`1px solid ${e.lightDividerColor}`:void 0,width:"100%"},icon:{width:26,height:26,fill:e.lightIconColor}})),[n]);return s()("div",{style:o.container,className:p.a8k},void 0,r.createElement(ei,a()({currentBlockStore:t,permissionItem:i.permissionItem,from:i.from,icon:Ze.Z.globe(o.icon),title:s()(ti,{}),subtitle:s()(ii,{role:i.permissionItem.role}),nonInheritedTooltip:s()(ni,{}),upgradeButtonName:"public_permission_item",switcherRole:"reader"},e.permissionItemArgs)))};const oi=function(e){const{store:t,mostPermissivePublicItem:i}=e,n=i.permissionItem.role,{isPublicAccessDisabled:a}=kt({store:t});return r.createElement(r.Fragment,null,!a&&s()(ai,{store:t,publicPermission:i,permissionItemArgs:e.permissionItemArgs}),y.YX(n)&&s()(It,{}))};const si=function(e){const{isMobile:t}=(0,l.Fy)(),i="control"!==(0,B.a)("link_sharing_pill"),n="control"===(0,B.a)("share_menu_publish_tab")||t,a=(0,c.yK)((e=>({container:{display:"flex",alignItems:"center",boxShadow:t?void 0:`0 -1px 0 ${e.regularDividerColor}`,flexDirection:"row",justifyContent:"space-between",padding:t||i?"8px 14px":"4px 4px"}})),[t,i]),{mostPermissivePublicItem:o,mostPermissiveSpaceItem:d}=e.calculatedPermissions;return r.createElement(r.Fragment,null,n&&s()(oi,{store:e.store,mostPermissivePublicItem:o,permissionItemArgs:e.permissionItemArgs}),s()("div",{style:a.container},void 0,i&&s()(pt,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:d}),!t&&!i&&s()(nt.Z,{}),s()(Ct,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})))};var ri=i(90965);function li(e){window.__c={n:"UnlistedPermissionItem"};const{store:t,spacePermission:i}=e,n=(0,c.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]);return r.createElement(be.Z,a()({icon:Ze.Z.link(n.icon),iconStyle:n.iconContainer,title:s()(u.FormattedMessage,{defaultMessage:"Members with the link",id:"blockPermissionsSettings.permissionItem.linkAccess",description:"Title for workspace members that have the link to a page"}),currentBlockStore:t,permissionItem:i.permissionItem,from:i.from,upgradeButtonName:"space_permission_item"},e.permissionItemArgs))}function di(e){window.__c={n:"Title"};const{spaceStore:t}=e,i=(0,l.O7)(),n=(0,d.VK)((()=>(0,Be.rn)(i,t)),[i,t]);return s()(u.FormattedMessage,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:n}})}function ci(e){window.__c={n:"Subtitle"};const{spaceStore:t}=e,i=(0,d.VK)((()=>(0,ri.t5)((0,Be.jv)(t))),[t]);return s()(u.FormattedMessage,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} person} other {{numberOfWorkspaceMembers} people}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:i}})}function ui(){window.__c={n:"Tooltip"};const e=(0,c.yK)((()=>({tooltip:{fontWeight:Y.Z.fontWeight.bold}})),[]);return s()(ye.Z,{imageURL:ge.Z.images.tooltips.share.workspacePng,imageWidth:240,imageHeight:180,caption:s()(u.FormattedMessage,{defaultMessage:"For all members in your workspace, this page will show up in the <boldtext>Workspace</boldtext> section in their sidebar.",values:{boldtext:t=>s()("span",{style:e.tooltip},void 0,t)},id:"blockPermissionsSettings.spacePermission.tooltip"})})}const pi=function(e){window.__c={n:"SpacePermissionItem"};const{store:t,spacePermission:i}=e,n=(0,d.VK)((()=>{const e=_.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),o=(0,c.yK)((()=>({container:{width:"100%"}})),[]);return n?i.permissionItem.unlisted_timestamp?r.createElement(li,e):s()("div",{style:o.container,className:p.afv},void 0,r.createElement(be.Z,a()({currentBlockStore:t,permissionItem:i.permissionItem,from:i.from,icon:s()(Ee.p,{disabled:!0,store:n,size:be.Z.iconSize}),title:s()(di,{spaceStore:n}),nonInheritedTooltip:s()(ui,{}),subtitle:s()(ci,{spaceStore:n}),upgradeButtonName:"space_permission_item"},e.permissionItemArgs))):null};var mi=i(79362);function gi(e){window.__c={n:"Title"};const{teamName:t,isCompact:i}=e;return s()(u.FormattedMessage,i?{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact",description:"All teamspace members of the given teamspace"}:t?{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",description:"All teamspace guests of the given teamspace name",values:{teamName:t}}:{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace",description:"A generic name to give a team we don't know the name of."})}function hi(e){window.__c={n:"Subtitle"};const{membersCount:t,isCompact:i}=e;return i?null:s()(u.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",description:"A sub-title indicating the number of members in the teamspace.",values:{membersCount:t}})}function fi(e){window.__c={n:"TeamGuestPermissionTooltip"};const{teamName:t}=e,i=(0,c.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?s()("div",{style:i.tooltip},void 0,s()(u.FormattedMessage,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamGuestPermission.tooltip",description:"A tooltip indicating that this permission item role applies to all teamspace guests of the given teamspace."})):null}const vi=function(e){var t;window.__c={n:"TeamGuestPermissionItem"};const{store:i,blockTeamGuestPermission:n,isExternalTeam:o}=e,{permissionItem:l}=n,u=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),m=y.bm(l)?l.team_id:null===(t=C.VP(i))||void 0===t?void 0:t.id,{teamStore:g,teamIsDefined:h,teamName:f,teamIcon:v,membersCount:b}=(0,d.VK)((()=>{if(!u||!m)return{};const e=I.zX.createChildStore(u,{table:w.e0,id:m,spaceId:u.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName(),teamIcon:e.getIcon(),membersCount:(0,T.xf)({teamStore:e,spaceStore:u}).length}:{}}),[u,m]),S=!o,M=(0,c.yK)((()=>({container:{width:"100%"}})),[]);if(!g)return null;const k=v&&mi.V2(v.icon)?mi.mk(v.icon):"gray",x=v?{...v,icon:`/icons/user-circle_${k}.svg`}:void 0;return s()("div",{style:M.container,className:p.YHn},void 0,r.createElement(be.Z,a()({isCompact:S,currentBlockStore:i,permissionItem:l,icon:h?s()(Ee.p,{disabled:!0,store:g,size:be.Z.iconSize,icon:x}):Ze.Z.privateTeam(),title:s()(gi,{teamName:f,isCompact:S}),nonInheritedTooltip:s()(fi,{teamName:f}),from:n.from,subtitle:h&&s()(hi,{membersCount:b,isCompact:S}),upgradeButtonName:"team_permission_item"},e.permissionItemArgs)))};function yi(e){window.__c={n:"Title"};const{teamName:t,isCompact:i}=e;return s()(u.FormattedMessage,i&&t?{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2",description:"All teamspace members of the given teamspace"}:t?{defaultMessage:"Members of {teamName}",id:"blockPermissionsSettings.permissionItem.teamAccess",description:"All teamspace members of the given teamspace name",values:{teamName:t}}:{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace",description:"A generic name to give a team we don't know the name of."})}function bi(e){window.__c={n:"Subtitle"};const{membersCount:t,isCompact:i}=e;return i?null:s()(u.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",description:"A sub-title indicating the number of members in the teamspace.",values:{membersCount:t}})}function Si(e){window.__c={n:"TeamMemberPermissionTooltip"};const{teamName:t}=e,i=(0,c.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?s()("div",{style:i.tooltip},void 0,s()(u.FormattedMessage,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamPermission.tooltip",description:"A tooltip indicating that this permission item role applies to all owners and teamspace members of the given teamspace."})):null}const wi=function(e){var t;window.__c={n:"TeamMemberPermissionItem"};const{store:i,blockTeamPermission:n,isExternalTeam:o}=e,{permissionItem:l}=n,u=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),m=y.zU(l)?l.team_id:null===(t=C.VP(i))||void 0===t?void 0:t.id,{teamStore:g,teamIsDefined:h,teamName:f,membersCount:v}=(0,d.VK)((()=>{if(!u||!m)return{};const e=I.zX.createChildStore(u,{table:w.e0,id:m,spaceId:u.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName(),membersCount:(0,T.xf)({teamStore:e,spaceStore:u}).length}}),[u,m]),b=!o,S=(0,c.yK)((()=>({container:{width:"100%"}})),[]);return g?s()("div",{style:S.container,className:p.YHn},void 0,r.createElement(be.Z,a()({isCompact:b,currentBlockStore:i,permissionItem:n.permissionItem,from:n.from,icon:h?s()(Ee.p,{disabled:!0,store:g,size:be.Z.iconSize}):Ze.Z.privateTeam(),title:s()(yi,{teamName:f,isCompact:b}),nonInheritedTooltip:s()(Si,{teamName:f}),subtitle:h&&s()(bi,{membersCount:v,isCompact:b}),upgradeButtonName:"team_permission_item"},e.permissionItemArgs))):null};var Mi=i(62512);function Ci(e){const{store:t,teamOwners:i,teamStore:n,teamName:a}=e;if(a){const e=i.map((e=>I.U6.createChildStore(t,{table:oe.KJ,id:e})));return s()(Mi.n,{teamStore:n,ownerStores:e})}return Ze.Z.privateTeam()}function ki(e){window.__c={n:"Title"};const{teamName:t,isCompact:i}=e;return s()(u.FormattedMessage,i&&t?{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",description:"The title for a permission item that defines the access given to all owners of a team",values:{teamName:t}}:t?{defaultMessage:"Owners of {teamName}",id:"blockPermissionsSettings.permissionItem.teamOwnerAccess",description:"The title for a permission item that defines the access given to all owners of a team",values:{teamName:t}}:{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace",description:"A generic name to give a team we don't know the name of."})}function Ti(e){window.__c={n:"Subtitle"};const{teamOwnersCount:t,isCompact:i}=e;return i||0===t?null:s()(u.FormattedMessage,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",description:"The sub-title for a permission item that defines the access given to all owners of a teamspace",values:{teamOwnersCount:t}})}function _i(e){window.__c={n:"TeamOwnerPermissionTooltip"};const{teamName:t}=e,i=(0,c.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?s()("div",{style:i.tooltip},void 0,s()(u.FormattedMessage,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:t},id:"blockPermissionsSettings.teamOwnerPermission.tooltip",description:"Tooltip indicating how many owners are being granted a specific level of access to a page."})):null}const Ii=function(e){var t;window.__c={n:"TeamOwnerPermissionItem"};const{store:i,blockTeamOwnerPermission:n,isExternalTeam:o}=e,{permissionItem:l}=n,u=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),m=y.LW(l)?l.team_id:null===(t=C.VP(i))||void 0===t?void 0:t.id,{teamStore:g,teamName:h,teamOwners:f}=(0,d.VK)((()=>{if(!u||!m)return{undefined:void 0};const e=I.zX.createChildStore(u,{table:w.e0,id:m,spaceId:u.id});return{teamStore:e,teamName:e.getName(),teamOwners:(0,re.XO)({membership:e.getMembers()})}}),[u,m]),v=!o,b=(0,c.yK)((()=>({container:{width:"100%"}})),[]);return g?s()("div",{style:b.container,className:p.ZmO},void 0,r.createElement(be.Z,a()({isCompact:v,currentBlockStore:i,permissionItem:n.permissionItem,from:n.from,icon:s()(Ci,{store:i,teamName:h,teamStore:g,teamOwners:f}),title:s()(ki,{teamName:h,isCompact:v}),nonInheritedTooltip:s()(_i,{teamName:h}),subtitle:s()(Ti,{teamOwnersCount:f.length,isCompact:v}),upgradeButtonName:"team_owner_permission_item"},e.permissionItemArgs))):null};var xi=i(4708),Zi=i(92350),Pi=i(33241);function Fi(e){window.__c={n:"Title"};const{teamName:t}=e;return s()(u.FormattedMessage,t?{defaultMessage:"Everyone at {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccess",description:"Everyone in the given teamspace",values:{teamName:t??""}}:{defaultMessage:"Everyone at a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hidden",description:"A generic name to give a team we don't know the name of."})}function Ai(e){window.__c={n:"Subtitle"};const{membersCount:t}=e;return s()(u.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",description:"A sub-title indicating the number of members in the teamspace.",values:{membersCount:t}})}const Bi=function(e){var t;const{store:i,blockTeamMemberPermission:n,blockTeamOwnerPermission:o,blockTeamGuestPermission:u}=e,{device:p}=(0,l.O7)(),[m,g]=(0,r.useState)(!1),{permissionItem:h}=n,f=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),v=y.zU(h)?h.team_id:null===(t=C.VP(i))||void 0===t?void 0:t.id,S=o.permissionItem.role,M=h.role,k={type:"team_overview_permission",role:S===M?M:"none"===M||"none"===S?"limited":"access"},{teamStore:T,teamIsDefined:x,teamName:Z}=(0,d.VK)((()=>{if(!f||!v)return{undefined:void 0};const e=I.zX.createChildStore(f,{table:w.e0,id:v,spaceId:f.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[f,v]),P=(0,Zi.KR)(T),F=(0,d.VK)((()=>{if(!f)return!1;return!f.getDisableTeamGuests()&&((null==T||!T.isDefault())&&(0,xi.F$)())}),[f,T]),A=(0,c.yK)((e=>({icon:{width:10,marginRight:2,fill:e.lightIconColor},teamPermissionsContainer:{paddingLeft:16,display:m?"block":"none"},roleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:p.isMobile?14:12}})),[m,p.isMobile]),B=Ze.Z.chevronUpRounded(A.icon);return T?r.createElement(r.Fragment,null,r.createElement(be.Z,a()({currentBlockStore:i,permissionItem:k,from:n.from,icon:x?s()(Ee.p,{disabled:!0,store:T,size:be.Z.iconSize}):Ze.Z.privateTeam(),title:s()(Fi,{teamName:Z}),subtitle:x&&s()(Ai,{membersCount:P}),upgradeButtonName:"team_permission_item",onClick:()=>g(!m),permissionRoleSelect:m?B:s()(Pi.d,{role:k.role,icon:Ze.Z.expand,disabled:!0,buttonStyle:A.roleButton,table:b.iU,isRemovable:!1,isCurrentUser:!1})},e.permissionItemArgs)),s()("div",{style:A.teamPermissionsContainer},void 0,o&&s()(Ii,{store:i,permissionItemArgs:e.permissionItemArgs,blockTeamOwnerPermission:o}),n&&s()(wi,{store:i,permissionItemArgs:e.permissionItemArgs,blockTeamPermission:n}),F&&u&&s()(vi,{store:i,permissionItemArgs:e.permissionItemArgs,blockTeamGuestPermission:u}))):null};function Ei(e){const{store:t,permissionItemArgs:i}=e,{showTeamPermission:n,showSpacePermission:a,mostPermissiveTeamOwnerItem:o,mostPermissiveTeamMemberItem:l,mostPermissiveTeamGuestItem:d,mostPermissiveSpaceItem:c,pagePermissionUIModel:u}=e.calculatedPermissions,p=Number(n)+Number(a);return r.createElement(r.Fragment,null,n&&o&&l&&s()(Bi,{store:t,blockTeamOwnerPermission:o,blockTeamMemberPermission:l,blockTeamGuestPermission:d,permissionItemArgs:i}),a&&s()(pi,{store:t,spacePermission:c,permissionItemArgs:i}),s()(Di,{store:t,pagePermissions:u,numberPermissionsAlreadyRendered:p,permissionItemArgs:i}))}function Di(e){const t=(0,u.useIntl)(),i=(0,d.VK)((()=>{const e=_.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:n,pagePermissions:a,numberPermissionsAlreadyRendered:o,permissionItemArgs:l,showHeader:c}=e,{showUserPermissions:p,mostPermissiveGroupPermissions:m,mostPermissiveTeamPermissions:g,mostPermissiveUserPermissions:h,spacePermissionGroups:v}=a,b=(0,d.VK)((()=>le()),[]),S=(0,d.VK)((()=>{const e=p?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:i}=e,n={};return t.forEach((t=>{n[t.permissionItem.user_id]=s()(xe,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:i})})),n}({store:n,mostPermissiveUserPermissions:h,permissionItemArgs:l,spaceVisibleUserMap:b}):[];return f().compact(Object.keys(e).map((i=>{const a=I.U6.createChildStore(n,{table:oe.KJ,id:i}),o=a.getModel();if(!a.isReady()||o)return{title:(0,se.Nz)(t,o),permissionItem:e[i]}})))}),[p,h,l,n,t,b]),w=i?function(e){const{spaceId:t,spacePermissionGroups:i,mostPermissiveGroupPermissions:n}=e,a={};return n.forEach((n=>{const o=n.permissionItem.group_id;i.find((e=>e.id===o))&&(a[o]=s()(we,{store:e.store,groupPermission:n,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs}))})),a}({store:n,spaceId:i,spacePermissionGroups:v,mostPermissiveGroupPermissions:m,permissionItemArgs:l}):[],M=function(e){const{store:t,mostPermissiveTeamPermissions:i,permissionItemArgs:n}=e;return i.map((e=>y.LW(e.permissionItem)?s()(Ii,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:n},`${e.permissionItem.team_id}.owner`):y.bm(e.permissionItem)?s()(vi,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:n},`${e.permissionItem.team_id}.teamGuest`):s()(wi,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:n},`${e.permissionItem.team_id}.member`)))}({store:n,mostPermissiveTeamPermissions:g,permissionItemArgs:l}),C=[...S,...Object.keys(w).map((e=>{const i=v.find((t=>t.id===e));return{title:i?(0,ue.kF)({intl:t,group:i}):"",permissionItem:w[e]}}))];C.sort(((e,t)=>e.title.localeCompare(t.title)));const k=M.concat(C.map((e=>e.permissionItem))),T=k.length;if(0===T)return null;if(T>5-o){const e=Math.max(2-o,0);return r.createElement(r.Fragment,null,c&&s()(Ye,{}),k.slice(0,e),s()(Pe,{permissions:k.slice(e,-1)}),k[T-1])}return r.createElement(r.Fragment,null,c&&s()(Ye,{}),k)}function Ri(e,t){return e.from.table===b.iU&&e.from.blockId===t.id}const Li=function(e){const t=(0,l.O7)(),{device:i}=t,{store:n,permissionItemArgs:a,calculatedPermissions:o}=e,{sudoModeStore:u}=a,{permissionItemsCount:p,pagePermissionUIModel:m,showRestrictedPermissionBanner:g}=o,h=(0,d.VK)((()=>{const e=_.default.state.currentSpaceStore;if(!e)return!0;if(n.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;const i=(0,C.uJ)(n);for(const n of i)if((0,ce.NZ)(n)&&n.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;return!1}),[n,t]);let v=null;const y=(0,d.VK)((()=>function(e){const{store:t,showRestrictedPermissionBanner:i}=e,{canAccessParent:n}=Z({store:t});return n&&(i||x({store:t}))}({store:n,showRestrictedPermissionBanner:g})),[n,g]),{canAccessParent:b}=(0,d.VK)((()=>Z({store:n})),[n]),w={...o};if(!y&&b){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:i,mostPermissiveTeamPermissions:n,mostPermissiveUserPermissions:a}=t,[o,s]=f().partition(i,(t=>Ri(t,e))),[r,l]=f().partition(n,(t=>Ri(t,e))),[d,c]=f().partition(a,(t=>Ri(t,e))),u={...t,mostPermissiveGroupPermissions:s,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},p={...t,mostPermissiveGroupPermissions:o,mostPermissiveTeamPermissions:r,mostPermissiveUserPermissions:d};return[u,p]}(n,m);w.pagePermissionUIModel=e,v=s()(Di,{store:n,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:a,showHeader:!0})}const M=(0,d.VK)((()=>!function(e){const{store:t}=e,i=(0,C.uJ)(t),n=i.find((e=>e instanceof I.G&&e.isRestricted())),a=i[i.length-1];return n||a.getParentTable()===S.bx&&a.canRead()}({store:n})),[n]),k=i.isMobile?pe.Z.None:pe.Z.Y,T=(0,c.yK)((e=>({scroller:{paddingBottom:10,paddingTop:i.isMobile?5:0,minHeight:i.isMobile||0===p?void 0:1===p?60:90}})),[i,p]);return r.createElement(r.Fragment,null,s()(me.Z,{style:T.scroller,type:k},void 0,!h&&s()($e,{store:n}),s()(it,{store:n,showRestrictedPermissionBanner:g,sudoModeStore:u}),!y&&p>0&&s()(Xe,{store:n}),s()(Ei,{store:n,calculatedPermissions:w,permissionItemArgs:a}),v,M&&s()(Fe,{store:n})),!i.isMobile&&s()(si,{store:n,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:w,permissionItemArgs:a}))};const Oi=function(e){window.__c={n:"WorkspaceOwnerPermissionOverride"};const{store:t,sudoModeStore:i}=e,n=(0,d.VK)((()=>i.state.changePermissionsEnabled),[i]),a=(0,d.VK)((()=>i&&i.shouldUserHaveAccessToPrivatePageBlock()&&!i.doesUserAlreadyHaveEditorAccessOnBlock(t.id)&&i.state.privatePageStore),[i,t]),o=(0,c.yK)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.borderBoxShadow,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:Y.Z.fontWeight.medium,justifyContent:"center",marginTop:8,opacity:n?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:n?"rotate(-90deg)":void 0}})),[n]);return a?s()("div",{style:o.container},void 0,s()(U.Z,{isMultiline:!0},void 0,s()(u.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",description:"Explaining that a workspace owner can change the permissions of this page.",values:{b:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return s()("b",{},void 0,t)}}})),s()(lt.Z,{disabled:n,style:o.button,onClick:()=>{i.setState({...i.state,changePermissionsEnabled:!0})}},void 0,Ze.Z.settingsSecurity(o.icon),s()(u.FormattedMessage,n?{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions",description:"Button for the workspace owner to activate their ability to share permissions of this page, indicating that it is enabled."}:{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions",description:"Button for the workspace owner to activate their ability to share permissions of this page."}))):null};const Ni=function(e){window.__c={n:"MobileShareMenu"};const{store:t,permissionItemArgs:i,buttonPopupStore:n,calculatedPermissions:a}=e,{onUpgradeButtonClick:o,sudoModeStore:r}=i,{device:u,WindowSizeStore:p}=(0,l.O7)(),m=(0,d.qz)(void 0,R.Z),{permissionsInviteStore:g,contextualInviteStore:h}=(0,d.VK)((()=>m.state),[m]),f=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),v=(0,d.VK)((()=>t.canAdmin()),[t]),y=(0,d.VK)((()=>P({store:t})),[t]),{data:b}=(0,d.VK)((()=>G.default.state),[]),S=Boolean(b&&q.YK(b)),w=(0,d.VK)((()=>m.stage),[m]),M=(0,d.VK)((()=>p.getSafePaddingRightCSS(14)),[p]),C=(0,c.yK)((e=>({container:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column"},pageLinkButton:{display:"flex",paddingTop:8,paddingBottom:8,paddingRight:M,background:e.sidebarBackground},border:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[M]);return f&&w!==D.TG.closed?s()(H.LazyUniversalMemberInvite,{universalInviteStore:m,mode:"milestone_2",spaceStore:f,sudoModeStore:r,store:t,disabled:!v,membersOnly:y,isSubscribed:S,onUpgradeButtonClick:o,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:{height:u.isMobile?36:28}}):s()("div",{style:C.container},void 0,r&&s()(Oi,{store:t,sudoModeStore:r}),!u.isMobile&&s()(ae,{store:t,onUpgradeButtonClick:o,permissionsInviteStore:g,contextualInviteStore:h}),s()(Li,{store:t,permissionItemArgs:i,calculatedPermissions:a,buttonPopupStore:n}))};var Vi=i(5500),Ui=i(54642),Wi=i(95209),zi=i(79817),Ki=i(53353),qi=i(26781);function Hi(e){let{currentSpaceStore:t,blockStore:i}=e;return(0,d.VK)((()=>!!t&&(!(0,Be.Cx)(t)&&i.isTopLevelTeamPage()&&i.canAdmin()&&i.getPermissionItems().filter((e=>!y.FB(e))).length>0)),[t,i])}var Gi=i(30874),ji=i(55899),$i=i(29798),Yi=i(66708),Qi=i(51077),Xi=i(73063),Ji=i(3386),en=i(7567),tn=i(44385),nn=i(29477),an=i(68626),on=i(77719),sn=i(68785);function rn(e){const{onClickAuthenticated:t}=e,i=(0,l.O7)(),[n,a]=r.useState(!1),o=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),p=(0,d.VK)((()=>{const e=null==o?void 0:o.getBotSettingsStore().getValue();return"approved_only"!==(null==e?void 0:e.integration_restrictions)||Boolean((null==e?void 0:e.integration_approval_statuses)&&e.integration_approval_statuses[Vi.nO])}),[o]),m=(0,d.VK)((()=>Gi.Z.integrations.state.find((e=>e.id===Vi.nO))),[]),g=(0,d.VK)((()=>Gi.Z.completeSlackAuthentications.state),[]),h=(0,c.yK)((e=>({circleCheck:{height:14,width:14,marginLeft:6,color:J.ZP.blue},chevron:{height:12,width:12,marginLeft:6},title:{display:"flex",alignItems:"center",color:J.ZP.uiLightBlack,size:14},integrationName:{display:"flex"},integrationIcon:{marginLeft:4,marginRight:4},container:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},button:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9},loadingSpinner:{width:14,height:14,marginLeft:6}})),[]);if(!o)return r.createElement(r.Fragment,null);if(!p)return r.createElement(r.Fragment,null);const f=s()("div",{style:h.integrationName},void 0,s()(Qi.Z,{type:"image_url",imageURL:ge.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:h.integrationIcon}),s()(u.FormattedMessage,{defaultMessage:"Slack",id:"importContactsButton.integrationName",description:"Part of a label for a button that, when clicked, allows user to connect to Slack integration"})),v=n?s()(sn.Z,{style:h.loadingSpinner}):r.createElement(r.Fragment,null,g.length>0&&Ze.Z.circleCheckFilled(h.circleCheck),Ze.Z.chevronRight(h.chevron));return s()("div",{style:h.container},void 0,s()(yt.Z,{style:h.button,onClick:async()=>{0===g.length?await async function(){const e=i.currentUser.id;if(!m||!o||!e)return;try{var n;a(!0);const e=await on.hM({environment:i,integration:m,spaceId:o.id,from:"share_menu"});if(an.x.isFail(e))return;const s=null===(n=e.value.externalAuthentication)||void 0===n?void 0:n.parent_id;if(!s)return;const r=Zt.default.getEligibleGroup({experimentId:"import_slack_contacts",defaultGroup:2e3,parameter:"load_contacts_timeout"}),l=Number(r);await Promise.race([Ui.loadContacts(i,{botId:s,spaceId:o.id,integrationId:m.id}),(0,nn.Vs)(Number.isNaN(l)?2e3:l)]),null==t||t()}finally{a(!1)}}():g.length>0&&(null==t||t())}},void 0,s()("div",{style:h.title},void 0,s()(u.FormattedMessage,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",description:"Label for a button that, when clicked, allows user to connect to Slack integration",values:{integrationNameWithLogo:f}}),v)))}var ln=i(33728),dn=i(26907);var cn=i(47082),un=i(22193);const pn=function(e){window.__c={n:"InviteTargetsInput"};const{store:t,disabled:i,placeholder:n,right:a,focus:o,onFocus:r,onSubmit:u}=e,p=(0,l.O7)(),m=(0,l.Fy)(),g=(0,d.qz)(e.inviteTargetsStore,ji.ZP),h=(0,d.VK)((()=>g.state.inviteTargets),[g]),f=(0,d.VK)((()=>g.state.tokenQuery),[g]),v=h.map((e=>{const i="newUser"===e.type?e.value.email:e.value.id;return s()(un.Z,{store:t,target:e,showRemoveButton:!0,onClickRemove:()=>function(e){const{targetToRemove:t,inviteTargetsStore:i}=e;if(0===i.state.inviteTargets.length)return;const n=i.state.inviteTargets.filter((e=>e!==t));0===n.length?i.setState({...i.state,inviteTargets:[]}):i.setState({...i.state,inviteTargets:n})}({inviteTargetsStore:g,targetToRemove:e})},i)})),y=(0,c.yK)((e=>({tokenSpan:{maxWidth:"100%"},tokenInputMenuItem:{paddingTop:0===h.length?0:6,paddingLeft:6,paddingRight:6,paddingBottom:0,borderRadius:3,minHeight:"unset",...o&&{background:"none"},...i&&{background:e.inputBackground,color:e.mediumTextColor,fill:J.ZP.white,opacity:.4}},tokenInputMenuItemInput:{paddingTop:0===h.length?6:0}})),[h,o,i]);return s()(cn.Z,{focus:o,focusAfterAnimation:!0,onClick:()=>{m.isMobile||null==r||r()},format:cn.Z.Format.Share,value:f,onChange:e=>async function(e){const{environment:t,event:i,inviteTargetsStore:n}=e;n.setState({...n.state,tokenQuery:i.target.value});const a=i.target.value,{extractedEmails:o,newInputValue:s}=(0,ln.zI)(a),r=(await Wi.M5(t,o)).filter((e=>!dn.H({inviteTargetsStore:n,target:e}))),l=[...n.state.inviteTargets,...r];n.setState({...n.state,inviteTargets:l,tokenQuery:s})}({environment:p,event:e,inviteTargetsStore:g}),type:"email",tokens:v,disabled:i,autoComplete:"off",placeholder:n,onRemoveLastToken:()=>{g.setState({...g.state,inviteTargets:g.state.inviteTargets.slice(0,-1)})},right:a,showBorder:!0,inputStyle:y.tokenInputMenuItemInput,style:y.tokenInputMenuItem,onSubmit:u})};function mn(e){window.__c={n:"ResetPermissionsButton"};const{store:t,sudoModeStore:i}=e,n=(0,l.O7)(),a=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),o=(0,d.VK)((()=>!!i&&i.shouldSaveTransactionWithSudoMode(t)),[t,i]),p=Hi({currentSpaceStore:a,blockStore:t}),m=(0,c.yK)((()=>({button:{justifyContent:"center",width:"100%"},title:{display:"flex",alignItems:"center",color:J.ZP.uiLightBlack,size:14},tooltip:{width:210,whiteSpace:"initial"}})),[]),g=async()=>{await De.Kt({environment:n,useSudoMode:o,store:t})};return p?s()(ie.Z,{style:m.tooltip,placement:Oe.u.Left,renderTooltip:()=>s()(u.FormattedMessage,{defaultMessage:"Reset page permissions to match default teamspace permissions",id:"permissionsResetButton.tooltip.teamPermissions",description:"Tooltip for a button explaining that page permissions will be cleared to match teamspace defaults."}),render:e=>r.createElement("span",e,s()(yt.Z,{onClick:g,style:m.button},void 0,s()("div",{style:m.title},void 0,s()(u.FormattedMessage,{defaultMessage:"Reset permissions",id:"permissionsResetButton.resetButton.label",description:"Label for a button that, when clicked, allows user reset permissions on the page to match the parent page."}))))}):null}function gn(e){window.__c={n:"ShareMenuMoreActionsList"};const t=(0,c.yK)((()=>({container:{paddingLeft:4,paddingRight:4,paddingTop:6,paddingBottom:6}})),[]);return s()(st.Z,{popupType:st.Z.PopupType.Popup,placementToOrigin:st.Z.Placement.Bottom,alignmentToOrigin:st.Z.Alignment.End,renderOrigin:e=>r.createElement(Xi.Z,a()({icon:Ze.Z.dots},e)),render:()=>s()("div",{style:t.container},void 0,s()(mn,{store:e.store,sudoModeStore:e.sudoModeStore}))})}var hn=i(59054),fn=i(21752),vn=i(43765),yn=i(69507),bn=i(70268);function Sn(e){window.__c={n:"ShareMenuSearchRequestImpl"};const{store:t,shouldShowSlackOnly:i,calculatedPermissions:n,permissionItemArgs:o,tokenQuery:p,showShimmer:m,error:g,ready:h,result:f}=e,v=n.pagePermissionUIModel,b=(0,l.O7)(),S=(0,d.qz)(e.inviteTargetsStore,ji.ZP),w=(0,d.qz)(e.menuListStore,$i.Z),M=(0,d.VK)((()=>le()),[]),T=(0,d.VK)((()=>xi.Rv()),[]),_=(0,c.yK)((e=>({sectionMenuItem:{paddingTop:0,display:"flex",flexDirection:"column",gap:2},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:110},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:54,width:54,marginBottom:12,fill:e.mediumIconColor}})),[]),{inPageTargets:I,notInPageTargets:x,filteredImportedContacts:Z}=(0,d.VK)((()=>{const{inviteUsers:e,inviteGroups:i,importedContacts:a=[]}=f??{inviteUsers:[],inviteGroups:[],importedContacts:[]},o=[...e,...i],s=[],r=[],l=new Set;o.forEach((e=>{"group"!==e.type&&l.add(e.value.email.toLowerCase());const i=Boolean(K.Zp({store:t,target:e})),a=function(e){const{inviteTarget:t,blockStore:i,spacePermission:n,teamMemberPermission:a}=e,o=t.type;if("newUser"===o)return{role:"none",type:"user_permission",user_id:t.value.email};if("existingUser"===o)return k.Dt({userId:t.value.id,store:i});if("group"===o){const e={role:"none",type:"group_permission",group_id:t.value.id},o=(0,C.VP)(i);if(!o)return e;return!(null==o?void 0:o.getMembers().find((e=>(0,re.lF)({groupId:t.value.id,teamMember:e}))))&&n?n.permissionItem:a?a.permissionItem:e}(0,Ae.t1)(o)}({inviteTarget:e,blockStore:t,spacePermission:n.mostPermissiveSpaceItem,teamMemberPermission:n.mostPermissiveTeamMemberItem});if("existingUser"===e.type&&!Boolean(e.spaceRole)){const t=M.get(e.value.id);e.spaceRole=t?t.role:"not_in_space"}(i||y.YX(a.role??"none"))&&"newUser"!==e.type?s.push({inviteTarget:e,permissionItem:a}):r.push(e)}));const d=a.filter((e=>!l.has(e.value.email.toLowerCase())));return{inPageTargets:s,notInPageTargets:r,filteredImportedContacts:d}}),[t,f,n.mostPermissiveSpaceItem,n.mostPermissiveTeamMemberItem,M]);if(g)return s()(yn.l,{loading:!h},void 0,s()(vn.Z,{title:s()(u.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})}));if(!h&&m)return s()(bn.B,{areaHeight:window.innerHeight});const P=!i&&x.length>0&&0===p.length,F={key:"suggested",render:e=>r.createElement(dt.Z,a()({},e,{style:_.sectionMenuItem,title:s()(u.FormattedMessage,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested",description:"Section title for suggested people to invite for empty search request."}),loading:!h})),items:x.map(((e,i)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:i=>{const n=dn.H({target:e,inviteTargetsStore:S});return r.createElement(Zn,a()({},i,{invited:!1,inviteTarget:e,isInInviteTargets:n,blockStore:t,spaceVisibleUserMap:M}))},action:()=>wn({inviteTarget:e,inviteTargetsStore:S,menuListStore:w})})))},A=!i&&p.length>0&&I.length>0,B={key:"in page",render:e=>r.createElement(dt.Z,a()({},e,{style:_.sectionMenuItem,title:s()(u.FormattedMessage,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page",description:"Section title for search results of people in page."}),loading:!h})),items:I.map((e=>{const{inviteTarget:i,permissionItem:n}=e,{type:l}=i;if("existingUser"===l){const e=v.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===i.value.id));return e?{key:i.value.id,render:i=>r.createElement(ot.Z,a()({},i,{itemMarginLeft:0,itemMarginRight:0,title:s()(xe,{store:t,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:M,permissionItemArgs:o})})),action:()=>{}}:{key:i.value.id,render:e=>r.createElement(kn,a()({},e,{blockStore:t,inviteTarget:i,permissionItem:n,spaceVisibleUserMap:M})),action:()=>wn({inviteTarget:i,inviteTargetsStore:S,menuListStore:w})}}if("group"===l){const e=v.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===i.value.id));return e?{key:i.value.id,render:i=>r.createElement(ot.Z,a()({},i,{itemMarginLeft:0,itemMarginRight:0,title:s()(we,{store:t,groupPermission:e,spaceId:t.getSpaceId(),showInherited:!0,permissionItemArgs:o})})),action:()=>{}}:{key:i.value.id,render:e=>r.createElement(kn,a()({},e,{blockStore:t,inviteTarget:i,permissionItem:n,spaceVisibleUserMap:M})),action:()=>wn({inviteTarget:i,inviteTargetsStore:S,menuListStore:w})}}(0,Ae.t1)(l)}))},E=!i&&x.length>0&&p.length>0&&!(0,ln.oH)((0,ln.H3)(p)),D={key:"not in page",render:e=>r.createElement(dt.Z,a()({},e,{style:_.sectionMenuItem,title:p.length>0&&s()(u.FormattedMessage,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page",description:"Section title for search results of people not in page."}),loading:!h})),items:x.map((e=>({key:"newUser"===e.type?e.value.email:e.value.id,render:i=>r.createElement(Zn,a()({},i,{invited:!1,inviteTarget:e,isInInviteTargets:dn.H({target:e,inviteTargetsStore:S}),blockStore:t,spaceVisibleUserMap:M})),action:()=>wn({inviteTarget:e,inviteTargetsStore:S,menuListStore:w})})))},R=T&&Z.length>0,L={key:"imported contacts",render:e=>r.createElement(dt.Z,a()({},e,{style:_.sectionMenuItem,title:s()(u.FormattedMessage,{id:"shareMenuSearchRequest.importedContactsSection.title",defaultMessage:"From Slack",description:"Section title for search results of contacts imported from Slack."}),loading:!h})),items:Z.map((e=>({key:e.value.email,render:i=>r.createElement(Zn,a()({},i,{invited:!1,inviteTarget:e,isInInviteTargets:dn.H({target:e,inviteTargetsStore:S}),blockStore:t,spaceVisibleUserMap:M})),action:()=>{dn.H({target:e,inviteTargetsStore:S})?S.setState({...S.state,inviteTargets:S.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(S.setState({inviteTargets:[...S.state.inviteTargets,e],tokenQuery:""}),w.unsetFocus())}})))},O={key:"user results",render:e=>r.createElement(dt.Z,a()({},e,{style:_.sectionMenuItem,loading:!h,title:s()(u.FormattedMessage,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Suggested",description:"Header in invite menu, asking user to add a people's email."})})),items:[{key:p,render:e=>r.createElement(ot.Z,a()({icon:Ze.Z.addPerson({width:24,height:24}),title:s()(u.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",description:"Button item encouraging typing an email.",values:{tokenQuery:p}})},e)),action:async()=>{const e=(0,ln.H3)(p);if(!(0,ln.oH)(e))return;const t=await Wi.M5(b,[e]);if(!t.length)return;const i=t[0];dn.H({target:i,inviteTargetsStore:S})||(S.setState({inviteTargets:[...S.state.inviteTargets,i],tokenQuery:""}),w.unsetFocus())}}]};let N=[];return P&&(N=[F]),A&&N.push(B),E&&N.push(D),R&&N.push(L),i&&(N=[L],0===L.items.length)?s()(Pn,{styles:_}):0===N.length&&(N=[O],0===p.length)?s()(Fn,{styles:_,shouldShowSlackMessage:T}):s()(rt.Z,{type:rt.i.Vertical,initialFocus:p.length>0?0:void 0,sections:N,store:w})}function wn(e){const{inviteTarget:t,inviteTargetsStore:i,menuListStore:n}=e;if(dn.H({target:t,inviteTargetsStore:i})){const e=i.state.inviteTargets.filter((e=>"group"===t.type&&"group"===e.type||"existingUser"===t.type&&"existingUser"===e.type?t.value.id!==e.value.id:"newUser"!==t.type||"newUser"!==e.type||t.value.email!==e.value.email));return i.setState({...i.state,inviteTargets:e}),void n.unsetFocus()}i.setState({inviteTargets:[...i.state.inviteTargets,t],tokenQuery:""}),n.unsetFocus()}const Mn=r.forwardRef(((e,t)=>{const{blockStore:i,inviteTarget:n,permissionItem:o}=e,l=(0,u.useIntl)(),p=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),m=(0,d.VK)((()=>{if("group"===n.type)return(0,ue.kF)({group:n.value,intl:l})}),[n,l]),g=(0,d.VK)((()=>{if(p&&"group"===n.type&&n.value.icon)return{pointer:{table:p.table,id:p.id},icon:n.value.icon}}),[p,n]),h=(0,d.VK)((()=>p?"group"!==n.type?0:(0,ue.rm)({group:n.value,spaceStore:p,limit:void 0}).totalNumberMembers:0),[p,n]),f=(0,c.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10},permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:Y.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]);return s()(ie.Z,{delayThreshold:0,placement:ie.Z.Placement.Left,textWrap:!0,style:{maxWidth:180},renderTooltip:()=>s()(Tn,{blockStore:i,blockPermissionItem:o}),render:i=>r.createElement("div",i,r.createElement(ot.Z,a()({},e,{ref:t,title:s()("div",{style:f.titleContainer},void 0,s()(he.Z,{size:32}),s()("div",{style:f.groupInfoContainer},void 0,s()("div",{style:f.nameAndIconContainer},void 0,s()(U.Z,{style:f.groupNameLabel},void 0,m),Boolean(null==g?void 0:g.icon)&&s()(fe.Z,{disabled:!0,bucket:"public",title:m,icon:g,size:18,isEmptyPage:!1})),s()(U.Z,{isSmall:!0,style:f.groupMembersLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label",description:"Indicates a group of members"})," · ",s()(u.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:h}})))),right:s()(Pi.d,{table:b.iU,disabled:!0,role:o.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:f.permissionRoleButton})})))})})),Cn=r.forwardRef(((e,t)=>{const{blockStore:i,inviteTarget:n,permissionItem:o,spaceVisibleUserMap:l}=e,u=(0,c.yK)((e=>({permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:Y.Z.fontWeight.bold},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),p="existingUser"===n.type?I.U6.createChildStore(i,{table:oe.KJ,id:n.value.id}):void 0,m=(0,d.VK)((()=>"none"===n.spaceRole?de({spaceVisibleUserMap:l,userId:n.value.id,blockStore:i}):(0,fn.K)(n.spaceRole)),[n,l,i]);return s()(ie.Z,{delayThreshold:0,placement:ie.Z.Placement.Left,textWrap:!0,style:{maxWidth:180},renderTooltip:()=>s()(Tn,{blockStore:i,blockPermissionItem:o}),render:i=>r.createElement("div",i,r.createElement(ot.Z,a()({},e,{ref:t,title:s()(fn.Z,{isLarge:!0,actorStore:p,containerStyle:u.cellMemberAvatarContainer,spaceRole:m}),right:s()(Pi.d,{table:b.iU,disabled:!0,role:o.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:u.permissionRoleButton})})))})})),kn=r.forwardRef(((e,t)=>{const{inviteTarget:i}=e,n=i.type;switch(n){case"group":return r.createElement(Mn,a()({},e,{ref:t,inviteTarget:i}));case"existingUser":return r.createElement(Cn,a()({},e,{ref:t,inviteTarget:i}));default:(0,Ae.t1)(n)}}));function Tn(e){const{blockStore:t,blockPermissionItem:i}=e,n=(0,l.O7)(),a=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),o=(0,d.VK)((()=>{if(a)return(0,Be.Wd)(n,a)}),[n,a]),p=(0,d.VK)((()=>{const e=i.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return I.zX.createChildStore(t,{table:w.e0,id:i.team_id})}}),[t,i]),m=(0,d.VK)((()=>null==p?void 0:p.getIcon()),[p]),g=(0,c.yK)((()=>({container:{fontWeight:Y.Z.fontWeight.bold,...Y.Z.textOverflowStyle},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),h=i.type;return"space_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",description:"Tooltip explaining the user access comes from the fact that everyone in the workspace has access.",values:{spaceIconAndName:s()("span",{style:g.container},void 0,o&&s()(fe.Z,{disabled:!0,icon:o,isEmptyPage:!1,size:12,style:g.recordIcon}),a&&s()(Ue.ZP,{store:a,style:g.recordTitle}))}}):"explicit_team_owner_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",description:"Tooltip explaining the user access comes from the fact that every teamspace owner has access.",values:{teamIconAndName:s()("span",{style:g.container},void 0,m&&s()(fe.Z,{disabled:!0,icon:m,isEmptyPage:!1,size:12,style:g.recordIcon}),p&&s()(Ue.ZP,{store:p,style:g.recordTitle}))}}):"explicit_team_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",description:"Tooltip explaining the user access comes from the fact that every teamspace member has access.",values:{teamIconAndName:s()("span",{style:g.container},void 0,m&&s()(fe.Z,{disabled:!0,icon:m,isEmptyPage:!1,size:12,style:g.recordIcon}),p&&s()(Ue.ZP,{store:p,style:g.recordTitle}))}}):"explicit_team_guest_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",description:"Tooltip explaining the user access comes from the fact that every teamspace guests has access.",values:{teamIconAndName:s()("span",{style:g.container},void 0,m&&s()(fe.Z,{disabled:!0,icon:m,isEmptyPage:!1,size:12,style:g.recordIcon}),p&&s()(Ue.ZP,{store:p,style:g.recordTitle}))}}):"group_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access.",description:"Tooltip stating the group has access."}):"user_permission"===h||"public_permission"===h||"restricted_permission"===h||"deleted_permission"===h||"team_permission"===h||"team_owner_permission"===h||"bot_permission"===h?r.createElement(r.Fragment,null,y.YX(i.role??"none")&&s()(u.FormattedMessage,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access",description:"Tooltip explaining this user has access."})):void(0,Ae.t1)(h)}function _n(e){window.__c={n:"CircleCheckmark"};const{checked:t}=e,i=(0,c.yK)((e=>({circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:22,height:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,borderColor:t?J.ZP.blue:e.buttonPressedBackground,backgroundColor:t?J.ZP.blue:"transparent",marginRight:6},checkIcon:{height:12,width:12,color:"white"}})),[t]);return s()("div",{style:i.circleCheckmark},void 0,t&&Ze.Z.check(i.checkIcon))}const In=r.forwardRef(((e,t)=>{const{inviteTarget:i,isInInviteTargets:n,disabled:o}=e,l=(0,u.useIntl)(),p=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),m=(0,d.VK)((()=>(0,ue.kF)({group:i.value,intl:l})),[i,l]),g=(0,d.VK)((()=>{if(p&&i.value.icon)return{pointer:{table:p.table,id:p.id},icon:i.value.icon}}),[p,i]),h=(0,d.VK)((()=>{if(!p)return 0;return(0,ue.rm)({group:i.value,spaceStore:p,limit:void 0}).totalNumberMembers}),[p,i]),f=(0,c.yK)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[]),v=s()("div",{style:f.titleContainer},void 0,s()(he.Z,{size:32}),s()("div",{style:f.groupInfoContainer},void 0,s()("div",{style:f.nameAndIconContainer},void 0,s()(U.Z,{style:f.groupNameLabel},void 0,m),Boolean(null==g?void 0:g.icon)&&s()(fe.Z,{disabled:!0,bucket:"public",title:m,icon:g,size:18,isEmptyPage:!1})),s()(U.Z,{isSmall:!0,style:f.groupMembersLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label",description:"Indicates a group of members"})," · ",s()(u.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:h}}))));return r.createElement(ot.Z,a()({},e,{ref:t,title:v,right:s()(_n,{checked:n}),disabled:o}))})),xn=r.forwardRef(((e,t)=>{const{inviteTarget:i,blockStore:n,isInInviteTargets:o,disabled:l,spaceVisibleUserMap:u,...p}=e,m=(0,c.yK)((()=>({cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[]),g=(0,d.VK)((()=>"existingUser"===i.type?de({spaceVisibleUserMap:u,userId:i.value.id,blockStore:n}):void 0),[i,u,n]),h=(0,r.useMemo)((()=>"existingUser"===i.type?{actorStore:I.U6.createChildStore(n,{table:oe.KJ,id:i.value.id}),avatar:void 0}:"newUser"===i.type?{actorStore:void 0,avatar:{email:i.value.email,name:"slack"===i.source?i.value.name:void 0,avatarUrl:"slack"===i.source?i.value.avatar_url:void 0}}:void(0,Ae.t1)(i)),[i,n]);return r.createElement(ot.Z,a()({},p,{ref:t,title:r.createElement(fn.Z,a()({isLarge:!0},h,{containerStyle:m.cellMemberAvatarContainer,avatarBadge:"newUser"===i.type&&"slack"===i.source?s()(Qi.Z,{type:"image_url",imageURL:ge.Z.images.externalIntegrations.slackIconPng,size:18,style:m.iconBox,imageStyle:m.iconBoxImage}):void 0,spaceRole:g})),disabled:l,right:!l&&s()(_n,{checked:o})}))})),Zn=r.forwardRef(((e,t)=>{const{inviteTarget:i,blockStore:n,spaceVisibleUserMap:o}=e,s=i.type;switch(s){case"group":return r.createElement(In,a()({},e,{ref:t,inviteTarget:i}));case"newUser":case"existingUser":return r.createElement(xn,a()({},e,{ref:t,inviteTarget:i,blockStore:n,spaceVisibleUserMap:o}));default:(0,Ae.t1)(s)}}));function Pn(e){window.__c={n:"ImportContactsZeroState"};const{styles:t}=e;return s()("div",{style:t.zeroState},void 0,Ze.Z.personBadgeExclamationMark(t.zeroStateIcon),s()("div",{style:t.zeroStateText},void 0,s()("div",{style:{fontWeight:Y.Z.fontWeight.semibold,marginBottom:4}},void 0,s()(u.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found",description:"Title of text shown in the share menu when there are no imported contacts to show the user."})),s()("div",{},void 0,s()(u.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different Slack workspace or typing an email address",description:"Subtext shown in the share menu when there are no imported contacts to show the user. This text suggests two alternative solutions."}))))}function Fn(e){window.__c={n:"SuggestedZeroState"};const{styles:t,shouldShowSlackMessage:i}=e;return s()("div",{style:t.zeroState},void 0,Ze.Z.addPersonCircle(t.zeroStateIcon),s()("div",{style:t.zeroStateText},void 0,s()("div",{style:{fontWeight:Y.Z.fontWeight.semibold,marginBottom:4}},void 0,s()(u.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Search or add people",description:"Title of text shown in the share menu when there are no imported contacts to show the user."})),s()("div",{},void 0,s()(u.FormattedMessage,i?{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try connecting a Slack workspace or typing an email address",description:"Subtext shown in the share menu when there are no imported contacts to show the user. This text suggests two alternative solutions."}:{id:"shareMenuSearchRequest.noSuggestions.defaultText",defaultMessage:"Try typing an email address",description:"Subtext shown in the share menu when there are no imported contacts to show the user. This text suggests an alternative solution."}))))}const An=function(e){window.__c={n:"ShareMenuSearchRequest"};const t=(0,l.O7)(),i=(0,u.useIntl)(),[n,o]=(0,r.useState)(!0),s=(0,d.VK)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,d.VK)((()=>{if(e.shouldShowSlackOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=Gi.Z.completeSlackAuthentications.state.length>0&&xi.Rv();return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly]),[{value:p,status:m}]=(0,hn.r5)((async()=>Wi.jL({query:s,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:i}).finally((()=>o(!1)))),[t,i,e.membersOnly,s,c],{debounce:40});return r.createElement(Sn,a()({},e,{tokenQuery:s,showShimmer:n,ready:"pending"!==m,error:"rejected"===m,result:p}))};function Bn(e){window.__c={n:"Header"};const{store:t,source:i,focus:n,resetState:a}=e,o=(0,c.yK)((()=>({titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:Y.Z.fontWeight.semibold}})),[]);if("all"===i)return r.createElement(r.Fragment,null,"noFocus"===n&&s()(Ln,{store:t,style:o.titleLabel}),("searching"===n||"message"===n)&&s()(On,{onClick:()=>a()}));const l=r.createElement(r.Fragment,null,s()(Qi.Z,{type:"image_url",imageURL:ge.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:{marginLeft:4,marginRight:4}}),s()(u.FormattedMessage,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label",description:"Part of a label for a button that, when clicked, allows user to connect to Slack integration"}));return s()(U.Z,{style:o.titleLabel},void 0,s()(u.FormattedMessage,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",description:"Title of popup",values:{integrationNameWithLogo:l}}))}function En(e){window.__c={n:"HeaderRight"};const{showMoreActions:t,source:i,setSource:n}=e,a=(0,u.useIntl)();return s()("div",{style:{height:24,width:24}},void 0,"all"===i?r.createElement(r.Fragment,null,t&&s()(gn,{store:e.store,sudoModeStore:e.sudoModeStore})):s()(Xi.Z,{ariaLabel:a.formatMessage({id:"shareMenu.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close slack integration and go back to the main invite flow.",description:"Accessibility label for icon button to go back to the main invite flow for the share menu."}),icon:Ze.Z.closeSmall,style:{borderRadius:"100%"},onClick:()=>n("all")}))}function Dn(e){window.__c={n:"UpgradeButton"};const{onClick:t}=e;return s()(ie.Z,{disableTooltip:!1,renderTooltip:()=>s()(tn.e,{}),render:e=>r.createElement(Q.Z,a()({isLarge:!0,style:{marginLeft:8},onClick:t},e),s()(u.FormattedMessage,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade",description:"Invite button in the share menu."}))})}function Rn(e){window.__c={n:"InviteButton"};const{tooltip:t,disabled:i,onClick:n}=e;return s()(ie.Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>r.createElement(Q.Z,a()({isLarge:!0,style:{marginLeft:8},disabled:i,onClick:n},e),s()(u.FormattedMessage,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite",description:"Invite button in the share menu."}))})}function Ln(e){window.__c={n:"PageTitle"};const{store:t,style:i}=e,n=(0,d.VK)((()=>t.getIcon()),[t]),a=(0,d.VK)((()=>t.isEmptyPage()),[t]),o=(0,c.yK)((()=>({recordIcon:{marginLeft:4,marginRight:4}})),[]);return s()(U.Z,{style:i},void 0,s()(u.FormattedMessage,{id:"shareMenu.share.label",defaultMessage:"Share",description:"Title of popup prefacing the page to be shared."}),s()(fe.Z,{disabled:!0,style:o.recordIcon,icon:n,size:18,isEmptyPage:a}),s()(Ue.ZP,{store:t}))}function On(e){window.__c={n:"BackButton"};const{onClick:t}=e,i=(0,u.useIntl)(),n=(0,c.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:20,width:20},arrowIcon:{height:13,width:13,strokeWidth:Y.Z.fontWeight.semibold},sendInviteLabel:{fontSize:12,fontWeight:Y.Z.fontWeight.semibold}})),[]);return s()("div",{style:n.topContainer},void 0,s()(Xi.Z,{icon:Ze.Z.arrowLeftThick,iconStyle:n.arrowIcon,style:n.iconButton,onClick:t,ariaLabel:i.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu.",description:"Accessibility label for icon button to go back to main view for the share menu. This button appears when the user is inviting people to a page."})}),s()(U.Z,{style:n.sendInviteLabel},void 0,s()(u.FormattedMessage,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite",description:"Title of popup explaining the action to be taken by the invite button."})))}function Nn(e){window.__c={n:"EmailMessageInput"};const{open:t,focus:i,value:n,maxLength:a,onFocus:o,onChange:r,onCancel:l}=e,d=(0,u.useIntl)(),p=n.length/a>=.8,m=(0,$.TQ)(n),g=p||m,h=(0,c.yK)((e=>({container:{display:t?"block":"none",maxHeight:100,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)"},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=d.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite...",description:"Placeholder inciting to attach a message for email message input in share menu."});return s()("div",{style:h.container},void 0,g&&s()(Vn,{value:n,maxLength:a,shouldShowLengthWarning:p,shouldShowLinkWarning:m}),s()(Pt.Z,{textarea:!0,focusInitial:!1,format:Pt.B.Transparent,placeholder:f,maxlength:a,focus:i,value:n,onFocus:o,onChange:r,inputStyle:h.input,onCancel:l}))}function Vn(e){window.__c={n:"EmailMessageWarning"};const{shouldShowLengthWarning:t,shouldShowLinkWarning:i,value:n,maxLength:a}=e,o=(0,c.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return s()("div",{style:o.container},void 0,s()("div",{style:o.warning},void 0,t&&s()(u.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",description:"Message showing how many characters out of the maximum the user has already typed.",values:{characters:n.length,maxCharacters:a}}),t&&i&&" · ",i&&s()(u.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning",description:"Warning message to the user that hyperlinks will be removed from their custom message."})))}const Un=function(e){window.__c={n:"ShareMenu"};const{store:t,contextualInviteStore:i,permissionItemArgs:n}=e,{sudoModeStore:o}=n,p=(0,l.O7)(),m=(0,l.Fy)(),g=(0,u.useIntl)(),h=(0,d.qz)(void 0,ji.ZP),f=(0,d.qz)(void 0,$i.Z),[v,y]=(0,r.useState)("noFocus"),[b,S]=(0,r.useState)("all"),[w,M]=(0,r.useState)("editor"),C=(0,d.VK)((()=>t.getType()),[t]),T=(0,d.VK)((()=>h.state.inviteTargets),[h]),I=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),x=(0,d.VK)((()=>new Set(null==I?void 0:I.getEmailDomains())),[I]),Z=(0,d.VK)((()=>{const{data:e}=G.default.state,t=e?q.CM(e):[],i={};return t.forEach((e=>{i[e.userId]=e})),i}),[]),P=e=>{const t=e.type;if("existingUser"===t){const t=Z[e.value.id];if(!t)return!0;return"none"===t.role&&!t.isTeamGuest&&t.isPageGuest}return"newUser"===t||"group"!==t&&void 0},F=e=>!zi.$s({contextualInviteUser:e,allowedDomains:x}),A=(0,d.VK)((()=>t.canEditMembership()),[t]),B=(0,d.VK)((()=>{const e=T.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),t=T.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return k.dA(p,[...e,...t])}),[p,T]),E=(0,Ki.Z)(t),D=(0,d.VK)((()=>{const e=E.isStoreInTeam&&!E.teamAllowsGuests,t=!E.isStoreInTeam&&!E.spaceAllowsGuests||E.isStoreInTeam&&!E.teamAllowsGuests&&!E.spaceAllowsGuests,i=T.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&i}),[T,E]),R=(0,qi.i)(t),L=(0,d.VK)((()=>("searching"===v||"message"===v)&&"slack"!==b&&0===T.length&&(0,xi.Rv)()),[v,T.length,b]),[O,N]=(0,r.useState)(""),V=O.length>1e3,U=T.length>0,W=("searching"===v||"message"===v)&&T.length>0,z=Hi({currentSpaceStore:I,blockStore:t}),K=(0,d.VK)((()=>Gi.Z.completeSlackAuthentications.state),[]),[H,j]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(I&&!H&&L){for(const e of K)Ui.loadContacts(p,{botId:e.id,spaceId:I.id,integrationId:Vi.nO}).catch((e=>{}));j(!0)}}),[L]);const $=(0,c.yK)((()=>({container:{position:"relative",height:"noFocus"!==v?540:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:540},headerContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:3,color:J.ZP.uiGray},header:{paddingLeft:14,paddingRight:14,paddingTop:8,paddingBottom:8},closeIconButton:{borderRadius:"100%"},integrationIcon:{marginLeft:4,marginRight:4},scroller:{flexGrow:1}})),[v]),Y=()=>{h.reset(),N(""),y("noFocus")};async function Q(){await De.qg({environment:p,intl:g,inviteOrigin:"page_share_modal",role:w,emailMessage:O,inviteTargetsStore:h,blockStore:t,sudoModeStore:o,onInviteClick:()=>{Y(),(e=>{i.setState({...i.state,invitedUsers:e.filter(P).map(zi.Si).filter(Ae.$K).filter(F)}),I&&zi.fr({environment:p,spaceStore:I,contextualInviteStore:i})})(T)},onInviteComplete:e=>De.Cv({success:e,inviteTargets:T})})}async function X(){void 0===f.state.focus.indexGlobal&&void 0===f.state.focus.indexLocal&&void 0===f.state.focus.section&&await Q()}let ee;return ee=D?R:V?s()(u.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters.",description:"Tooltip on the invite button describing the email message character limit has been reached."}):void 0,s()(Ji.Z,{capture:!0,onTab:function(e){e.preventDefault(),y("searching")}},void 0,s()("div",{style:$.container},void 0,o&&s()(Oi,{store:t,sudoModeStore:o}),s()("div",{style:$.header},void 0,s()("div",{style:$.headerContainer},void 0,s()(Bn,{store:t,source:b,focus:v,resetState:Y}),A&&s()(En,{showMoreActions:z,source:b,setSource:S,store:t,sudoModeStore:o})),s()(ie.Z,{disableTooltip:A,renderTooltip:()=>{if(!A)return s()(u.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people.",description:"Tooltip explaining why the invite button action is disabled."})},render:e=>r.createElement("div",a()({style:{display:"flex"}},e),s()(pn,{store:t,inviteTargetsStore:h,disabled:!A,origin:"share_menu_v2",focus:"searching"===v,onFocus:()=>y("searching"),onSubmit:X,placeholder:g.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder",defaultMessage:"Add people, groups, or emails...",description:"Placeholder for invite targets input in the share menu."}),right:U&&s()(en.Z,{disabled:!A,role:w,table:"block",type:"user_permission",blockType:C,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:$.permissionsRoleSelectButton,isMenuItem:m.isMobile,onChange:e=>M(e)})}),B?s()(Dn,{onClick:()=>Wi.Vu({environment:p,upgradeButtonName:"user_permission_item"})}):s()(Rn,{tooltip:ee,disabled:!A||D||V,onClick:async()=>{"noFocus"!==v?await Q():y("searching")}}))})),"noFocus"===v&&"all"===b&&s()(Li,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:e.permissionItemArgs}),("searching"===v||"message"===v||"slack"===b)&&s()(me.Z,{type:pe.Z.Y,style:$.scroller},void 0,s()(An,{inviteTargetsStore:h,store:t,menuListStore:f,shouldShowGroups:!0,shouldShowSlackOnly:"slack"===b,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})),L&&s()(rn,{onClickAuthenticated:()=>{S("slack"),y("searching"),h.setState({...h.state,tokenQuery:""})}}),s()(Nn,{open:W&&!L,focus:"message"===v,value:O,onFocus:()=>y("message"),onChange:e=>N(e.target.value),onCancel:async()=>{const e=await De.zd({environment:p,inviteTargetsStore:h});e&&(Yi.Z.setState({...Yi.Z.state,open:!e}),Y())},maxLength:1e3})))};var Wn=i(97238),zn=i(51456);var Kn=i(66957);function qn(e){let{inviteTargetsStore:t,mostPermissivePublicItem:i}=e;const{display:n,source:a}=(0,d.VK)((()=>{const{display:e}=Wn.ZP.state;if(e===Wn.wV.Invite){const{source:t}=Wn.ZP.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(n){case Wn.wV.MainShareMenu:case Wn.wV.Publish:return s()(Gn,{mostPermissivePublicItem:i});case Wn.wV.Invite:if("notion"===a)return s()($n,{inviteTargetsStore:t});if("slack"===a)return s()(Yn,{});throw(0,Ae.t1)(a);default:(0,Ae.t1)(n)}}const Hn=[Wn.XF.Share,Wn.XF.Publish];function Gn(e){let{mostPermissivePublicItem:t}=e;window.__c={n:"ShareMenuTabs"};const i=(0,l.O7)(),n=(0,d.VK)((()=>Wn.ZP.state.tab),[]),o=(0,r.useCallback)((e=>{const t=Hn[e];t!==n&&(!function(e,t){zn.track(e,"share_menu_tab_click",t)}(i,{tab:t}),t===Wn.XF.Share&&Wn.ZP.setState({display:Wn.wV.MainShareMenu,tab:Wn.XF.Share}),t===Wn.XF.Publish&&Wn.ZP.setState({display:Wn.wV.Publish,tab:Wn.XF.Publish}))}),[n,i]),p="icons"===(0,B.a)("share_menu_publish_tab"),m="none"!==t.permissionItem.role,g=[r.createElement(r.Fragment,null,p&&jn[Wn.XF.Share],s()(u.FormattedMessage,{defaultMessage:"Share",description:"Title of tab in share menu that allows a user to see page permissions and invite users to a page.",id:"shareMenu.shareTab.title"},"share")),r.createElement(r.Fragment,null,p&&jn[Wn.XF.Publish],s()(u.FormattedMessage,{defaultMessage:"Publish",description:"Title of tab in the share menu that allows a user to publish a page to the web.",id:"shareMenu.publishTab.title"},"publish"),m&&jn.publishedCheckIcon({opacity:n===Wn.XF.Publish?1:.5}))],h=function(){const e=(0,B.a)("share_menu_publish_tab"),t={tabStyle:{...(0,c.yK)((e=>({tabTitleStyle:{color:e.lightTextColor}})),[]).tabTitleStyle},selectedTabStyle:{fontWeight:Y.Z.fontWeight.medium},tabTitleStyle:{color:"inherit"}};switch(e){case"control":return{};case"tabs":return{...t,tabStyle:{...t.tabStyle},style:{marginBottom:8}};case"minimal":case"icons":return{...t,style:{boxShadow:"none"},tabBorderStyle:{borderBottom:"none"}};default:(0,Ae.t1)(e)}}();return r.createElement(Kn.Z,a()({},h,{tabs:g,selectedIndex:Hn.indexOf(n),onChange:o}))}const jn={[Wn.XF.Share]:Ze.Z.iOSShare({height:17,width:17,marginRight:4}),[Wn.XF.Publish]:Ze.Z.globe3({height:15,width:15,marginRight:4}),publishedCheckIcon:e=>{let{opacity:t}=e;return Ze.Z.circleCheckFilled({color:J.ZP.blue,width:14,height:14,marginLeft:4.5,opacity:t})}};function $n(e){let{inviteTargetsStore:t}=e;window.__c={n:"InviteFromNotionHeader"};const i=(0,B.a)("share_menu_publish_tab"),n=(0,c.yK)((()=>({container:{display:"flex",margin:"0 12px",height:"tabs"===i?48:40}})),[i]),a=(0,r.useCallback)((()=>{t.reset(),Wn.ZP.setState({display:Wn.wV.MainShareMenu,tab:Wn.XF.Share})}),[t]);return s()("div",{style:n.container},void 0,s()(On,{onClick:a}))}function Yn(){window.__c={n:"InviteFromSlackHeader"};const e=(0,u.useIntl)(),t=(0,B.a)("share_menu_publish_tab"),i=(0,c.yK)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:"tabs"===t?48:40,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:Y.Z.fontWeight.semibold}})),[t]),n=(0,r.useCallback)((()=>{Wn.ZP.setState({tab:Wn.XF.Share,display:Wn.wV.Invite,source:Wn.T5.Notion,focus:Wn.Sw.Search})}),[]),a=r.createElement(r.Fragment,null,s()(Qi.Z,{type:"image_url",imageURL:ge.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:{marginLeft:4,marginRight:4}}),s()(u.FormattedMessage,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label",description:"Part of a label for a button that, when clicked, allows user to connect to Slack integration"}));return s()("div",{style:i.container},void 0,s()(U.Z,{style:i.titleLabel},void 0,s()(u.FormattedMessage,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",description:"Title of popup",values:{integrationNameWithLogo:a}})),s()(Xi.Z,{ariaLabel:e.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close slack integration and go back to the main invite flow.",description:"Accessibility label for icon button to go back to the main invite flow for the share menu."}),icon:Ze.Z.closeSmall,style:{borderRadius:"100%"},onClick:n}))}function Qn(e){window.__c={n:"PublishToWeb"};const{store:t,mostPermissivePublicItem:i,permissionItemArgs:n}=e,{permissionItem:a,from:o}=i,{sudoModeStore:p,location:m}=n,g=(0,l.O7)(),h=(0,d.VK)((()=>t.canAdmin()),[t]),{isPublicAccessDisabled:f}=kt({store:t}),v=!h||f,y=(0,c.yK)((e=>({container:{display:"flex",width:"100%",justifyContent:"center",alignItems:"center",flexDirection:"column",padding:32,textAlign:"center",cursor:v?"not-allowed":""},icon:{height:30,width:30,marginBottom:10,fill:e.mediumIconColor},title:{fontWeight:Y.Z.fontWeight.semibold,fontSize:14,marginBottom:6},caption:{marginLeft:26,marginRight:26,marginBottom:20},button:{display:"flex",width:"100%",padding:16,cursor:v?"not-allowed":"pointer"}})),[v]),S=o.table===b.iU?o.blockId:o.teamId,w=(0,r.useCallback)((()=>{De.iK({oldPermissionItem:a,newPermissionItem:{...a,role:"reader"},wasInherited:S!==t.id,environment:g,store:t,sudoModeStore:p,location:m})}),[g,S,m,a,t,p]);return s()("div",{style:y.container},void 0,Ze.Z.globe3(y.icon),s()("div",{style:y.title},void 0,s()(u.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.title",description:"Title for publish to web section in the share menu."})),s()(U.Z,{isMultiline:!0,isSecondaryColor:!0,style:y.caption},void 0,s()(Xn,{store:t})),s()(Q.Z,{style:y.button,disabled:v,onClick:w},void 0,s()(u.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.button",description:"Button for publish to web section in the share menu. Clicking this button will publish the page to the web. It is disabled if the user does not have full access to the page."})))}function Xn(e){let{store:t}=e;window.__c={n:"PublishToWebMessage"};const{isPublicAccessDisabled:i,disabledBy:n}=kt({store:t}),a=(0,d.VK)((()=>t.canAdmin()),[t]);return s()(u.FormattedMessage,i?"team"===n?{defaultMessage:"Publishing to web is disabled for this page via teamspace settings.",id:"publishTab.publishToWeb.disabledByTeamspace.caption",description:"Caption for publish to web section in the share menu when public sharing is disabled for the page via teamspace security settings."}:{defaultMessage:"Publishing to web is disabled for this page via workspace settings.",id:"publishTab.publishToWeb.disabledByWorkspace.caption",description:"Caption for publish to web section in the share menu when public sharing is disabled for the page via workspace security settings."}:a?{defaultMessage:"Publish a static website of this page. You can allow others to view, duplicate, and remix.",id:"publishTab.publishToWeb.hasFullAccess.caption",description:"Caption for publish to web section  in the share menu when the user has full access to the page."}:{defaultMessage:"You must have full access to this page to publish to web.",id:"publishTab.publishToWeb.noFullAccess.caption",description:"Caption for publish to web section  in the share menu when the user does not have full access to the page."})}var Jn=i(5978);function ea(e){window.__c={n:"PublishToWebSettings"};const{store:t,mostPermissivePublicItem:i,permissionItemArgs:n}=e,{permissionItem:o,from:p}=i,{sudoModeStore:m,location:g,onUpgradeButtonClick:h}=n,f=(0,l.O7)(),v=(0,B.a)("share_menu_publish_tab"),y=(0,c.yK)((e=>({title:{color:e.blueColor,fontWeight:Y.Z.fontWeight.medium,fontSize:14,display:"flex",alignItems:"center",margin:"0px 16px 10px",paddingTop:"tabs"===v?4:0},icon:{height:16,width:16,marginRight:6},linkSharingOptions:{margin:"10px 2px"},learnAboutDomainsCTA:{fontSize:14,margin:"8px 8px",padding:0,backgroundColor:void 0,boxShadow:void 0,textAlign:"left",alignItems:"flex-start"},buttonGroup:{margin:"10px 14px 16px",display:"flex",gap:10},button:{flexGrow:1,height:34},disabledButton:{opacity:.7,cursor:"not-allowed"}})),[v]),S=(0,d.VK)((()=>!t.canAdmin()),[t]),w=p.table===b.iU?p.blockId:p.teamId,M=(0,r.useCallback)((e=>{De.iK({oldPermissionItem:o,newPermissionItem:{...o,...e},wasInherited:w!==t.id,environment:f,store:t,sudoModeStore:m,location:g})}),[o,w,t,f,m,g]),C=(0,r.useCallback)((()=>{M({role:"none"})}),[M]),k=(0,d.VK)((()=>(0,Le.ZP)({store:t,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=_t.Z.getPublicSpaceData(f,t.getSpaceId()))||void 0===e?void 0:e.domain}})),[t,f]),T=(0,r.useCallback)((()=>{!function(e){zn.track(e,"view_public_site_click")}(f),Jn.navigate({url:k,environment:f,openInNew:"tab"})}),[f,k]);return s()("div",{},void 0,s()("div",{style:y.title},void 0,Ze.Z.blueCircleDot(y.icon),s()(u.FormattedMessage,{defaultMessage:"This page is live on the web",id:"publishTab.settings.liveOnWeb.title",description:"Button for publish to web section in the share menu. Clicking this button will publish the page to the web. It is disabled if the user does not have full access to the page."})),s()(Ht,{currentBlockStore:t}),s()(It,{style:y.learnAboutDomainsCTA,labelStyle:{isSmall:!1}}),s()("div",{style:y.linkSharingOptions},void 0,s()(Kt,{currentBlockStore:t,permissionItem:o,onChange:M,onUpgradeButtonClick:h})),s()("div",{style:y.buttonGroup},void 0,s()(ie.Z,{disableTooltip:!S,renderTooltip:()=>s()(u.FormattedMessage,{defaultMessage:"You must have full access to this page to unpublish it",id:"publishTab.settings.liveOnWeb.unpublishTooltip",description:"Tooltip for the unpublish button in the share menu which states a user must have full access to the page to unpublish it."}),render:e=>r.createElement(lt.Z,a()({onClick:C,disabled:S,style:S?{...y.button,...y.disabledButton}:y.button},e),s()(u.FormattedMessage,{defaultMessage:"Unpublish",id:"publishTab.settings.liveOnWeb.unpublish",description:"Button for publish settings in the share menu. Clicking this button will make it so the page is no longer public."}))}),s()(Q.Z,{onClick:T,style:y.button},void 0,s()(u.FormattedMessage,{defaultMessage:"View site",id:"publishTab.settings.liveOnWeb.viewSite",description:"Button for publish settings in the share menu. Clicking this button directs the user to the published page."}))))}function ta(e){window.__c={n:"ShareMenuPublishTab"};const{store:t,mostPermissivePublicItem:i,permissionItemArgs:n}=e,{permissionItem:a}=i,o="none"!==a.role;return s()(o?ea:Qn,{store:t,mostPermissivePublicItem:i,permissionItemArgs:n})}function ia(e){window.__c={n:"UpgradeButton"};const{onClick:t}=e;return s()(ie.Z,{disableTooltip:!1,renderTooltip:()=>s()(tn.e,{}),render:e=>r.createElement(Q.Z,a()({isLarge:!0,style:{marginLeft:8},onClick:t},e),s()(u.FormattedMessage,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade",description:"Invite button in the share menu."}))})}function na(e){window.__c={n:"InviteButton"};const{tooltip:t,disabled:i,onClick:n}=e;return s()(ie.Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>r.createElement(Q.Z,a()({isLarge:!0,style:{marginLeft:8},disabled:i,onClick:n},e),s()(u.FormattedMessage,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite",description:"Invite button in the share menu."}))})}function aa(e){window.__c={n:"EmailMessageInput"};const{open:t,focus:i,value:n,maxLength:a,onFocus:o,onChange:r,onCancel:l}=e,d=(0,u.useIntl)(),p=n.length/a>=.8,m=(0,$.TQ)(n),g=p||m,h=(0,c.yK)((e=>({container:{maxHeight:t?100:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=d.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite...",description:"Placeholder inciting to attach a message for email message input in share menu."});return s()("div",{style:h.container},void 0,g&&s()(oa,{value:n,maxLength:a,shouldShowLengthWarning:p,shouldShowLinkWarning:m}),s()(Pt.Z,{textarea:!0,focusInitial:!1,format:Pt.B.Transparent,placeholder:f,maxlength:a,focus:i,value:n,onFocus:o,onChange:r,inputStyle:h.input,onCancel:l}))}function oa(e){window.__c={n:"EmailMessageWarning"};const{shouldShowLengthWarning:t,shouldShowLinkWarning:i,value:n,maxLength:a}=e,o=(0,c.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return s()("div",{style:o.container},void 0,s()("div",{style:o.warning},void 0,t&&s()(u.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",description:"Message showing how many characters out of the maximum the user has already typed.",values:{characters:n.length,maxCharacters:a}}),t&&i&&" · ",i&&s()(u.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning",description:"Warning message to the user that hyperlinks will be removed from their custom message."})))}const sa=function(e){window.__c={n:"ShareMenuInviteTab"};const{store:t,contextualInviteStore:i,permissionItemArgs:n,inviteTargetsStore:o}=e,{sudoModeStore:p}=n,m=(0,l.O7)(),g=(0,l.Fy)(),h=(0,u.useIntl)(),f=(0,d.qz)(void 0,$i.Z),{display:v,source:y,focus:b}=(0,d.VK)((()=>{const{display:e}=Wn.ZP.state;if(e===Wn.wV.Invite){const{source:e,focus:t}=Wn.ZP.state;return{display:Wn.wV.Invite,source:e,focus:t}}return{display:e,source:void 0,focus:void 0}}),[]),[S,w]=(0,r.useState)("editor"),M=(0,d.VK)((()=>t.getType()),[t]),C=(0,d.VK)((()=>o.state.inviteTargets),[o]),T=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),I=(0,d.VK)((()=>new Set(null==T?void 0:T.getEmailDomains())),[T]),x=(0,d.VK)((()=>{const{data:e}=G.default.state,t=e?q.CM(e):[],i={};return t.forEach((e=>{i[e.userId]=e})),i}),[]),Z=e=>{const t=e.type;if("existingUser"===t){const t=x[e.value.id];if(!t)return!0;return"none"===t.role&&!t.isTeamGuest&&t.isPageGuest}return"newUser"===t||"group"!==t&&void 0},P=e=>!zi.$s({contextualInviteUser:e,allowedDomains:I}),F=(0,d.VK)((()=>t.canEditMembership()),[t]),A=(0,d.VK)((()=>{const e=C.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),t=C.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return k.dA(m,[...e,...t])}),[m,C]),B=(0,Ki.Z)(t),E=(0,d.VK)((()=>{const e=B.isStoreInTeam&&!B.teamAllowsGuests,t=!B.isStoreInTeam&&!B.spaceAllowsGuests||B.isStoreInTeam&&!B.teamAllowsGuests&&!B.spaceAllowsGuests,i=C.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&i}),[C,B]),D=(0,qi.i)(t),R=(0,d.VK)((()=>v===Wn.wV.Invite&&y===Wn.T5.Notion&&0===C.length&&(0,xi.Rv)()),[v,C.length,y]),[L,O]=(0,r.useState)(""),N=L.length>1e3,V=C.length>0,U=v===Wn.wV.Invite&&C.length>0,W=(0,d.VK)((()=>Gi.Z.completeSlackAuthentications.state),[]),[z,K]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(T&&!z&&R){for(const e of W)Ui.loadContacts(m,{botId:e.id,spaceId:T.id,integrationId:Vi.nO}).catch((e=>{}));K(!0)}}),[R]);const H=(0,c.yK)((()=>({container:{position:"relative",height:v!==Wn.wV.MainShareMenu?540:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:540},permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:3,color:J.ZP.uiGray},searchBar:{paddingLeft:14,paddingRight:14,paddingBottom:8},closeIconButton:{borderRadius:"100%"},integrationIcon:{marginLeft:4,marginRight:4},scroller:{flexGrow:1}})),[v]),j=()=>{o.reset(),O(""),Wn.ZP.setState({tab:Wn.XF.Share,display:Wn.wV.MainShareMenu})};async function $(){await De.qg({environment:m,intl:h,inviteOrigin:"page_share_modal",role:S,emailMessage:L,inviteTargetsStore:o,blockStore:t,sudoModeStore:p,onInviteClick:()=>{j(),(e=>{i.setState({...i.state,invitedUsers:e.filter(Z).map(zi.Si).filter(Ae.$K).filter(P)}),T&&zi.fr({environment:m,spaceStore:T,contextualInviteStore:i})})(C)},onInviteComplete:e=>De.Cv({success:e,inviteTargets:C})})}async function Y(){void 0===f.state.focus.indexGlobal&&void 0===f.state.focus.indexLocal&&void 0===f.state.focus.section&&await $()}let Q;return Q=E?D:N?s()(u.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters.",description:"Tooltip on the invite button describing the email message character limit has been reached."}):void 0,s()(Ji.Z,{capture:!0,onTab:function(e){e.preventDefault(),Wn.ZP.setState({tab:Wn.XF.Share,display:Wn.wV.Invite,focus:Wn.Sw.Search,source:y||Wn.T5.Notion})}},void 0,s()("div",{style:H.container},void 0,s()("div",{style:H.searchBar},void 0,s()(ie.Z,{disableTooltip:F,renderTooltip:()=>{if(!F)return s()(u.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people.",description:"Tooltip explaining why the invite button action is disabled."})},render:e=>r.createElement("div",a()({style:{display:"flex"}},e),s()(pn,{store:t,inviteTargetsStore:o,disabled:!F,origin:"share_menu_v2",focus:b===Wn.Sw.Search,onFocus:()=>Wn.ZP.setState({tab:Wn.XF.Share,display:Wn.wV.Invite,focus:Wn.Sw.Search,source:y||Wn.T5.Notion}),onSubmit:Y,placeholder:h.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder",defaultMessage:"Add people, groups, or emails...",description:"Placeholder for invite targets input in the share menu."}),right:V&&s()(en.Z,{disabled:!F,role:S,table:"block",type:"user_permission",blockType:M,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:H.permissionsRoleSelectButton,isMenuItem:g.isMobile,onChange:e=>w(e)})}),A?s()(ia,{onClick:()=>Wi.Vu({environment:m,upgradeButtonName:"user_permission_item"})}):s()(na,{tooltip:Q,disabled:!F||E||N,onClick:async()=>{v!==Wn.wV.MainShareMenu?await $():Wn.ZP.setState({tab:Wn.XF.Share,display:Wn.wV.Invite,focus:Wn.Sw.Search,source:Wn.T5.Notion})}}))})),v===Wn.wV.MainShareMenu&&s()(Li,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:e.permissionItemArgs}),v===Wn.wV.Invite&&s()(me.Z,{type:pe.Z.Y,style:H.scroller},void 0,s()(An,{inviteTargetsStore:o,store:t,menuListStore:f,shouldShowGroups:!0,shouldShowSlackOnly:y===Wn.T5.Slack,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})),R&&s()(rn,{onClickAuthenticated:()=>{Wn.ZP.setState({tab:Wn.XF.Share,display:Wn.wV.Invite,focus:Wn.Sw.Search,source:Wn.T5.Slack}),o.setState({...o.state,tokenQuery:""})}}),s()(aa,{open:U&&!R,focus:b===Wn.Sw.Message,value:L,onFocus:()=>{y&&v===Wn.wV.Invite&&Wn.ZP.setState({focus:Wn.Sw.Message,tab:Wn.XF.Share,display:v,source:y})},onChange:e=>O(e.target.value),onCancel:async()=>{const e=await De.zd({environment:m,inviteTargetsStore:o});e&&(Yi.Z.setState({...Yi.Z.state,open:!e}),j())},maxLength:1e3})))};function ra(e){const t=(0,d.VK)((()=>Wn.ZP.state.tab),[]);switch(t){case Wn.XF.Share:return r.createElement(sa,e);case Wn.XF.Publish:return s()(ta,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,Ae.t1)(t)}}const la=function(e){window.__c={n:"ShareMenuV2"};const{store:t,permissionItemArgs:i}=e,{sudoModeStore:n}=i,o=(0,d.qz)(void 0,ji.ZP);return s()("div",{},void 0,n&&s()(Oi,{store:t,sudoModeStore:n}),s()(qn,{inviteTargetsStore:o,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),r.createElement(ra,a()({inviteTargetsStore:o},e)))};const da=function(e){return"control"!==(0,B.a)("share_menu_publish_tab")?r.createElement(la,e):r.createElement(Un,e)};function ca(){window.__c={n:"OfflineMessage"};const e=(0,l.Fy)(),t=(0,c.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",height:160}})),[]);return s()("div",{style:t.container},void 0,s()(U.Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0},void 0,s()(u.FormattedMessage,{defaultMessage:"Please go online to publish & share.",id:"blockPermissionsSettings.offline.prompt"})))}const ua=function(e){const{store:t,sudoModeStore:i,onUpgradeButtonClick:n,location:o}=e,h=(0,l.O7)(),f=(0,l.Fy)(),v=(0,d.qz)(void 0,R.Z),{permissionsInviteStore:y,contextualInviteStore:b}=(0,d.VK)((()=>v.state),[v]),S=(0,d.VK)((()=>_.default.state.currentSpaceStore),[]),w=(0,d.VK)((()=>A({environment:h,spaceStore:S,store:t})),[h,S,t]);"control"!==(0,B.a)("link_sharing_pill")&&(w.showSpacePermission="none"!==w.mostPermissiveSpaceItem.permissionItem.role);const M=(0,d.VK)((()=>b.state.inviteStage),[b]),C=(0,c.yK)((()=>({title:{fontSize:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto"}})),[]),k=(0,r.useMemo)((()=>({onUpgradeButtonClick:n,sudoModeStore:i,location:o})),[n,i,o]);if(!S)return null;if(!f.isMobile&&(M===D.TG.share_workspace||M===D.TG.request_workspace))return s()(z.Z,{blockStore:t,spaceStore:S,contextualInviteStore:b});const T=f.isMobile?{menuType:m.og.Modal,title:s()(U.Z,{isMobile:f.isMobile,style:C.title},void 0,s()(u.FormattedMessage,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})),additionalTopbarContent:s()(ae,{store:t,onUpgradeButtonClick:e.onUpgradeButtonClick,permissionsInviteStore:y,contextualInviteStore:b}),left:s()(W.Z,{href:(0,g.UY)("guides.sharing"),analyticsFrom:"sharing"}),footer:s()(si,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:w,permissionItemArgs:k}),topbarStyle:C.topbarStyle,right:s()(V.DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:m.og.Popup,maxHeight:"90vh"};return r.createElement(r.Fragment,null,r.createElement(N.Z,a()({},T,{className:p.B8p}),s()(L.Z,{capture:!0,allowEsc:!0},void 0,s()(O.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!1,focusOffscreenInput:!1,render:()=>E.Z.state.online?f.isMobile?s()(Ni,{store:t,permissionItemArgs:k,calculatedPermissions:w,buttonPopupStore:e.buttonPopupStore}):s()(da,{store:t,permissionItemArgs:k,calculatedPermissions:w,buttonPopupStore:e.buttonPopupStore,contextualInviteStore:b}):s()(ca,{})}))))}},93638:(e,t,i)=>{i.r(t),i.d(t,{default:()=>A});var n=i(77094),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(83355),d=i(42875),c=i(94044),u=i(5366),p=i(4708),m=i(79817),g=i(60709),h=i(75472),f=i(65598),v=i(38755),y=i(23537),b=i(25464),S=i(27832),w=i(85834),M=i(52878),C=i(74194),k=i(78140),T=i(89728),_=i(44532),I=i(57806),x=i(32357),Z=i(20346);class P extends l.Z{constructor(){super(...arguments),this.storeTypes={universalInviteStore:M.Z},this.renderEmailInput=this.createComputedStore((()=>"milestone_2"===this.props.mode))}renderComponent(){const{universalInviteStore:e}=this.stores,{permissionsInviteStore:t,contextualInviteStore:i}=e.state,n=e.stage,{spaceStore:o}=this.props;if(this.environment.device.isMobile||n===w.TG.closed)return null;if(!(0,f.Mm)(this.props.store)&&(n===w.TG.share_workspace||n===w.TG.request_workspace))return a()(x.Z,{blockStore:this.props.store,spaceStore:o,contextualInviteStore:i});if(n===w.TG.share_page){const n={...this.props,renderInShareMenu:!0,spaceStore:o,permissionsInviteStore:t,contextualInviteStore:i,onInviteClick:()=>{(0,y.$)(this.environment)?i.setState({...i.state,inviteStage:w.TG.closed}):m.fr({environment:this.environment,spaceStore:o,contextualInviteStore:i})},onInviteComplete:e=>{m.x5({success:e,intl:this.props.intl,contextualInviteStore:i})},onCancel:async()=>{await(0,h.Aw)({environment:this.environment,permissionsInviteStoreState:t.state,from:"share_menu"})||e.reset()}};return this.renderEmailInput.state?r.createElement(F,n):r.createElement(I.default,n)}}}P.displayName="UniversalMemberInvite";class F extends I.PermissionsInviteBase{constructor(){super(...arguments),this.inviteTargetLength=this.createComputedStore((()=>this.stores.permissionsInviteStore.state.inviteTargets.length)),this.blockTitle=this.createComputedStore((()=>{if((0,f.Mm)(this.props.store))return"";const e=this.props.store;if(!e.isDefined())return"";const t=e.getModel().getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,d.r)(),intl:this.props.intl});return t||e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,d.r)(),intl:this.props.intl})})),this.handleInviteInputSubmit=async()=>{const{permissionsInviteStore:e}=this.stores;"invitee"===e.state.inputFocus?e.setState({...e.state,inputFocus:"email-content"}):await super.handleInviteInputSubmit()},this.resetFocusOnClickEmpty=e=>{const{permissionsInviteStore:t}=this.stores;e.currentTarget===e.target&&t.setState({...t.state,inputFocus:"none"})}}renderComponent(){return this.renderInShareMenu.state?this.renderUniversalInviteInner():super.renderComponent()}renderUniversalInviteInner(){const{permissionsInviteStore:e}=this.stores;return a()("div",{style:this.getContainerStyle(),onClick:this.resetFocusOnClickEmpty},void 0,a()(_.ZP,{popupType:_.kQ.Popup,alignmentToOrigin:b.v.Start,placementToOrigin:b.u.Bottom,open:"invitee"===e.state.inputFocus,originGap:10,disableMouseCapture:!0,forceRemeasureStore:this.inviteTargetLength,origin:super.renderHeader(),onDismiss:()=>{e.setState({...e.state,inputFocus:"email-content"})},render:()=>{const e=super.renderSearchRequest(),t={menuType:g.og.Popup,disableScroller:!1};return a()("div",{},void 0,r.createElement(k.Z,t,e))},style:{width:360}}),this.renderEmailMessageInput(),this.renderSinglePlayerOptions(),this.renderActions())}renderEmailMessageInput(){const{permissionsInviteStore:e}=this.stores,t=this.getEmailMessage(),{inputFocus:i,emailMessage:n}=e.state,o=n.length/c.vr>=.8,s=(0,c.TQ)(n),r=o||s,l=(0,p._6)(this.environment),d="email-content"===i;return a()(C.Z,{textarea:!0,value:n,focus:d,focusInitial:!1,maxlength:c.vr,onFocus:()=>{e.setState({...e.state,inputFocus:"email-content"})},style:{background:d?"none":this.theme.inputBackground,alignItems:"flex-start",paddingLeft:12,paddingRight:12,paddingTop:8,paddingBottom:r?34:12},inputStyle:{minHeight:l?80:100},placeholder:t,onChange:t=>{e.setState({...e.state,emailMessage:t.target.value})},right:r&&this.renderMessageWarning({shouldShowLengthWarning:o,shouldShowLinkWarning:s}),isRightLastElementOfInput:!0,onSubmit:async()=>{await super.handleInviteClick()}})}renderSinglePlayerOptions(){if((0,f.Mm)(this.props.store))return null;const{contextualInviteStore:e,permissionsInviteStore:t}=this.stores,{currentSpaceStore:i}=S.default.state;if(!i)return null;if(!(0,y.$)(this.environment))return null;const{inviteTargets:n}=t.state;return!t.state.isInviteTargetsEmpty&&n.some((e=>h.OA(e)))?a()(x.Z,{blockStore:this.props.store,spaceStore:i,contextualInviteStore:e}):null}renderActions(){return a()("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center",width:"100%"},onClick:this.resetFocusOnClickEmpty},void 0,a()("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"flex-end",gap:8}},void 0,this.renderDesktopInputRightInnerButton({isLarge:!1}),a()(T.Z,{style:{minWidth:c.UF,justifyContent:"center"},isLarge:!1,isLightGray:!0,onClick:()=>{var e,t;null===(e=(t=this.props).onCancel)||void 0===e||e.call(t)}},void 0,a()(u.FormattedMessage,{defaultMessage:"Cancel",id:"ContextualInvite.permissions_invites.button.cancel",description:"Button to cancel"}))),a()(Z.Z,{style:{paddingLeft:0,paddingRight:0},disableHover:!0}))}renderMessageWarning(e){const{permissionsInviteStore:t}=this.stores,{shouldShowLengthWarning:i,shouldShowLinkWarning:n}=e;return a()("span",{style:{fontSize:12,color:this.theme.lightTextColor,position:"absolute",bottom:8,left:12}},void 0,i&&a()(u.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",description:"Message showing how many characters out of the maximum the user has already typed.",values:{characters:t.state.emailMessage.length,maxCharacters:c.vr}}),i&&n&&" · ",n&&a()(u.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning",description:"Warning message to the user that hyperlinks will be removed from their custom message."}))}getEmailMessage(){const{currentUserStore:e,currentSpaceStore:t}=S.default.state,{permissionsInviteStore:i}=this.stores,{intl:n}=this.props,{inviteTargets:a}=i.state,o=!i.state.isInviteTargetsEmpty&&s().every(a,h.OA);if(!t)return n.formatMessage(c.VX.default);const r=null==e?void 0:e.getDisplayName(n),l=(0,v.rn)(this.environment,t);if(!r||!l)return n.formatMessage(c.VX.default);return(0,c.jm)({includeOptional:!1,isGuest:o,emailProps:{userName:r,pageName:this.blockTitle.state,spaceName:l},intl:this.props.intl})}getContainerStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:10,paddingBottom:10,paddingLeft:e.getSafePaddingLeftCSS(14),paddingRight:e.getSafePaddingRightCSS(14),flexDirection:"column",gap:10}}}const A=(0,u.injectIntl)(P)},40732:(e,t,i)=>{i.r(t),i.d(t,{isLimitReachedStage:()=>Q,isConfirmPurchaseStage:()=>X,isCancellationStage:()=>J,default:()=>te});var n=i(77094),a=i.n(n),o=i(67294),s=i(13991),r=i(480),l=i(81954),d=i(24405),c=i(41892),u=i(8848),p=i(3779),m=i(61784),g=i(5366),h=i(32056),f=i(3791),v=i(47425),y=i(97880),b=i(82990),S=i(47307),w=i(21325),M=i(99498),C=i(89859),k=i(65544),T=i(93678),_=i(52533),I=i(33665),x=i(38755),Z=i(80554),P=i(62216),F=i(31925),A=i(21115),B=i(8323),E=i(27832),D=i(78291),R=i(8711),L=i(42922),O=i(11066),N=i(92660),V=i(42402);function U(e){const{addOnFeature:t,canPurchaseAddOn:i,isSubscribed:n}=e,s=Y(),l=(0,r.O7)();return i&&n?a()(W,{addOnFeature:t,canPurchaseAddOn:i}):o.createElement(o.Fragment,null,p.Z.info(s.icon),a()(z,{addOnFeature:t,canPurchaseAddOn:i}),a()(K,{addOnFeature:t,canPurchaseAddOn:i}),a()(L.Z,{isLarge:!0,style:s.button,onClick:async()=>i?n?M.Cl(void 0):async function(e,t){await T.y(e,{from:"plans_page",for:t,addOnFeature:"ai"}),M.v5()}(l,"free"):M.v5()},void 0,a()(g.FormattedMessage,i?{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase",description:"Confirmation message shown in upgrade modal to let an admin continue to purchase the add-on subscription."}:{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it",description:"Confirmation message shown in the dismiss button we tell a user they have to contact an admin to continue using the add-on features."})))}function W(e){var t,i,n;const{addOnFeature:s,canPurchaseAddOn:d}=e,u=(0,r.O7)(),p=Y(),m=(0,l.VK)((()=>(0,B.zt)()),[]),h=(0,l.VK)((()=>D.default.state.data),[]),f=(0,l.VK)((()=>R.Z.state.open?R.Z.state.coupon:null),[]),b=(0,l.VK)((()=>E.default.state.currentSpaceStore),[]);if(!b)return null;const w=(0,_.S$)({environment:u})&&(0,v.QR)(m);if(u.device.isMobileNative&&!w)return null;let M;if(!h||"unsubscribed_admin"!==h.type&&"subscribed_admin"!==h.type||(M=h),M&&"revenueCat"===(null===(t=M.customerData)||void 0===t?void 0:t.activeSubscriptionPlatform)){const e=a()(g.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first.",description:"Shown as an error popup if a user is trying to upgrade to an add on but is on an ios plan."});return S.showErrorMessage(e),null}const C=a()(g.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator.",description:"Shown as an error popup if a user is trying to upgrade to an add on but is not an admin."});if(!(0,A.GJ)(h))return S.showErrorMessage(C),null;const k=null===(i=M)||void 0===i||null===(n=i.customerData)||void 0===n?void 0:n.stripe;if(!k)return null;const T=k.isSubscribed?k.interval:"month",I=f?function(e){switch(e){case"ai_thirty_percent":return a()(g.FormattedMessage,{id:"addOnUpgradeModal.coupon.thirtyPercent.label",defaultMessage:"30% off discount",description:"Discount message letting the customer they are getting a 30 percent off the normal Notion AI subscription"});case"ai_forty_percent":return a()(g.FormattedMessage,{id:"addOnUpgradeModal.coupon.fortyPercent.label",defaultMessage:"40% off discount",description:"Discount message letting the customer they are getting a 40 percent off the normal Notion AI subscription"});case"ai_fifty_percent":return a()(g.FormattedMessage,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount",description:"Discount message letting the customer they are getting a 50 percent off the normal Notion AI subscription"});case"ai_sixty_percent":return a()(g.FormattedMessage,{id:"addOnUpgradeModal.coupon.sixtyPercent.label",defaultMessage:"60% off discount",description:"Discount message letting the customer they are getting a 60 percent off the normal Notion AI subscription"});default:(0,y.t1)(e)}}(f):"year"===T?(window.__c={n:"getYearlyDiscountMessage"},a()(g.FormattedMessage,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount",description:"Discount message letting the customer they are getting a 20 percent off the normal Notion AI subscription"})):null;return o.createElement(o.Fragment,null,a()("img",{src:c.Z.images.pricing.aiLogoPng,style:p.aiLogo}),a()(z,{addOnFeature:s,canPurchaseAddOn:d}),a()(q,{addOnFeature:s}),I?function(e){window.__c={n:"DiscountBadge"};const t=Y();return a()(O.Z,{style:{...t.sharedStyleForDiscountBadge},disabled:!0},void 0,a()("div",{style:{...t.innerStyleForDiscountBadge}},void 0,e))}(I):null,a()(H,{addOnFeature:s,interval:T,stripeData:k,spaceStore:b}))}function z(e){window.__c={n:"Title"};const{addOnFeature:t,canPurchaseAddOn:i}=e,n=Y();let o;switch(t){case"ai":o=a()(g.FormattedMessage,i?{id:"addOnUpgrade.title.admin",defaultMessage:"Get more Notion AI",description:"Shown when a customer has run out of Notion AI and needs to upgrade."}:{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion",description:"Shown when a customer has run out of Notion AI and needs to upgrade."});break;default:(0,y.t1)(t)}return a()("h3",{style:n.title},void 0,o)}function K(e){window.__c={n:"Description"};const{addOnFeature:t,canPurchaseAddOn:i}=e;let n;const o=Y();switch(t){case"ai":n=a()(g.FormattedMessage,i?{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace",description:"Shown when a customer has run out of Notion AI and needs to upgrade."}:{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use.",description:"Shown when a customer has run out of Notion AI and needs to upgrade."});break;default:(0,y.t1)(t)}return a()("p",{style:o.paragraph},void 0,a()("div",{style:o.text},void 0,n))}function q(e){window.__c={n:"ConfirmationDescription"};const{addOnFeature:t}=e;let i;const n=(0,r.O7)(),o=Y(),s=(0,l.VK)((()=>E.default.state.currentSpaceStore),[]);if(!s)return null;const d=(0,l.VK)((()=>(0,x.rn)(n,s)),[n,s]);switch(t){case"ai":i=a()(g.FormattedMessage,{id:"addOnUpgrade.confirmation.description.admins",defaultMessage:"Go unlimited with Notion AI for all members in {spaceName}.",description:"Shown when a customer has run out of Notion AI and needs to upgrade.",values:{spaceName:d}});break;default:(0,y.t1)(t)}return a()("p",{style:o.paragraph},void 0,a()("div",{style:o.text},void 0,i))}function H(e){const{addOnFeature:t,interval:i,stripeData:n,spaceStore:s}=e,d=Y(),c=(0,g.useIntl)(),u=(0,r.O7)(),p=(0,l.VK)((()=>(0,A.qX)()),[]),{tax:m,coupon:v}=(0,l.VK)((()=>({tax:R.Z.state.open?R.Z.state.tax:0,coupon:R.Z.state.open?R.Z.state.coupon:void 0})),[]),y=(0,F.VK)(c),b=(0,F.oX)(p,i,c),S=v?(0,F.TC)(v,p,i,c):y,T=(0,A.v3)({addOnFeature:t,billingInterval:i,quantity:p,getMonthlyPrice:"month"===i,additionalAmount:m+S.amount,alwaysShowCents:!0,intl:c}),_=(0,A.v3)({addOnFeature:t,billingInterval:"month",quantity:p,getMonthlyPrice:"month"===i,alwaysShowCents:!0,intl:c}),{addOnCostItem:x,addOnCostItemWithMembers:P}=(0,Z.OL)(t,p,i,c);return(0,o.useEffect)((()=>{!async function(){n&&n.address&&await k.nf({environment:u,priceForTaxCalculation:T.amount,address:n.address,customerId:n.customerId,vatId:n.vatId})}()}),[u,n,T]),o.createElement(o.Fragment,null,a()("p",{style:d.monthlyCostText},void 0,a()("h3",{style:d.title},void 0,a()(g.FormattedMessage,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on",description:"Shown in the confirmation modal before a user subscribes to an add-on."})),a()("div",{style:d.costSectionTitle},void 0,a()("div",{},void 0,x),a()("div",{style:d.rightAlign},void 0,_.formattedAmount)),a()("div",{style:d.costSection},void 0,P),a()(G,{coupon:v,interval:i,yearlyDiscount:b,couponDiscount:S}),a()("div",{style:d.costSection},void 0,a()(g.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:",description:"Shown in the confirmation modal to display tax cost for adding the add on subscription."}),a()("div",{style:d.rightAlign},void 0,(0,h.Dx)({amount:m,currency:"dollar",alwaysShowCents:!0,intl:c}))),a()("div",{style:d.totalCostSection},void 0,a()("h3",{style:d.title},void 0,a()(g.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total",description:"Shown in the confirmation modal before a user subscribes to an add-on."})),a()("div",{style:d.rightAlign},void 0,a()("h3",{style:d.title},void 0,T.formattedTotal))),a()("div",{style:d.perMonth},void 0,a()(g.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",description:"Shown in the confirmation modal to display tax cost for adding the add on subscription.",values:{interval:i}}))),a()(L.Z,{isLarge:!0,style:d.button,onClick:async()=>{const e=(0,f.aG)({addOnFeature:t,addOnTier:"base",addOnBillingInterval:i,addOnPricingModel:"standard",addOnPricingVariant:(0,f._h)(i),isCancellation:!1});await w.Mg({environment:u,spaceStore:s,from:"add_on_upgrade_modal",addOns:e}),v&&n.isSubscribed&&await C.A(u,{customerId:n.customerId,coupon:v,offerType:"add_on_upgrade_flow"}),M.v5()}},void 0,a()(g.FormattedMessage,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase",description:"Confirmation message shown in upgrade modal for an admin to purchase the add-on subscription."})),a()("p",{style:d.termsOfService},void 0,a()("div",{style:d.text},void 0,a()(g.FormattedMessage,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",description:"Shown as a warning in the confirmation modal before a user subscribes to an add-on so they understand how it affects their subscription.",values:{br:a()("br",{}),fairUsePolicies:e=>a()(V.Z,{href:(0,I.UY)("ai.fairUsePolicies")},void 0,e),terms:e=>a()(V.Z,{href:(0,I.UY)("ai.terms")},void 0,e)}}))))}function G(e){const{coupon:t,interval:i,yearlyDiscount:n,couponDiscount:s}=e,r=Y(),l="year"===i;return t||l?o.createElement(o.Fragment,null,l?o.createElement(o.Fragment,null,a()("div",{style:r.costSectionTitle},void 0,a()("div",{},void 0,a()(g.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.annual.twentyPercentDiscountMessage",defaultMessage:"<bold>Annual discount (20%)</bold>",description:"Shown in the confirmation modal before a user subscribes to an add-on.",values:{bold:e=>a()("b",{},void 0,e)}})),a()("div",{style:r.greenRightAlign},void 0,n.formattedAmount)),a()("div",{style:r.costSection},void 0,a()(g.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan",description:"Shown in the confirmation modal before a user subscribes to an add-on to describe how long their discount will be good for."}))):null,t?o.createElement(o.Fragment,null,a()("div",{style:r.costSectionTitle},void 0,a()("div",{},void 0,a()(g.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",description:"Shown in the confirmation modal before a user subscribes to an add-on.",values:{bold:e=>a()("b",{},void 0,e),percentage:(0,F.ov)(t)}})),a()("div",{style:r.greenRightAlign},void 0,s.formattedAmount)),a()("div",{style:r.costSection},void 0,a()(g.FormattedMessage,l?{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualMessage",defaultMessage:"for your annual term",description:"Shown in the confirmation modal before a user subscribes to an add-on to describe how long their discount will be good for."}:{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months",description:"Shown in the confirmation modal before a user subscribes to an add-on to describe how long their discount will be good for."}))):null):null}function j(e){const{addOnFeature:t,canPurchaseAddOn:i,data:n,isSubscribed:d}=e,c=Y(),p=(0,r.O7)(),h=(0,l.VK)((()=>E.default.state.currentSpaceStore),[]),v=(0,l.VK)((()=>P.yw()),[]);if(!i||!h)return null;const b=function(e,t){var i;return null===(i=e.addOns.find((e=>e.feature===t)))||void 0===i?void 0:i.billingInterval}(n,t);if(!b)return null;let S,C,k=!1;if("subscribed_admin"===n.type||"unsubscribed_admin"===n.type){var T;const e=null===(T=n.customerData)||void 0===T?void 0:T.stripe;S=null==e?void 0:e.periodEnd,k=Boolean((null==e?void 0:e.schedule)||(null==e?void 0:e.willCancelAt))}switch(t){case"ai":C=a()(g.FormattedMessage,v?{id:"addOnUpgradeModal.midterm.cancellation.title",defaultMessage:"Remove AI at the end of your billing period?",description:"Confirmation message shown when admin wants to cancel their Notion AI add-on subscription."}:{id:"addOnUpgradeModal.cancellation.title",defaultMessage:"Are you sure you want to remove Notion AI from your plan?",description:"Confirmation message shown when admin wants to cancel their Notion AI add-on subscription."});break;default:(0,y.t1)(t)}return o.createElement(o.Fragment,null,a()("h3",{style:c.cancellationTitle},void 0,C),a()("p",{style:c.paragraph},void 0,a()("div",{style:c.text},void 0,a()(g.FormattedMessage,v&&S?k?{id:"addOnUpgradeModal.midterm.cancellationWithPendingChanges.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. This change will cancel your previous pending changes. You can resubscribe anytime.",description:"Confirmation message shown when admin wants to cancel their Notion AI add-on subscription.",values:{periodEnd:(0,m.Yx)(S,"long",s.SP),bold:e=>a()("b",{},void 0,e)}}:{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",description:"Confirmation message shown when admin wants to cancel their Notion AI add-on subscription.",values:{periodEnd:(0,m.Yx)(S,"long",s.SP),bold:e=>a()("b",{},void 0,e)}}:d?{id:"addOnUpgradeModal.immediateCancellation.description",defaultMessage:"It will be removed immediately from your plan. You can re-add it at anytime.",description:"Confirmation message shown when admin wants to cancel their Notion AI add-on subscription."}:{id:"addOnUpgradeModal.cancellation.description",defaultMessage:"It will be removed at the end of your billing period. You can re-add it at anytime.",description:"Confirmation message shown when admin wants to cancel their Notion AI add-on subscription."}))),a()("div",{style:c.buttonWithTopPadding},void 0,a()(O.Z,{style:c.redButton,hoveredStyle:{background:u.ZP.redWithAlpha(.8)},onClick:async()=>{const e=(0,f.aG)({addOnFeature:t,addOnTier:"base",addOnBillingInterval:b,addOnPricingModel:"standard",addOnPricingVariant:(0,f._h)(b),isCancellation:!0});await w.Mg({environment:p,spaceStore:h,from:"add_on_upgrade_modal",addOns:e}),M.v5()}},void 0,a()(g.FormattedMessage,v?{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal",description:"Confirmation message shown in upgrade modal for an admin to remove the add-on subscription."}:{id:"addOnUpgradeModal.yesButton.label",defaultMessage:"Remove from plan",description:"Confirmation message shown in upgrade modal for an admin to remove the add-on subscription."}))),a()("div",{style:c.buttonWithTopPadding},void 0,a()(O.Z,{style:c.noButton,onClick:()=>M.v5()},void 0,a()(g.FormattedMessage,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel",description:"Confirmation message shown in upgrade modal for an admin to exit out of the modal that allows them to remove the add-on subscription."}))))}function $(){const e=Y(),t=(0,r.O7)();let i=a()(g.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited.",description:"Message shown in mobile web or android to let the user know how to get more Notion AI"});return(t.device.isIOS||t.device.isIpad)&&(i=a()(g.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"You are out of free AI.",description:"Message shown in mobile web or android to let the user know how to get more Notion AI"})),o.createElement(o.Fragment,null,p.Z.info(e.icon),a()("h3",{style:e.title},void 0,a()(g.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion",description:"Shown when a customer has run out of Notion AI and needs to upgrade."})),a()("p",{style:e.paragraph},void 0,a()("div",{style:e.text},void 0,i)),a()(L.Z,{isLarge:!0,style:e.button,onClick:()=>M.v5()},void 0,a()(g.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it",description:"Confirmation message shown in the dismiss button we tell a user they have to contact an admin to continue using the add-on features."})))}function Y(){return(0,d.yK)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.mediumTextColor},costSectionTitle:{display:"flex",color:e.mediumTextColor},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.mediumTextColor,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:u.ZP.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:3,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:b.Z.fontWeight.medium},closeIcon:{width:14,fill:e.mediumTextColor},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.mediumTextColor,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:3},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:3,color:e.regularTextColor,background:e.accentColors.gray[50],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function Q(){return ee("limit_reached")}function X(){return ee("confirm_purchase")}function J(){return ee("cancel_plan")}function ee(e){const t=R.Z.state;if(t.open)return t.stage===e}const te=function(e){window.__c={n:"AddOnUpgradeModal"};const{data:t}=e,i="ai",n=(0,A.GJ)(t),o=Y(),s=A.YK(t),d=(0,r.O7)(),c=(0,l.VK)((()=>P.yw()),[]),u=d.device.isMobile;return a()(N.Z,u?{innerStyle:o.innerStyle,requireOnline:!0,modalStore:R.Z,onDismiss:()=>M.v5(),render:()=>a()("div",{style:o.mobileModal},void 0,a()("div",{style:o.innerModalPadding},void 0,a()($,{})))}:{innerStyle:o.innerStyle,requireOnline:!0,modalStore:R.Z,onDismiss:()=>M.v5(),render:()=>a()("div",{style:X()||Q()&&s&&n?o.largeModal:J()&&c?o.cancellationModal:o.modal},void 0,a()("div",{style:J()?o.cancellationInnerModalPadding:o.innerModalPadding},void 0,a()(O.Z,{onClick:()=>{M.v5()},style:o.cancelButton,hoveredStyle:o.hovered},void 0,p.Z.closeSmall(o.closeIcon)),Q()&&a()(U,{addOnFeature:i,canPurchaseAddOn:n,isSubscribed:s}),X()&&a()(W,{addOnFeature:i,canPurchaseAddOn:n}),J()&&a()(j,{addOnFeature:i,canPurchaseAddOn:n,data:t,isSubscribed:s})))})}},62889:(e,t,i)=>{i.r(t),i.d(t,{CreateTeamFromPageConfirmModal:()=>v});var n=i(77094),a=i.n(n),o=(i(67294),i(480)),s=i(24405),r=i(3779),l=i(5366),d=i(82990),c=i(57688),u=i(72684),p=i(42922),m=i(63296),g=i(92660),h=i(29551),f=i(51923);function v(){window.__c={n:"CreateTeamFromPageConfirmModal"};const e=(0,o.O7)(),t=(0,l.useIntl)(),i=(0,s.yK)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:d.Z.fontWeight.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]);return a()(g.Z,{onDismiss:()=>{u.Z.setState({open:!1})},render:()=>a()("div",{style:i.modal},void 0,a()(h.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center"},void 0,r.Z.loop(i.loopIcon),a()("div",{style:i.title},void 0,a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?",description:"Title in confirmation modal for creating a teamspace from a page."})),a()("div",{style:i.description},void 0,a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page.",description:"Description in confirmation modal for creating a teamspace from a page."})),a()(p.Z,{isLarge:!0,style:i.confirmButton,onClick:()=>{if(u.Z.state.open){const{pageStore:i,flowId:n}=u.Z.state;c.Sq({environment:e,intl:t,page:i,flowId:n}),u.Z.setState({open:!1})}}},void 0,a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace",description:"Confirm button in confirmation modal for creating a teamspace from a page."})),a()(m.Z,{isLarge:!0,style:i.cancelButton,onClick:()=>u.Z.setState({open:!1})},void 0,a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel",description:"Cancel button in confirmation modal for creating a teamspace from a page."})),a()(f.Z,{message:a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces",description:"Learn more link in confirmation modal for creating a teamspace from a page."}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"}))),requireOnline:!0,modalStore:u.Z})}},89350:(e,t,i)=>{i.r(t),i.d(t,{SidebarCreateTeamModal:()=>fe});var n=i(77094),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(41892),p=i(3779),m=i(97880),g=i(82990),h=i(5366),f=i(50906),v=i(57688),y=i(4708),b=i(33929),S=i(38755),w=i(23537),M=i(27832),C=i(85057),k=i(19522),T=i(33052),_=i(64921),I=i(74194),x=i(3386),Z=i(68785),P=i(22346),F=i(58032),A=i(64369),B=i(45653),E=i(13490),D=i(8323),R=i(78122),L=i(42922),O=i(51923);function N(){window.__c={n:"SidebarCreateTeamModalFooter"};const e=(0,l.O7)(),{currentSpaceStore:t,spaceViewStore:i}=(0,d.VK)((()=>({currentSpaceStore:M.default.state.currentSpaceStore,spaceViewStore:M.default.state.currentSpaceViewStore})),[]),n=(0,d.VK)((()=>k.Z.state),[]),o=(0,w.OX)(),u=(0,d.VK)((()=>(0,y.xb)()),[]),p=function(){const e=(0,d.VK)((()=>D.Mk()&&!k.Z.state.isDefault),[]),t=k.F.Team,i=k.F.Members;return e?[t,i]:[t]}(),{screen:g,pageNumber:f,teamId:b}=n,S=""===n.name,T=(0,c.yK)((e=>({box:{justifyContent:"space-between",alignItems:"center",display:"flex",width:"100%",paddingTop:22},button:{marginLeft:8},previous:{fontSize:14,color:e.mediumTextColor,cursor:"pointer"},learnMoreLink:{overflow:"hidden"}})),[]),_=(0,r.useCallback)(((i,n)=>{t&&function(e){let{pageOrder:t,pageNumber:i,teamId:n,currentSpaceStore:a,environment:o,from:s}=e;const r=i+1;if(r<=t.length)k.Z.update((e=>({...e,loading:!1,screen:t[r-1],pageNumber:r})));else if(n){const e=C.zX.createChildStore(a,{table:"team",id:n,spaceId:a.id});v.hI({environment:o,teamStore:e,shouldScroll:!0}),v.ED({environment:o,from:s,teamStore:e})}}({pageOrder:p,pageNumber:f,teamId:n||b,currentSpaceStore:t,environment:e,from:i})}),[t,e,f,p,b]),I=s().debounce((async()=>{if(!t||!i)return;let a=b;switch(g){case k.F.Team:a=await async function(e){var t;let{spaceStore:i,environment:n,shouldShowZeroTeamsExperience:a,sidebarCreateTeamModalStoreState:o,typedDbsForTeamsEnabled:s}=e;const{name:r,description:l,icon:d,flowId:c,accessLevel:u,isDefault:p,persona:m}=o;if(!(await(0,R.Xg)({environment:n,spaceStore:i,teamName:r})))return;let g;k.Z.update((e=>({...e,loading:!0}))),g=a?await v.HD({environment:n,name:r,description:l,icon:d,flowId:c,trackCreateTeamComplete:!0,persona:m}):await v.Cm({environment:n,name:r,description:l,icon:d,accessLevel:u,isDefault:p,flowId:c,createTeamHome:!0,createTemplates:s,persona:s?m:void 0});if(!g)return;const h=null===(t=g)||void 0===t?void 0:t.id;return k.Z.update((e=>({...e,teamId:h}))),h}({spaceStore:t,environment:e,shouldShowZeroTeamsExperience:o,sidebarCreateTeamModalStoreState:n,typedDbsForTeamsEnabled:u});break;case k.F.Members:break;default:(0,m.t1)(g)}a?_("success",a):k.Z.update((e=>({...e,loading:!1})))}),1e3,{leading:!0,trailing:!1}),x=(0,r.useCallback)(I,[I]);return a()("div",{style:T.box},void 0,a()(O.Z,{containerStyle:T.learnMoreLink,helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_sidebar_create_team_modal"}),a()("div",{style:{display:"inline-flex"}},void 0,a()(L.Z,{isLarge:!0,onClick:x,disabled:S,style:T.button},void 0,a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.footer.createTeam",defaultMessage:"Create teamspace"}))))}var V=i(97464),U=i.n(V),W=i(60709),z=i(17311),K=i(31194),q=i(52275),H=i(31945),G=i(78140),j=i(9342),$=i(72495),Y=i(38294);const Q=[{key:"marketing",title:Y.Jm.marketing,icon:p.Z.marketing},{key:"sales",title:Y.Jm.sales,icon:p.Z.sales},{key:"product",title:Y.Jm.product,icon:p.Z.product},{key:"eng",title:Y.Jm.eng,icon:p.Z.engineering},{key:"other",title:a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.functions.generalTitle",defaultMessage:"General",description:"Title for a general teamspace with no specific function"}),icon:p.Z.settingsMembers}];const X=function(){window.__c={n:"SidebarCreateTeamModalPersonaSelection"};const e=(0,l.O7)(),t=(0,d.VK)((()=>k.Z.state.persona),[]),{teamId:i,flowId:n}=(0,d.VK)((()=>k.Z.state),[]),o=(0,c.yK)((e=>({chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},button:{border:`1px solid ${e.regularDividerColor}`,borderRadius:z.Z.borderRadius,margin:0,width:"100%"},icon:{width:16,height:16}})),[]);return a()(H.Z,{popupType:H.Z.PopupType.Popup,renderOrigin:e=>{const i=Q.find((e=>e.key===t));return i?r.createElement(q.Z,U()({},e,{buttonStyle:o.button,title:i.title,icon:i.icon?i.icon(o.icon):void 0,right:p.Z.chevronDown(o.chevron),focused:!1})):null},placementToOrigin:K.Iw.Bottom,alignmentToOrigin:K.lU.Start,sameWidthAsOrigin:!0,render:t=>a()(G.Z,{menuType:W.og.Popup},void 0,a()(j.Z,{type:j.i.Vertical,initialFocus:void 0,sections:[{key:"functions",render:e=>r.createElement($.Z,e),items:Q.map((a=>{const s=a.key,l=a.icon?a.icon(o.icon):void 0;return{key:s,render:e=>r.createElement(q.Z,U()({title:a.title,icon:l},e)),action:()=>{k.Z.update((e=>({...e,persona:s}))),i&&f.YYV(e,{teamId:i,flowId:n,persona:s}),t.close()}}}))}]}))})};var J=i(65426),ee=i(30688),te=i(93686);const ie={userSelect:"none",WebkitUserSelect:"none",position:"relative",padding:"22px 26px"},ne={createTeamContainer:{...ie,width:480},addMembersContainer:{...ie,width:500},full:{width:"100%"}},ae=(0,h.defineMessages)({teamNamePlaceholder:{id:"sidebarCreateTeamModal.teamScreen.namePlaceholder",defaultMessage:"Acme Labs"},teamDescriptionPlaceholder:{id:"sidebarCreateTeamModal.teamScreen.descriptionPlaceholder",defaultMessage:"Details about your teamspace"}});function oe(){const[e,t]=(0,d.AF)(k.Z);return r.createElement(r.Fragment,null,a()(E.Z,{hasMarginTop:!0},void 0,a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamDescriptionLabel",defaultMessage:"Description",description:"Label for a description for a new teamspace. This is an optional field."})),a()(I.Z,{value:e.description,placeholder:b.default.formatMessage(ae.teamDescriptionPlaceholder),textarea:!0,onChange:i=>{t({...e,description:i.target.value})}}))}function se(e){return window.__c={n:"Title"},a()("div",{style:{fontSize:18,fontWeight:g.Z.fontWeight.semibold}},void 0,(()=>{switch(e.screen){case k.F.Team:return a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.teamTitle.label",defaultMessage:"Create a new teamspace",description:"Modal title for creating a new teamspace"});case k.F.Members:return a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.membersTitle.label",defaultMessage:"Add people"});default:(0,m.t1)(e.screen)}})())}function re(){const e=(0,l.O7)(),[t]=(0,d.AF)(k.Z),i=(0,r.useCallback)(((t,i)=>{v.ED({environment:e,from:i,teamStore:t})}),[e]),{screen:n}=t;switch(n){case k.F.Team:return a()(ce,{});case k.F.Members:const e=t.teamId;return e?a()(me,{teamId:e,onCompleted:e=>{i(e,"success")},onCanceled:e=>{i(e,"dismiss_button")}}):null;default:(0,m.t1)(n)}}function le(){const[e,t]=(0,d.AF)(k.Z),i=(0,d.VK)((()=>M.default.state.currentSpaceStore),[]),n=(0,c.yK)((e=>({container:{display:"inline-flex",width:"100%",verticalAlign:"middle"},icon:{marginRight:8,marginTop:1}})),[]);if(!i)return null;const o=e.icon?{icon:e.icon,pointer:{table:"space",id:i.id}}:void 0;return r.createElement(r.Fragment,null,a()(E.Z,{hasMarginTop:!0},void 0,a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamNameLabel",defaultMessage:"Icon & name"})),a()("div",{style:n.container},void 0,a()(te.p,{icon:o,size:26,style:n.icon,onChange:i=>{t({...e,icon:i})},iconLoggingData:{recordTable:"team",source:"team_creation"}}),a()(I.Z,{value:e.name,placeholder:b.default.formatMessage(ae.teamNamePlaceholder),onChange:i=>{t({...e,name:i.target.value})},preventSafariAutofill:!0})))}function de(e){window.__c={n:"Description"};const t=(0,c.yK)((()=>({description:{marginTop:3,marginBottom:26}})),[]);return a()(A.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:t.description},void 0,(()=>{switch(e.screen){case k.F.Team:return a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.teamDescription.label",defaultMessage:"Teamspaces are where your team organizes pages, permissions, and members"});case k.F.Members:return null;default:(0,m.t1)(e.screen)}})())}function ce(){window.__c={n:"TeamScreen"};const[e]=(0,d.AF)(k.Z),t=(0,l.O7)(),i=(0,d.VK)((()=>(0,y.Hi)()),[]),n=(0,d.VK)((()=>(0,y.xb)()),[]);(0,r.useEffect)((()=>{if(e.open){const{from:i,flowId:n}=e;f.krX(t,{from:i,flowId:n})}}),[]);const o=(0,c.yK)((()=>({personaPickerDescription:{marginTop:3},tooltip:{maxWidth:300,whiteSpace:"pre-wrap"}})),[]);return a()("div",{style:ne.createTeamContainer},void 0,a()(se,{screen:k.F.Team}),a()(de,{screen:k.F.Team}),a()("div",{style:ne.full},void 0,a()(le,{}),a()(oe,{}),i?r.createElement(r.Fragment,null,a()(E.Z,{hasMarginTop:!0},void 0,a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.optionalFunctionSelection2.label",defaultMessage:"Who is this teamspace for?",description:"Label for selecting a function (marketing, sales, product, etc.) for a new teamspace."})),a()(X,{}),a()(A.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:o.personaPickerDescription},void 0,a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.optionalFunctionSelectionDescription.label",defaultMessage:"This will determine the default templates in your teamspace. You can always change them later.",description:"Description for selecting a function (marketing, sales, product, etc.) for a new teamspace."}))):r.createElement(r.Fragment,null,n&&a()(F.Z,{render:e=>r.createElement("div",e,a()(E.Z,{hasMarginTop:!0},void 0,a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.optionalFunctionSelection.label",defaultMessage:"Function",description:"Label for selecting a function (marketing, sales, product, etc.) for a new teamspace."})),a()(X,{})),renderTooltip:()=>a()("div",{style:o.tooltip},void 0,a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.optionalFunctionSelectionDescription.label",defaultMessage:"This will determine the default templates in your teamspace. You can always change them later.",description:"Description for selecting a function (marketing, sales, product, etc.) for a new teamspace."})),placement:F.Z.Placement.Left})),a()(pe,{})),a()(N,{}))}function ue(){const e=(0,d.VK)((()=>k.Z.state.loading),[]),t=(0,c.yK)((e=>({spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0}})),[]);return r.createElement(r.Fragment,null,e&&a()("div",{style:t.spinner},void 0,a()(Z.Z,{style:{position:"absolute",top:"50%",left:"50%"}})))}function pe(){const e=(0,c.yK)((e=>({openAccessMessage:{fontSize:13,color:e.mediumTextColor,marginTop:20,lineHeight:1.4,display:"flex"},iconContainer:{marginRight:8},openTeamIcon:{width:24,fill:e.mediumIconColor},teamAccessPopupContainer:{marginTop:20}})),[]),[t,i]=(0,d.AF)(k.Z),n=(0,w.OX)(),o=(0,l.O7)(),s=(0,d.VK)((()=>{const e=M.default.state.currentSpaceStore;return e?(0,S.rn)(o,e):"this workspace"}),[o]);return n?a()("div",{style:e.openAccessMessage},void 0,a()("div",{style:e.iconContainer},void 0,p.Z.openTeam(e.openTeamIcon)),a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.openAccessLabel",defaultMessage:"Everyone at {spaceName} and new members will have access to this teamspace",description:"Message for a user creating their first teamspace explaining that all workspace members will have access to this teamspace.",values:{spaceName:s}})):r.createElement(r.Fragment,null,a()(E.Z,{hasMarginTop:!0},void 0,a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.permissionsLabel",defaultMessage:"Permissions",description:"Header label above the teamspace access level switcher."})),a()(J._,{currentAccessLevel:t.accessLevel,currentIsDefault:t.isDefault,onChange:(e,n)=>{i(n?{...t,accessLevel:"open",isDefault:n}:{...t,accessLevel:e,isDefault:n})}}))}function me(e){window.__c={n:"MemberScreen"};const t=(0,l.O7)(),[,,i]=(0,d.AF)(k.Z),[,,n]=(0,d.AF)(void 0,T.Z);(0,d.VK)((()=>{const{defaultInviteTargets:e,flowId:t}=i.state;n.setState({...n.state,flowId:t}),e&&n.setState({...n.state,isInviteTargetsEmpty:!1,inviteTargets:e})}),[i,n]);const o=(0,d.VK)((()=>M.default.state.currentSpaceStore),[]);if(!o)return null;const s=C.zX.createChildStore(o,{table:"team",id:e.teamId,spaceId:o.id});return a()("div",{style:ne.full},void 0,a()("div",{style:ne.addMembersContainer},void 0,a()(ee.Z,{store:s,permissionsInviteStore:n,isNewlyCreatedTeam:!0,onSubmitSuccessful:()=>{e.onCompleted(s),v.hI({environment:t,teamStore:s,shouldScroll:!0})},onDismiss:()=>{e.onCanceled(s)}})))}const ge=[u.Z.images.avatars.avatar1Png,u.Z.images.avatars.avatar2Png,u.Z.images.avatars.avatar3Png];function he(e){let{handleModalClose:t}=e;window.__c={n:"FirstTeamHeader"};const i=(0,c.yK)((e=>({container:{borderTopLeftRadius:5,borderTopRightRadius:5,background:e.inputBackground,boxShadow:e.inputBoxShadow},header:{display:"flex",padding:14,fontWeight:g.Z.fontWeight.medium},avatarGroup:{display:"flex",width:"100",marginLeft:4,alignSelf:"center"},avatar:{marginLeft:-4},message:{paddingLeft:14,paddingRight:14},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return a()("div",{style:i.container},void 0,a()("div",{style:i.header},void 0,a()("div",{style:i.avatarGroup},void 0,ge.map(((e,t)=>a()(B.Z,{avatarShouldShowShadow:!0,style:i.avatar,size:28,avatar:{avatarUrl:e}},t)))),a()(A.Z,{style:i.message,isMultiline:!0,isSmall:!0},void 0,a()(h.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.firstTeamHeader",defaultMessage:"Create your first teamspace to start using Notion with your teammates",description:"Message for a user creating their first teamspace explaining that all workspace members will have access to this teamspace."})),a()(_.Z,{onClick:t,style:i.closeButton,hoveredStyle:i.closeButtonHover},void 0,p.Z.closeSmall(i.closeButtonIcon))))}function fe(){window.__c={n:"SidebarCreateTeamModal"};const e=(0,l.O7)(),[t,,]=(0,d.AF)(k.Z),i=(0,c.yK)((e=>({modal:{maxWidth:500,borderRadius:5},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor},wrapper:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}})),[]),n=(0,r.useCallback)((t=>{v.ED({environment:e,from:t})}),[e]),{open:o,loading:u,screen:m}=t,g=(0,w.OX)(),h=(0,r.useRef)(g);return(0,r.useEffect)((()=>{u||(h.current=g&&m===k.F.Team)}),[u,m,g]),o?a()(P.Z,{open:o,innerStyle:i.modal,onDismiss:()=>{n("modal")},render:()=>{const{device:t}=e;return a()("div",{style:{height:"100%"}},void 0,!t.isMobile&&(h.current?a()(he,{handleModalClose:()=>{n("close_button")}}):a()(_.Z,{onClick:()=>{n("close_button")},style:i.closeButton,hoveredStyle:i.closeButtonHover},void 0,p.Z.closeSmall(i.closeButtonIcon))),a()("div",{style:i.wrapper},void 0,a()(x.Z,{capture:!0,onBackspace:s().identity,onLeft:s().identity,onRight:s().identity,onSelectAll:s().identity,onRedo:s().identity,onUndo:s().identity,onCut:s().identity,onCopy:s().identity,onPaste:s().identity,onKeypress:s().identity,onDelete:s().identity,onTab:s().identity},void 0,a()(re,{}))),a()(ue,{}))}}):null}},65426:(e,t,i)=>{i.d(t,{_:()=>k});var n=i(77094),a=i.n(n),o=i(97464),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(3779),p=i(60709),m=i(98742),g=i(92350),h=i(4657),f=i(25464),v=i(31194),y=i(52275),b=i(31945),S=i(78140),w=i(9342),M=i(72495),C=i(58032);function k(e){let{currentAccessLevel:t,currentIsDefault:i=!1,onChange:n,teamStore:o,disabledWithRightChevron:k=!1,style:T}=e;window.__c={n:"TeamAccessLevelButtonPopup"};const{device:_}=(0,l.O7)(),I=(0,g.ql)(o),x=(0,c.yK)((e=>({chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},selectedButton:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${e.outlineButtonBorder}`,...T},selectedCheckmark:{width:_.isMobile?16:14},icon:{alignSelf:"center",marginTop:0}})),[_.isMobile,T]),Z=(0,d.VK)((()=>(null==o?void 0:o.isDefault())??i),[o,i]),P=Z?"default":t,F=(0,h.U)({teamStore:o,onChange:n,isDefault:Z});return a()(b.Z,{popupType:_.isMobile?b.Z.PopupType.SlideUp:b.Z.PopupType.Popup,renderOrigin:e=>{const t=F.find((e=>e.key===P));if(!t)return null;const i=t.disableAllOptionsTooltip,n=k||Boolean(i)||Boolean(o)&&!I;return a()(C.Z,{placement:f.u.Bottom,alignment:f.v.Start,disableTooltip:!i||!I,renderTooltip:()=>i,style:{width:350},textWrap:!0,render:i=>r.createElement(y.Z,s()({},(0,m.Z)(e,i),{title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:x.icon,disabled:n,right:k?u.Z.chevronRight(x.chevron):n?void 0:u.Z.chevronDown(x.chevron),focused:!1,shouldWrapCaption:!0,buttonStyle:x.selectedButton}))})},placementToOrigin:v.Iw.Bottom,alignmentToOrigin:v.lU.Start,sameWidthAsOrigin:!0,render:e=>{const t=[{key:"access levels",render:e=>r.createElement(M.Z,s()({},e,{topBorder:0!==e.index})),items:F.map((t=>{const i=t.key===P;return{key:t.key,render:e=>a()(C.Z,{placement:f.u.Top,disableTooltip:!t.tooltip,renderTooltip:()=>t.tooltip,render:n=>r.createElement(y.Z,s()({},(0,m.Z)(e,n),{title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:x.icon,right:i?a()("div",{style:x.selectedCheckmark},void 0,u.Z.check()):void 0,disabled:t.disabled,shouldWrapCaption:!0}))}),action:()=>{t.onSelect(),e.close()}}}))}];return a()(S.Z,{menuType:p.og.Popup},void 0,a()(w.Z,{type:w.i.Vertical,initialFocus:void 0,sections:t}))}})}},67110:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var n=i(77094),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(24405),d=i(33728),c=i(59054),u=i(5366),p=i(21325),m=i(4708),g=i(60709),h=i(75472),f=i(23537),v=i(27832),y=i(33052),b=i(78140),S=i(43579),w=i(91487),M=i(47082),C=i(97464),k=i.n(C),T=i(96486),_=i.n(T),I=i(3779),x=i(92350),Z=i(31194),P=i(52275),F=i(31945),A=i(9342),B=i(89728),E=i(72495),D=i(58032);function R(e){window.__c={n:"TeamRoleSelect"};const{disabled:t,selectedRole:i,allRoles:n,onChange:d,store:c,labelStyle:p}=e,{device:m}=(0,s.O7)(),h=(0,l.Fg)(),y=(0,x.ql)(c),S=(0,r.VK)((()=>{const{currentSpaceStore:e}=v.default.state;return null==e?void 0:e.canEditMembership()}),[]),w=(0,r.VK)((()=>c.isDefault()),[c]);return a()(F.Z,{popupType:m.isMobile?F.Z.PopupType.SlideUp:F.Z.PopupType.Popup,renderOrigin:e=>o.createElement(B.Z,k()({style:p,disabled:t,disabledFeedback:!0},e),o.createElement(u.FormattedMessage,f.q9[i].label),I.Z.chevronDown({width:10,marginLeft:4,fill:h.lightIconColor})),placementToOrigin:Z.Iw.Bottom,render:e=>{const t=[{key:"roles",render:e=>o.createElement(E.Z,k()({},e,{topBorder:0!==e.index})),items:n.map((t=>{const n=!y&&"owner"===t,s=w&&"team_level_guest"===t,r=!S&&"team_level_guest"===t,l=!y&&"team_level_guest"===t,c=n||s||r||l;return{key:t,render:e=>a()(D.Z,{disableTooltip:!c,placement:D.Z.Placement.Right,textWrap:!0,renderTooltip:()=>n?a()(u.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingOwnerForMembers",defaultMessage:"Teamspace members can't add owners",description:"Tooltip explaining why the option to add an owner is disabled"}):s?a()(u.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestsInDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests",description:"Tooltip explaining why the option to add a teamspace guest is disabled"}):r||l?a()(u.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestForNonSpaceAdminsOrNonTeamOwners",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests",description:"Tooltip explaining why the option to add a teamspace guest is disabled"}):void 0,render:n=>o.createElement("span",n,o.createElement(P.Z,k()({},e,{focused:!1,checkState:_().isEqual(t,i),disabled:c,disabledFeedback:c,title:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,o.createElement(u.FormattedMessage,f.q9[t].label)),caption:a()("span",{style:{color:h.mediumTextColor}},void 0,o.createElement(u.FormattedMessage,f.q9[t].caption)),shouldWrapCaption:!0})))}),action:()=>{d(t),e.close()}}}))}];let s;return s=m.isMobile?{menuType:g.og.Modal,title:a()(u.FormattedMessage,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role",description:"Message telling user they can select a teamspace role here."}),right:a()(u.FormattedMessage,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done",description:"Done button"}),onClickRight:e.close}:{menuType:g.og.Popup,width:264},o.createElement(b.Z,s,a()(A.Z,{type:A.i.Vertical,initialFocus:void 0,sections:t}))}})}const L="member";function O(e){window.__c={n:"TeamPermissionsInviteInput"};const{store:t,permissionsInviteStore:i,onEmptySubmit:n}=e,o=(0,u.useIntl)(),s=(0,r.VK)((()=>Boolean(i.state.isFocused)),[i]),c=(0,r.VK)((()=>i.state.tokenQuery),[i]),p=(0,r.VK)((()=>i.state.inviteRole),[i]),m=(0,r.VK)((()=>i.state.inviteTargets),[i]),g=(0,l.yK)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:3,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:s?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[s]);function f(e){if(i.state.isInviteTargetsEmpty)return;const t=i.state.inviteTargets.filter((t=>t!==e));0===m.length?i.setState({...i.state,inviteTargets:[],inviteRole:L,isInviteTargetsEmpty:!0}):i.setState({...i.state,inviteTargets:t})}function v(e){i.setState({...i.state,isFocused:e})}const y=m.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return a()(w.Z,{target:e,onClickRemove:f,role:p,shouldWrap:!0,style:g.inputTokenVerticalMargin,backgroundColor:(0,h.gQ)(e)},t)}));return a()(M.Z,{focus:s,onClick:()=>v(!0),format:M.Z.Format.Share,value:c,onChange:function(e){const t=e.target.value,{extractedEmails:n,newInputValue:a}=(0,d.zI)(t),o=n.map((e=>({type:"newUser",value:{email:e},source:"email"}))).filter((e=>!(0,h.Nd)({target:e,permissionsInviteStore:i}))),s=[...i.state.inviteTargets,...o];s.length>0?(i.setState({...i.state,inviteTargets:s,isInviteTargetsEmpty:!1,tokenQuery:a}),v(!(o.length>0))):i.setState({...i.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:a})},onEmptySubmit:n,type:"email",placeholder:o.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups",description:"Placeholder text for inviting people or groups to a team"}),tokens:y,onRemoveLastToken:function(){const e={...i.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=L),i.setState(e)},focusAfterAnimation:!0,right:a()(N,{store:t,permissionsInviteStore:i}),style:g.tokenMenuItem,inputStyle:g.inputTokenVerticalMargin,inputDivStyle:g.inputDiv})}function N(e){const{store:t,permissionsInviteStore:i}=e,n=(0,r.VK)((()=>{const e=v.default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,m.F$)()}),[]),o=(0,r.VK)((()=>i.state.inviteRole),[i]),s=(0,l.yK)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function d(e){i.setState({...i.state,inviteRole:e})}return a()(R,n?{store:t,selectedRole:o,allRoles:f.ZN,onChange:d,labelStyle:s.teamRoleLabel}:{store:t,selectedRole:o,allRoles:f.$r,onChange:d,labelStyle:s.teamRoleLabel})}const V=function(e){window.__c={n:"TeamPermissionsInvite"};const{store:t,onEmptySubmit:i}=e,n=(0,s.O7)();(0,c.r5)((async()=>{await p.bi(n)}),[]);const o=(0,r.qz)(e.permissionsInviteStore,y.Z),d=(0,r.VK)((()=>Boolean(o.state.isFocused)),[o]),u=(0,r.VK)((()=>o.state.tokenQuery),[o]),m=(0,r.VK)((()=>d&&u.length>0),[d,u]),h=(0,l.yK)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:3,backgroundColor:e.contentBackground,boxShadow:e.largeBoxShadow,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){o.setState({...o.state,isFocused:e})}return a()("div",{onFocus:()=>f(!0),onBlur:()=>f(!1)},void 0,a()(b.Z,{menuType:g.og.Popup,header:a()(O,{store:t,permissionsInviteStore:o,onEmptySubmit:i}),scrollerStyle:h.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0},void 0,m&&a()("div",{style:h.permissionsInviteSearchRequest},void 0,a()(S.Z,{permissionsInviteStore:o,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0}))))}},30688:(e,t,i)=>{i.d(t,{Z:()=>O});var n=i(97464),a=i.n(n),o=i(77094),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(33728),u=i(3779),p=i(82990),m=i(5366),g=i(50906),h=i(43132),f=i(95209),v=i(64964),y=i(57688),b=i(43250),S=i(4708),w=i(75472),M=i(8323),C=i(23537),k=i(77907),T=i(27832),_=i(42922),I=i(68785),x=i(63296),Z=i(89728),P=i(58032),F=i(64369),A=i(93686),B=i(13380);const E={button:{height:32},buttonContainer:{width:"100%",paddingTop:22,display:"flex",justifyContent:"end"},multiButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"space-between"},singleButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"right"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},containerLeftAligned:{display:"flex",alignItems:"left",justifyContent:"left",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},titleAndIcon:{paddingBottom:18,alignItems:"center",display:"flex"},addMembersTo:{minWidth:"25%"},icon:{paddingRight:3,paddingLeft:3},teamName:{paddingRight:10,fontWeight:p.Z.fontWeight.medium,...p.Z.textOverflowStyle,maxWidth:250},full:{width:"100%"},submitTooltip:{minWidth:250},subtitle:{paddingTop:16}};function D(e){var t;let{isLoading:i,isNewlyCreatedTeam:n,onDismiss:o,onSubmit:l,inviteTargets:c,includesGroups:u,inviteRole:p,canEditSpaceMembership:g,membershipRequestsDisabled:h,spaceAllowedDomains:f,hasTeamGuestsMatchAllowedDomain:v}=e;window.__c={n:"InviteSubmitButton"};const y=c.length>0,b=u&&"owner"===p,M=c.filter((e=>(0,w.OA)(e))).length>0&&h&&!g,C=(0,d.VK)((()=>(0,S.F$)()&&"team_level_guest"===p&&c.some((e=>"group"===e.type||"existingUser"===e.type&&"none"!==e.spaceRole&&"not_in_space"!==e.spaceRole))),[p,c]),k=b||C||M||v;if(i)return s()(_.Z,{style:{...E.button,minWidth:80},disabled:!0},void 0,s()(I.Z,{isWhite:!0}));if(n&&!y)return s()(x.Z,{style:E.button,onClick:o,disabled:i},void 0,s()(m.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.skipForNow",defaultMessage:"Skip for now",description:"Button prompt to skip adding teamspace members."}));const T=b?s()(m.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.groupsAsOwnersTooltip",defaultMessage:"Cannot add groups as teamspace owners. Remove any groups to continue.",description:"Explains to user it cannot proceed to add permission groups as teamspace owners."}):C?s()(m.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.memberOrGroupInvitedAsTeamGuestTooltip",defaultMessage:"Cannot add space members or groups as teamspace guests. Remove them to continue.",description:"Explains to user it cannot proceed to add workspace members or groups as teamspace guests."}):v?s()(m.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.hasTeamGuestsMatchAllowedDomain",defaultMessage:"Cannot add users with {emailDomains} as teamspace guests. Remove them to continue.",description:"Explains to user it cannot proceed to add users who matched the space allow doamins as teamspace guests.",values:{emailDomains:null==f||null===(t=f.map((e=>`@${e}`)))||void 0===t?void 0:t.join(", ")}}):null;return s()(P.Z,{textWrap:!0,style:E.submitTooltip,disableTooltip:!T,renderTooltip:()=>T,render:e=>r.createElement(_.Z,a()({style:E.button,onClick:l,disabled:!y||i||k},e),s()(m.FormattedMessage,{id:"teamPermissionsInviteOverlayV2.inviteButton.label",defaultMessage:"Invite",description:"Button prompt to add members or owners to teamspace."}))})}function R(e){let{inviteTargets:t,workspaceName:i,canEditSpaceMembership:n,membershipRequestsDisabled:a,isFreeTier:o,inviteRole:r,hasTeamGuestsMatchAllowedDomain:l}=e;if(void 0===n)return null;if(!t||0===t.length)return null;const d=t.map((e=>{if("group"!==e.type&&(0,w.OA)(e))return e.value.email})).filter((e=>e));if(!d||0===d.length)return null;const c=e=>s()("b",{},void 0,e),u=i??"this workspace";return n?o?s()(F.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0},void 0,1===d.length?s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingularOwner.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a workspace owner.",description:"Subtitle explaning that a subset of members will be added to the workspace.",values:{guestEmail:d[0],workspaceName:u,b:c}}):s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPluralOwners.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as workspace owners.",description:"Subtitle explaning that a subset of members will be added to the workspace.",values:{firstGuest:d[0],secondGuest:d[1],numberOfOtherEmails:d.length-1,workspaceName:u,b:c}})):"team_level_guest"===r?l?null:s()(F.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0},void 0,1===d.length?s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.teamGuest.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed teamspace guest.",description:"Subtitle explaning that a subset of members will be added and charged as teamspace guests to the workspace.",values:{guestEmail:d[0],workspaceName:u,b:c}}):s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.teamGuest.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed teamspace guests.",description:"Subtitle explaning that a subset of members will be added and charged as teamspace guests to the workspace.",values:{firstGuest:d[0],secondGuest:d[1],numberOfOtherEmails:d.length-1,workspaceName:u,b:c}})):s()(F.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0},void 0,1===d.length?s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed workspace member.",description:"Subtitle explaning that a subset of members will be added to the workspace.",values:{guestEmail:d[0],workspaceName:u,b:c}}):s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed workspace members.",description:"Subtitle explaning that a subset of members will be added to the workspace.",values:{firstGuest:d[0],secondGuest:d[1],numberOfOtherEmails:d.length-1,workspaceName:u,b:c}})):s()(F.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0},void 0,a?s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipDisabled.subtitle",defaultMessage:"You can't add workspace guests to a teamspace. Ask your admin to add them as workspace members first.",description:"Subtitle explaning that guests can't be added to a teamspace."}):1===d.length?s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipSingular.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{guestEmail}</b> as a member to {workspaceName}.",description:"Subtitle explaning that a subset of members will be added to the workspace.",values:{guestEmail:d[0],workspaceName:u,b:c}}):s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipPlural.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> as members to {workspaceName}.",description:"Subtitle explaning that a subset of members will be added to the workspace.",values:{firstGuest:d[0],secondGuest:d[1],numberOfOtherEmails:d.length-1,workspaceName:u,b:c}}))}function L(e){window.__c={n:"InviteLink"};const{store:t}=e,i=(0,l.O7)();return s()(Z.Z,{onClick:()=>{h.RD({environment:i,stringValue:C.W8(t.id),copiedMessage:h.tq.copiedLinkToClipboard}),g.XTk(i,{store:t})},icon:u.Z.link,style:{marginRight:5,height:32},isBlue:!0},void 0,s()(m.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkButton.label",defaultMessage:"Copy invite link",description:"Prompt to copy a team invite link to the clipboard"}))}const O=function(e){let{store:t,permissionsInviteStore:i,isNewlyCreatedTeam:n,onSubmitSuccessful:a,onDismiss:o}=e;window.__c={n:"TeamPermissionsInviteOverlay"};const u=(0,l.O7)(),{teamName:p,workspaceName:g,canEditSpaceMembership:h,membershipRequestsDisabled:_,teamAccessLevel:I,spaceAllowedDomains:x}=(0,d.VK)((()=>{const{currentSpaceStore:e}=T.default.state;return{teamName:t.getName(),workspaceName:null==e?void 0:e.getName(),canEditSpaceMembership:null==e?void 0:e.canEditMembership(),membershipRequestsDisabled:null==e?void 0:e.getDisableMembershipRequests(),teamAccessLevel:t.getTeamAccessLevel(),spaceAllowedDomains:null==e?void 0:e.getEmailDomains()}}),[t]);(0,r.useEffect)((()=>()=>{n&&y.hI({environment:u,teamStore:t,shouldScroll:!0})}),[n,t,u]);const[Z,P]=(0,r.useState)(!1),F=(0,d.VK)((()=>i.state.inviteTargets),[i]),O=(0,d.VK)((()=>i.state.inviteTargets.length),[i]),N=(0,d.VK)((()=>i.state.inviteRole),[i]),V=(0,d.VK)((()=>{if(i.state.isInviteTargetsEmpty)return!1;return Boolean(i.state.inviteTargets.find((e=>"group"===e.type)))}),[i]),U=(0,d.VK)((()=>M.QM()),[]),W=(0,d.VK)((()=>!(null==x||!x.length||"team_level_guest"!==N||!(0,S.F$)())&&F.some((e=>"group"!==e.type&&(0,c.dy)(x,e.value.email)))),[x,N,F]),z=(0,d.VK)((()=>(0,S.s$)()?!C.U2(t):"open"===I&&(0,S.u3)()),[t,I]),K=async()=>{if(P(!0),O>0){const e=i.state.inviteTargets,n=await f.zK({environment:u,store:t,permissionsInviteStore:i,inviteOrigin:"team_invite_overlay"});if(void 0!==h)if(n){const i=(0,w.t0)({inviteTargets:e,recordStore:t,canEditSpaceMembership:h});if(!i)return;setTimeout((()=>{v.oV({label:i})}))}else setTimeout((()=>{v.oV({label:s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlay.inviteMembersFailure.message",defaultMessage:"Failed to send invites",description:"Message shown if new members could not be added to teamspace."})})}))}f.Mr({permissionsInviteStore:i}),P(!1),null==a||a()};return s()("div",{className:b.D$4,style:{...E.full}},void 0,s()("div",{style:E.containerLeftAligned},void 0,s()("div",{style:E.titleAndIcon},void 0,s()("div",{style:E.addMembersTo},void 0,s()(m.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.membersTitle.label",defaultMessage:"Invite people to",description:"A prefix for adding members to a certain teamspace (followed by the teamspace's name)."})),s()("div",{style:E.icon},void 0,s()(A.p,{disabled:!0,store:t,size:20})),s()(B.s,{style:E.teamName},void 0,p)),s()("div",{style:E.full},void 0,s()(k.LazyTeamPermissionsInvite,{store:t,permissionsInviteStore:i,onEmptySubmit:K}),s()("div",{style:E.subtitle},void 0,s()(R,{inviteTargets:F,workspaceName:g,canEditSpaceMembership:h,membershipRequestsDisabled:_,isFreeTier:U,inviteRole:N,hasTeamGuestsMatchAllowedDomain:W}))),s()("div",{style:z?E.multiButtonContainer:E.singleButtonContainer},void 0,s()("div",{style:z?E.multiButtonContainer:{}},void 0,z&&s()(L,{store:t}),s()(D,{isLoading:Z,onSubmit:K,onDismiss:()=>{f.Mr({permissionsInviteStore:i}),null==o||o()},isNewlyCreatedTeam:n,inviteTargets:F,includesGroups:V,inviteRole:N,canEditSpaceMembership:h,membershipRequestsDisabled:_,spaceAllowedDomains:x,hasTeamGuestsMatchAllowedDomain:W})))))}},86100:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});var n=i(77094),a=i.n(n),o=(i(67294),i(81954)),s=i(9019),r=i(30688);const l=function(e){window.__c={n:"TeamPermissionsInviteWithModal"};const[t,,i]=(0,o.AF)(e.permissionsInviteStore),n=()=>{i.reset()};return a()(s.Z,{modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:500},open:t.modalOpen,onDismiss:n,renderContent:()=>a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}},void 0,a()(r.Z,{store:e.store,permissionsInviteStore:i,isNewlyCreatedTeam:!1,onSubmitSuccessful:n,onDismiss:n})),origin:e.origin})}},51923:(e,t,i)=>{i.d(t,{Z:()=>m});var n=i(77094),a=i.n(n),o=(i(67294),i(24405)),s=i(5366),r=i(97880),l=i(33665),d=i(74523),c=i(13380);function u(e){switch(e){case"bestPractices":return(0,l.UY)("guides.teamspacesLearnMore");case"workspaceOwnerGuide":return(0,l.UY)("guides.teamspacesWorkspaceOwner");case"settingsAndPermissions":return(0,l.UY)("guides.teamspacesSettingsAndPermissions");default:return(0,r.t1)(e)}}function p(e){return window.__c={n:"renderMessage"},e||a()(c.s,{},void 0,a()(s.FormattedMessage,{defaultMessage:"Learn about teamspaces",description:"Link that takes a user to a guide with more information about the teamspaces feature.",id:"teamsLearnMoreLink"}))}function m(e){let{onClick:t,message:i,helpCenterLocation:n,analyticsFrom:s,containerStyle:r}=e;window.__c={n:"TeamsLearnMoreLink"};const l=(0,o.yK)((()=>({button:{maxWidth:"100%"}})),[]);return a()("div",{style:r},void 0,a()(d.Z,{buttonStyle:l.button,title:p(i),analyticsFrom:s,href:u(n),onClick:t}))}},62512:(e,t,i)=>{i.d(t,{n:()=>h});var n=i(77094),a=i.n(n),o=(i(67294),i(81954)),s=i(24405),r=i(7928),l=i(5366),d=i(31278),c=i(45653),u=i(37432),p=i(37708);const m=u.Z.iconSize,g=p.Kt;function h(e){let{ownerStores:t,teamStore:i,isSmall:n=!1}=e;window.__c={n:"TeamOwnerIcons"};const r=n?g:m,l=n?10:16,c=(0,s.yK)((e=>({container:{position:"relative",width:r,height:r},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[r]),{teamName:u,teamIcon:p}=(0,o.VK)((()=>({teamName:i.getName(),teamIcon:i.getIcon()})),[i]),h=e=>a()(d.Z,{disabled:!0,title:u,icon:p,isEmptyPage:!1,size:e});return 0===t.length?h(r):a()("div",{style:c.container},void 0,a()(f,{isSmall:n,store:t[0]}),a()("div",{style:c.teamBadge},void 0,h(l)))}function f(e){let{store:t,isSmall:i=!1,style:n={}}=e;window.__c={n:"OwnerIcon"};const u=(0,l.useIntl)(),p=i?g:m,h=(0,s.yK)((e=>({icon:{width:p,height:p,borderRadius:p,boxShadow:e.avatarBoxShadow,...n}})),[p,n]),f=(0,o.VK)((()=>null!=t&&t.isDefined()?(0,r.Nz)(u,null==t?void 0:t.getModel()):void 0),[u,t]),v=f?a()(c.Z,{avatarShouldShowShadow:!0,userStore:t,size:p}):a()(d.Z,{bucket:"public",disabled:!0,isEmptyPage:!1,title:f,size:p,icon:void 0});return a()("div",{style:h.icon},void 0,v)}},49469:(e,t,i)=>{i.d(t,{z:()=>r});var n=i(77094),a=i.n(n),o=(i(67294),i(24405)),s=i(82990);function r(e){let{title:t,subtitle:i,style:n}=e;window.__c={n:"TeamSettingsHeader"};const r=(0,o.yK)((e=>({base:{width:"100%"},title:{fontWeight:s.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14},subtitle:{fontWeight:s.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:12}})),[]);return a()("div",{style:{...r.base,...n}},void 0,a()("div",{style:r.title},void 0,t),i&&a()("div",{style:r.subtitle},void 0,i))}},37708:(e,t,i)=>{i.d(t,{oM:()=>c,MQ:()=>u,Kt:()=>p,Ph:()=>m});var n=i(77094),a=i.n(n),o=i(67294),s=i(24405),r=i(61519),l=i(89728),d=i(49469);const c=15,u=8,p=20;function m(e){const t=(0,s.yK)((()=>({button:{height:"auto",paddingLeft:0,paddingRight:0,display:"flex"},title:{marginBottom:10}})),[]);return Boolean(e.onClick)?o.createElement(o.Fragment,null,a()(d.z,{title:e.title,style:t.title}),a()(l.Z,{onClick:e.onClick,style:t.button},void 0,o.createElement(g,e))):o.createElement(o.Fragment,null,a()(d.z,{title:e.title,style:t.title}),o.createElement(g,e))}function g(e){let{title:t,rows:i,hideDividers:n=!1,itemStyle:l,onClick:d}=e;window.__c={n:"TeamSettingsListContainer"};const p=(0,s.yK)((e=>({container:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,width:"100%"},list:{listStyle:"none",padding:0,margin:0},listItem:{marginLeft:c,marginRight:c,paddingTop:u,paddingBottom:u,...l},divider:{marginLeft:c,marginRight:c,borderColor:`${e.regularDividerColor}`}})),[l]);return a()("div",{style:{...p.container}},void 0,a()("ul",{style:p.list},void 0,i.map(((e,t)=>o.createElement(o.Fragment,null,!n&&t>0&&a()(r.Z,{size:1,innerStyle:p.divider}),a()("li",{style:p.listItem},t,e))))))}},20671:(e,t,i)=>{i.r(t),i.d(t,{default:()=>he});var n=i(77094),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(24405),d=i(11002),c=i(50906),u=i(54642),p=i(51127),m=i(5299),g=i(88428),h=i(5978),f=i(30149),v=i(28020),y=i(77373),b=i(93959),S=i(54258),w=i(98165),M=i(72444),C=i(94660),k=i(46740),T=i(27832),_=i(37394),I=i(22346),x=i(97464),Z=i.n(x),P=i(41892),F=i(3779),A=i(21202),B=i(97880),E=i(5366),D=i(92350);var R=i(82136),L=i(85057),O=i(42922),N=i(31945),V=i(62896),U=i(73063),W=i(64369),z=i(84315),K=i(59281);function q(e){const t=(0,s.O7)(),i=function(e){const[t,i]=o.useState(!1);return o.useEffect((()=>{const t=window.matchMedia(e);function n(e){i(e.matches)}return t.addEventListener("change",n),()=>{t.removeEventListener("change",n)}}),[e]),t}("(max-width: 960px)"),n=(0,l.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor},contentContainer:{margin:16,padding:"20px 24px",border:"1px solid rgba(0, 0, 0, 0.07)",borderRadius:8,background:e.sidebarBackground,display:"flex",flexDirection:"row",justifyContent:"space-between",columnGap:50,flexWrap:i?"wrap":"nowrap"},getTemplateColumn:{width:i?"100%":void 0,display:"flex",flexDirection:i?"column-reverse":"column"},madeByLabel:{marginTop:16,marginBottom:16},heroImg:{height:"100%",width:"100%"},getTemplateButton:{width:i?"100%":220,height:38,fontSize:16},addBadgeTeamTemplateButton:{textTransform:"none",color:e.blueColor}})),[i]),{status:d,selectedTemplate:u,cloneTo:p,selectedTeam:m}=(0,r.VK)((()=>_.Z.state),[]),g=(0,r.VK)((()=>{if("open"===d&&"preset"===(null==u?void 0:u.type)){const e=u.uri,t=(0,b.SP)(e),i=null==t?void 0:t.presets.find((t=>t.uri===e));if(t&&i)return{currentApp:t,currentPreset:i}}}),[d,u]),h=(0,r.VK)((()=>{if(u){if("preset"===u.type){var e;if(!g)return;const{currentPreset:i}=g,o=null===(e=i.previews)||void 0===e?void 0:e.find((e=>"previewRootId"in e)),s=o&&new L.G(t,{table:A.iU,id:o.previewRootId,spaceId:o.spaceId}),r=s?a()("div",{style:{overflow:"hidden",paddingTop:64,paddingLeft:64,paddingRight:64}},void 0,a()(z.Z,{store:s,loadingContainerStore:void 0,context:R.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:0,titleStyle:{fontSize:32},disabled:!0},s.id)):a()("img",{style:n.heroImg,src:P.Z.images.appPackages.projectPreview1Png});return[i.name,i.description,a()("img",{src:i.icon,style:{width:30,height:30}},i.uri),r]}if("pageTemplate"===u.type){const{template:e}=u,i=new L.G(t,{table:A.iU,id:e.previewRootId,spaceId:e.spaceId}),n=i.isCollectionView()?64:0,o=a()("div",{style:{overflow:"hidden",paddingTop:n,paddingLeft:n,paddingRight:n}},void 0,a()(z.Z,{store:i,loadingContainerStore:void 0,context:R.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:z.Z.defaultPageCoverHeight(t),disabled:!0,style:{...i.isFullWidth()?{width:"calc(100% - 64px)",margin:"0 32px"}:{}}}));return[e.name,e.description,a()("span",{style:{fontSize:20,height:30}},e.rootId,e.emoji?a()(V.Z,{},void 0,e.emoji):a()("img",{src:e.icon,style:{width:30,height:30}},e.icon)),o]}(0,B.t1)(u)}}),[g,t,u,n.heroImg]),f=(0,D.E7)(),v=(0,r.VK)((()=>f.filter((e=>e.canAddOrRemoveTopLevelPages()))),[f]);if("open"!==d||void 0===u||!h)return null;const[y,S,w,M]=h,C=v.length>0&&"destination_picker"===p&&!m,k=a()(E.FormattedMessage,{id:"templateDetail.getTemplateButton.label",defaultMessage:"Get template"}),T=a()(O.Z,{style:n.getTemplateButton,onClick:()=>{e.onAcceptTemplate(u,m),c.ye(t,{template_name:y,from:_.Z.state.analyticsFrom,target_team:null==m?void 0:m.id})}},void 0,k),I=a()(K.Z,{showMemberCount:!0,showPrivate:!0,placementToOrigin:N.Z.Placement.Top,originGap:4,sectionTitle:a()(E.FormattedMessage,{id:"templateDetail.addToTeamspace",defaultMessage:"Add to a teamspace",description:"Header of a section that lists different teamspaces. When one of those teamspaces are pressed, the template the user selected in the template gallery is then added to the teamspace."}),renderOrigin:e=>o.createElement(O.Z,Z()({},e,{style:n.getTemplateButton}),k),onTeamAccept:i=>{e.onAcceptTemplate(u,i),c.ye(t,{template_name:y,from:_.Z.state.analyticsFrom,target_team:i.id})},onPrivateAccept:()=>{e.onAcceptTemplate(u),c.ye(t,{template_name:y,from:_.Z.state.analyticsFrom,target_team:"private"})},right:a()(U.Z,{isBlue:!0,style:{borderRadius:"100px",pointerEvents:"none"},icon:F.Z.plusThick,hovered:!0,caption:a()(E.FormattedMessage,{defaultMessage:"Add",description:"Add a new instance of the databases to the team",id:"TemplateDetail.TeamItem.addButton"}),captionStyle:n.addBadgeTeamTemplateButton})});return o.createElement(o.Fragment,null,a()("div",{style:n.container},void 0,a()("div",{style:{height:"100%",overflowX:"hidden",overflowY:"auto",maskImage:"linear-gradient(black 80%, transparent 100%)",WebkitMaskImage:"linear-gradient(black 80%, transparent 100%)"}},void 0,a()("div",{style:{position:"relative"}},void 0,a()("div",{style:{marginTop:-20,opacity:1,zIndex:999,pointerEvents:"none"}},void 0,M),a()("div",{style:{backgroundColor:"transparent",position:"absolute",left:0,top:0,right:0,bottom:0,zIndex:1e3}}))),a()("div",{style:n.contentContainer},void 0,a()("div",{style:{display:"flex",flexDirection:"column"}},void 0,a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",marginBottom:20}},void 0,w,a()("div",{style:{display:"flex",flexDirection:"column",marginLeft:10}},void 0,a()("span",{style:{fontSize:20,fontWeight:700,lineHeight:1.2,marginTop:3}},void 0,y))),a()("div",{style:{fontSize:14}},void 0,S)),a()("div",{style:n.getTemplateColumn},void 0,C?I:T,a()("div",{style:n.madeByLabel},void 0,a()(W.Z,{isSmall:!0},void 0,a()(E.FormattedMessage,{id:"templateDetail.madeBy.label",defaultMessage:"Made by"})),a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginTop:4}},void 0,a()("img",{src:P.Z.images.notionLogoPng,style:{width:15,height:16}}),a()("span",{style:{fontSize:14,fontWeight:500,marginLeft:5,marginRight:5}},void 0,"Notion")))))))}var H=i(96486),G=i.n(H),j=i(31942),$=i(10482),Y=i(33929),Q=i(60709),X=i(33665),J=i(31194),ee=i(73657),te=i(52275),ie=i(74194),ne=i(3386),ae=i(16354),oe=i(78140),se=i(9342),re=i(72495),le=i(64921);function de(e){window.__c={n:"SelectPill"};const{icon:t,title:i,on:n,wrapStyle:o,innerStyle:r,hideChevron:d}=e,c=(0,l.Fg)(),u=(0,s.O7)(),p=(0,l.yK)((e=>({button:{fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderRadius:32,height:u.device.isMobile?28:24,lineHeight:u.device.isMobile?"28px":"24px",padding:"0 8px",border:`1px solid ${e.outlineButtonBorder}`,color:e.mediumTextColor,...n&&{color:e.blueColor,border:`1px solid ${e.filterPillBorder}`,background:e.filterPillBackground},...r}})),[u.device.isMobile,r,n]);return a()("div",{style:{borderRadius:14,marginRight:6,display:"inline-flex",...o}},void 0,a()(le.Z,{style:p.button,hoveredStyle:n?{background:c.outlineBlueButtonHoveredBackground}:void 0,pressedStyle:n?{background:c.outlineBlueButtonPressedBackground}:void 0,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,onDoubleClick:e.onDoubleClick},void 0,t,i,!d&&F.Z.chevronDown({width:10,marginLeft:4,marginTop:1,fill:n?c.blueColor:c.lightIconColor})))}var ce=i(14694);const ue=(0,E.defineMessages)({allPersona:{id:"templateGallery.sidebar.persona.allTemplates",defaultMessage:"All templates",description:"Category selector indicating all templates are shown"},noResults:{id:"templateGallery.sidebar.results",defaultMessage:"No results",description:"Message indicating no app & page template search results were found"}});function pe(){window.__c={n:"TemplateGallerySidebar"};const[e,t]=(0,o.useState)(""),i=(0,E.useIntl)(),n=(0,l.Fg)(),d=(0,s.O7)(),{selectedCategory:u,status:p}=(0,r.VK)((()=>_.Z.state),[]),[m,g]=(0,o.useState)(!1);(0,o.useEffect)((()=>{if(!m){const i=_.Z.state.selectedTemplate;var e,t;if(i)null===(e=document)||void 0===e||null===(t=e.getElementById(`tg-${"uri"in i?b.XR[i.uri]:i.template.name}`))||void 0===t||t.scrollIntoView({block:"center"}),g(!0)}}),[m]),(0,o.useEffect)((()=>{"closed"===p&&g(!1)}),[g,p]);const h=(0,l.yK)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},filterBar:{display:"flex",flexDirection:"row",width:273,flexWrap:"wrap",gap:6}})),[]),f=(0,o.useMemo)((()=>a()(ne.Z,{capture:!0,onBackspace:G().identity,onLeft:G().identity,onRight:G().identity,onSelectAll:G().identity,onRedo:G().identity,onUndo:G().identity,onCut:G().identity,onCopy:G().identity,onPaste:G().identity,onKeypress:G().identity,onDelete:G().identity,onTab:G().identity},void 0,a()(ie.Z,{placeholder:i.formatMessage({id:"templateGallery.sidebar.searchbar.placeholder",defaultMessage:"Search templates"}),left:F.Z.searchThick(h.searchIcon),showClearButton:!0,format:ie.Z.Format.Small,value:e,style:h.searchBar,onChange:e=>t(e.target.value)}))),[e,i,h.searchBar,h.searchIcon]),v=(0,o.useCallback)((e=>{var t,i,n;const s=[{key:"personas",render:e=>o.createElement(re.Z,Z()({},e,{topBorder:0!==e.index})),items:[void 0,...(0,C.Io)({userPersona:null===(t=T.default.state.currentUserSettingsStore)||void 0===t||null===(i=t.getSettings())||void 0===i?void 0:i.persona,subscriptionTier:null===(n=T.default.state.currentSpaceStore)||void 0===n?void 0:n.getSubscriptionTier()}).filter((e=>"suggested"!==e))].map((t=>({key:t??"all",render:e=>o.createElement(te.Z,Z()({},e,{focused:!1,checkState:G().isEqual(t,u),title:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,o.createElement(E.FormattedMessage,t?$._5[t]:ue.allPersona)),shouldWrapCaption:!0})),action:()=>{_.Z.setState({..._.Z.state,selectedCategory:t}),e.close(),c.NgT(d,{persona:t??"all"})}})))}],r={menuType:Q.og.Popup,width:260};return o.createElement(oe.Z,r,a()(se.Z,{type:se.i.Vertical,initialFocus:void 0,sections:s}))}),[d,u]),y=(0,o.useMemo)((()=>a()("div",{style:h.filterBar},void 0,a()(N.Z,{popupType:N.Z.PopupType.Popup,renderOrigin:e=>o.createElement(de,Z()({on:!0,icon:F.Z.person({width:14,marginRight:6,fill:n.blueColor}),title:a()("span",{},void 0,o.createElement(E.FormattedMessage,u?$._5[u]:ue.allPersona))},e)),placementToOrigin:J.Iw.Bottom,render:e=>v(e)}))),[v,u,h.filterBar,n.blueColor]);return a()("div",{style:h.sidebar},void 0,a()("div",{style:h.header},void 0,f,y),a()(me,{currentQuery:e,selectedCategory:u}))}function me(e){window.__c={n:"TemplateGallerySidebarItemList"};const{currentQuery:t,selectedCategory:i}=e,n=(0,l.Fg)(),d=(0,s.O7)(),u=""!==t||void 0!==i,{allTemplates:p,status:m,limitResults:g}=(0,r.VK)((()=>_.Z.state),[]),h=(0,l.yK)((e=>({button:{height:44,padding:"8px 0",borderRadius:4,marginBottom:4,transition:"all 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start"},categoryDiv:{marginBottom:u?0:14},unSelectedItem:{color:e.mediumTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.buttonHoveredBackground,fontWeight:500,color:e.regularTextColor},hoveredItem:{borderRadius:4,background:e.buttonHoveredBackground},presetTitle:{fontSize:14,color:e.regularTextColor},presetDescription:{fontSize:12},sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"},sidebarShowMore:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"2px 2px 0 6px"}})),[u]),f=(0,r.VK)((()=>{if("open"!==m||void 0===p)return[];const e=new Set;return Object.fromEntries(Object.entries(p).filter((e=>{let[t]=e;return void 0===i||t===i})).map((i=>{let[n,a]=i;return[n,(0,j.ZP)(t.replaceAll("-",""),a,(e=>`${e.name}`.replaceAll("-",""))).filter((t=>{const i=e.has(t.name);return e.add(t.name),!i}))]})))}),[m,p,i,t]),v=(0,o.useCallback)((e=>{"open"===m&&void 0!==g&&_.Z.setState({..._.Z.state,limitResults:{...g,[e]:!1}})}),[g,m]);return"open"!==m?null:a()("div",{style:{flexGrow:1,width:"100%",overflowY:"auto"}},void 0,a()(re.Z,{desktopTitleStyle:{paddingLeft:8}},void 0,Object.entries(f).map((e=>{let[t,i]=e;if(0===i.length)return;const n=(null==g?void 0:g[t])&&!u&&i.length>C.IJ+1,s=n?i.length-C.IJ:0,r=n?i.slice(0,C.IJ):i;return a()("div",{style:h.categoryDiv},t,!u&&a()(ce.Z,{style:h.sidebarTitle},void 0,o.createElement(E.FormattedMessage,$._5[t])),r.map((e=>"uri"in e?a()(ge,{icon:e.icon,name:e.name,template:{type:"preset",uri:e.uri}},e.uri):a()(ge,{icon:e.icon,emoji:e.emoji,name:e.name,template:{type:"pageTemplate",template:e}},e.id))),n&&s>0?a()(te.Z,{style:h.sidebarShowMore,focused:!1,onClick:()=>v(t),title:a()(E.FormattedMessage,{defaultMessage:"{numNotShown} more...",id:"templateGallerySidebar.category.showMore",description:"Show more button to limit how many templates are be shown at once. Clicking on it will show remaining templates in category.",values:{numNotShown:s}})}):void 0)})),0===Object.values(f).flatMap((e=>e)).length&&a()(ee.Z,{caption:Y.default.formatMessage(ue.noResults),style:{lineHeight:"14px",padding:6,margin:0}}),a()(te.Z,{desktopIconStyle:{alignSelf:"unset"},focused:!1,buttonStyle:{...h.button},title:a()(ae.Z,{href:(0,X.UY)("templateGallery"),onClick:()=>{c.T2x(d)},style:{display:"flex",flexDirection:"row",alignItems:"center"},external:!0},void 0,F.Z.typesRelation({width:15,height:15,marginLeft:6,marginRight:12,marginBottom:0,fill:n.mediumIconColor}),a()(E.FormattedMessage,{defaultMessage:"More from the Community",id:"templateGallerySidebar.goToMarketingTemplateGalleryButton.label"}))})))}function ge(e){var t;window.__c={n:"TemplateGallerySidebarItem"};const i=(0,s.O7)(),n=(0,l.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},itemText:{marginLeft:5},unSelectedItemText:{color:e.mediumTextColor},selectedItemText:{color:e.regularTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500},hoveredItem:{background:e.buttonHoveredBackground},presetIcon:{width:16,height:16,fontSize:16,color:e.regularEmojiColor},presetTitle:{fontSize:14},presetDescription:{fontSize:12}})),[]),{status:d,selectedTemplate:u,analyticsFrom:p}=(0,r.VK)((()=>_.Z.state),[]),m=(0,r.VK)((()=>"open"===d&&G().isEqual(u,e.template)),[d,e.template,u]),g=(0,o.useCallback)((()=>{const t="uri"in e.template?b.XR[e.template.uri]:e.template.template.previewRootId,n=(0,C.W4)({templateGalleryItem:t});h.navigate({environment:i,url:n}),c.n1D(i,{template_name:"preset"===e.template.type?e.template.uri:e.template.template.name,page_prepopulated_template_id:t,from:p})}),[p,i,e.template]);if("open"!==d)return null;const f=null!==(t=e.icon)&&void 0!==t&&t.startsWith("/")?a()("img",{src:e.icon,style:n.presetIcon}):a()("div",{style:n.presetIcon},void 0,a()(V.Z,{},void 0,e.emoji??e.icon??"")),v=`tg-${"uri"in e.template?b.XR[e.template.uri]:e.template.template.name}`;return a()(te.Z,{id:v,desktopIconStyle:{alignSelf:"unset"},buttonStyle:{...n.button,...m?n.selectedItem:void 0},textWrapperStyle:{...m?n.selectedItemText:n.unSelectedItemText,...n.itemText},focused:!1,icon:f,title:a()("span",{style:n.presetTitle},void 0,e.name),shouldWrapCaption:!0,hoveredStyle:n.hoveredItem,onClick:g})}function he(){const e=(0,s.Fy)(),t=(0,s.O7)(),i=(0,l.yK)((t=>({modal:{width:e.isMobile?"auto":"90vw",height:e.isMobile?"auto":"90vh",borderRadius:8}})),[e.isMobile]),{currentSpaceStore:n,currentUserSettingsStore:d,inAppCalloutStore:x}=(0,r.VK)((()=>{const{currentSpaceStore:e,currentUserSettingsStore:t,inAppCalloutStore:i}=T.default.state;return{currentSpaceStore:e,currentUserSettingsStore:t,inAppCalloutStore:i}}),[]),{templateGalleryItem:Z}=(0,r.VK)((()=>t.RouterStore.state.route),[t.RouterStore]),{status:P,allTemplates:F,selectedTemplate:A,cloneTo:B,limitResults:E}=(0,r.VK)((()=>_.Z.state),[]),D=(0,r.VK)((()=>(0,M.gw)({environment:t,currentSpaceStore:n,currentUserSettingsStore:d,inAppCalloutStore:x})),[n,d,t,x]);(0,o.useEffect)((()=>{if(D)_.Z.setState({..._.Z.state,status:"closed",selectedTemplate:void 0});else if("opening"===P){var e,t,i;const n=F??(0,C.GH)({userPersona:null===(e=T.default.state.currentUserSettingsStore)||void 0===e||null===(t=e.getSettings())||void 0===t?void 0:t.persona,subscriptionTier:null===(i=T.default.state.currentSpaceStore)||void 0===i?void 0:i.getSubscriptionTier()}),a=void 0!==A&&(void 0===Z||"gallery"===Z)?A:ve({templateGalleryItem:Z,allTemplates:n}),o=_.Z.state.limitResults??fe(n);_.Z.setState({..._.Z.state,status:"open",allTemplates:n,selectedTemplate:a,limitResults:o,analyticsFrom:_.Z.state.analyticsFrom,cloneTo:_.Z.state.cloneTo})}}),[F,t,P,A,Z,D]),(0,o.useEffect)((()=>{if(D)_.Z.setState({..._.Z.state,status:"closed",selectedTemplate:void 0});else if(void 0!==F&&"opening"===P){const e=void 0!==A&&(void 0===Z||"gallery"===Z)?A:ve({templateGalleryItem:Z,allTemplates:F});_.Z.setState({..._.Z.state,status:"open",allTemplates:F,selectedTemplate:e,limitResults:E??fe(F),cloneTo:_.Z.state.cloneTo,analyticsFrom:_.Z.state.analyticsFrom}),c.jWY(t,{template_name:"preset"===e.type?e.uri:e.template.name,from:_.Z.state.analyticsFrom})}}),[Z,t,F,P,A,B,E,D]),(0,o.useEffect)((()=>{"open"===P&&void 0!==F&&void 0!==Z&&"gallery"!==Z&&_.Z.setState({..._.Z.state,selectedTemplate:ve({templateGalleryItem:Z,allTemplates:F})})}),[F,P,Z]);const R=(0,r.VK)((()=>{const e=(0,v.np)();if("open"===P&&"current_page"===B&&e&&e.isEmptyPage())return e}),[B,P]),L=(0,o.useCallback)((async(e,i)=>{var n,a,o;_.Z.setState({..._.Z.state,status:"closed",selectedTemplate:void 0});const{currentSpaceStore:s,currentSpaceViewStore:r}=T.default.state,l=null==R||!R.getParentStore()||"block"!==(null===(n=R.getParentStore())||void 0===n?void 0:n.table)&&"space"!==(null===(a=R.getParentStore())||void 0===a?void 0:a.table)&&"team"!==(null===(o=R.getParentStore())||void 0===o?void 0:o.table)?i||s:R.getParentStore(),d=Date.now();let v;if("preset"!==e.type||e.uri.startsWith("notion://wiki")){const n="preset"===e.type?(0,S.CQ)(e.uri):e.template;if(!n)return;if(!s||!r)return;const a={environment:t,item:n,spaceStore:s,spaceViewStore:r,useMinimalTemplates:!1,from:"template_gallery"},o=R?await g.rC({...a,isPrivate:!1,initializeStore:R,type:"inExistingStore"}):i?await g.rC({...a,isPrivate:!1,teamStore:i,type:"inTeam",appendOrPrepend:"append"}):await g.rC({...a,isPrivate:!0,type:"inSpace"});v=o,o&&h.navigateToBlock({environment:t,store:o})}else{var M;const n=e.uri,a=null===(M=(0,b.SP)(n))||void 0===M?void 0:M.uri;if(!(a&&s&&r&&l))return;const o=i||w.VP(l);if(o){if(!(await async function(e){let{environment:t,spaceId:i,presetUri:n,teamStore:a}=e;const o=p.Y6(n);if(!o)return!0;if("tasks"===o)return!0;return await(0,k.l)({environment:t,spaceId:i,databaseCreationType:o,parentStore:a,teamId:a.id,from:"template_gallery"})}({environment:t,spaceId:s.id,presetUri:n,teamStore:o})))return}const d=R||(i?i.getTeamPagesStores().find((e=>e.getFormat().app_config_uri&&e.getFormat().app_config_uri===a)):void 0);f.createAndCommit({environment:t,userAction:"templateGallery.getTemplate",perform:e=>{const i=(0,y.p)().find((e=>e.uri===a)),o=null==i?void 0:i.presets.find((e=>e.uri===n));if(o){const i=p.ZF({environment:t,appUri:a,presetUri:o.uri,appParentStore:l,temporaryContainerBlockStore:d,transaction:e,from:"template_gallery"});m.G({environment:t,appParentStore:l,transaction:e,blockStores:i,creationEntryPoint:{type:"preset",presetUri:o.uri}})}}}),u.finalizeAppTemplate(t,{})}const C="preset"===e.type?e.uri:e.template.name,I=Date.now()-d,x=R?!w.VP(R):!Boolean(i),Z=x||null==i?void 0:i.id;c.enX(t,{template_name:C,destination:x?"private":"team",template_block_id:"pageTemplate"===e.type?e.template.rootId:void 0,template_duplication_duration_ms:I,team_id:Z,created_page_id:v?v.id:null==R?void 0:R.id}),"preset"===e.type&&v&&c.bRT(t,{preset_uri:e.uri,created_block_stores:[v],from:"template_gallery",destination_team_id:Z}),"pageTemplate"===e.type&&be(e.template.id)&&v&&c.Jw_(t,{from:"template_gallery",wiki_block_id:v.id,destination_team_id:Z,wiki_template_id:e.template.id})}),[t,R]),O=(0,o.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=T.default.state,{RouterStore:i}=t,n=i.state.route;if(e&&"page"===n.name){const e=(0,C.p8)();h.navigate({environment:t,url:e})}}),[t]);return D?null:a()(I.Z,{open:"open"===P,innerStyle:i.modal,onDismiss:O,render:()=>"open"!==P?null:a()("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"}},void 0,a()(pe,{}),a()(q,{onAcceptTemplate:L}))})}function fe(e){const t=Object.keys(e).map((e=>[e,!0]));return Object.fromEntries(t)}function ve(e){let{templateGalleryItem:t,allTemplates:i}=e;if(!t||"gallery"===t){var n;return"team"===(null===(n=T.default.state.currentSpaceStore)||void 0===n?void 0:n.getPlanType())?{type:"preset",uri:"notion://projects/projects_preset"}:ye(i)}const a=Object.values(i).flatMap((e=>e)).find((e=>"uri"in e?b.XR[e.uri]===t:e.previewRootId===t));return a?"uri"in a?{type:"preset",uri:a.uri}:{type:"pageTemplate",template:a}:ye(i)}function ye(e){const t=e[Object.keys(e)[0]][0];return"uri"in t?{type:"preset",uri:t.uri}:{type:"pageTemplate",template:t}}function be(e){return["defaultWiki","teamWiki","salesWiki","engineeringWiki","companyHome"].some((t=>d.Y[t].nameMessage.id===e))}},72340:(e,t,i)=>{i.d(t,{Tc:()=>a,$6:()=>o});var n=i(10161);function a(e){return"on"===n.default.getEligibleGroup({experimentId:"parallel_confluence_importer_via_api",defaultGroup:"control"})}function o(e){return n.default.getEligibleGroup({experimentId:"special_case_confluence_file_size",defaultGroup:5..toString()})}},4657:(e,t,i)=>{i.d(t,{U:()=>S});var n=i(77094),a=i.n(n),o=(i(67294),i(480)),s=i(81954),r=i(24405),l=i(8848),d=i(3779),c=i(5366),u=i(64684),p=i(93678),m=i(74136);const g=function(e){let{tier:t}=e;window.__c={n:"TeamUpsellBadge"};const i=()=>a()(c.FormattedMessage,"business"===t?{id:"upgradeToBusinessBadge",description:"Shows Business Plan is required to access feature",defaultMessage:"Business"}:{id:"upgradeToEnterpriseBadge",description:"Shows Enterprise plan is required to access feature",defaultMessage:"Enterprise"});return a()(m.Z,{},void 0,a()(i,{}))};var h=i(38755),f=i(27832),v=i(12205),y=i(45660),b=i(35901);function S(e){let{teamStore:t,isDefault:i,onChange:n=(()=>{})}=e;const m=(0,o.O7)(),S=(0,v.J)(),M=(0,b.y)(null==t?void 0:t.id),C=(0,y.e)(),k="business",T=(0,s.VK)((()=>f.default.state.currentSpaceStore),[]),_=(0,s.VK)((()=>{if(T)return(0,h.rn)(m,T)}),[m,T]),I=(0,s.VK)((()=>{const e=null==t?void 0:t.getSettingsStore().getValue();return!!e&&("private"===(0,u.B5)(e)??!1)}),[t]),x=(0,r.yK)((()=>({openIcon:{width:20,height:20},lockIcon:{width:18,height:18},closedIcon:{width:20,height:20},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginLeft:5,marginRight:5}})),[]),Z=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamspaceUpsellBusiness.tooltip",defaultMessage:"Upgrade to Business Plan to enable Private teamspaces",description:"Tooltip asks user to upgrade to Business Plan to be able to set team as private"}),P=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamSpace.title",defaultMessage:"Default",description:"Toggle title for default teamspace."}),F=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.title",defaultMessage:"Open",description:"Toggle title for open teamspace."}),A=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.closedTeamSpace.title",defaultMessage:"Closed",description:"Toggle title for closed teamspace."}),B=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamSpace.title",defaultMessage:"Private",description:"Toggle title for private teamspace."}),E="dark"===(0,r.Fg)().mode?l.ZP.uiLightGray:l.ZP.black,D=[{key:"open",icon:e=>a()("div",{style:x.iconContainer},void 0,d.Z.openTeam({...e,...x.openIcon})),iconColor:E,level:F,title:F,caption:a()(c.FormattedMessage,{id:"CreateTeamspaceMenu.openTeamspace.caption",defaultMessage:"Anyone can see and join this teamspace",description:"Toggle caption for open teamspace."}),disabled:!1,onSelect:()=>n("open",!1)},{key:"closed",icon:e=>a()("div",{style:x.iconContainer},void 0,d.Z.closedTeam({...e,...x.closedIcon})),iconColor:E,level:A,title:A,caption:a()(c.FormattedMessage,{id:"CreateTeamspaceMenu.closedTeamspace.caption",defaultMessage:"Anyone can see this teamspace but not join",description:"Toggle caption for closed teamspace."}),disabled:!1,onSelect:()=>n("closed",!1)},{key:"private",icon:e=>a()("div",{style:x.iconContainer},void 0,d.Z.locked({...e,...x.lockIcon})),iconColor:E,level:B,title:C?a()(w,{title:B,badge:a()(g,{tier:k})}):B,caption:a()(c.FormattedMessage,{id:"CreateTeamspaceMenu.privateTeamspace.caption",defaultMessage:"Only members can see that this teamspace exists",description:"Toggle caption for private teamspace."}),disabled:C&&!S,tooltip:C?Z:void 0,onSelect:()=>{if(C&&!I)return p.y(m,{from:"team_security_settings",for:k,dontOpenPlansOnCancel:!0});n("private",!1)}}];if(i||S){const e=i&&(!S||M),t={key:"default",icon:e=>a()("div",{style:x.iconContainer},void 0,d.Z.globe2({...e,...x.lockIcon})),iconColor:E,level:P,title:P,caption:a()(c.FormattedMessage,{id:"CreateTeamspaceMenu.defaultTeamspace.caption",defaultMessage:"Everyone at {spaceName} must be a member",description:"Toggle caption for default teamspace.",values:{spaceName:_}}),disabled:!1,disableAllOptionsTooltip:e?a()(c.FormattedMessage,S?{id:"TeamAccessLevelSwitcher.closeOrPrivateTeamspace.disabledTooltipOnlyDefaultTeam",defaultMessage:"Add another default teamspace to change teamspace permissions.",description:"Tooltip text shown when hovering over close or private teamspace button and it is disabled because this is the only default teamspace left."}:{id:"TeamAccessLevelSwitcher.defaultTeamspace.disabledTooltipNonAdmin",defaultMessage:"You can't change this setting because you are not a workspace admin",description:"Tooltip text shown when hovering over default teamspace button and changing it is disabled because user is not a workspace admin."}):void 0,onSelect:()=>n("open",!0)};D.unshift(t)}return D}function w(e){let{title:t,badge:i}=e;window.__c={n:"TitleWithBadge"};const n=(0,r.yK)((()=>({container:{display:"flex",flexWrap:"wrap",alignItems:"center"},badge:{marginLeft:5}})),[]);return a()("div",{style:n.container},void 0,t,a()("div",{style:n.badge},void 0,i))}},22756:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(49085);class a extends n.Z{getInitialState(){return{isModalOpen:!1,currentTab:"selectData",account:void 0,isAccountLinkingInProgress:!1,isAccountDelinkingInProgress:!1,workspaces:[],teamsAndProjects:[],selectedWorkspace:void 0,selectedProjectsAndTeamspaces:{},importCompletedTasks:!0,teams:void 0,loadMoreClicks:0,isLoadingProjects:!1,isLoadingAsanaWorkspaces:!1,result:void 0,isComplete:!1,loggerPageId:void 0,templateCreationInProgress:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const o=new a},74021:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(49085);class a extends n.Z{getInitialState(){return{open:!1}}}const o=new a},78900:(e,t,i)=>{i.d(t,{Z:()=>n});const n=new(i(61766).Z)}}]);